<div class="h-auto lg:h-screen w-full flex flex-col bg-gray-100 font-sans text-xs md:text-sm xl:text-base lg:overflow-hidden select-none transition-colors duration-500"
     [class.eco-mode]="store.performanceMode() === 'eco'">
  
  <!-- Global ECO Styles Injection -->
  <style>
    .eco-mode * {
      box-shadow: none !important;
      text-shadow: none !important;
      backdrop-filter: none !important;
      background-image: none !important; /* Remove gradients */
      -webkit-backdrop-filter: none !important;
      transition: none !important;
    }
    .eco-mode .shadow-sm, .eco-mode .shadow-md, .eco-mode .shadow-lg, .eco-mode .shadow-xl {
      border: 1px solid #d1d5db !important;
    }
    .eco-mode .animate-pulse, .eco-mode .animate-bounce, .eco-mode .animate-pulse-soft, .eco-mode .animate-fade-in {
      animation: none !important;
    }
  </style>

  <!-- Corporate Header: KOF Executive (Slate-900 with Red Accent) -->
  <header class="bg-slate-900 text-white shadow-md px-4 sm:px-6 py-3 lg:py-2 flex flex-col sm:flex-row justify-between items-center shrink-0 z-20 min-h-[auto] lg:h-[8vh] gap-3 border-b-2 border-coke-red relative overflow-hidden">
    
    <!-- Subtle Coke Curve Pattern (Low opacity) -->
    <div class="absolute right-0 top-0 h-full w-1/3 bg-gradient-to-l from-white/5 to-transparent pointer-events-none"></div>

    <div class="flex items-center gap-4 w-full sm:w-auto justify-center sm:justify-start z-10">
      <!-- Logo Circle -->
      <div class="w-10 h-10 lg:w-12 lg:h-12 bg-white text-coke-red rounded-full flex items-center justify-center font-black text-xs md:text-sm shadow-sm ring-2 ring-slate-700 shrink-0">
        KOF
      </div>
      <div class="text-center sm:text-left">
        <h1 class="text-sm sm:text-lg lg:text-xl font-bold tracking-tight leading-tight uppercase text-gray-100">
            Resultados <span class="font-light opacity-75">{{ store.lastUpdate() | date:'MMM yyyy' }}</span>
        </h1>
        <div class="flex items-center gap-2 justify-center sm:justify-start">
            <span class="w-2 h-2 bg-emerald-500 rounded-full animate-pulse shadow-[0_0_8px_rgba(16,185,129,0.5)]"></span>
            <p class="text-slate-400 uppercase text-[10px] sm:text-xs font-medium tracking-widest">Planta Central &bull; En Vivo</p>
        </div>
      </div>
    </div>
    
    <div class="text-center sm:text-right w-full sm:w-auto flex justify-between sm:block border-t border-slate-700 sm:border-0 pt-2 sm:pt-0 z-10">
      <div class="text-lg sm:text-2xl lg:text-3xl font-bold leading-none tracking-tight text-white font-mono">
        {{ store.lastUpdate() | date:'HH:mm' }}
      </div>
      <div class="text-slate-400 text-[10px] sm:text-xs uppercase font-semibold tracking-wide">
        {{ store.lastUpdate() | date:'EEEE, d MMM' }}
      </div>
      <button
        (click)="forceGlobalSync()"
        class="mt-1 sm:mt-0 sm:ml-2 px-2 py-1 bg-coke-red hover:bg-red-700 text-white text-xs font-bold rounded shadow-sm transition-colors"
        title="Sincronizar globalmente con la base de datos">
        üîÑ SYNC
      </button>
    </div>
  </header>

  <!-- Main Grid Container -->
  <main class="flex-1 p-3 md:p-4 bg-gray-100 w-full overflow-y-auto lg:overflow-hidden h-auto lg:h-[88vh]">
    <!-- Grid System -->
    <div class="grid grid-cols-1 lg:grid-cols-12 auto-rows-auto lg:grid-rows-[minmax(0,1fr)_minmax(0,1fr)_minmax(0,1fr)] gap-4 lg:gap-4 h-auto lg:h-full w-full pb-20 lg:pb-0">

      @for (widget of store.layout(); track widget.id) {
        
        @switch (widget.id) {
          
          <!-- Safety (Row 1, 3 Cols) -->
          @case ('safety') {
            <div class="col-span-1 lg:col-span-3 lg:row-span-1 flex flex-col gap-3 h-auto lg:h-full min-h-[220px] lg:min-h-0">
              <!-- Safety Card -->
              <div class="bg-white rounded-lg shadow-sm border border-gray-200 flex-[2] flex flex-col relative overflow-hidden group">
                <div class="h-1 w-full bg-slate-800"></div>
                <div class="p-3 flex flex-col h-full">
                    <h3 class="font-bold text-gray-400 uppercase text-[10px] lg:text-xs mb-1 tracking-wider">Seguridad Industrial</h3>
                    <div class="flex-1 flex flex-col items-center justify-center py-2 lg:py-0">
                      <div class="text-6xl lg:text-6xl xl:text-7xl font-black text-slate-800 leading-none tracking-tighter">
                          {{ store.safety().daysWithoutAccident }}
                      </div>
                      <div class="text-slate-500 font-bold text-xs uppercase tracking-widest mt-1">D√≠as sin Accidentes</div>
                    </div>
                    <div class="grid grid-cols-2 gap-2 mt-2 text-center">
                        <div class="bg-gray-50 rounded py-1 px-2 border border-gray-100">
                            <span class="block text-gray-400 text-[9px] uppercase font-bold">R√©cord</span>
                            <span class="font-bold text-slate-700 text-sm">{{ store.safety().recordDays }}</span>
                        </div>
                        <div class="bg-gray-50 rounded py-1 px-2 border border-gray-100">
                            <span class="block text-gray-400 text-[9px] uppercase font-bold">Anterior</span>
                            <span class="font-bold text-slate-700 text-sm">{{ store.safety().previousRecord }}</span>
                        </div>
                    </div>
                </div>
              </div>

              <!-- Warehouse Card -->
              <div class="bg-white rounded-lg shadow-sm border border-gray-200 flex-1 flex flex-col justify-center px-3 py-2 min-h-[100px] lg:min-h-0 relative">
                @let ptPerc = (store.warehouse().ptReal / store.warehouse().ptCap) * 100;
                @let matPerc = (store.warehouse().matReal / store.warehouse().matCap) * 100;
                
                <h3 class="font-bold text-gray-400 uppercase text-[10px] tracking-wide mb-2">Saturaci√≥n Almac√©n</h3>
                
                <div class="mb-2">
                    <div class="flex justify-between text-[10px] font-bold mb-0.5">
                        <span class="text-slate-600">Prod. Terminado</span>
                        <span class="text-slate-800">{{ ptPerc | number:'1.0-0' }}%</span>
                    </div>
                    <div class="w-full bg-gray-100 rounded-full h-1.5 overflow-hidden">
                        <div class="h-1.5 rounded-full" [style.width.%]="ptPerc"
                             [class.bg-emerald-500]="ptPerc <= 85"
                             [class.bg-amber-400]="ptPerc > 85 && ptPerc <= 95"
                             [class.bg-rose-500]="ptPerc > 95"></div>
                    </div>
                </div>
                <div>
                    <div class="flex justify-between text-[10px] font-bold mb-0.5">
                        <span class="text-slate-600">Materiales</span>
                        <span class="text-slate-800">{{ matPerc | number:'1.0-0' }}%</span>
                    </div>
                    <div class="w-full bg-gray-100 rounded-full h-1.5 overflow-hidden">
                        <div class="h-1.5 rounded-full" [style.width.%]="matPerc"
                             [class.bg-emerald-500]="matPerc <= 85"
                             [class.bg-amber-400]="matPerc > 85 && matPerc <= 95"
                             [class.bg-rose-500]="matPerc > 95"></div>
                    </div>
                </div>
              </div>
            </div>
          }

          <!-- Freight (Row 1, 9 Cols) -->
          @case ('freight') {
            <div class="col-span-1 lg:col-span-9 lg:row-span-1 bg-white shadow-sm rounded-lg flex flex-col h-[280px] lg:h-full min-h-0 overflow-hidden border border-gray-200">
              <div class="bg-slate-50 border-b border-gray-200 px-4 py-2 flex justify-between items-center shrink-0 h-[40px] lg:h-[12%]">
                <span class="font-bold uppercase tracking-wide text-xs md:text-sm text-slate-700 flex items-center gap-2">
                    Cumplimiento al Programa de Fleteo
                </span>
                <span class="bg-white border border-gray-200 text-gray-500 px-2 py-0.5 rounded text-[10px] font-bold tracking-wider">MENSUAL</span>
              </div>
              <div class="flex-1 w-full min-h-0 relative p-3 h-[calc(100%-40px)] lg:h-[88%]">
                <app-d3-bar-chart 
                  [data]="store.freight()"
                  [autoScroll]="true" 
                  [windowSize]="15"
                  [performanceMode]="store.performanceMode()"
                  xKey="day" 
                  barDataKey="real" 
                  lineDataKey="planned"
                  barLabel="Cargados" 
                  lineLabel="Plan"
                  barColor="#334155" 
                  lineColor="#000000">
                </app-d3-bar-chart>
              </div>
            </div>
          }

          <!-- Downtime (Row 2, 3 Cols) -->
          @case ('downtime') {
            <div class="col-span-1 lg:col-span-3 lg:row-span-1 bg-white shadow-sm rounded-lg flex flex-col h-[220px] lg:h-full min-h-0 overflow-hidden border border-gray-200">
               <div class="bg-gray-50 border-b border-gray-200 px-4 py-2 shrink-0">
                  <h3 class="font-bold text-gray-500 uppercase text-[10px] md:text-xs tracking-wide truncate">
                    Tiempo Perdido (Montacargas)
                  </h3>
               </div>
              <div class="flex-1 overflow-auto min-h-0 px-2">
                <table class="w-full text-[10px] xl:text-xs text-left">
                  <thead class="sticky top-0 bg-white border-b border-gray-100 text-gray-400 font-medium">
                    <tr>
                      <th class="py-2 pl-2">Linea</th>
                      <th class="py-2 text-center">Min</th>
                      <th class="py-2">Trip</th>
                      <th class="py-2 text-center">Est</th>
                    </tr>
                  </thead>
                  <tbody class="divide-y divide-gray-50">
                    @for (item of store.downtime(); track item.line) {
                      <tr class="group hover:bg-gray-50 transition-colors">
                        <td class="py-2 pl-2 font-bold text-slate-600">{{ item.line }}</td>
                        <td class="py-2 text-center font-bold text-slate-800 bg-gray-50 rounded">{{ minutesToTime(item.lostTime) }}</td>
                        <td class="py-2 truncate max-w-[50px] text-gray-500 pl-1" [title]="item.crew">{{ item.crew }}</td>
                        <td class="py-2 flex justify-center">
                          <span class="w-2 h-2 rounded-full"
                              [class.bg-emerald-500]="item.pdf >= 1.0"
                              [class.bg-amber-400]="item.pdf < 1.0 && item.pdf >= 0.9"
                              [class.bg-rose-500]="item.pdf < 0.9">
                          </span>
                        </td>
                      </tr>
                    }
                  </tbody>
                </table>
              </div>
            </div>
          }

          <!-- Stay Time (Row 2, 6 Cols) -->
          @case ('stayTime') {
            <div class="col-span-1 lg:col-span-6 lg:row-span-1 bg-white shadow-sm rounded-lg flex flex-col h-[280px] lg:h-full min-h-0 overflow-hidden border border-gray-200">
              <div class="flex justify-between items-center border-b border-gray-200 px-4 py-2 shrink-0 h-[40px] lg:h-[12%] bg-slate-50">
                 <h3 class="font-bold text-slate-700 uppercase text-[10px] md:text-xs tracking-wide">
                    Tiempo de Estancia
                 </h3>
                 <span class="text-[9px] text-white font-bold bg-slate-600 px-2 py-0.5 rounded-full">Promedio</span>
              </div>
              <div class="flex-1 min-h-0 w-full relative h-[calc(100%-40px)] lg:h-[88%] p-3">
                <app-d3-bar-chart 
                  [data]="store.stayTime()"
                  [autoScroll]="true"
                  [windowSize]="12"
                  [performanceMode]="store.performanceMode()"
                  xKey="day"
                  barDataKey="real"
                  lineDataKey="goal"
                  valueFormat="time"
                  barColor="#94a3b8" 
                  barLabel="Real"
                  lineLabel="Meta"
                  lineColor="#334155"
                  [lowerIsBetter]="true">
                </app-d3-bar-chart>
              </div>
            </div>
          }

          <!-- Waste & Discipline (Row 2, 3 Cols) -->
          @case ('waste_discipline') {
            <div class="col-span-1 lg:col-span-3 lg:row-span-1 bg-white shadow-sm rounded-lg flex flex-col h-[220px] lg:h-full min-h-0 overflow-hidden border border-gray-200">
               <div class="flex-1 p-3 border-b border-gray-100 min-h-0 flex flex-col bg-gray-50">
                  <h3 class="font-bold text-gray-500 uppercase mb-1 text-[10px] xl:text-xs shrink-0 tracking-wide">Disciplina Operativa</h3>
                  <div class="flex-1 flex flex-col justify-center">
                    <table class="w-full text-[10px] xl:text-xs">
                      <tbody class="divide-y divide-gray-200">
                        <tr>
                           <td class="py-2 text-slate-600 font-medium">Faltas Injustificadas</td>
                           <td class="py-2 text-right text-rose-600 font-bold">2</td>
                        </tr>
                        <tr>
                           <td class="py-2 text-slate-600 font-medium">Retardos</td>
                           <td class="py-2 text-right text-amber-600 font-bold">5</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
               </div>
               <div class="flex-1 p-3 min-h-0 flex flex-col">
                  <h3 class="font-bold text-gray-500 uppercase mb-1 text-[10px] xl:text-xs shrink-0 tracking-wide">Merma Operativa ($)</h3>
                  <div class="flex-1 overflow-auto">
                    <table class="w-full text-[9px] xl:text-xs text-left">
                      <thead class="text-gray-400 font-medium">
                        <tr><th class="py-1">Mat</th><th class="py-1 text-right">Real</th><th class="py-1 text-right">Obj</th></tr>
                      </thead>
                      <tbody class="divide-y divide-gray-50">
                        @for (item of store.waste(); track item.material) {
                          <tr>
                            <td class="py-1.5 font-bold text-slate-600 truncate max-w-[50px]">{{ item.material }}</td>
                            <td class="py-1.5 text-right font-bold" 
                                [class.text-rose-600]="item.real > item.target"
                                [class.text-emerald-600]="item.real <= item.target">
                                {{ item.real | currency:'MXN':'symbol':'1.0-0' }}
                            </td>
                            <td class="py-1.5 text-right text-gray-400">{{ item.target | currency:'MXN':'symbol':'1.0-0' }}</td>
                          </tr>
                        }
                      </tbody>
                    </table>
                  </div>
               </div>
            </div>
          }

          <!-- Bonus Table (Row 3, 8 Cols) - 3-ROW TV LAYOUT -->
          @case ('bonus') {
            <div class="col-span-1 lg:col-span-8 lg:row-span-1 bg-white shadow-sm rounded-lg flex flex-col h-auto min-h-[300px] lg:min-h-0 lg:h-full z-0 overflow-hidden border border-gray-200">
              
              <!-- Row 1: Term√≥metro (Compact Height) -->
              <div class="flex items-center justify-between px-6 py-2 border-b border-gray-100 bg-gray-50 shrink-0 h-[22%]">
                 <div class="flex flex-col justify-center">
                    <h2 class="text-lg lg:text-2xl font-black text-slate-800 uppercase tracking-tight leading-none">Bono Planta Hoy</h2>
                    <span class="text-[10px] lg:text-xs font-bold text-gray-400 tracking-wider mt-1 uppercase">Logro Ponderado</span>
                 </div>
                 
                 <div class="flex items-center gap-6 flex-1 justify-end max-w-xl">
                    <div class="flex-1 bg-gray-200 h-6 rounded-full overflow-hidden relative shadow-inner">
                        <div class="h-full rounded-full transition-all duration-1000 ease-out"
                             [style.width.%]="store.bonusGlobal().percentage"
                             [class.bg-emerald-500]="store.bonusGlobal().percentage >= 80"
                             [class.bg-amber-400]="store.bonusGlobal().percentage >= 60 && store.bonusGlobal().percentage < 80"
                             [class.bg-rose-500]="store.bonusGlobal().percentage < 60">
                        </div>
                        <span class="absolute inset-0 flex items-center justify-center text-xs font-black text-slate-700 mix-blend-multiply">
                           {{ store.bonusGlobal().percentage }}%
                        </span>
                    </div>
                    <div class="flex flex-col items-end justify-center">
                       <span class="text-[10px] text-gray-400 font-medium">Si cerr√°ramos hoy:</span>
                       <span class="text-xl lg:text-2xl font-black uppercase tracking-tight leading-none"
                             [class.text-emerald-600]="store.bonusGlobal().label === 'Alto'"
                             [class.text-amber-500]="store.bonusGlobal().label === 'Medio'"
                             [class.text-rose-600]="store.bonusGlobal().label === 'Bajo'">
                          {{ store.bonusGlobal().label }}
                       </span>
                    </div>
                 </div>
              </div>

              <!-- Row 2: Tabla Ejecutiva (Flexible Height, No Scroll) -->
              <div class="flex-1 overflow-hidden bg-white px-6 py-1">
                <table class="w-full text-left border-collapse h-full">
                  <thead class="text-[10px] uppercase text-gray-400 font-bold tracking-wider border-b border-gray-100 h-[30px]">
                    <tr>
                      <th class="py-1 w-[40%] align-middle">Indicador</th>
                      <th class="py-1 text-right align-middle">Resultado</th>
                      <th class="py-1 text-center text-[9px] w-[20%] align-middle">Rango Objetivo (SAT ‚Üò EXC)</th>
                      <th class="py-1 text-center align-middle">Peso</th>
                      <th class="py-1 text-right align-middle">Estado</th>
                    </tr>
                  </thead>
                  <tbody class="text-xs lg:text-sm font-medium text-slate-600 divide-y divide-gray-50">
                     @for (row of store.bonusObjectives(); track row.description) {
                       <tr class="group hover:bg-slate-50 transition-colors">
                          <td class="py-1 font-bold text-slate-700 pr-2 truncate max-w-[200px] align-middle" [title]="row.description">{{ row.description }}</td>
                          
                          <!-- Helper Template -->
                          <ng-template #valTemplate let-val="val">
                            @if (row.format === 'currency') {
                              {{ val | currency:'MXN':'symbol':'1.0-0' }}
                            } @else if (row.format === 'time') {
                              {{ minutesToTime(val) }}
                            } @else if (row.format === 'percent') {
                              {{ val | number:'1.1-1' }}%
                            } @else {
                              {{ val | number:'1.4-4' }}
                            }
                          </ng-template>

                          <td class="py-1 text-right font-black text-slate-800 text-sm align-middle">
                             <ng-container *ngTemplateOutlet="valTemplate; context: { val: row.accumulated }"></ng-container>
                          </td>

                          <td class="py-1 text-center text-xs font-mono text-gray-500 align-middle">
                             <span class="opacity-75"><ng-container *ngTemplateOutlet="valTemplate; context: { val: row.sat }"></ng-container></span>
                             <span class="mx-1 text-gray-300 font-bold">@if (row.exc > row.sat) { ‚Üó } @else { ‚Üò }</span>
                             <span class="font-bold text-slate-600"><ng-container *ngTemplateOutlet="valTemplate; context: { val: row.exc }"></ng-container></span>
                          </td>

                          <td class="py-1 text-center font-bold text-gray-400 text-xs align-middle">{{ row.weight }}</td>

                          <td class="py-1 text-right align-middle">
                             <span class="px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-wide inline-block w-[90px] text-center"
                                   [class.bg-emerald-50]="row.status === 'Excelente'"
                                   [class.text-emerald-700]="row.status === 'Excelente'"
                                   [class.bg-amber-50]="row.status === 'Satisfactorio' || row.status === 'Minimo'"
                                   [class.text-amber-700]="row.status === 'Satisfactorio' || row.status === 'Minimo'"
                                   [class.bg-rose-50]="row.status === 'Bajo'"
                                   [class.text-rose-700]="row.status === 'Bajo'">
                                {{ row.status }}
                             </span>
                          </td>
                       </tr>
                     }
                  </tbody>
                </table>
              </div>

              <!-- Row 3: Mensaje + Tripulaci√≥n (Compact Height) - GOLD WINNER DESIGN -->
              <div class="h-[15%] bg-gray-50 border-t border-gray-100 flex items-center justify-between px-6 py-2 shrink-0">
                  <p class="text-[10px] text-gray-500 italic max-w-[50%] border-l-2 border-gray-300 pl-3">
                     Estos indicadores se construyen con el desempe√±o diario de las tripulaciones.
                  </p>
                  
                  <!-- Winner Card -->
                  <div class="flex items-center gap-3 bg-gradient-to-br from-amber-50 to-yellow-100 border border-amber-300 shadow-sm rounded-lg px-4 py-1.5 relative overflow-hidden group hover:shadow-md transition-shadow">
                      <!-- Shine Animation -->
                      <div class="absolute inset-0 bg-white/30 translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-1000 skew-x-12"></div>

                      <!-- Trophy Icon -->
                      <div class="w-8 h-8 rounded-full bg-amber-100 border border-amber-200 flex items-center justify-center shrink-0 text-amber-500">
                          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M5 2H2v6a2 2 0 0 0 2 2h2a2 2 0 0 0 2-2V2H5zm14 0h-3v6a2 2 0 0 0 2 2h2a2 2 0 0 0 2-2V2h-3zM7 2h10v2H7V2zm3.5 12a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7z"/><path d="M12 15a4 4 0 1 0 0-8 4 4 0 0 0 0 8zm-2 1v2H8v2h8v-2h-2v-2h-2z"/></svg>
                      </div>

                      <div class="flex flex-col items-end z-10">
                         <span class="text-[9px] uppercase font-black text-amber-600 tracking-widest">Mejor Tripulaci√≥n</span>
                         <span class="text-sm font-black text-slate-800 leading-none">{{ store.bestCrew().name }}</span>
                      </div>

                      <div class="bg-amber-400 text-amber-900 font-bold text-xs px-2 py-0.5 rounded shadow-sm z-10 border border-amber-500">
                         {{ store.bestCrew().totalSum | number:'1.0-0' }} pts
                      </div>
                  </div>
              </div>
            </div>
          }

          <!-- Crew Results (EXECUTIVE STYLE) -->
          @case ('crew') {
            <div class="col-span-1 lg:col-span-4 lg:row-span-1 bg-white shadow-sm rounded-lg flex flex-col h-auto min-h-[300px] lg:min-h-0 lg:h-full z-0 overflow-hidden border border-gray-200">
              <div class="bg-slate-900 text-white px-4 py-3 flex justify-between items-center shrink-0 border-b-2 border-coke-red">
                 <span class="font-semibold tracking-wide text-xs md:text-sm text-gray-100 uppercase">Resultados Tripulaci√≥n</span>
                 <span class="text-[10px] text-gray-400 font-medium">Turno Matutino</span>
              </div>
              <div class="flex-1 w-full min-h-0 p-0 flex flex-col overflow-auto bg-white">
                <table class="w-full text-[11px] md:text-xs text-left border-collapse h-full min-w-[320px]">
                  <thead class="bg-white text-gray-500 border-b border-gray-200 shrink-0">
                    <tr class="uppercase text-[9px] md:text-[10px] font-semibold tracking-wider">
                      <th class="py-3 pl-4 text-left">Tripulaci√≥n</th>
                      <th class="py-3 text-right">PDF <span class="block text-[8px] text-gray-400 font-normal normal-case">Obj: 1.0</span></th>
                      <th class="py-3 text-right">Estancia <span class="block text-[8px] text-gray-400 font-normal normal-case">Obj: 55m</span></th>
                      <th class="py-3 text-right hidden sm:table-cell">Tarimas <span class="block text-[8px] text-gray-400 font-normal normal-case">Promedio</span></th>
                      <th class="py-3 text-right pr-4 w-[25%]">Score <span class="block text-[8px] text-gray-400 font-normal normal-case">Total</span></th>
                    </tr>
                  </thead>
                  <tbody class="divide-y divide-gray-100">
                    @for (crew of store.crews(); track crew.name) {
                      <tr class="hover:bg-slate-50 transition-colors h-1/4">
                        <td class="py-2 pl-4 text-slate-700 font-bold text-xs lg:text-sm">{{ crew.name }}</td>
                        <td class="py-2 text-right font-mono text-slate-600 font-medium">
                           {{ crew.pdf | number:'1.2-2' }}
                           <span class="inline-block w-2 h-2 rounded-full ml-1"
                                 [class.bg-emerald-500]="crew.pdf >= 1.0"
                                 [class.bg-rose-500]="crew.pdf < 1.0"></span>
                        </td>
                        <td class="py-2 text-right font-mono text-slate-600 font-medium">
                           {{ crew.stayTime }}
                           <span class="inline-block w-2 h-2 rounded-full ml-1"
                                 [class.bg-emerald-500]="crew.stayTime <= '00:55'"
                                 [class.bg-rose-500]="crew.stayTime > '00:55'"></span>
                        </td>
                        <td class="py-2 text-right text-slate-500 hidden sm:table-cell font-mono text-xs">{{ crew.palletsAverage | number }}</td>
                        <td class="py-2 pr-4 relative align-middle text-right">
                           <div class="absolute right-4 top-3 bottom-3 bg-slate-100 rounded w-full max-w-[80px] ml-auto overflow-hidden">
                              <div class="h-full bg-slate-300 rounded" [style.width.%]="(crew.totalSum / 20) * 100"></div>
                           </div>
                           <span class="relative z-10 font-bold text-slate-800 text-xs">{{ crew.totalSum | number:'1.1-1' }}</span>
                        </td>
                      </tr>
                    }
                  </tbody>
                </table>
              </div>
            </div>
          }
        }
      }
    </div>
  </main>
  
  <footer class="h-[4vh] bg-black text-white flex items-center overflow-hidden whitespace-nowrap relative border-t-2 border-coke-red fixed bottom-0 w-full lg:relative z-20 shadow-2xl">
    <div class="absolute left-0 top-0 bottom-0 bg-black z-20 px-3 flex items-center shadow-[2px_0_10px_rgba(0,0,0,1)]">
       <span class="text-[10px] xl:text-xs font-black text-yellow-400 uppercase tracking-widest flex items-center gap-2">
          <span class="w-2 h-2 rounded-full bg-red-600 animate-pulse border border-red-400"></span>
          AVISOS
       </span>
    </div>
    <div class="animate-marquee inline-block pl-[100%]">
       <span class="text-xs xl:text-sm font-semibold tracking-wide text-gray-200">{{ store.announcement() }}</span>
    </div>
  </footer>
</div>

