var Lw=Object.defineProperty,Vw=Object.defineProperties;var Uw=Object.getOwnPropertyDescriptors;var iy=Object.getOwnPropertySymbols;var Bw=Object.prototype.hasOwnProperty,Hw=Object.prototype.propertyIsEnumerable;var sy=(t,e,n)=>e in t?Lw(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,x=(t,e)=>{for(var n in e||={})Bw.call(e,n)&&sy(t,n,e[n]);if(iy)for(var n of iy(e))Hw.call(e,n)&&sy(t,n,e[n]);return t},W=(t,e)=>Vw(t,Uw(e));var Le=null,Zs=!1,Mc=1,Gw=null,ke=Symbol("SIGNAL");function F(t){let e=Le;return Le=t,e}function ea(){return Le}var jr={version:0,lastCleanEpoch:0,dirty:!1,producers:void 0,producersTail:void 0,consumers:void 0,consumersTail:void 0,recomputing:!1,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function ri(t){if(Zs)throw new Error("");if(Le===null)return;Le.consumerOnSignalRead(t);let e=Le.producersTail;if(e!==void 0&&e.producer===t)return;let n,r=Le.recomputing;if(r&&(n=e!==void 0?e.nextProducer:Le.producers,n!==void 0&&n.producer===t)){Le.producersTail=n,n.lastReadVersion=t.version;return}let o=t.consumersTail;if(o!==void 0&&o.consumer===Le&&(!r||qw(o,Le)))return;let i=Jr(Le),s={producer:t,consumer:Le,nextProducer:n,prevConsumer:o,lastReadVersion:t.version,nextConsumer:void 0};Le.producersTail=s,e!==void 0?e.nextProducer=s:Le.producers=s,i&&cy(t,s)}function ay(){Mc++}function xc(t){if(!(Jr(t)&&!t.dirty)&&!(!t.dirty&&t.lastCleanEpoch===Mc)){if(!t.producerMustRecompute(t)&&!ii(t)){Ac(t);return}t.producerRecomputeValue(t),Ac(t)}}function Nc(t){if(t.consumers===void 0)return;let e=Zs;Zs=!0;try{for(let n=t.consumers;n!==void 0;n=n.nextConsumer){let r=n.consumer;r.dirty||$w(r)}}finally{Zs=e}}function Rc(){return Le?.consumerAllowSignalWrites!==!1}function $w(t){t.dirty=!0,Nc(t),t.consumerMarkedDirty?.(t)}function Ac(t){t.dirty=!1,t.lastCleanEpoch=Mc}function Yr(t){return t&&ly(t),F(t)}function ly(t){t.producersTail=void 0,t.recomputing=!0}function oi(t,e){F(e),t&&uy(t)}function uy(t){t.recomputing=!1;let e=t.producersTail,n=e!==void 0?e.nextProducer:t.producers;if(n!==void 0){if(Jr(t))do n=Pc(n);while(n!==void 0);e!==void 0?e.nextProducer=void 0:t.producers=void 0}}function ii(t){for(let e=t.producers;e!==void 0;e=e.nextProducer){let n=e.producer,r=e.lastReadVersion;if(r!==n.version||(xc(n),r!==n.version))return!0}return!1}function or(t){if(Jr(t)){let e=t.producers;for(;e!==void 0;)e=Pc(e)}t.producers=void 0,t.producersTail=void 0,t.consumers=void 0,t.consumersTail=void 0}function cy(t,e){let n=t.consumersTail,r=Jr(t);if(n!==void 0?(e.nextConsumer=n.nextConsumer,n.nextConsumer=e):(e.nextConsumer=void 0,t.consumers=e),e.prevConsumer=n,t.consumersTail=e,!r)for(let o=t.producers;o!==void 0;o=o.nextProducer)cy(o.producer,o)}function Pc(t){let e=t.producer,n=t.nextProducer,r=t.nextConsumer,o=t.prevConsumer;if(t.nextConsumer=void 0,t.prevConsumer=void 0,r!==void 0?r.prevConsumer=o:e.consumersTail=o,o!==void 0)o.nextConsumer=r;else if(e.consumers=r,!Jr(e)){let i=e.producers;for(;i!==void 0;)i=Pc(i)}return n}function Jr(t){return t.consumerIsAlwaysLive||t.consumers!==void 0}function kc(t){Gw?.(t)}function qw(t,e){let n=e.producersTail;if(n!==void 0){let r=e.producers;do{if(r===t)return!0;if(r===n)break;r=r.nextProducer}while(r!==void 0)}return!1}function Fc(t,e){return Object.is(t,e)}function si(t,e){let n=Object.create(Ww);n.computation=t,e!==void 0&&(n.equal=e);let r=()=>{if(xc(n),ri(n),n.value===Xs)throw n.error;return n.value};return r[ke]=n,kc(n),r}var Sc=Symbol("UNSET"),bc=Symbol("COMPUTING"),Xs=Symbol("ERRORED"),Ww=W(x({},jr),{value:Sc,dirty:!0,error:null,equal:Fc,kind:"computed",producerMustRecompute(t){return t.value===Sc||t.value===bc},producerRecomputeValue(t){if(t.value===bc)throw new Error("");let e=t.value;t.value=bc;let n=Yr(t),r,o=!1;try{r=t.computation(),F(null),o=e!==Sc&&e!==Xs&&r!==Xs&&t.equal(e,r)}catch(i){r=Xs,t.error=i}finally{oi(t,n)}if(o){t.value=e;return}t.value=r,t.version++}});function zw(){throw new Error}var dy=zw;function fy(t){dy(t)}function Oc(t){dy=t}var jw=null;function Lc(t,e){let n=Object.create(ta);n.value=t,e!==void 0&&(n.equal=e);let r=()=>hy(n);return r[ke]=n,kc(n),[r,s=>ai(n,s),s=>py(n,s)]}function hy(t){return ri(t),t.value}function ai(t,e){Rc()||fy(t),t.equal(t.value,e)||(t.value=e,Yw(t))}function py(t,e){Rc()||fy(t),ai(t,e(t.value))}var ta=W(x({},jr),{equal:Fc,value:void 0,kind:"signal"});function Yw(t){t.version++,ay(),Nc(t),jw?.(t)}function Vc(t){let e=F(null);try{return t()}finally{F(e)}}var Uc=W(x({},jr),{consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!0,dirty:!0,kind:"effect"});function Bc(t){if(t.dirty=!1,t.version>0&&!ii(t))return;t.version++;let e=Yr(t);try{t.cleanup(),t.fn()}finally{oi(t,e)}}function ee(t){return typeof t=="function"}function na(t){let n=t(r=>{Error.call(r),r.stack=new Error().stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var ra=na(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:
${n.map((r,o)=>`${o+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=n});function li(t,e){if(t){let n=t.indexOf(e);0<=n&&t.splice(n,1)}}var We=class t{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(let i of n)i.remove(this);else n.remove(this);let{initialTeardown:r}=this;if(ee(r))try{r()}catch(i){e=i instanceof ra?i.errors:[i]}let{_finalizers:o}=this;if(o){this._finalizers=null;for(let i of o)try{my(i)}catch(s){e=e??[],s instanceof ra?e=[...e,...s.errors]:e.push(s)}}if(e)throw new ra(e)}}add(e){var n;if(e&&e!==this)if(this.closed)my(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}}_hasParent(e){let{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){let{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){let{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&li(n,e)}remove(e){let{_finalizers:n}=this;n&&li(n,e),e instanceof t&&e._removeParent(this)}};We.EMPTY=(()=>{let t=new We;return t.closed=!0,t})();var Hc=We.EMPTY;function oa(t){return t instanceof We||t&&"closed"in t&&ee(t.remove)&&ee(t.add)&&ee(t.unsubscribe)}function my(t){ee(t)?t():t.unsubscribe()}var Et={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Kr={setTimeout(t,e,...n){let{delegate:r}=Kr;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){let{delegate:e}=Kr;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function ia(t){Kr.setTimeout(()=>{let{onUnhandledError:e}=Et;if(e)e(t);else throw t})}function Gc(){}var gy=$c("C",void 0,void 0);function yy(t){return $c("E",void 0,t)}function _y(t){return $c("N",t,void 0)}function $c(t,e,n){return{kind:t,value:e,error:n}}var ir=null;function Qr(t){if(Et.useDeprecatedSynchronousErrorHandling){let e=!ir;if(e&&(ir={errorThrown:!1,error:null}),t(),e){let{errorThrown:n,error:r}=ir;if(ir=null,n)throw r}}else t()}function vy(t){Et.useDeprecatedSynchronousErrorHandling&&ir&&(ir.errorThrown=!0,ir.error=t)}var sr=class extends We{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,oa(e)&&e.add(this)):this.destination=Qw}static create(e,n,r){return new Zr(e,n,r)}next(e){this.isStopped?Wc(_y(e),this):this._next(e)}error(e){this.isStopped?Wc(yy(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Wc(gy,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},Jw=Function.prototype.bind;function qc(t,e){return Jw.call(t,e)}var zc=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){sa(r)}}error(e){let{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){sa(r)}else sa(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){sa(n)}}},Zr=class extends sr{constructor(e,n,r){super();let o;if(ee(e)||!e)o={next:e??void 0,error:n??void 0,complete:r??void 0};else{let i;this&&Et.useDeprecatedNextContext?(i=Object.create(e),i.unsubscribe=()=>this.unsubscribe(),o={next:e.next&&qc(e.next,i),error:e.error&&qc(e.error,i),complete:e.complete&&qc(e.complete,i)}):o=e}this.destination=new zc(o)}};function sa(t){Et.useDeprecatedSynchronousErrorHandling?vy(t):ia(t)}function Kw(t){throw t}function Wc(t,e){let{onStoppedNotification:n}=Et;n&&Kr.setTimeout(()=>n(t,e))}var Qw={closed:!0,next:Gc,error:Kw,complete:Gc};var Xr=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Ey(t){return t}function Cy(t){return t.length===0?Ey:t.length===1?t[0]:function(n){return t.reduce((r,o)=>o(r),n)}}var De=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){let r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,o){let i=Xw(n)?n:new Zr(n,r,o);return Qr(()=>{let{operator:s,source:a}=this;i.add(s?s.call(i,a):a?this._subscribe(i):this._trySubscribe(i))}),i}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return r=Dy(r),new r((o,i)=>{let s=new Zr({next:a=>{try{n(a)}catch(l){i(l),s.unsubscribe()}},error:i,complete:o});this.subscribe(s)})}_subscribe(n){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(n)}[Xr](){return this}pipe(...n){return Cy(n)(this)}toPromise(n){return n=Dy(n),new n((r,o)=>{let i;this.subscribe(s=>i=s,s=>o(s),()=>r(i))})}}return t.create=e=>new t(e),t})();function Dy(t){var e;return(e=t??Et.Promise)!==null&&e!==void 0?e:Promise}function Zw(t){return t&&ee(t.next)&&ee(t.error)&&ee(t.complete)}function Xw(t){return t&&t instanceof sr||Zw(t)&&oa(t)}function eT(t){return ee(t?.lift)}function eo(t){return e=>{if(eT(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function to(t,e,n,r,o){return new jc(t,e,n,r,o)}var jc=class extends sr{constructor(e,n,r,o,i,s){super(e),this.onFinalize=i,this.shouldUnsubscribe=s,this._next=n?function(a){try{n(a)}catch(l){e.error(l)}}:super._next,this._error=o?function(a){try{o(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:n}=this;super.unsubscribe(),!n&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};var Iy=na(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Ct=(()=>{class t extends De{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){let r=new aa(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new Iy}next(n){Qr(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(n)}})}error(n){Qr(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;let{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){Qr(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){let{hasError:r,isStopped:o,observers:i}=this;return r||o?Hc:(this.currentObservers=null,i.push(n),new We(()=>{this.currentObservers=null,li(i,n)}))}_checkFinalizedStatuses(n){let{hasError:r,thrownError:o,isStopped:i}=this;r?n.error(o):i&&n.complete()}asObservable(){let n=new De;return n.source=this,n}}return t.create=(e,n)=>new aa(e,n),t})(),aa=class extends Ct{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.next)===null||r===void 0||r.call(n,e)}error(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.error)===null||r===void 0||r.call(n,e)}complete(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)}_subscribe(e){var n,r;return(r=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&r!==void 0?r:Hc}};var ui=class extends Ct{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){let{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};function tT(t){return t[t.length-1]}function wy(t){return ee(tT(t))?t.pop():void 0}function Sy(t,e,n,r){function o(i){return i instanceof n?i:new n(function(s){s(i)})}return new(n||(n=Promise))(function(i,s){function a(f){try{c(r.next(f))}catch(h){s(h)}}function l(f){try{c(r.throw(f))}catch(h){s(h)}}function c(f){f.done?i(f.value):o(f.value).then(a,l)}c((r=r.apply(t,e||[])).next())})}function Ty(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ar(t){return this instanceof ar?(this.v=t,this):new ar(t)}function by(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),o,i=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),o[Symbol.asyncIterator]=function(){return this},o;function s(m){return function(g){return Promise.resolve(g).then(m,h)}}function a(m,g){r[m]&&(o[m]=function(y){return new Promise(function(_,C){i.push([m,y,_,C])>1||l(m,y)})},g&&(o[m]=g(o[m])))}function l(m,g){try{c(r[m](g))}catch(y){p(i[0][3],y)}}function c(m){m.value instanceof ar?Promise.resolve(m.value.v).then(f,h):p(i[0][2],m)}function f(m){l("next",m)}function h(m){l("throw",m)}function p(m,g){m(g),i.shift(),i.length&&l(i[0][0],i[0][1])}}function Ay(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Ty=="function"?Ty(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=t[i]&&function(s){return new Promise(function(a,l){s=t[i](s),o(a,l,s.done,s.value)})}}function o(i,s,a,l){Promise.resolve(l).then(function(c){i({value:c,done:a})},s)}}var la=t=>t&&typeof t.length=="number"&&typeof t!="function";function ua(t){return ee(t?.then)}function ca(t){return ee(t[Xr])}function da(t){return Symbol.asyncIterator&&ee(t?.[Symbol.asyncIterator])}function fa(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function nT(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var ha=nT();function pa(t){return ee(t?.[ha])}function ma(t){return by(this,arguments,function*(){let n=t.getReader();try{for(;;){let{value:r,done:o}=yield ar(n.read());if(o)return yield ar(void 0);yield yield ar(r)}}finally{n.releaseLock()}})}function ga(t){return ee(t?.getReader)}function Nn(t){if(t instanceof De)return t;if(t!=null){if(ca(t))return rT(t);if(la(t))return oT(t);if(ua(t))return iT(t);if(da(t))return My(t);if(pa(t))return sT(t);if(ga(t))return aT(t)}throw fa(t)}function rT(t){return new De(e=>{let n=t[Xr]();if(ee(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function oT(t){return new De(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function iT(t){return new De(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,ia)})}function sT(t){return new De(e=>{for(let n of t)if(e.next(n),e.closed)return;e.complete()})}function My(t){return new De(e=>{lT(t,e).catch(n=>e.error(n))})}function aT(t){return My(ma(t))}function lT(t,e){var n,r,o,i;return Sy(this,void 0,void 0,function*(){try{for(n=Ay(t);r=yield n.next(),!r.done;){let s=r.value;if(e.next(s),e.closed)return}}catch(s){o={error:s}}finally{try{r&&!r.done&&(i=n.return)&&(yield i.call(n))}finally{if(o)throw o.error}}e.complete()})}function Ut(t,e,n,r=0,o=!1){let i=e.schedule(function(){n(),o?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(i),!o)return i}function ya(t,e=0){return eo((n,r)=>{n.subscribe(to(r,o=>Ut(r,t,()=>r.next(o),e),()=>Ut(r,t,()=>r.complete(),e),o=>Ut(r,t,()=>r.error(o),e)))})}function _a(t,e=0){return eo((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function xy(t,e){return Nn(t).pipe(_a(e),ya(e))}function Ny(t,e){return Nn(t).pipe(_a(e),ya(e))}function Ry(t,e){return new De(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function Py(t,e){return new De(n=>{let r;return Ut(n,e,()=>{r=t[ha](),Ut(n,e,()=>{let o,i;try{({value:o,done:i}=r.next())}catch(s){n.error(s);return}i?n.complete():n.next(o)},0,!0)}),()=>ee(r?.return)&&r.return()})}function va(t,e){if(!t)throw new Error("Iterable cannot be null");return new De(n=>{Ut(n,e,()=>{let r=t[Symbol.asyncIterator]();Ut(n,e,()=>{r.next().then(o=>{o.done?n.complete():n.next(o.value)})},0,!0)})})}function ky(t,e){return va(ma(t),e)}function Fy(t,e){if(t!=null){if(ca(t))return xy(t,e);if(la(t))return Ry(t,e);if(ua(t))return Ny(t,e);if(da(t))return va(t,e);if(pa(t))return Py(t,e);if(ga(t))return ky(t,e)}throw fa(t)}function Yc(t,e){return e?Fy(t,e):Nn(t)}function lr(t,e){return eo((n,r)=>{let o=0;n.subscribe(to(r,i=>{r.next(t.call(e,i,o++))}))})}var{isArray:uT}=Array;function cT(t,e){return uT(e)?t(...e):t(e)}function Oy(t){return lr(e=>cT(t,e))}var{isArray:dT}=Array,{getPrototypeOf:fT,prototype:hT,keys:pT}=Object;function Ly(t){if(t.length===1){let e=t[0];if(dT(e))return{args:e,keys:null};if(mT(e)){let n=pT(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}function mT(t){return t&&typeof t=="object"&&fT(t)===hT}function Vy(t,e){return t.reduce((n,r,o)=>(n[r]=e[o],n),{})}function Jc(...t){let e=wy(t),{args:n,keys:r}=Ly(t),o=new De(i=>{let{length:s}=n;if(!s){i.complete();return}let a=new Array(s),l=s,c=s;for(let f=0;f<s;f++){let h=!1;Nn(n[f]).subscribe(to(i,p=>{h||(h=!0,c--),a[f]=p},()=>l--,void 0,()=>{(!l||!h)&&(c||i.next(r?Vy(r,a):a),i.complete())}))}});return e?o.pipe(Oy(e)):o}var Kc;function Ea(){return Kc}function Bt(t){let e=Kc;return Kc=t,e}var Uy=Symbol("NotFound");function no(t){return t===Uy||t?.name==="\u0275NotFound"}var ud="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",O=class extends Error{code;constructor(e,n){super(gi(e,n)),this.code=e}};function gT(t){return`NG0${Math.abs(t)}`}function gi(t,e){return`${gT(t)}${e?": "+e:""}`}var pr=globalThis;function re(t){for(let e in t)if(t[e]===re)return e;throw Error("")}function qy(t,e){for(let n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function Rn(t){if(typeof t=="string")return t;if(Array.isArray(t))return`[${t.map(Rn).join(", ")}]`;if(t==null)return""+t;let e=t.overriddenName||t.name;if(e)return`${e}`;let n=t.toString();if(n==null)return""+n;let r=n.indexOf(`
`);return r>=0?n.slice(0,r):n}function cd(t,e){return t?e?`${t} ${e}`:t:e||""}var yT=re({__forward_ref__:re});function On(t){return t.__forward_ref__=On,t.toString=function(){return Rn(this())},t}function Fe(t){return dd(t)?t():t}function dd(t){return typeof t=="function"&&t.hasOwnProperty(yT)&&t.__forward_ref__===On}function fe(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Ln(t){return{providers:t.providers||[],imports:t.imports||[]}}function ba(t){return _T(t,Aa)}function _T(t,e){return t.hasOwnProperty(e)&&t[e]||null}function vT(t){let e=t?.[Aa]??null;return e||null}function Zc(t){return t&&t.hasOwnProperty(Da)?t[Da]:null}var Aa=re({\u0275prov:re}),Da=re({\u0275inj:re}),B=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,n){this._desc=e,this.\u0275prov=void 0,typeof n=="number"?this.__NG_ELEMENT_ID__=n:n!==void 0&&(this.\u0275prov=fe({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function fd(t){return t&&!!t.\u0275providers}var hd=re({\u0275cmp:re}),pd=re({\u0275dir:re}),md=re({\u0275pipe:re});var di=re({\u0275fac:re}),mr=re({__NG_ELEMENT_ID__:re}),By=re({__NG_ENV_ID__:re});function gr(t){return yd(t,"@Component"),t[hd]||null}function gd(t){return yd(t,"@Directive"),t[pd]||null}function Wy(t){return yd(t,"@Pipe"),t[md]||null}function yd(t,e){if(t==null)throw new O(-919,!1)}function yi(t){return typeof t=="string"?t:t==null?"":String(t)}function zy(t){return typeof t=="function"?t.name||t.toString():typeof t=="object"&&t!=null&&typeof t.type=="function"?t.type.name||t.type.toString():yi(t)}var jy=re({ngErrorCode:re}),ET=re({ngErrorMessage:re}),CT=re({ngTokenPath:re});function _d(t,e){return Yy("",-200,e)}function Ma(t,e){throw new O(-201,!1)}function Yy(t,e,n){let r=new O(e,t);return r[jy]=e,r[ET]=t,n&&(r[CT]=n),r}function DT(t){return t[jy]}var Xc;function Jy(){return Xc}function ze(t){let e=Xc;return Xc=t,e}function vd(t,e,n){let r=ba(t);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(n&8)return null;if(e!==void 0)return e;Ma(t,"")}var IT={},ur=IT,wT="__NG_DI_FLAG__",ed=class{injector;constructor(e){this.injector=e}retrieve(e,n){let r=cr(n)||0;try{return this.injector.get(e,r&8?null:ur,r)}catch(o){if(no(o))return o;throw o}}};function TT(t,e=0){let n=Ea();if(n===void 0)throw new O(-203,!1);if(n===null)return vd(t,void 0,e);{let r=ST(e),o=n.retrieve(t,r);if(no(o)){if(r.optional)return null;throw o}return o}}function te(t,e=0){return(Jy()||TT)(Fe(t),e)}function K(t,e){return te(t,cr(e))}function cr(t){return typeof t>"u"||typeof t=="number"?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function ST(t){return{optional:!!(t&8),host:!!(t&1),self:!!(t&2),skipSelf:!!(t&4)}}function td(t){let e=[];for(let n=0;n<t.length;n++){let r=Fe(t[n]);if(Array.isArray(r)){if(r.length===0)throw new O(900,!1);let o,i=0;for(let s=0;s<r.length;s++){let a=r[s],l=bT(a);typeof l=="number"?l===-1?o=a.token:i|=l:o=a}e.push(te(o,i))}else e.push(te(r))}return e}function bT(t){return t[wT]}function Pn(t,e){let n=t.hasOwnProperty(di);return n?t[di]:null}function Ky(t,e,n){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++){let o=t[r],i=e[r];if(n&&(o=n(o),i=n(i)),i!==o)return!1}return!0}function Qy(t){return t.flat(Number.POSITIVE_INFINITY)}function xa(t,e){t.forEach(n=>Array.isArray(n)?xa(n,e):e(n))}function Ed(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function _i(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function Zy(t,e,n,r){let o=t.length;if(o==e)t.push(n,r);else if(o===1)t.push(r,t[0]),t[0]=n;else{for(o--,t.push(t[o-1],t[o]);o>e;){let i=o-2;t[o]=t[i],o--}t[e]=n,t[e+1]=r}}function Xy(t,e,n){let r=oo(t,e);return r>=0?t[r|1]=n:(r=~r,Zy(t,r,e,n)),r}function Na(t,e){let n=oo(t,e);if(n>=0)return t[n|1]}function oo(t,e){return AT(t,e,1)}function AT(t,e,n){let r=0,o=t.length>>n;for(;o!==r;){let i=r+(o-r>>1),s=t[i<<n];if(e===s)return i<<n;s>e?o=i:r=i+1}return~(o<<n)}var Vn={},Ke=[],vi=new B(""),Cd=new B("",-1),Dd=new B(""),fi=class{get(e,n=ur){if(n===ur){let o=Yy("",-201);throw o.name="\u0275NotFound",o}return n}};function Id(t){return{\u0275providers:t}}function e_(...t){return{\u0275providers:wd(!0,t),\u0275fromNgModule:!0}}function wd(t,...e){let n=[],r=new Set,o,i=s=>{n.push(s)};return xa(e,s=>{let a=s;Ia(a,i,[],r)&&(o||=[],o.push(a))}),o!==void 0&&t_(o,i),n}function t_(t,e){for(let n=0;n<t.length;n++){let{ngModule:r,providers:o}=t[n];Td(o,i=>{e(i,r)})}}function Ia(t,e,n,r){if(t=Fe(t),!t)return!1;let o=null,i=Zc(t),s=!i&&gr(t);if(!i&&!s){let l=t.ngModule;if(i=Zc(l),i)o=l;else return!1}else{if(s&&!s.standalone)return!1;o=t}let a=r.has(o);if(s){if(a)return!1;if(r.add(o),s.dependencies){let l=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let c of l)Ia(c,e,n,r)}}else if(i){if(i.imports!=null&&!a){r.add(o);let c;xa(i.imports,f=>{Ia(f,e,n,r)&&(c||=[],c.push(f))}),c!==void 0&&t_(c,e)}if(!a){let c=Pn(o)||(()=>new o);e({provide:o,useFactory:c,deps:Ke},o),e({provide:Dd,useValue:o,multi:!0},o),e({provide:vi,useValue:()=>te(o),multi:!0},o)}let l=i.providers;if(l!=null&&!a){let c=t;Td(l,f=>{e(f,c)})}}else return!1;return o!==t&&t.providers!==void 0}function Td(t,e){for(let n of t)fd(n)&&(n=n.\u0275providers),Array.isArray(n)?Td(n,e):e(n)}var MT=re({provide:String,useValue:re});function n_(t){return t!==null&&typeof t=="object"&&MT in t}function xT(t){return!!(t&&t.useExisting)}function NT(t){return!!(t&&t.useFactory)}function dr(t){return typeof t=="function"}function r_(t){return!!t.useClass}var Ei=new B(""),Ca={},Hy={},Qc;function Ci(){return Qc===void 0&&(Qc=new fi),Qc}var at=class{},fr=class extends at{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,n,r,o){super(),this.parent=n,this.source=r,this.scopes=o,rd(e,s=>this.processProvider(s)),this.records.set(Cd,ro(void 0,this)),o.has("environment")&&this.records.set(at,ro(void 0,this));let i=this.records.get(Ei);i!=null&&typeof i.value=="string"&&this.scopes.add(i.value),this.injectorDefTypes=new Set(this.get(Dd,Ke,{self:!0}))}retrieve(e,n){let r=cr(n)||0;try{return this.get(e,ur,r)}catch(o){if(no(o))return o;throw o}}destroy(){ci(this),this._destroyed=!0;let e=F(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let n=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of n)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),F(e)}}onDestroy(e){return ci(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){ci(this);let n=Bt(this),r=ze(void 0),o;try{return e()}finally{Bt(n),ze(r)}}get(e,n=ur,r){if(ci(this),e.hasOwnProperty(By))return e[By](this);let o=cr(r),i,s=Bt(this),a=ze(void 0);try{if(!(o&4)){let c=this.records.get(e);if(c===void 0){let f=OT(e)&&ba(e);f&&this.injectableDefInScope(f)?c=ro(nd(e),Ca):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c,o)}let l=o&2?Ci():this.parent;return n=o&8&&n===ur?null:n,l.get(e,n)}catch(l){let c=DT(l);throw c===-200||c===-201?new O(c,null):l}finally{ze(a),Bt(s)}}resolveInjectorInitializers(){let e=F(null),n=Bt(this),r=ze(void 0),o;try{let i=this.get(vi,Ke,{self:!0});for(let s of i)s()}finally{Bt(n),ze(r),F(e)}}toString(){let e=[],n=this.records;for(let r of n.keys())e.push(Rn(r));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=Fe(e);let n=dr(e)?e:Fe(e&&e.provide),r=PT(e);if(!dr(e)&&e.multi===!0){let o=this.records.get(n);o||(o=ro(void 0,Ca,!0),o.factory=()=>td(o.multi),this.records.set(n,o)),n=e,o.multi.push(e)}this.records.set(n,r)}hydrate(e,n,r){let o=F(null);try{if(n.value===Hy)throw _d(Rn(e));return n.value===Ca&&(n.value=Hy,n.value=n.factory(void 0,r)),typeof n.value=="object"&&n.value&&FT(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}finally{F(o)}}injectableDefInScope(e){if(!e.providedIn)return!1;let n=Fe(e.providedIn);return typeof n=="string"?n==="any"||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){let n=this._onDestroyHooks.indexOf(e);n!==-1&&this._onDestroyHooks.splice(n,1)}};function nd(t){let e=ba(t),n=e!==null?e.factory:Pn(t);if(n!==null)return n;if(t instanceof B)throw new O(204,!1);if(t instanceof Function)return RT(t);throw new O(204,!1)}function RT(t){if(t.length>0)throw new O(204,!1);let n=vT(t);return n!==null?()=>n.factory(t):()=>new t}function PT(t){if(n_(t))return ro(void 0,t.useValue);{let e=Sd(t);return ro(e,Ca)}}function Sd(t,e,n){let r;if(dr(t)){let o=Fe(t);return Pn(o)||nd(o)}else if(n_(t))r=()=>Fe(t.useValue);else if(NT(t))r=()=>t.useFactory(...td(t.deps||[]));else if(xT(t))r=(o,i)=>te(Fe(t.useExisting),i!==void 0&&i&8?8:void 0);else{let o=Fe(t&&(t.useClass||t.provide));if(kT(t))r=()=>new o(...td(t.deps));else return Pn(o)||nd(o)}return r}function ci(t){if(t.destroyed)throw new O(205,!1)}function ro(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function kT(t){return!!t.deps}function FT(t){return t!==null&&typeof t=="object"&&typeof t.ngOnDestroy=="function"}function OT(t){return typeof t=="function"||typeof t=="object"&&t.ngMetadataName==="InjectionToken"}function rd(t,e){for(let n of t)Array.isArray(n)?rd(n,e):n&&fd(n)?rd(n.\u0275providers,e):e(n)}function Ra(t,e){let n;t instanceof fr?(ci(t),n=t):n=new ed(t);let r,o=Bt(n),i=ze(void 0);try{return e()}finally{Bt(o),ze(i)}}function o_(){return Jy()!==void 0||Ea()!=null}var Dt=0,k=1,V=2,Me=3,ut=4,ct=5,io=6,so=7,Ie=8,hn=9,pn=10,ge=11,ao=12,bd=13,yr=14,it=15,Un=16,_r=17,Gt=18,mn=19,Ad=20,dn=21,Pa=22,kn=23,st=24,ka=25,vr=26,pe=27,i_=1,Md=6,Bn=7,Di=8,Er=9,Ee=10;function $t(t){return Array.isArray(t)&&typeof t[i_]=="object"}function It(t){return Array.isArray(t)&&t[i_]===!0}function xd(t){return(t.flags&4)!==0}function Hn(t){return t.componentOffset>-1}function lo(t){return(t.flags&1)===1}function qt(t){return!!t.template}function uo(t){return(t[V]&512)!==0}function Cr(t){return(t[V]&256)===256}var Nd="svg",s_="math";function dt(t){for(;Array.isArray(t);)t=t[Dt];return t}function Rd(t,e){return dt(e[t])}function Wt(t,e){return dt(e[t.index])}function Ii(t,e){return t.data[e]}function wi(t,e){return t[e]}function Pd(t,e,n,r){n>=t.data.length&&(t.data[n]=null,t.blueprint[n]=null),e[n]=r}function ft(t,e){let n=e[t];return $t(n)?n:n[Dt]}function Fa(t){return(t[V]&128)===128}function a_(t){return It(t[Me])}function ht(t,e){return e==null?null:t[e]}function kd(t){t[_r]=0}function Fd(t){t[V]&1024||(t[V]|=1024,Fa(t)&&co(t))}function l_(t,e){for(;t>0;)e=e[yr],t--;return e}function Ti(t){return!!(t[V]&9216||t[st]?.dirty)}function Oa(t){t[pn].changeDetectionScheduler?.notify(8),t[V]&64&&(t[V]|=1024),Ti(t)&&co(t)}function co(t){t[pn].changeDetectionScheduler?.notify(0);let e=Fn(t);for(;e!==null&&!(e[V]&8192||(e[V]|=8192,!Fa(e)));)e=Fn(e)}function Od(t,e){if(Cr(t))throw new O(911,!1);t[dn]===null&&(t[dn]=[]),t[dn].push(e)}function u_(t,e){if(t[dn]===null)return;let n=t[dn].indexOf(e);n!==-1&&t[dn].splice(n,1)}function Fn(t){let e=t[Me];return It(e)?e[Me]:e}function Ld(t){return t[so]??=[]}function Vd(t){return t.cleanup??=[]}function c_(t,e,n,r){let o=Ld(e);o.push(n),t.firstCreatePass&&Vd(t).push(r,o.length-1)}var H={lFrame:T_(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var od=!1;function d_(){return H.lFrame.elementDepthCount}function f_(){H.lFrame.elementDepthCount++}function Ud(){H.lFrame.elementDepthCount--}function La(){return H.bindingsEnabled}function h_(){return H.skipHydrationRootTNode!==null}function Bd(t){return H.skipHydrationRootTNode===t}function Hd(){H.skipHydrationRootTNode=null}function q(){return H.lFrame.lView}function Re(){return H.lFrame.tView}function gn(t){return H.lFrame.contextLView=t,t[Ie]}function yn(t){return H.lFrame.contextLView=null,t}function Ve(){let t=Gd();for(;t!==null&&t.type===64;)t=t.parent;return t}function Gd(){return H.lFrame.currentTNode}function p_(){let t=H.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}function fo(t,e){let n=H.lFrame;n.currentTNode=t,n.isParent=e}function $d(){return H.lFrame.isParent}function m_(){H.lFrame.isParent=!1}function g_(){return H.lFrame.contextLView}function qd(){return od}function hi(t){let e=od;return od=t,e}function Si(){let t=H.lFrame,e=t.bindingRootIndex;return e===-1&&(e=t.bindingRootIndex=t.tView.bindingStartIndex),e}function y_(){return H.lFrame.bindingIndex}function __(t){return H.lFrame.bindingIndex=t}function ho(){return H.lFrame.bindingIndex++}function Wd(t){let e=H.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function v_(){return H.lFrame.inI18n}function E_(t,e){let n=H.lFrame;n.bindingIndex=n.bindingRootIndex=t,Va(e)}function C_(){return H.lFrame.currentDirectiveIndex}function Va(t){H.lFrame.currentDirectiveIndex=t}function D_(t){let e=H.lFrame.currentDirectiveIndex;return e===-1?null:t[e]}function I_(){return H.lFrame.currentQueryIndex}function Ua(t){H.lFrame.currentQueryIndex=t}function LT(t){let e=t[k];return e.type===2?e.declTNode:e.type===1?t[ct]:null}function zd(t,e,n){if(n&4){let o=e,i=t;for(;o=o.parent,o===null&&!(n&1);)if(o=LT(i),o===null||(i=i[yr],o.type&10))break;if(o===null)return!1;e=o,t=i}let r=H.lFrame=w_();return r.currentTNode=e,r.lView=t,!0}function Ba(t){let e=w_(),n=t[k];H.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function w_(){let t=H.lFrame,e=t===null?null:t.child;return e===null?T_(t):e}function T_(t){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return t!==null&&(t.child=e),e}function S_(){let t=H.lFrame;return H.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}var jd=S_;function Ha(){let t=S_();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function b_(t){return(H.lFrame.contextLView=l_(t,H.lFrame.contextLView))[Ie]}function _n(){return H.lFrame.selectedIndex}function Gn(t){H.lFrame.selectedIndex=t}function Yd(){let t=H.lFrame;return Ii(t.tView,t.selectedIndex)}function wt(){H.lFrame.currentNamespace=Nd}function po(){VT()}function VT(){H.lFrame.currentNamespace=null}function A_(){return H.lFrame.currentNamespace}var M_=!0;function Ga(){return M_}function bi(t){M_=t}function id(t,e=null,n=null,r){let o=x_(t,e,n,r);return o.resolveInjectorInitializers(),o}function x_(t,e=null,n=null,r,o=new Set){let i=[n||Ke,e_(t)];return r=r||(typeof t=="object"?void 0:Rn(t)),new fr(i,e||Ci(),r||null,o)}var Ht=class t{static THROW_IF_NOT_FOUND=ur;static NULL=new fi;static create(e,n){if(Array.isArray(e))return id({name:""},n,e,"");{let r=e.name??"";return id({name:r},e.parent,e.providers,r)}}static \u0275prov=fe({token:t,providedIn:"any",factory:()=>te(Cd)});static __NG_ELEMENT_ID__=-1},pt=new B(""),Dr=(()=>{class t{static __NG_ELEMENT_ID__=UT;static __NG_ENV_ID__=n=>n}return t})(),wa=class extends Dr{_lView;constructor(e){super(),this._lView=e}get destroyed(){return Cr(this._lView)}onDestroy(e){let n=this._lView;return Od(n,e),()=>u_(n,e)}};function UT(){return new wa(q())}var N_=!1,R_=new B(""),mo=(()=>{class t{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new ui(!1);debugTaskTracker=K(R_,{optional:!0});get hasPendingTasks(){return this.destroyed?!1:this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new De(n=>{n.next(!1),n.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);let n=this.taskId++;return this.pendingTasks.add(n),this.debugTaskTracker?.add(n),n}has(n){return this.pendingTasks.has(n)}remove(n){this.pendingTasks.delete(n),this.debugTaskTracker?.remove(n),this.pendingTasks.size===0&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=fe({token:t,providedIn:"root",factory:()=>new t})}return t})(),sd=class extends Ct{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,o_()&&(this.destroyRef=K(Dr,{optional:!0})??void 0,this.pendingTasks=K(mo,{optional:!0})??void 0)}emit(e){let n=F(null);try{super.next(e)}finally{F(n)}}subscribe(e,n,r){let o=e,i=n||(()=>null),s=r;if(e&&typeof e=="object"){let l=e;o=l.next?.bind(l),i=l.error?.bind(l),s=l.complete?.bind(l)}this.__isAsync&&(i=this.wrapInTimeout(i),o&&(o=this.wrapInTimeout(o)),s&&(s=this.wrapInTimeout(s)));let a=super.subscribe({next:o,error:i,complete:s});return e instanceof We&&e.add(a),a}wrapInTimeout(e){return n=>{let r=this.pendingTasks?.add();setTimeout(()=>{try{e(n)}finally{r!==void 0&&this.pendingTasks?.remove(r)}})}}},ot=sd;function Ta(...t){}function Jd(t){let e,n;function r(){t=Ta;try{n!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(n),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{t(),r()}),typeof requestAnimationFrame=="function"&&(n=requestAnimationFrame(()=>{t(),r()})),()=>r()}function P_(t){return queueMicrotask(()=>t()),()=>{t=Ta}}var Kd="isAngularZone",pi=Kd+"_ID",BT=0,lt=class t{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new ot(!1);onMicrotaskEmpty=new ot(!1);onStable=new ot(!1);onError=new ot(!1);constructor(e){let{enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:o=!1,scheduleInRootZone:i=N_}=e;if(typeof Zone>"u")throw new O(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!o&&r,s.shouldCoalesceRunChangeDetection=o,s.callbackScheduled=!1,s.scheduleInRootZone=i,$T(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(Kd)===!0}static assertInAngularZone(){if(!t.isInAngularZone())throw new O(909,!1)}static assertNotInAngularZone(){if(t.isInAngularZone())throw new O(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,o){let i=this._inner,s=i.scheduleEventTask("NgZoneEvent: "+o,e,HT,Ta,Ta);try{return i.runTask(s,n,r)}finally{i.cancelTask(s)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}},HT={};function Qd(t){if(t._nesting==0&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function GT(t){if(t.isCheckStableRunning||t.callbackScheduled)return;t.callbackScheduled=!0;function e(){Jd(()=>{t.callbackScheduled=!1,ad(t),t.isCheckStableRunning=!0,Qd(t),t.isCheckStableRunning=!1})}t.scheduleInRootZone?Zone.root.run(()=>{e()}):t._outer.run(()=>{e()}),ad(t)}function $T(t){let e=()=>{GT(t)},n=BT++;t._inner=t._inner.fork({name:"angular",properties:{[Kd]:!0,[pi]:n,[pi+n]:!0},onInvokeTask:(r,o,i,s,a,l)=>{if(qT(l))return r.invokeTask(i,s,a,l);try{return Gy(t),r.invokeTask(i,s,a,l)}finally{(t.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||t.shouldCoalesceRunChangeDetection)&&e(),$y(t)}},onInvoke:(r,o,i,s,a,l,c)=>{try{return Gy(t),r.invoke(i,s,a,l,c)}finally{t.shouldCoalesceRunChangeDetection&&!t.callbackScheduled&&!WT(l)&&e(),$y(t)}},onHasTask:(r,o,i,s)=>{r.hasTask(i,s),o===i&&(s.change=="microTask"?(t._hasPendingMicrotasks=s.microTask,ad(t),Qd(t)):s.change=="macroTask"&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(r,o,i,s)=>(r.handleError(i,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}function ad(t){t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&t.callbackScheduled===!0?t.hasPendingMicrotasks=!0:t.hasPendingMicrotasks=!1}function Gy(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function $y(t){t._nesting--,Qd(t)}var mi=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new ot;onMicrotaskEmpty=new ot;onStable=new ot;onError=new ot;run(e,n,r){return e.apply(n,r)}runGuarded(e,n,r){return e.apply(n,r)}runOutsideAngular(e){return e()}runTask(e,n,r,o){return e.apply(n,r)}};function qT(t){return k_(t,"__ignore_ng_zone__")}function WT(t){return k_(t,"__scheduler_tick__")}function k_(t,e){return!Array.isArray(t)||t.length!==1?!1:t[0]?.data?.[e]===!0}var fn=class{_console=console;handleError(e){this._console.error("ERROR",e)}},Ir=new B("",{factory:()=>{let t=K(lt),e=K(at),n;return r=>{t.runOutsideAngular(()=>{e.destroyed&&!n?setTimeout(()=>{throw r}):(n??=e.get(fn),n.handleError(r))})}}}),F_={provide:vi,useValue:()=>{let t=K(fn,{optional:!0})},multi:!0};function oe(t,e){let[n,r,o]=Lc(t,e?.equal),i=n,s=i[ke];return i.set=r,i.update=o,i.asReadonly=O_.bind(i),i}function O_(){let t=this[ke];if(t.readonlyFn===void 0){let e=()=>this();e[ke]=t,t.readonlyFn=e}return t.readonlyFn}var $a=(()=>{class t{view;node;constructor(n,r){this.view=n,this.node=r}static __NG_ELEMENT_ID__=zT}return t})();function zT(){return new $a(q(),Ve())}var hr=class{},Ai=new B("",{factory:()=>!0});var Zd=new B("");var qa=(()=>{class t{static \u0275prov=fe({token:t,providedIn:"root",factory:()=>new ld})}return t})(),ld=class{dirtyEffectCount=0;queues=new Map;add(e){this.enqueue(e),this.schedule(e)}schedule(e){e.dirty&&this.dirtyEffectCount++}remove(e){let n=e.zone,r=this.queues.get(n);r.has(e)&&(r.delete(e),e.dirty&&this.dirtyEffectCount--)}enqueue(e){let n=e.zone;this.queues.has(n)||this.queues.set(n,new Set);let r=this.queues.get(n);r.has(e)||r.add(e)}flush(){for(;this.dirtyEffectCount>0;){let e=!1;for(let[n,r]of this.queues)n===null?e||=this.flushQueue(r):e||=n.run(()=>this.flushQueue(r));e||(this.dirtyEffectCount=0)}}flushQueue(e){let n=!1;for(let r of e)r.dirty&&(this.dirtyEffectCount--,n=!0,r.run());return n}},Sa=class{[ke];constructor(e){this[ke]=e}destroy(){this[ke].destroy()}};function go(t,e){let n=e?.injector??K(Ht),r=e?.manualCleanup!==!0?n.get(Dr):null,o,i=n.get($a,null,{optional:!0}),s=n.get(hr);return i!==null?(o=JT(i.view,s,t),r instanceof wa&&r._lView===i.view&&(r=null)):o=KT(t,n.get(qa),s),o.injector=n,r!==null&&(o.onDestroyFns=[r.onDestroy(()=>o.destroy())]),new Sa(o)}var L_=W(x({},Uc),{cleanupFns:void 0,zone:null,onDestroyFns:null,run(){let t=hi(!1);try{Bc(this)}finally{hi(t)}},cleanup(){if(!this.cleanupFns?.length)return;let t=F(null);try{for(;this.cleanupFns.length;)this.cleanupFns.pop()()}finally{this.cleanupFns=[],F(t)}}}),jT=W(x({},L_),{consumerMarkedDirty(){this.scheduler.schedule(this),this.notifier.notify(12)},destroy(){if(or(this),this.onDestroyFns!==null)for(let t of this.onDestroyFns)t();this.cleanup(),this.scheduler.remove(this)}}),YT=W(x({},L_),{consumerMarkedDirty(){this.view[V]|=8192,co(this.view),this.notifier.notify(13)},destroy(){if(or(this),this.onDestroyFns!==null)for(let t of this.onDestroyFns)t();this.cleanup(),this.view[kn]?.delete(this)}});function JT(t,e,n){let r=Object.create(YT);return r.view=t,r.zone=typeof Zone<"u"?Zone.current:null,r.notifier=e,r.fn=V_(r,n),t[kn]??=new Set,t[kn].add(r),r.consumerMarkedDirty(r),r}function KT(t,e,n){let r=Object.create(jT);return r.fn=V_(r,t),r.scheduler=e,r.notifier=n,r.zone=typeof Zone<"u"?Zone.current:null,r.scheduler.add(r),r.notifier.notify(12),r}function V_(t,e){return()=>{e(n=>(t.cleanupFns??=[]).push(n))}}function zt(t){return Vc(t)}function Hi(t){return{toString:t}.toString()}function iS(t){return typeof t=="function"}function fv(t,e,n,r){e!==null?e.applyValueToInputSignal(e,r):t[n]=r}var Ka=class{previousValue;currentValue;firstChange;constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}},Gi=(()=>{let t=()=>hv;return t.ngInherit=!0,t})();function hv(t){return t.type.prototype.ngOnChanges&&(t.setInput=aS),sS}function sS(){let t=mv(this),e=t?.current;if(e){let n=t.previous;if(n===Vn)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function aS(t,e,n,r,o){let i=this.declaredInputs[r],s=mv(t)||lS(t,{previous:Vn,current:null}),a=s.current||(s.current={}),l=s.previous,c=l[i];a[i]=new Ka(c&&c.currentValue,n,l===Vn),fv(t,e,o,n)}var pv="__ngSimpleChanges__";function mv(t){return t[pv]||null}function lS(t,e){return t[pv]=e}var U_=[];var ie=function(t,e=null,n){for(let r=0;r<U_.length;r++){let o=U_[r];o(t,e,n)}},X=(function(t){return t[t.TemplateCreateStart=0]="TemplateCreateStart",t[t.TemplateCreateEnd=1]="TemplateCreateEnd",t[t.TemplateUpdateStart=2]="TemplateUpdateStart",t[t.TemplateUpdateEnd=3]="TemplateUpdateEnd",t[t.LifecycleHookStart=4]="LifecycleHookStart",t[t.LifecycleHookEnd=5]="LifecycleHookEnd",t[t.OutputStart=6]="OutputStart",t[t.OutputEnd=7]="OutputEnd",t[t.BootstrapApplicationStart=8]="BootstrapApplicationStart",t[t.BootstrapApplicationEnd=9]="BootstrapApplicationEnd",t[t.BootstrapComponentStart=10]="BootstrapComponentStart",t[t.BootstrapComponentEnd=11]="BootstrapComponentEnd",t[t.ChangeDetectionStart=12]="ChangeDetectionStart",t[t.ChangeDetectionEnd=13]="ChangeDetectionEnd",t[t.ChangeDetectionSyncStart=14]="ChangeDetectionSyncStart",t[t.ChangeDetectionSyncEnd=15]="ChangeDetectionSyncEnd",t[t.AfterRenderHooksStart=16]="AfterRenderHooksStart",t[t.AfterRenderHooksEnd=17]="AfterRenderHooksEnd",t[t.ComponentStart=18]="ComponentStart",t[t.ComponentEnd=19]="ComponentEnd",t[t.DeferBlockStateStart=20]="DeferBlockStateStart",t[t.DeferBlockStateEnd=21]="DeferBlockStateEnd",t[t.DynamicComponentStart=22]="DynamicComponentStart",t[t.DynamicComponentEnd=23]="DynamicComponentEnd",t[t.HostBindingsUpdateStart=24]="HostBindingsUpdateStart",t[t.HostBindingsUpdateEnd=25]="HostBindingsUpdateEnd",t})(X||{});function uS(t,e,n){let{ngOnChanges:r,ngOnInit:o,ngDoCheck:i}=e.type.prototype;if(r){let s=hv(e);(n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s)}o&&(n.preOrderHooks??=[]).push(0-t,o),i&&((n.preOrderHooks??=[]).push(t,i),(n.preOrderCheckHooks??=[]).push(t,i))}function gv(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){let i=t.data[n].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:f}=i;s&&(t.contentHooks??=[]).push(-n,s),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),l&&(t.viewHooks??=[]).push(-n,l),c&&((t.viewHooks??=[]).push(n,c),(t.viewCheckHooks??=[]).push(n,c)),f!=null&&(t.destroyHooks??=[]).push(n,f)}}function za(t,e,n){yv(t,e,3,n)}function ja(t,e,n,r){(t[V]&3)===n&&yv(t,e,n,r)}function Xd(t,e){let n=t[V];(n&3)===e&&(n&=16383,n+=1,t[V]=n)}function yv(t,e,n,r){let o=r!==void 0?t[_r]&65535:0,i=r??-1,s=e.length-1,a=0;for(let l=o;l<s;l++)if(typeof e[l+1]=="number"){if(a=e[l],r!=null&&a>=r)break}else e[l]<0&&(t[_r]+=65536),(a<i||i==-1)&&(cS(t,n,e,l),t[_r]=(t[_r]&4294901760)+l+2),l++}function B_(t,e){ie(X.LifecycleHookStart,t,e);let n=F(null);try{e.call(t)}finally{F(n),ie(X.LifecycleHookEnd,t,e)}}function cS(t,e,n,r){let o=n[r]<0,i=n[r+1],s=o?-n[r]:n[r],a=t[s];o?t[V]>>14<t[_r]>>16&&(t[V]&3)===e&&(t[V]+=16384,B_(a,i)):B_(a,i)}var _o=-1,Tr=class{factory;name;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,n,r,o){this.factory=e,this.name=o,this.canSeeViewProviders=n,this.injectImpl=r}};function dS(t){return(t.flags&8)!==0}function fS(t){return(t.flags&16)!==0}function hS(t,e,n){let r=0;for(;r<n.length;){let o=n[r];if(typeof o=="number"){if(o!==0)break;r++;let i=n[r++],s=n[r++],a=n[r++];t.setAttribute(e,s,a,i)}else{let i=o,s=n[++r];mS(i)?t.setProperty(e,i,s):t.setAttribute(e,i,s),r++}}return r}function pS(t){return t===3||t===4||t===6}function mS(t){return t.charCodeAt(0)===64}function vo(t,e){if(!(e===null||e.length===0))if(t===null||t.length===0)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){let o=e[r];typeof o=="number"?n=o:n===0||(n===-1||n===2?H_(t,n,o,null,e[++r]):H_(t,n,o,null,null))}}return t}function H_(t,e,n,r,o){let i=0,s=t.length;if(e===-1)s=-1;else for(;i<t.length;){let a=t[i++];if(typeof a=="number"){if(a===e){s=-1;break}else if(a>e){s=i-1;break}}}for(;i<t.length;){let a=t[i];if(typeof a=="number")break;if(a===n){o!==null&&(t[i+1]=o);return}i++,o!==null&&i++}s!==-1&&(t.splice(s,0,e),i=s+1),t.splice(i++,0,n),o!==null&&t.splice(i++,0,o)}function _v(t){return t!==_o}function Qa(t){return t&32767}function gS(t){return t>>16}function Za(t,e){let n=gS(t),r=e;for(;n>0;)r=r[yr],n--;return r}var df=!0;function Xa(t){let e=df;return df=t,e}var yS=256,vv=yS-1,Ev=5,_S=0,jt={};function vS(t,e,n){let r;typeof n=="string"?r=n.charCodeAt(0)||0:n.hasOwnProperty(mr)&&(r=n[mr]),r==null&&(r=n[mr]=_S++);let o=r&vv,i=1<<o;e.data[t+(o>>Ev)]|=i}function el(t,e){let n=Cv(t,e);if(n!==-1)return n;let r=e[k];r.firstCreatePass&&(t.injectorIndex=e.length,ef(r.data,t),ef(e,null),ef(r.blueprint,null));let o=Bf(t,e),i=t.injectorIndex;if(_v(o)){let s=Qa(o),a=Za(o,e),l=a[k].data;for(let c=0;c<8;c++)e[i+c]=a[s+c]|l[s+c]}return e[i+8]=o,i}function ef(t,e){t.push(0,0,0,0,0,0,0,0,e)}function Cv(t,e){return t.injectorIndex===-1||t.parent&&t.parent.injectorIndex===t.injectorIndex||e[t.injectorIndex+8]===null?-1:t.injectorIndex}function Bf(t,e){if(t.parent&&t.parent.injectorIndex!==-1)return t.parent.injectorIndex;let n=0,r=null,o=e;for(;o!==null;){if(r=Sv(o),r===null)return _o;if(n++,o=o[yr],r.injectorIndex!==-1)return r.injectorIndex|n<<16}return _o}function ff(t,e,n){vS(t,e,n)}function Dv(t,e,n){if(n&8||t!==void 0)return t;Ma(e,"NodeInjector")}function Iv(t,e,n,r){if(n&8&&r===void 0&&(r=null),(n&3)===0){let o=t[hn],i=ze(void 0);try{return o?o.get(e,r,n&8):vd(e,r,n&8)}finally{ze(i)}}return Dv(r,e,n)}function wv(t,e,n,r=0,o){if(t!==null){if(e[V]&2048&&!(r&2)){let s=IS(t,e,n,r,jt);if(s!==jt)return s}let i=Tv(t,e,n,r,jt);if(i!==jt)return i}return Iv(e,n,r,o)}function Tv(t,e,n,r,o){let i=CS(n);if(typeof i=="function"){if(!zd(e,t,r))return r&1?Dv(o,n,r):Iv(e,n,r,o);try{let s;if(s=i(r),s==null&&!(r&8))Ma(n);else return s}finally{jd()}}else if(typeof i=="number"){let s=null,a=Cv(t,e),l=_o,c=r&1?e[it][ct]:null;for((a===-1||r&4)&&(l=a===-1?Bf(t,e):e[a+8],l===_o||!$_(r,!1)?a=-1:(s=e[k],a=Qa(l),e=Za(l,e)));a!==-1;){let f=e[k];if(G_(i,a,f.data)){let h=ES(a,e,n,s,r,c);if(h!==jt)return h}l=e[a+8],l!==_o&&$_(r,e[k].data[a+8]===c)&&G_(i,a,e)?(s=f,a=Qa(l),e=Za(l,e)):a=-1}}return o}function ES(t,e,n,r,o,i){let s=e[k],a=s.data[t+8],l=r==null?Hn(a)&&df:r!=s&&(a.type&3)!==0,c=o&1&&i===a,f=Ya(a,s,n,l,c);return f!==null?Pi(e,s,f,a,o):jt}function Ya(t,e,n,r,o){let i=t.providerIndexes,s=e.data,a=i&1048575,l=t.directiveStart,c=t.directiveEnd,f=i>>20,h=r?a:a+f,p=o?a+f:c;for(let m=h;m<p;m++){let g=s[m];if(m<l&&n===g||m>=l&&g.type===n)return m}if(o){let m=s[l];if(m&&qt(m)&&m.type===n)return l}return null}function Pi(t,e,n,r,o){let i=t[n],s=e.data;if(i instanceof Tr){let a=i;if(a.resolving){let m=zy(s[n]);throw _d(m)}let l=Xa(a.canSeeViewProviders);a.resolving=!0;let c=s[n].type||s[n],f,h=a.injectImpl?ze(a.injectImpl):null,p=zd(t,r,0);try{i=t[n]=a.factory(void 0,o,s,t,r),e.firstCreatePass&&n>=r.directiveStart&&uS(n,s[n],e)}finally{h!==null&&ze(h),Xa(l),a.resolving=!1,jd()}}return i}function CS(t){if(typeof t=="string")return t.charCodeAt(0)||0;let e=t.hasOwnProperty(mr)?t[mr]:void 0;return typeof e=="number"?e>=0?e&vv:DS:e}function G_(t,e,n){let r=1<<t;return!!(n[e+(t>>Ev)]&r)}function $_(t,e){return!(t&2)&&!(t&1&&e)}var wr=class{_tNode;_lView;constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return wv(this._tNode,this._lView,e,cr(r),n)}};function DS(){return new wr(Ve(),q())}function cl(t){return Hi(()=>{let e=t.prototype.constructor,n=e[di]||hf(e),r=Object.prototype,o=Object.getPrototypeOf(t.prototype).constructor;for(;o&&o!==r;){let i=o[di]||hf(o);if(i&&i!==n)return i;o=Object.getPrototypeOf(o)}return i=>new i})}function hf(t){return dd(t)?()=>{let e=hf(Fe(t));return e&&e()}:Pn(t)}function IS(t,e,n,r,o){let i=t,s=e;for(;i!==null&&s!==null&&s[V]&2048&&!uo(s);){let a=Tv(i,s,n,r|2,jt);if(a!==jt)return a;let l=i.parent;if(!l){let c=s[Ad];if(c){let f=c.get(n,jt,r);if(f!==jt)return f}l=Sv(s),s=s[yr]}i=l}return o}function Sv(t){let e=t[k],n=e.type;return n===2?e.declTNode:n===1?t[ct]:null}function wS(){return Io(Ve(),q())}function Io(t,e){return new Jt(Wt(t,e))}var Jt=(()=>{class t{nativeElement;constructor(n){this.nativeElement=n}static __NG_ELEMENT_ID__=wS}return t})();function TS(t){return t instanceof Jt?t.nativeElement:t}function SS(){return this._results[Symbol.iterator]()}var tl=class{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new Ct}constructor(e=!1){this._emitDistinctChangesOnly=e}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,n){return this._results.reduce(e,n)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,n){this.dirty=!1;let r=Qy(e);(this._changesDetected=!Ky(this._results,r,n))&&(this._results=r,this.length=r.length,this.last=r[this.length-1],this.first=r[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=SS};function bv(t){return(t.flags&128)===128}var Hf=(function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t})(Hf||{}),Av=new Map,bS=0;function AS(){return bS++}function MS(t){Av.set(t[mn],t)}function pf(t){Av.delete(t[mn])}var q_="__ngContext__";function Eo(t,e){$t(e)?(t[q_]=e[mn],MS(e)):t[q_]=e}function Mv(t){return Nv(t[ao])}function xv(t){return Nv(t[ut])}function Nv(t){for(;t!==null&&!It(t);)t=t[ut];return t}var xS;function Gf(t){xS=t}var dl=new B("",{factory:()=>NS}),NS="ng";var fl=new B(""),$i=new B("",{providedIn:"platform",factory:()=>"unknown"});var hl=new B("",{factory:()=>K(pt).body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var Rv="r";var Pv="di";var kv=!1,Fv=new B("",{factory:()=>kv});var RS=(t,e,n,r)=>{};function PS(t,e,n,r){RS(t,e,n,r)}function $f(t){return(t.flags&32)===32}var kS=()=>null;function Ov(t,e,n=!1){return kS(t,e,n)}function Lv(t,e){let n=t.contentQueries;if(n!==null){let r=F(null);try{for(let o=0;o<n.length;o+=2){let i=n[o],s=n[o+1];if(s!==-1){let a=t.data[s];Ua(i),a.contentQueries(2,e[s],s)}}}finally{F(r)}}}function mf(t,e,n){Ua(0);let r=F(null);try{e(t,n)}finally{F(r)}}function qf(t,e,n){if(xd(e)){let r=F(null);try{let o=e.directiveStart,i=e.directiveEnd;for(let s=o;s<i;s++){let a=t.data[s];if(a.contentQueries){let l=n[s];a.contentQueries(1,l,s)}}}finally{F(r)}}}var St=(function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t[t.ExperimentalIsolatedShadowDom=4]="ExperimentalIsolatedShadowDom",t})(St||{});var gf=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${ud})`}};function Wf(t){return t instanceof gf?t.changingThisBreaksApplicationSecurity:t}var FS=/^>|^->|<!--|-->|--!>|<!-$/g,OS=/(<|>)/g,LS="\u200B$1\u200B";function VS(t){return t.replace(FS,e=>e.replace(OS,LS))}function US(t,e){return t.createText(e)}function BS(t,e,n){t.setValue(e,n)}function HS(t,e){return t.createComment(VS(e))}function Vv(t,e,n){return t.createElement(e,n)}function nl(t,e,n,r,o){t.insertBefore(e,n,r,o)}function Uv(t,e,n){t.appendChild(e,n)}function W_(t,e,n,r,o){r!==null?nl(t,e,n,r,o):Uv(t,e,n)}function Bv(t,e,n,r){t.removeChild(null,e,n,r)}function GS(t,e,n){t.setAttribute(e,"style",n)}function $S(t,e,n){n===""?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function Hv(t,e,n){let{mergedAttrs:r,classes:o,styles:i}=n;r!==null&&hS(t,e,r),o!==null&&$S(t,e,o),i!==null&&GS(t,e,i)}function qS(t,e,n){let r=t.length;for(;;){let o=t.indexOf(e,n);if(o===-1)return o;if(o===0||t.charCodeAt(o-1)<=32){let i=e.length;if(o+i===r||t.charCodeAt(o+i)<=32)return o}n=o+1}}var Gv="ng-template";function WS(t,e,n,r){let o=0;if(r){for(;o<e.length&&typeof e[o]=="string";o+=2)if(e[o]==="class"&&qS(e[o+1].toLowerCase(),n,0)!==-1)return!0}else if(zf(t))return!1;if(o=e.indexOf(1,o),o>-1){let i;for(;++o<e.length&&typeof(i=e[o])=="string";)if(i.toLowerCase()===n)return!0}return!1}function zf(t){return t.type===4&&t.value!==Gv}function zS(t,e,n){let r=t.type===4&&!n?Gv:t.value;return e===r}function jS(t,e,n){let r=4,o=t.attrs,i=o!==null?KS(o):0,s=!1;for(let a=0;a<e.length;a++){let l=e[a];if(typeof l=="number"){if(!s&&!Tt(r)&&!Tt(l))return!1;if(s&&Tt(l))continue;s=!1,r=l|r&1;continue}if(!s)if(r&4){if(r=2|r&1,l!==""&&!zS(t,l,n)||l===""&&e.length===1){if(Tt(r))return!1;s=!0}}else if(r&8){if(o===null||!WS(t,o,l,n)){if(Tt(r))return!1;s=!0}}else{let c=e[++a],f=YS(l,o,zf(t),n);if(f===-1){if(Tt(r))return!1;s=!0;continue}if(c!==""){let h;if(f>i?h="":h=o[f+1].toLowerCase(),r&2&&c!==h){if(Tt(r))return!1;s=!0}}}}return Tt(r)||s}function Tt(t){return(t&1)===0}function YS(t,e,n,r){if(e===null)return-1;let o=0;if(r||!n){let i=!1;for(;o<e.length;){let s=e[o];if(s===t)return o;if(s===3||s===6)i=!0;else if(s===1||s===2){let a=e[++o];for(;typeof a=="string";)a=e[++o];continue}else{if(s===4)break;if(s===0){o+=4;continue}}o+=i?1:2}return-1}else return QS(e,t)}function JS(t,e,n=!1){for(let r=0;r<e.length;r++)if(jS(t,e[r],n))return!0;return!1}function KS(t){for(let e=0;e<t.length;e++){let n=t[e];if(pS(n))return e}return t.length}function QS(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){let r=t[n];if(typeof r=="number")return-1;if(r===e)return n;n++}return-1}function z_(t,e){return t?":not("+e.trim()+")":e}function ZS(t){let e=t[0],n=1,r=2,o="",i=!1;for(;n<t.length;){let s=t[n];if(typeof s=="string")if(r&2){let a=t[++n];o+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else r&8?o+="."+s:r&4&&(o+=" "+s);else o!==""&&!Tt(s)&&(e+=z_(i,o),o=""),r=s,i=i||!Tt(r);n++}return o!==""&&(e+=z_(i,o)),e}function XS(t){return t.map(ZS).join(",")}function eb(t){let e=[],n=[],r=1,o=2;for(;r<t.length;){let i=t[r];if(typeof i=="string")o===2?i!==""&&e.push(i,t[++r]):o===8&&n.push(i);else{if(!Tt(o))break;o=i}r++}return n.length&&e.push(1,...n),e}var mt={};function jf(t,e,n,r,o,i,s,a,l,c,f){let h=pe+r,p=h+o,m=tb(h,p),g=typeof c=="function"?c():c;return m[k]={type:t,blueprint:m,template:n,queries:null,viewQuery:a,declTNode:e,data:m.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:p,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof i=="function"?i():i,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:l,consts:g,incompleteFirstPass:!1,ssrId:f}}function tb(t,e){let n=[];for(let r=0;r<e;r++)n.push(r<t?null:mt);return n}function nb(t){let e=t.tView;return e===null||e.incompleteFirstPass?t.tView=jf(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function Yf(t,e,n,r,o,i,s,a,l,c,f){let h=e.blueprint.slice();return h[Dt]=o,h[V]=r|4|128|8|64|1024,(c!==null||t&&t[V]&2048)&&(h[V]|=2048),kd(h),h[Me]=h[yr]=t,h[Ie]=n,h[pn]=s||t&&t[pn],h[ge]=a||t&&t[ge],h[hn]=l||t&&t[hn]||null,h[ct]=i,h[mn]=AS(),h[io]=f,h[Ad]=c,h[it]=e.type==2?t[it]:h,h}function rb(t,e,n){let r=Wt(e,t),o=nb(n),i=t[pn].rendererFactory,s=Jf(t,Yf(t,o,null,$v(n),r,e,null,i.createRenderer(r,n),null,null,null));return t[e.index]=s}function $v(t){let e=16;return t.signals?e=4096:t.onPush&&(e=64),e}function qv(t,e,n,r){if(n===0)return-1;let o=e.length;for(let i=0;i<n;i++)e.push(r),t.blueprint.push(r),t.data.push(null);return o}function Jf(t,e){return t[ao]?t[bd][ut]=e:t[ao]=e,t[bd]=e,e}function T(t=1){Wv(Re(),q(),_n()+t,!1)}function Wv(t,e,n,r){if(!r)if((e[V]&3)===3){let i=t.preOrderCheckHooks;i!==null&&za(e,i,n)}else{let i=t.preOrderHooks;i!==null&&ja(e,i,0,n)}Gn(n)}var pl=(function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t})(pl||{});function yf(t,e,n,r){let o=F(null);try{let[i,s,a]=t.inputs[n],l=null;(s&pl.SignalBased)!==0&&(l=e[i][ke]),l!==null&&l.transformFn!==void 0?r=l.transformFn(r):a!==null&&(r=a.call(e,r)),t.setInput!==null?t.setInput(e,l,r,n,i):fv(e,l,i,r)}finally{F(o)}}var Yt=(function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t})(Yt||{}),ob;function Kf(t,e){return ob(t,e)}var Sr=new Set,Qf=(function(t){return t[t.CHANGE_DETECTION=0]="CHANGE_DETECTION",t[t.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",t})(Qf||{}),qi=new B(""),j_=new Set;function qn(t){j_.has(t)||(j_.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}var zv=(()=>{class t{impl=null;execute(){this.impl?.execute()}static \u0275prov=fe({token:t,providedIn:"root",factory:()=>new t})}return t})();var jv=new B("",{factory:()=>({queue:new Set,isScheduled:!1,scheduler:null,injector:K(at)})});function Yv(t,e,n){let r=t.get(jv);if(Array.isArray(e))for(let o of e)r.queue.add(o),n?.detachedLeaveAnimationFns?.push(o);else r.queue.add(e),n?.detachedLeaveAnimationFns?.push(e);r.scheduler&&r.scheduler(t)}function ib(t,e){let n=t.get(jv);if(e.detachedLeaveAnimationFns){for(let r of e.detachedLeaveAnimationFns)n.queue.delete(r);e.detachedLeaveAnimationFns=void 0}}function sb(t,e){for(let[n,r]of e)Yv(t,r.animateFns)}function Y_(t,e,n,r){let o=t?.[vr]?.enter;e!==null&&o&&o.has(n.index)&&sb(r,o)}function yo(t,e,n,r,o,i,s,a){if(o!=null){let l,c=!1;It(o)?l=o:$t(o)&&(c=!0,o=o[Dt]);let f=dt(o);t===0&&r!==null?(Y_(a,r,i,n),s==null?Uv(e,r,f):nl(e,r,f,s||null,!0)):t===1&&r!==null?(Y_(a,r,i,n),nl(e,r,f,s||null,!0)):t===2?J_(a,i,n,h=>{Bv(e,f,c,h)}):t===3&&J_(a,i,n,()=>{e.destroyNode(f)}),l!=null&&vb(e,t,n,l,i,r,s)}}function ab(t,e){Jv(t,e),e[Dt]=null,e[ct]=null}function lb(t,e,n,r,o,i){r[Dt]=o,r[ct]=e,gl(t,r,n,1,o,i)}function Jv(t,e){e[pn].changeDetectionScheduler?.notify(9),gl(t,e,e[ge],2,null,null)}function ub(t){let e=t[ao];if(!e)return tf(t[k],t);for(;e;){let n=null;if($t(e))n=e[ao];else{let r=e[Ee];r&&(n=r)}if(!n){for(;e&&!e[ut]&&e!==t;)$t(e)&&tf(e[k],e),e=e[Me];e===null&&(e=t),$t(e)&&tf(e[k],e),n=e&&e[ut]}e=n}}function Zf(t,e){let n=t[Er],r=n.indexOf(e);n.splice(r,1)}function ml(t,e){if(Cr(e))return;let n=e[ge];n.destroyNode&&gl(t,e,n,3,null,null),ub(e)}function tf(t,e){if(Cr(e))return;let n=F(null);try{e[V]&=-129,e[V]|=256,e[st]&&or(e[st]),fb(t,e),db(t,e),e[k].type===1&&e[ge].destroy();let r=e[Un];if(r!==null&&It(e[Me])){r!==e[Me]&&Zf(r,e);let o=e[Gt];o!==null&&o.detachView(t)}pf(e)}finally{F(n)}}function J_(t,e,n,r){let o=t?.[vr];if(o==null||o.leave==null||!o.leave.has(e.index))return r(!1);t&&Sr.add(t[mn]),Yv(n,()=>{if(o.leave&&o.leave.has(e.index)){let s=o.leave.get(e.index),a=[];if(s){for(let l=0;l<s.animateFns.length;l++){let c=s.animateFns[l],{promise:f}=c();a.push(f)}o.detachedLeaveAnimationFns=void 0}o.running=Promise.allSettled(a),cb(t,r)}else t&&Sr.delete(t[mn]),r(!1)},o)}function cb(t,e){let n=t[vr]?.running;if(n){n.then(()=>{t[vr].running=void 0,Sr.delete(t[mn]),e(!0)});return}e(!1)}function db(t,e){let n=t.cleanup,r=e[so];if(n!==null)for(let s=0;s<n.length-1;s+=2)if(typeof n[s]=="string"){let a=n[s+3];a>=0?r[a]():r[-a].unsubscribe(),s+=2}else{let a=r[n[s+1]];n[s].call(a)}r!==null&&(e[so]=null);let o=e[dn];if(o!==null){e[dn]=null;for(let s=0;s<o.length;s++){let a=o[s];a()}}let i=e[kn];if(i!==null){e[kn]=null;for(let s of i)s.destroy()}}function fb(t,e){let n;if(t!=null&&(n=t.destroyHooks)!=null)for(let r=0;r<n.length;r+=2){let o=e[n[r]];if(!(o instanceof Tr)){let i=n[r+1];if(Array.isArray(i))for(let s=0;s<i.length;s+=2){let a=o[i[s]],l=i[s+1];ie(X.LifecycleHookStart,a,l);try{l.call(a)}finally{ie(X.LifecycleHookEnd,a,l)}}else{ie(X.LifecycleHookStart,o,i);try{i.call(o)}finally{ie(X.LifecycleHookEnd,o,i)}}}}}function hb(t,e,n){return pb(t,e.parent,n)}function pb(t,e,n){let r=e;for(;r!==null&&r.type&168;)e=r,r=e.parent;if(r===null)return n[Dt];if(Hn(r)){let{encapsulation:o}=t.data[r.directiveStart+r.componentOffset];if(o===St.None||o===St.Emulated)return null}return Wt(r,n)}function mb(t,e,n){return yb(t,e,n)}function gb(t,e,n){return t.type&40?Wt(t,n):null}var yb=gb,K_;function Xf(t,e,n,r){let o=hb(t,r,e),i=e[ge],s=r.parent||e[ct],a=mb(s,r,e);if(o!=null)if(Array.isArray(n))for(let l=0;l<n.length;l++)W_(i,o,n[l],a,!1);else W_(i,o,n,a,!1);K_!==void 0&&K_(i,r,e,n,o)}function xi(t,e){if(e!==null){let n=e.type;if(n&3)return Wt(e,t);if(n&4)return _f(-1,t[e.index]);if(n&8){let r=e.child;if(r!==null)return xi(t,r);{let o=t[e.index];return It(o)?_f(-1,o):dt(o)}}else{if(n&128)return xi(t,e.next);if(n&32)return Kf(e,t)()||dt(t[e.index]);{let r=Kv(t,e);if(r!==null){if(Array.isArray(r))return r[0];let o=Fn(t[it]);return xi(o,r)}else return xi(t,e.next)}}}return null}function Kv(t,e){if(e!==null){let r=t[it][ct],o=e.projection;return r.projection[o]}return null}function _f(t,e){let n=Ee+t+1;if(n<e.length){let r=e[n],o=r[k].firstChild;if(o!==null)return xi(r,o)}return e[Bn]}function eh(t,e,n,r,o,i,s){for(;n!=null;){let a=r[hn];if(n.type===128){n=n.next;continue}let l=r[n.index],c=n.type;if(s&&e===0&&(l&&Eo(dt(l),r),n.flags|=2),!$f(n))if(c&8)eh(t,e,n.child,r,o,i,!1),yo(e,t,a,o,l,n,i,r);else if(c&32){let f=Kf(n,r),h;for(;h=f();)yo(e,t,a,o,h,n,i,r);yo(e,t,a,o,l,n,i,r)}else c&16?_b(t,e,r,n,o,i):yo(e,t,a,o,l,n,i,r);n=s?n.projectionNext:n.next}}function gl(t,e,n,r,o,i){eh(n,r,t.firstChild,e,o,i,!1)}function _b(t,e,n,r,o,i){let s=n[it],l=s[ct].projection[r.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++){let f=l[c];yo(e,t,n[hn],o,f,r,i,n)}else{let c=l,f=s[Me];bv(r)&&(c.flags|=128),eh(t,e,c,f,o,i,!0)}}function vb(t,e,n,r,o,i,s){let a=r[Bn],l=dt(r);a!==l&&yo(e,t,n,i,a,o,s);for(let c=Ee;c<r.length;c++){let f=r[c];gl(f[k],f,t,e,i,a)}}function Eb(t,e,n,r,o){if(e)o?t.addClass(n,r):t.removeClass(n,r);else{let i=r.indexOf("-")===-1?void 0:Yt.DashCase;o==null?t.removeStyle(n,r,i):(typeof o=="string"&&o.endsWith("!important")&&(o=o.slice(0,-10),i|=Yt.Important),t.setStyle(n,r,o,i))}}function Qv(t,e,n,r,o){let i=_n(),s=r&2;try{Gn(-1),s&&e.length>pe&&Wv(t,e,pe,!1);let a=s?X.TemplateUpdateStart:X.TemplateCreateStart;ie(a,o,n),n(r,o)}finally{Gn(i);let a=s?X.TemplateUpdateEnd:X.TemplateCreateEnd;ie(a,o,n)}}function yl(t,e,n){bb(t,e,n),(n.flags&64)===64&&Ab(t,e,n)}function Wi(t,e,n=Wt){let r=e.localNames;if(r!==null){let o=e.index+1;for(let i=0;i<r.length;i+=2){let s=r[i+1],a=s===-1?n(e,t):t[s];t[o++]=a}}}function Cb(t,e,n,r){let i=r.get(Fv,kv)||n===St.ShadowDom||n===St.ExperimentalIsolatedShadowDom,s=t.selectRootElement(e,i);return Db(s),s}function Db(t){Ib(t)}var Ib=()=>null;function wb(t){return t==="class"?"className":t==="for"?"htmlFor":t==="formaction"?"formAction":t==="innerHtml"?"innerHTML":t==="readonly"?"readOnly":t==="tabindex"?"tabIndex":t}function Zv(t,e,n,r,o,i){let s=e[k];if(oh(t,s,e,n,r)){Hn(t)&&Sb(e,t.index);return}t.type&3&&(n=wb(n)),Tb(t,e,n,r,o,i)}function Tb(t,e,n,r,o,i){if(t.type&3){let s=Wt(t,e);r=i!=null?i(r,t.value||"",n):r,o.setProperty(s,n,r)}else t.type&12}function Sb(t,e){let n=ft(e,t);n[V]&16||(n[V]|=64)}function bb(t,e,n){let r=n.directiveStart,o=n.directiveEnd;Hn(n)&&rb(e,n,t.data[r+n.componentOffset]),t.firstCreatePass||el(n,e);let i=n.initialInputs;for(let s=r;s<o;s++){let a=t.data[s],l=Pi(e,t,s,n);if(Eo(l,e),i!==null&&xb(e,s-r,l,a,n,i),qt(a)){let c=ft(n.index,e);c[Ie]=Pi(e,t,s,n)}}}function Ab(t,e,n){let r=n.directiveStart,o=n.directiveEnd,i=n.index,s=C_();try{Gn(i);for(let a=r;a<o;a++){let l=t.data[a],c=e[a];Va(a),(l.hostBindings!==null||l.hostVars!==0||l.hostAttrs!==null)&&Mb(l,c)}}finally{Gn(-1),Va(s)}}function Mb(t,e){t.hostBindings!==null&&t.hostBindings(1,e)}function th(t,e){let n=t.directiveRegistry,r=null;if(n)for(let o=0;o<n.length;o++){let i=n[o];JS(e,i.selectors,!1)&&(r??=[],qt(i)?r.unshift(i):r.push(i))}return r}function xb(t,e,n,r,o,i){let s=i[e];if(s!==null)for(let a=0;a<s.length;a+=2){let l=s[a],c=s[a+1];yf(r,n,l,c)}}function nh(t,e,n,r,o){let i=pe+n,s=e[k],a=o(s,e,t,r,n);e[i]=a,fo(t,!0);let l=t.type===2;return l?(Hv(e[ge],a,t),(d_()===0||lo(t))&&Eo(a,e),f_()):Eo(a,e),Ga()&&(!l||!$f(t))&&Xf(s,e,a,t),t}function rh(t){let e=t;return $d()?m_():(e=e.parent,fo(e,!1)),e}function Nb(t,e){let n=t[hn];if(!n)return;let r;try{r=n.get(Ir,null)}catch{r=null}r?.(e)}function oh(t,e,n,r,o){let i=t.inputs?.[r],s=t.hostDirectiveInputs?.[r],a=!1;if(s)for(let l=0;l<s.length;l+=2){let c=s[l],f=s[l+1],h=e.data[c];yf(h,n[c],f,o),a=!0}if(i)for(let l of i){let c=n[l],f=e.data[l];yf(f,c,r,o),a=!0}return a}function Rb(t,e){let n=ft(e,t),r=n[k];Pb(r,n);let o=n[Dt];o!==null&&n[io]===null&&(n[io]=Ov(o,n[hn])),ie(X.ComponentStart);try{ih(r,n,n[Ie])}finally{ie(X.ComponentEnd,n[Ie])}}function Pb(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}function ih(t,e,n){Ba(e);try{let r=t.viewQuery;r!==null&&mf(1,r,n);let o=t.template;o!==null&&Qv(t,e,o,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),e[Gt]?.finishViewCreation(t),t.staticContentQueries&&Lv(t,e),t.staticViewQueries&&mf(2,t.viewQuery,n);let i=t.components;i!==null&&kb(e,i)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[V]&=-5,Ha()}}function kb(t,e){for(let n=0;n<e.length;n++)Rb(t,e[n])}function _l(t,e,n,r){let o=F(null);try{let i=e.tView,a=t[V]&4096?4096:16,l=Yf(t,i,n,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),c=t[e.index];l[Un]=c;let f=t[Gt];return f!==null&&(l[Gt]=f.createEmbeddedView(i)),ih(i,l,n),l}finally{F(o)}}function ki(t,e){return!e||e.firstChild===null||bv(t)}function Fi(t,e,n,r,o=!1){for(;n!==null;){if(n.type===128){n=o?n.projectionNext:n.next;continue}let i=e[n.index];i!==null&&r.push(dt(i)),It(i)&&Xv(i,r);let s=n.type;if(s&8)Fi(t,e,n.child,r);else if(s&32){let a=Kf(n,e),l;for(;l=a();)r.push(l)}else if(s&16){let a=Kv(e,n);if(Array.isArray(a))r.push(...a);else{let l=Fn(e[it]);Fi(l[k],l,a,r,!0)}}n=o?n.projectionNext:n.next}return r}function Xv(t,e){for(let n=Ee;n<t.length;n++){let r=t[n],o=r[k].firstChild;o!==null&&Fi(r[k],r,o,e)}t[Bn]!==t[Dt]&&e.push(t[Bn])}function eE(t){if(t[ka]!==null){for(let e of t[ka])e.impl.addSequence(e);t[ka].length=0}}var tE=[];function Fb(t){return t[st]??Ob(t)}function Ob(t){let e=tE.pop()??Object.create(Vb);return e.lView=t,e}function Lb(t){t.lView[st]!==t&&(t.lView=null,tE.push(t))}var Vb=W(x({},jr),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:t=>{co(t.lView)},consumerOnSignalRead(){this.lView[st]=this}});function Ub(t){let e=t[st]??Object.create(Bb);return e.lView=t,e}var Bb=W(x({},jr),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:t=>{let e=Fn(t.lView);for(;e&&!nE(e[k]);)e=Fn(e);e&&Fd(e)},consumerOnSignalRead(){this.lView[st]=this}});function nE(t){return t.type!==2}function rE(t){if(t[kn]===null)return;let e=!0;for(;e;){let n=!1;for(let r of t[kn])r.dirty&&(n=!0,r.zone===null||Zone.current===r.zone?r.run():r.zone.run(()=>r.run()));e=n&&!!(t[V]&8192)}}var Hb=100;function oE(t,e=0){let r=t[pn].rendererFactory,o=!1;o||r.begin?.();try{Gb(t,e)}finally{o||r.end?.()}}function Gb(t,e){let n=qd();try{hi(!0),vf(t,e);let r=0;for(;Ti(t);){if(r===Hb)throw new O(103,!1);r++,vf(t,1)}}finally{hi(n)}}function $b(t,e,n,r){if(Cr(e))return;let o=e[V],i=!1,s=!1;Ba(e);let a=!0,l=null,c=null;i||(nE(t)?(c=Fb(e),l=Yr(c)):ea()===null?(a=!1,c=Ub(e),l=Yr(c)):e[st]&&(or(e[st]),e[st]=null));try{kd(e),__(t.bindingStartIndex),n!==null&&Qv(t,e,n,2,r);let f=(o&3)===3;if(!i)if(f){let m=t.preOrderCheckHooks;m!==null&&za(e,m,null)}else{let m=t.preOrderHooks;m!==null&&ja(e,m,0,null),Xd(e,0)}if(s||qb(e),rE(e),iE(e,0),t.contentQueries!==null&&Lv(t,e),!i)if(f){let m=t.contentCheckHooks;m!==null&&za(e,m)}else{let m=t.contentHooks;m!==null&&ja(e,m,1),Xd(e,1)}zb(t,e);let h=t.components;h!==null&&aE(e,h,0);let p=t.viewQuery;if(p!==null&&mf(2,p,r),!i)if(f){let m=t.viewCheckHooks;m!==null&&za(e,m)}else{let m=t.viewHooks;m!==null&&ja(e,m,2),Xd(e,2)}if(t.firstUpdatePass===!0&&(t.firstUpdatePass=!1),e[Pa]){for(let m of e[Pa])m();e[Pa]=null}i||(eE(e),e[V]&=-73)}catch(f){throw i||co(e),f}finally{c!==null&&(oi(c,l),a&&Lb(c)),Ha()}}function iE(t,e){for(let n=Mv(t);n!==null;n=xv(n))for(let r=Ee;r<n.length;r++){let o=n[r];sE(o,e)}}function qb(t){for(let e=Mv(t);e!==null;e=xv(e)){if(!(e[V]&2))continue;let n=e[Er];for(let r=0;r<n.length;r++){let o=n[r];Fd(o)}}}function Wb(t,e,n){ie(X.ComponentStart);let r=ft(e,t);try{sE(r,n)}finally{ie(X.ComponentEnd,r[Ie])}}function sE(t,e){Fa(t)&&vf(t,e)}function vf(t,e){let r=t[k],o=t[V],i=t[st],s=!!(e===0&&o&16);if(s||=!!(o&64&&e===0),s||=!!(o&1024),s||=!!(i?.dirty&&ii(i)),s||=!1,i&&(i.dirty=!1),t[V]&=-9217,s)$b(r,t,r.template,t[Ie]);else if(o&8192){let a=F(null);try{rE(t),iE(t,1);let l=r.components;l!==null&&aE(t,l,1),eE(t)}finally{F(a)}}}function aE(t,e,n){for(let r=0;r<e.length;r++)Wb(t,e[r],n)}function zb(t,e){let n=t.hostBindingOpCodes;if(n!==null)try{for(let r=0;r<n.length;r++){let o=n[r];if(o<0)Gn(~o);else{let i=o,s=n[++r],a=n[++r];E_(s,i);let l=e[i];ie(X.HostBindingsUpdateStart,l);try{a(2,l)}finally{ie(X.HostBindingsUpdateEnd,l)}}}}finally{Gn(-1)}}function sh(t,e){let n=qd()?64:1088;for(t[pn].changeDetectionScheduler?.notify(e);t;){t[V]|=n;let r=Fn(t);if(uo(t)&&!r)return t;t=r}return null}function lE(t,e,n,r){return[t,!0,0,e,null,r,null,n,null,null]}function uE(t,e){let n=Ee+e;if(n<t.length)return t[n]}function vl(t,e,n,r=!0){let o=e[k];if(jb(o,e,t,n),r){let s=_f(n,t),a=e[ge],l=a.parentNode(t[Bn]);l!==null&&lb(o,t[ct],a,e,l,s)}let i=e[io];i!==null&&i.firstChild!==null&&(i.firstChild=null)}function cE(t,e){let n=Oi(t,e);return n!==void 0&&ml(n[k],n),n}function Oi(t,e){if(t.length<=Ee)return;let n=Ee+e,r=t[n];if(r){let o=r[Un];o!==null&&o!==t&&Zf(o,r),e>0&&(t[n-1][ut]=r[ut]);let i=_i(t,Ee+e);ab(r[k],r);let s=i[Gt];s!==null&&s.detachView(i[k]),r[Me]=null,r[ut]=null,r[V]&=-129}return r}function jb(t,e,n,r){let o=Ee+r,i=n.length;r>0&&(n[o-1][ut]=e),r<i-Ee?(e[ut]=n[o],Ed(n,Ee+r,e)):(n.push(e),e[ut]=null),e[Me]=n;let s=e[Un];s!==null&&n!==s&&dE(s,e);let a=e[Gt];a!==null&&a.insertView(t),Oa(e),e[V]|=128}function dE(t,e){let n=t[Er],r=e[Me];if($t(r))t[V]|=2;else{let o=r[Me][it];e[it]!==o&&(t[V]|=2)}n===null?t[Er]=[e]:n.push(e)}var $n=class{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){let e=this._lView,n=e[k];return Fi(n,e,n.firstChild,[])}constructor(e,n){this._lView=e,this._cdRefInjectingView=n}get context(){return this._lView[Ie]}set context(e){this._lView[Ie]=e}get destroyed(){return Cr(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Me];if(It(e)){let n=e[Di],r=n?n.indexOf(this):-1;r>-1&&(Oi(e,r),_i(n,r))}this._attachedToViewContainer=!1}ml(this._lView[k],this._lView)}onDestroy(e){Od(this._lView,e)}markForCheck(){sh(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[V]&=-129}reattach(){Oa(this._lView),this._lView[V]|=128}detectChanges(){this._lView[V]|=1024,oE(this._lView)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new O(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=uo(this._lView),n=this._lView[Un];n!==null&&!e&&Zf(n,this._lView),Jv(this._lView[k],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new O(902,!1);this._appRef=e;let n=uo(this._lView),r=this._lView[Un];r!==null&&!n&&dE(r,this._lView),Oa(this._lView)}};var Co=(()=>{class t{_declarationLView;_declarationTContainer;elementRef;static __NG_ELEMENT_ID__=Yb;constructor(n,r,o){this._declarationLView=n,this._declarationTContainer=r,this.elementRef=o}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(n,r){return this.createEmbeddedViewImpl(n,r)}createEmbeddedViewImpl(n,r,o){let i=_l(this._declarationLView,this._declarationTContainer,n,{embeddedViewInjector:r,dehydratedView:o});return new $n(i)}}return t})();function Yb(){return El(Ve(),q())}function El(t,e){return t.type&4?new Co(e,t,Io(t,e)):null}function zi(t,e,n,r,o){let i=t.data[e];if(i===null)i=Jb(t,e,n,r,o),v_()&&(i.flags|=32);else if(i.type&64){i.type=n,i.value=r,i.attrs=o;let s=p_();i.injectorIndex=s===null?-1:s.injectorIndex}return fo(i,!0),i}function Jb(t,e,n,r,o){let i=Gd(),s=$d(),a=s?i:i&&i.parent,l=t.data[e]=Qb(t,a,n,e,r,o);return Kb(t,l,i,s),l}function Kb(t,e,n,r){t.firstChild===null&&(t.firstChild=e),n!==null&&(r?n.child==null&&e.parent!==null&&(n.child=e):n.next===null&&(n.next=e,e.prev=n))}function Qb(t,e,n,r,o,i){let s=e?e.injectorIndex:-1,a=0;return h_()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,fieldIndex:-1,customControlIndex:-1,propertyBindings:null,flags:a,providerIndexes:0,value:o,attrs:i,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function Zb(t){let e=t[Md]??[],r=t[Me][ge],o=[];for(let i of e)i.data[Pv]!==void 0?o.push(i):Xb(i,r);t[Md]=o}function Xb(t,e){let n=0,r=t.firstChild;if(r){let o=t.data[Rv];for(;n<o;){let i=r.nextSibling;Bv(e,r,!1),r=i,n++}}}var eA=()=>null,tA=()=>null;function Ef(t,e){return eA(t,e)}function fE(t,e,n){return tA(t,e,n)}var hE=class{},Cl=class{},Cf=class{resolveComponentFactory(e){throw new O(917,!1)}},Dl=class{static NULL=new Cf},br=class{},wo=(()=>{class t{destroyNode=null;static __NG_ELEMENT_ID__=()=>nA()}return t})();function nA(){let t=q(),e=Ve(),n=ft(e.index,t);return($t(n)?n:t)[ge]}var pE=(()=>{class t{static \u0275prov=fe({token:t,providedIn:"root",factory:()=>null})}return t})();var Ja={},Df=class{injector;parentInjector;constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){let o=this.injector.get(e,Ja,r);return o!==Ja||n===Ja?o:this.parentInjector.get(e,n,r)}};function rl(t,e,n){let r=n?t.styles:null,o=n?t.classes:null,i=0;if(e!==null)for(let s=0;s<e.length;s++){let a=e[s];if(typeof a=="number")i=a;else if(i==1)o=cd(o,a);else if(i==2){let l=a,c=e[++s];r=cd(r,l+": "+c+";")}}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=o:t.classesWithoutHost=o}function ae(t,e=0){let n=q();if(n===null)return te(t,e);let r=Ve();return wv(r,n,Fe(t),e)}function mE(t,e,n,r,o){let i=r===null?null:{"":-1},s=o(t,n);if(s!==null){let a=s,l=null,c=null;for(let f of s)if(f.resolveHostDirectives!==null){[a,l,c]=f.resolveHostDirectives(s);break}iA(t,e,n,a,i,l,c)}i!==null&&r!==null&&rA(n,r,i)}function rA(t,e,n){let r=t.localNames=[];for(let o=0;o<e.length;o+=2){let i=n[e[o+1]];if(i==null)throw new O(-301,!1);r.push(e[o],i)}}function oA(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function iA(t,e,n,r,o,i,s){let a=r.length,l=null;for(let p=0;p<a;p++){let m=r[p];l===null&&qt(m)&&(l=m,oA(t,n,p)),ff(el(n,e),t,m.type)}dA(n,t.data.length,a),l?.viewProvidersResolver&&l.viewProvidersResolver(l);for(let p=0;p<a;p++){let m=r[p];m.providersResolver&&m.providersResolver(m)}let c=!1,f=!1,h=qv(t,e,a,null);a>0&&(n.directiveToIndex=new Map);for(let p=0;p<a;p++){let m=r[p];if(n.mergedAttrs=vo(n.mergedAttrs,m.hostAttrs),aA(t,n,e,h,m),cA(h,m,o),s!==null&&s.has(m)){let[y,_]=s.get(m);n.directiveToIndex.set(m.type,[h,y+n.directiveStart,_+n.directiveStart])}else(i===null||!i.has(m))&&n.directiveToIndex.set(m.type,h);m.contentQueries!==null&&(n.flags|=4),(m.hostBindings!==null||m.hostAttrs!==null||m.hostVars!==0)&&(n.flags|=64);let g=m.type.prototype;!c&&(g.ngOnChanges||g.ngOnInit||g.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),c=!0),!f&&(g.ngOnChanges||g.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),f=!0),h++}sA(t,n,i)}function sA(t,e,n){for(let r=e.directiveStart;r<e.directiveEnd;r++){let o=t.data[r];if(n===null||!n.has(o))Q_(0,e,o,r),Q_(1,e,o,r),X_(e,r,!1);else{let i=n.get(o);Z_(0,e,i,r),Z_(1,e,i,r),X_(e,r,!0)}}}function Q_(t,e,n,r){let o=t===0?n.inputs:n.outputs;for(let i in o)if(o.hasOwnProperty(i)){let s;t===0?s=e.inputs??={}:s=e.outputs??={},s[i]??=[],s[i].push(r),gE(e,i)}}function Z_(t,e,n,r){let o=t===0?n.inputs:n.outputs;for(let i in o)if(o.hasOwnProperty(i)){let s=o[i],a;t===0?a=e.hostDirectiveInputs??={}:a=e.hostDirectiveOutputs??={},a[s]??=[],a[s].push(r,i),gE(e,s)}}function gE(t,e){e==="class"?t.flags|=8:e==="style"&&(t.flags|=16)}function X_(t,e,n){let{attrs:r,inputs:o,hostDirectiveInputs:i}=t;if(r===null||!n&&o===null||n&&i===null||zf(t)){t.initialInputs??=[],t.initialInputs.push(null);return}let s=null,a=0;for(;a<r.length;){let l=r[a];if(l===0){a+=4;continue}else if(l===5){a+=2;continue}else if(typeof l=="number")break;if(!n&&o.hasOwnProperty(l)){let c=o[l];for(let f of c)if(f===e){s??=[],s.push(l,r[a+1]);break}}else if(n&&i.hasOwnProperty(l)){let c=i[l];for(let f=0;f<c.length;f+=2)if(c[f]===e){s??=[],s.push(c[f+1],r[a+1]);break}}a+=2}t.initialInputs??=[],t.initialInputs.push(s)}function aA(t,e,n,r,o){t.data[r]=o;let i=o.factory||(o.factory=Pn(o.type,!0)),s=new Tr(i,qt(o),ae,null);t.blueprint[r]=s,n[r]=s,lA(t,e,r,qv(t,n,o.hostVars,mt),o)}function lA(t,e,n,r,o){let i=o.hostBindings;if(i){let s=t.hostBindingOpCodes;s===null&&(s=t.hostBindingOpCodes=[]);let a=~e.index;uA(s)!=a&&s.push(a),s.push(n,r,i)}}function uA(t){let e=t.length;for(;e>0;){let n=t[--e];if(typeof n=="number"&&n<0)return n}return 0}function cA(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;qt(e)&&(n[""]=t)}}function dA(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function ah(t,e,n,r,o,i,s,a){let l=e[k],c=l.consts,f=ht(c,s),h=zi(l,t,n,r,f);return i&&mE(l,e,h,ht(c,a),o),h.mergedAttrs=vo(h.mergedAttrs,h.attrs),h.attrs!==null&&rl(h,h.attrs,!1),h.mergedAttrs!==null&&rl(h,h.mergedAttrs,!0),l.queries!==null&&l.queries.elementStart(l,h),h}function lh(t,e){gv(t,e),xd(e)&&t.queries.elementEnd(e)}function fA(t,e,n,r,o,i){let s=e.consts,a=ht(s,o),l=zi(e,t,n,r,a);if(l.mergedAttrs=vo(l.mergedAttrs,l.attrs),i!=null){let c=ht(s,i);l.localNames=[];for(let f=0;f<c.length;f+=2)l.localNames.push(c[f],-1)}return l.attrs!==null&&rl(l,l.attrs,!1),l.mergedAttrs!==null&&rl(l,l.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,l),l}function uh(t,e,n){return t[e]=n}function vn(t,e,n){if(n===mt)return!1;let r=t[e];return Object.is(r,n)?!1:(t[e]=n,!0)}function ol(t,e,n,r){let o=vn(t,e,n);return vn(t,e+1,r)||o}function hA(t,e,n,r,o,i){let s=ol(t,e,n,r);return ol(t,e+2,o,i)||s}function nf(t,e,n){return function r(o){let i=Hn(t)?ft(t.index,e):e;sh(i,5);let s=e[Ie],a=ev(e,s,n,o),l=r.__ngNextListenerFn__;for(;l;)a=ev(e,s,l,o)&&a,l=l.__ngNextListenerFn__;return a}}function ev(t,e,n,r){let o=F(null);try{return ie(X.OutputStart,e,n),n(r)!==!1}catch(i){return Nb(t,i),!1}finally{ie(X.OutputEnd,e,n),F(o)}}function pA(t,e,n,r,o,i,s,a){let l=lo(t),c=!1,f=null;if(!r&&l&&(f=gA(e,n,i,t.index)),f!==null){let h=f.__ngLastListenerFn__||f;h.__ngNextListenerFn__=s,f.__ngLastListenerFn__=s,c=!0}else{let h=Wt(t,n),p=r?r(h):h;PS(n,p,i,a);let m=o.listen(p,i,a);if(!mA(i)){let g=r?y=>r(dt(y[t.index])):t.index;yE(g,e,n,i,a,m,!1)}}return c}function mA(t){return t.startsWith("animation")||t.startsWith("transition")}function gA(t,e,n,r){let o=t.cleanup;if(o!=null)for(let i=0;i<o.length-1;i+=2){let s=o[i];if(s===n&&o[i+1]===r){let a=e[so],l=o[i+2];return a&&a.length>l?a[l]:null}typeof s=="string"&&(i+=2)}return null}function yE(t,e,n,r,o,i,s){let a=e.firstCreatePass?Vd(e):null,l=Ld(n),c=l.length;l.push(o,i),a&&a.push(r,t,c,(c+1)*(s?-1:1))}function tv(t,e,n,r,o,i){let s=e[n],a=e[k],c=a.data[n].outputs[r],h=s[c].subscribe(i);yE(t.index,a,e,o,i,h,!0)}var If=Symbol("BINDING");var wf=class extends Dl{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let n=gr(e);return new Li(n,this.ngModule)}};function yA(t){return Object.keys(t).map(e=>{let[n,r,o]=t[e],i={propName:n,templateName:e,isSignal:(r&pl.SignalBased)!==0};return o&&(i.transform=o),i})}function _A(t){return Object.keys(t).map(e=>({propName:t[e],templateName:e}))}function vA(t,e,n){let r=e instanceof at?e:e?.injector;return r&&t.getStandaloneInjector!==null&&(r=t.getStandaloneInjector(r)||r),r?new Df(n,r):n}function EA(t){let e=t.get(br,null);if(e===null)throw new O(407,!1);let n=t.get(pE,null),r=t.get(hr,null);return{rendererFactory:e,sanitizer:n,changeDetectionScheduler:r,ngReflect:!1}}function CA(t,e){let n=_E(t);return Vv(e,n,n==="svg"?Nd:n==="math"?s_:null)}function _E(t){return(t.selectors[0][0]||"div").toLowerCase()}var Li=class extends Cl{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=yA(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=_A(this.componentDef.outputs),this.cachedOutputs}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=XS(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!n}create(e,n,r,o,i,s){ie(X.DynamicComponentStart);let a=F(null);try{let l=this.componentDef,c=DA(r,l,s,i),f=vA(l,o||this.ngModule,e),h=EA(f),p=h.rendererFactory.createRenderer(null,l),m=r?Cb(p,r,l.encapsulation,f):CA(l,p),g=s?.some(nv)||i?.some(C=>typeof C!="function"&&C.bindings.some(nv)),y=Yf(null,c,null,512|$v(l),null,null,h,p,f,null,Ov(m,f,!0));y[pe]=m,Ba(y);let _=null;try{let C=ah(pe,y,2,"#host",()=>c.directiveRegistry,!0,0);Hv(p,m,C),Eo(m,y),yl(c,y,C),qf(c,C,y),lh(c,C),n!==void 0&&wA(C,this.ngContentSelectors,n),_=ft(C.index,y),y[Ie]=_[Ie],ih(c,y,null)}catch(C){throw _!==null&&pf(_),pf(y),C}finally{ie(X.DynamicComponentEnd),Ha()}return new il(this.componentType,y,!!g)}finally{F(a)}}};function DA(t,e,n,r){let o=t?["ng-version","21.1.1"]:eb(e.selectors[0]),i=null,s=null,a=0;if(n)for(let f of n)a+=f[If].requiredVars,f.create&&(f.targetIdx=0,(i??=[]).push(f)),f.update&&(f.targetIdx=0,(s??=[]).push(f));if(r)for(let f=0;f<r.length;f++){let h=r[f];if(typeof h!="function")for(let p of h.bindings){a+=p[If].requiredVars;let m=f+1;p.create&&(p.targetIdx=m,(i??=[]).push(p)),p.update&&(p.targetIdx=m,(s??=[]).push(p))}}let l=[e];if(r)for(let f of r){let h=typeof f=="function"?f:f.type,p=gd(h);l.push(p)}return jf(0,null,IA(i,s),1,a,l,null,null,null,[o],null)}function IA(t,e){return!t&&!e?null:n=>{if(n&1&&t)for(let r of t)r.create();if(n&2&&e)for(let r of e)r.update()}}function nv(t){let e=t[If].kind;return e==="input"||e==="twoWay"}var il=class extends hE{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,n,r){super(),this._rootLView=n,this._hasInputBindings=r,this._tNode=Ii(n[k],pe),this.location=Io(this._tNode,n),this.instance=ft(this._tNode.index,n)[Ie],this.hostView=this.changeDetectorRef=new $n(n,void 0),this.componentType=e}setInput(e,n){this._hasInputBindings;let r=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;let o=this._rootLView,i=oh(r,o[k],o,e,n);this.previousInputValues.set(e,n);let s=ft(r.index,o);sh(s,1)}get injector(){return new wr(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function wA(t,e,n){let r=t.projection=[];for(let o=0;o<e.length;o++){let i=n[o];r.push(i!=null&&i.length?Array.from(i):null)}}var To=(()=>{class t{static __NG_ELEMENT_ID__=TA}return t})();function TA(){let t=Ve();return EE(t,q())}var SA=To,vE=class extends SA{_lContainer;_hostTNode;_hostLView;constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return Io(this._hostTNode,this._hostLView)}get injector(){return new wr(this._hostTNode,this._hostLView)}get parentInjector(){let e=Bf(this._hostTNode,this._hostLView);if(_v(e)){let n=Za(e,this._hostLView),r=Qa(e),o=n[k].data[r+8];return new wr(o,n)}else return new wr(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let n=rv(this._lContainer);return n!==null&&n[e]||null}get length(){return this._lContainer.length-Ee}createEmbeddedView(e,n,r){let o,i;typeof r=="number"?o=r:r!=null&&(o=r.index,i=r.injector);let s=Ef(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(n||{},i,s);return this.insertImpl(a,o,ki(this._hostTNode,s)),a}createComponent(e,n,r,o,i,s,a){let l=e&&!iS(e),c;if(l)c=n;else{let _=n||{};c=_.index,r=_.injector,o=_.projectableNodes,i=_.environmentInjector||_.ngModuleRef,s=_.directives,a=_.bindings}let f=l?e:new Li(gr(e)),h=r||this.parentInjector;if(!i&&f.ngModule==null){let C=(l?h:this.parentInjector).get(at,null);C&&(i=C)}let p=gr(f.componentType??{}),m=Ef(this._lContainer,p?.id??null),g=m?.firstChild??null,y=f.create(h,o,g,i,s,a);return this.insertImpl(y.hostView,c,ki(this._hostTNode,m)),y}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,r){let o=e._lView;if(a_(o)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let l=o[Me],c=new vE(l,l[ct],l[Me]);c.detach(c.indexOf(e))}}let i=this._adjustIndex(n),s=this._lContainer;return vl(s,o,i,r),e.attachToViewContainerRef(),Ed(rf(s),i,e),e}move(e,n){return this.insert(e,n)}indexOf(e){let n=rv(this._lContainer);return n!==null?n.indexOf(e):-1}remove(e){let n=this._adjustIndex(e,-1),r=Oi(this._lContainer,n);r&&(_i(rf(this._lContainer),n),ml(r[k],r))}detach(e){let n=this._adjustIndex(e,-1),r=Oi(this._lContainer,n);return r&&_i(rf(this._lContainer),n)!=null?new $n(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function rv(t){return t[Di]}function rf(t){return t[Di]||(t[Di]=[])}function EE(t,e){let n,r=e[t.index];return It(r)?n=r:(n=lE(r,e,null,t),e[t.index]=n,Jf(e,n)),AA(n,e,t,r),new vE(n,t,e)}function bA(t,e){let n=t[ge],r=n.createComment(""),o=Wt(e,t),i=n.parentNode(o);return nl(n,i,r,n.nextSibling(o),!1),r}var AA=NA,MA=()=>!1;function xA(t,e,n){return MA(t,e,n)}function NA(t,e,n,r){if(t[Bn])return;let o;n.type&8?o=dt(r):o=bA(e,n),t[Bn]=o}var Tf=class t{queryList;matches=null;constructor(e){this.queryList=e}clone(){return new t(this.queryList)}setDirty(){this.queryList.setDirty()}},Sf=class t{queries;constructor(e=[]){this.queries=e}createEmbeddedView(e){let n=e.queries;if(n!==null){let r=e.contentQueries!==null?e.contentQueries[0]:n.length,o=[];for(let i=0;i<r;i++){let s=n.getByIndex(i),a=this.queries[s.indexInDeclarationView];o.push(a.clone())}return new t(o)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let n=0;n<this.queries.length;n++)IE(e,n).matches!==null&&this.queries[n].setDirty()}},bf=class{flags;read;predicate;constructor(e,n,r=null){this.flags=n,this.read=r,typeof e=="string"?this.predicate=VA(e):this.predicate=e}},Af=class t{queries;constructor(e=[]){this.queries=e}elementStart(e,n){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(e,n)}elementEnd(e){for(let n=0;n<this.queries.length;n++)this.queries[n].elementEnd(e)}embeddedTView(e){let n=null;for(let r=0;r<this.length;r++){let o=n!==null?n.length:0,i=this.getByIndex(r).embeddedTView(e,o);i&&(i.indexInDeclarationView=r,n!==null?n.push(i):n=[i])}return n!==null?new t(n):null}template(e,n){for(let r=0;r<this.queries.length;r++)this.queries[r].template(e,n)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},Mf=class t{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(e,n=-1){this.metadata=e,this._declarationNodeIndex=n}elementStart(e,n){this.isApplyingToNode(n)&&this.matchTNode(e,n)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,n){this.elementStart(e,n)}embeddedTView(e,n){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,n),new t(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let n=this._declarationNodeIndex,r=e.parent;for(;r!==null&&r.type&8&&r.index!==n;)r=r.parent;return n===(r!==null?r.index:-1)}return this._appliesToNextNode}matchTNode(e,n){let r=this.metadata.predicate;if(Array.isArray(r))for(let o=0;o<r.length;o++){let i=r[o];this.matchTNodeWithReadOption(e,n,RA(n,i)),this.matchTNodeWithReadOption(e,n,Ya(n,e,i,!1,!1))}else r===Co?n.type&4&&this.matchTNodeWithReadOption(e,n,-1):this.matchTNodeWithReadOption(e,n,Ya(n,e,r,!1,!1))}matchTNodeWithReadOption(e,n,r){if(r!==null){let o=this.metadata.read;if(o!==null)if(o===Jt||o===To||o===Co&&n.type&4)this.addMatch(n.index,-2);else{let i=Ya(n,e,o,!1,!1);i!==null&&this.addMatch(n.index,i)}else this.addMatch(n.index,r)}}addMatch(e,n){this.matches===null?this.matches=[e,n]:this.matches.push(e,n)}};function RA(t,e){let n=t.localNames;if(n!==null){for(let r=0;r<n.length;r+=2)if(n[r]===e)return n[r+1]}return null}function PA(t,e){return t.type&11?Io(t,e):t.type&4?El(t,e):null}function kA(t,e,n,r){return n===-1?PA(e,t):n===-2?FA(t,e,r):Pi(t,t[k],n,e)}function FA(t,e,n){if(n===Jt)return Io(e,t);if(n===Co)return El(e,t);if(n===To)return EE(e,t)}function CE(t,e,n,r){let o=e[Gt].queries[r];if(o.matches===null){let i=t.data,s=n.matches,a=[];for(let l=0;s!==null&&l<s.length;l+=2){let c=s[l];if(c<0)a.push(null);else{let f=i[c];a.push(kA(e,f,s[l+1],n.metadata.read))}}o.matches=a}return o.matches}function xf(t,e,n,r){let o=t.queries.getByIndex(n),i=o.matches;if(i!==null){let s=CE(t,e,o,n);for(let a=0;a<i.length;a+=2){let l=i[a];if(l>0)r.push(s[a/2]);else{let c=i[a+1],f=e[-l];for(let h=Ee;h<f.length;h++){let p=f[h];p[Un]===p[Me]&&xf(p[k],p,c,r)}if(f[Er]!==null){let h=f[Er];for(let p=0;p<h.length;p++){let m=h[p];xf(m[k],m,c,r)}}}}}return r}function DE(t,e){return t[Gt].queries[e].queryList}function OA(t,e,n){let r=new tl((n&4)===4);return c_(t,e,r,r.destroy),(e[Gt]??=new Sf).queries.push(new Tf(r))-1}function LA(t,e,n){let r=Re();return r.firstCreatePass&&(UA(r,new bf(t,e,n),-1),(e&2)===2&&(r.staticViewQueries=!0)),OA(r,q(),e)}function VA(t){return t.split(",").map(e=>e.trim())}function UA(t,e,n){t.queries===null&&(t.queries=new Af),t.queries.track(new Mf(e,n))}function IE(t,e){return t.queries.getByIndex(e)}function BA(t,e){let n=t[k],r=IE(n,e);return r.crossesNgTemplate?xf(n,t,e,[]):CE(n,t,r,e)}function wE(t,e,n){let r,o=si(()=>{r._dirtyCounter();let i=GA(r,t);if(e&&i===void 0)throw new O(-951,!1);return i});return r=o[ke],r._dirtyCounter=oe(0),r._flatValue=void 0,o}function TE(t){return wE(!0,!1,t)}function SE(t){return wE(!0,!0,t)}function HA(t,e){let n=t[ke];n._lView=q(),n._queryIndex=e,n._queryList=DE(n._lView,e),n._queryList.onDirty(()=>n._dirtyCounter.update(r=>r+1))}function GA(t,e){let n=t._lView,r=t._queryIndex;if(n===void 0||r===void 0||n[V]&4)return e?void 0:Ke;let o=DE(n,r),i=BA(n,r);return o.reset(i,TS),e?o.first:o._changesDetected||t._flatValue===void 0?t._flatValue=o.toArray():t._flatValue}var Vi=class{};var Ui=class extends Vi{injector;componentFactoryResolver=new wf(this);instance=null;constructor(e){super();let n=new fr([...e.providers,{provide:Vi,useValue:this},{provide:Dl,useValue:this.componentFactoryResolver}],e.parent||Ci(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function bE(t,e,n=null){return new Ui({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}var $A=(()=>{class t{_injector;cachedInjectors=new Map;constructor(n){this._injector=n}getOrCreateStandaloneInjector(n){if(!n.standalone)return null;if(!this.cachedInjectors.has(n)){let r=wd(!1,n.type),o=r.length>0?bE([r],this._injector,""):null;this.cachedInjectors.set(n,o)}return this.cachedInjectors.get(n)}ngOnDestroy(){try{for(let n of this.cachedInjectors.values())n!==null&&n.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=fe({token:t,providedIn:"environment",factory:()=>new t(te(at))})}return t})();function En(t){return Hi(()=>{let e=AE(t),n=W(x({},e),{decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===Hf.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:e.standalone?o=>o.get($A).getOrCreateStandaloneInjector(n):null,getExternalStyles:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||St.Emulated,styles:t.styles||Ke,_:null,schemas:t.schemas||null,tView:null,id:""});e.standalone&&qn("NgStandalone"),ME(n);let r=t.dependencies;return n.directiveDefs=ov(r,qA),n.pipeDefs=ov(r,Wy),n.id=jA(n),n})}function qA(t){return gr(t)||gd(t)}function Mr(t){return Hi(()=>({type:t.type,bootstrap:t.bootstrap||Ke,declarations:t.declarations||Ke,imports:t.imports||Ke,exports:t.exports||Ke,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function WA(t,e){if(t==null)return Vn;let n={};for(let r in t)if(t.hasOwnProperty(r)){let o=t[r],i,s,a,l;Array.isArray(o)?(a=o[0],i=o[1],s=o[2]??i,l=o[3]||null):(i=o,s=o,a=pl.None,l=null),n[i]=[r,a,l],e[i]=s}return n}function zA(t){if(t==null)return Vn;let e={};for(let n in t)t.hasOwnProperty(n)&&(e[t[n]]=n);return e}function Kt(t){return Hi(()=>{let e=AE(t);return ME(e),e})}function ji(t){return{type:t.type,name:t.name,factory:null,pure:t.pure!==!1,standalone:t.standalone??!0,onDestroy:t.type.prototype.ngOnDestroy||null}}function AE(t){let e={};return{type:t.type,providersResolver:null,viewProvidersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputConfig:t.inputs||Vn,exportAs:t.exportAs||null,standalone:t.standalone??!0,signals:t.signals===!0,selectors:t.selectors||Ke,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:WA(t.inputs,e),outputs:zA(t.outputs),debugInfo:null}}function ME(t){t.features?.forEach(e=>e(t))}function ov(t,e){return t?()=>{let n=typeof t=="function"?t():t,r=[];for(let o of n){let i=e(o);i!==null&&r.push(i)}return r}:null}function jA(t){let e=0,n=typeof t.consts=="function"?"":t.consts,r=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,n,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery];for(let i of r.join("|"))e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function YA(t){return Object.getPrototypeOf(t.prototype).constructor}function Wn(t){let e=YA(t.type),n=!0,r=[t];for(;e;){let o;if(qt(t))o=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new O(903,!1);o=e.\u0275dir}if(o){if(n){r.push(o);let s=t;s.inputs=of(t.inputs),s.declaredInputs=of(t.declaredInputs),s.outputs=of(t.outputs);let a=o.hostBindings;a&&XA(t,a);let l=o.viewQuery,c=o.contentQueries;if(l&&QA(t,l),c&&ZA(t,c),JA(t,o),qy(t.outputs,o.outputs),qt(o)&&o.data.animation){let f=t.data;f.animation=(f.animation||[]).concat(o.data.animation)}}let i=o.features;if(i)for(let s=0;s<i.length;s++){let a=i[s];a&&a.ngInherit&&a(t),a===Wn&&(n=!1)}}e=Object.getPrototypeOf(e)}KA(r)}function JA(t,e){for(let n in e.inputs){if(!e.inputs.hasOwnProperty(n)||t.inputs.hasOwnProperty(n))continue;let r=e.inputs[n];r!==void 0&&(t.inputs[n]=r,t.declaredInputs[n]=e.declaredInputs[n])}}function KA(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){let o=t[r];o.hostVars=e+=o.hostVars,o.hostAttrs=vo(o.hostAttrs,n=vo(n,o.hostAttrs))}}function of(t){return t===Vn?{}:t===Ke?[]:t}function QA(t,e){let n=t.viewQuery;n?t.viewQuery=(r,o)=>{e(r,o),n(r,o)}:t.viewQuery=e}function ZA(t,e){let n=t.contentQueries;n?t.contentQueries=(r,o,i)=>{e(r,o,i),n(r,o,i)}:t.contentQueries=e}function XA(t,e){let n=t.hostBindings;n?t.hostBindings=(r,o)=>{e(r,o),n(r,o)}:t.hostBindings=e}function xE(t,e,n,r,o,i,s,a){if(n.firstCreatePass){t.mergedAttrs=vo(t.mergedAttrs,t.attrs);let f=t.tView=jf(2,t,o,i,s,n.directiveRegistry,n.pipeRegistry,null,n.schemas,n.consts,null);n.queries!==null&&(n.queries.template(n,t),f.queries=n.queries.embeddedTView(t))}a&&(t.flags|=a),fo(t,!1);let l=tM(n,e,t,r);Ga()&&Xf(n,e,l,t),Eo(l,e);let c=lE(l,e,l,t);e[r+pe]=c,Jf(e,c),xA(c,t,e)}function eM(t,e,n,r,o,i,s,a,l,c,f){let h=n+pe,p;return e.firstCreatePass?(p=zi(e,h,4,s||null,a||null),La()&&mE(e,t,p,ht(e.consts,c),th),gv(e,p)):p=e.data[h],xE(p,t,e,n,r,o,i,l),lo(p)&&yl(e,t,p),c!=null&&Wi(t,p,f),p}function sl(t,e,n,r,o,i,s,a,l,c,f){let h=n+pe,p;if(e.firstCreatePass){if(p=zi(e,h,4,s||null,a||null),c!=null){let m=ht(e.consts,c);p.localNames=[];for(let g=0;g<m.length;g+=2)p.localNames.push(m[g],-1)}}else p=e.data[h];return xE(p,t,e,n,r,o,i,l),c!=null&&Wi(t,p,f),p}function xr(t,e,n,r,o,i,s,a){let l=q(),c=Re(),f=ht(c.consts,i);return eM(l,c,t,e,n,r,o,f,void 0,s,a),xr}var tM=nM;function nM(t,e,n,r){return bi(!0),e[ge].createComment("")}function NE(t){return typeof t=="function"&&t[ke]!==void 0}function ch(t){return NE(t)&&typeof t.set=="function"}var dh=new B("");function So(t){return!!t&&typeof t.then=="function"}function fh(t){return!!t&&typeof t.subscribe=="function"}var RE=new B("");var hh=(()=>{class t{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((n,r)=>{this.resolve=n,this.reject=r});appInits=K(RE,{optional:!0})??[];injector=K(Ht);constructor(){}runInitializers(){if(this.initialized)return;let n=[];for(let o of this.appInits){let i=Ra(this.injector,o);if(So(i))n.push(i);else if(fh(i)){let s=new Promise((a,l)=>{i.subscribe({complete:a,error:l})});n.push(s)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(n).then(()=>{r()}).catch(o=>{this.reject(o)}),n.length===0&&r(),this.initialized=!0}static \u0275fac=function(r){return new(r||t)};static \u0275prov=fe({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),PE=new B("");function kE(){Oc(()=>{let t="";throw new O(600,t)})}function FE(t){return t.isBoundToModule}var rM=10;var Yi=(()=>{class t{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=K(Ir);afterRenderManager=K(zv);zonelessEnabled=K(Ai);rootEffectScheduler=K(qa);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new Ct;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=K(mo);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe(lr(n=>!n))}constructor(){K(qi,{optional:!0})}whenStable(){let n;return new Promise(r=>{n=this.isStable.subscribe({next:o=>{o&&r()}})}).finally(()=>{n.unsubscribe()})}_injector=K(at);_rendererFactory=null;get injector(){return this._injector}bootstrap(n,r){return this.bootstrapImpl(n,r)}bootstrapImpl(n,r,o=Ht.NULL){return this._injector.get(lt).run(()=>{ie(X.BootstrapComponentStart);let s=n instanceof Cl;if(!this._injector.get(hh).done){let g="";throw new O(405,g)}let l;s?l=n:l=this._injector.get(Dl).resolveComponentFactory(n),this.componentTypes.push(l.componentType);let c=FE(l)?void 0:this._injector.get(Vi),f=r||l.selector,h=l.create(o,[],f,c),p=h.location.nativeElement,m=h.injector.get(dh,null);return m?.registerApplication(p),h.onDestroy(()=>{this.detachView(h.hostView),Ni(this.components,h),m?.unregisterApplication(p)}),this._loadComponent(h),ie(X.BootstrapComponentEnd,h),h})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){ie(X.ChangeDetectionStart),this.tracingSnapshot!==null?this.tracingSnapshot.run(Qf.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw ie(X.ChangeDetectionEnd),new O(101,!1);let n=F(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,F(n),this.afterTick.next(),ie(X.ChangeDetectionEnd)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(br,null,{optional:!0}));let n=0;for(;this.dirtyFlags!==0&&n++<rM;){ie(X.ChangeDetectionSyncStart);try{this.synchronizeOnce()}finally{ie(X.ChangeDetectionSyncEnd)}}}synchronizeOnce(){this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let n=!1;if(this.dirtyFlags&7){let r=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:o}of this.allViews){if(!r&&!Ti(o))continue;let i=r&&!this.zonelessEnabled?0:1;oE(o,i),n=!0}if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}n||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:n})=>Ti(n))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(n){let r=n;this._views.push(r),r.attachToAppRef(this)}detachView(n){let r=n;Ni(this._views,r),r.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView);try{this.tick()}catch(o){this.internalErrorHandler(o)}this.components.push(n),this._injector.get(PE,[]).forEach(o=>o(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>Ni(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new O(406,!1);let n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(r){return new(r||t)};static \u0275prov=fe({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Ni(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}var M8=typeof document<"u"&&typeof document?.documentElement?.getAnimations=="function";var Nf=class{destroy(e){}updateValue(e,n){}swap(e,n){let r=Math.min(e,n),o=Math.max(e,n),i=this.detach(o);if(o-r>1){let s=this.detach(r);this.attach(r,i),this.attach(o,s)}else this.attach(r,i)}move(e,n){this.attach(n,this.detach(e))}};function sf(t,e,n,r,o){return t===n&&Object.is(e,r)?1:Object.is(o(t,e),o(n,r))?-1:0}function oM(t,e,n,r){let o,i,s=0,a=t.length-1,l=void 0;if(Array.isArray(e)){F(r);let c=e.length-1;for(F(null);s<=a&&s<=c;){let f=t.at(s),h=e[s],p=sf(s,f,s,h,n);if(p!==0){p<0&&t.updateValue(s,h),s++;continue}let m=t.at(a),g=e[c],y=sf(a,m,c,g,n);if(y!==0){y<0&&t.updateValue(a,g),a--,c--;continue}let _=n(s,f),C=n(a,m),I=n(s,h);if(Object.is(I,C)){let w=n(c,g);Object.is(w,_)?(t.swap(s,a),t.updateValue(a,g),c--,a--):t.move(a,s),t.updateValue(s,h),s++;continue}if(o??=new al,i??=sv(t,s,a,n),Rf(t,o,s,I))t.updateValue(s,h),s++,a++;else if(i.has(I))o.set(_,t.detach(s)),a--;else{let w=t.create(s,e[s]);t.attach(s,w),s++,a++}}for(;s<=c;)iv(t,o,n,s,e[s]),s++}else if(e!=null){F(r);let c=e[Symbol.iterator]();F(null);let f=c.next();for(;!f.done&&s<=a;){let h=t.at(s),p=f.value,m=sf(s,h,s,p,n);if(m!==0)m<0&&t.updateValue(s,p),s++,f=c.next();else{o??=new al,i??=sv(t,s,a,n);let g=n(s,p);if(Rf(t,o,s,g))t.updateValue(s,p),s++,a++,f=c.next();else if(!i.has(g))t.attach(s,t.create(s,p)),s++,a++,f=c.next();else{let y=n(s,h);o.set(y,t.detach(s)),a--}}}for(;!f.done;)iv(t,o,n,t.length,f.value),f=c.next()}for(;s<=a;)t.destroy(t.detach(a--));o?.forEach(c=>{t.destroy(c)})}function Rf(t,e,n,r){return e!==void 0&&e.has(r)?(t.attach(n,e.get(r)),e.delete(r),!0):!1}function iv(t,e,n,r,o){if(Rf(t,e,r,n(r,o)))t.updateValue(r,o);else{let i=t.create(r,o);t.attach(r,i)}}function sv(t,e,n,r){let o=new Set;for(let i=e;i<=n;i++)o.add(r(i,t.at(i)));return o}var al=class{kvMap=new Map;_vMap=void 0;has(e){return this.kvMap.has(e)}delete(e){if(!this.has(e))return!1;let n=this.kvMap.get(e);return this._vMap!==void 0&&this._vMap.has(n)?(this.kvMap.set(e,this._vMap.get(n)),this._vMap.delete(n)):this.kvMap.delete(e),!0}get(e){return this.kvMap.get(e)}set(e,n){if(this.kvMap.has(e)){let r=this.kvMap.get(e);this._vMap===void 0&&(this._vMap=new Map);let o=this._vMap;for(;o.has(r);)r=o.get(r);o.set(r,n)}else this.kvMap.set(e,n)}forEach(e){for(let[n,r]of this.kvMap)if(e(r,n),this._vMap!==void 0){let o=this._vMap;for(;o.has(r);)r=o.get(r),e(r,n)}}};function Ue(t,e,n,r,o,i,s,a){qn("NgControlFlow");let l=q(),c=Re(),f=ht(c.consts,i);return sl(l,c,t,e,n,r,o,f,256,s,a),ph}function ph(t,e,n,r,o,i,s,a){qn("NgControlFlow");let l=q(),c=Re(),f=ht(c.consts,i);return sl(l,c,t,e,n,r,o,f,512,s,a),ph}function Be(t,e){qn("NgControlFlow");let n=q(),r=ho(),o=n[r]!==mt?n[r]:-1,i=o!==-1?ll(n,pe+o):void 0,s=0;if(vn(n,r,t)){let a=F(null);try{if(i!==void 0&&cE(i,s),t!==-1){let l=pe+t,c=ll(n,l),f=Of(n[k],l),h=fE(c,f,n),p=_l(n,f,e,{dehydratedView:h});vl(c,p,s,ki(f,h))}}finally{F(a)}}else if(i!==void 0){let a=uE(i,s);a!==void 0&&(a[Ie]=e)}}var Pf=class{lContainer;$implicit;$index;constructor(e,n,r){this.lContainer=e,this.$implicit=n,this.$index=r}get $count(){return this.lContainer.length-Ee}};function mh(t){return t}var kf=class{hasEmptyBlock;trackByFn;liveCollection;constructor(e,n,r){this.hasEmptyBlock=e,this.trackByFn=n,this.liveCollection=r}};function Qt(t,e,n,r,o,i,s,a,l,c,f,h,p){qn("NgControlFlow");let m=q(),g=Re(),y=l!==void 0,_=q(),C=a?s.bind(_[it][Ie]):s,I=new kf(y,C);_[pe+t]=I,sl(m,g,t+1,e,n,r,o,ht(g.consts,i),256),y&&sl(m,g,t+2,l,c,f,h,ht(g.consts,p),512)}var Ff=class extends Nf{lContainer;hostLView;templateTNode;operationsCounter=void 0;needsIndexUpdate=!1;constructor(e,n,r){super(),this.lContainer=e,this.hostLView=n,this.templateTNode=r}get length(){return this.lContainer.length-Ee}at(e){return this.getLView(e)[Ie].$implicit}attach(e,n){let r=n[io];this.needsIndexUpdate||=e!==this.length,vl(this.lContainer,n,e,ki(this.templateTNode,r)),iM(this.lContainer,e)}detach(e){return this.needsIndexUpdate||=e!==this.length-1,sM(this.lContainer,e),aM(this.lContainer,e)}create(e,n){let r=Ef(this.lContainer,this.templateTNode.tView.ssrId);return _l(this.hostLView,this.templateTNode,new Pf(this.lContainer,n,e),{dehydratedView:r})}destroy(e){ml(e[k],e)}updateValue(e,n){this.getLView(e)[Ie].$implicit=n}reset(){this.needsIndexUpdate=!1}updateIndexes(){if(this.needsIndexUpdate)for(let e=0;e<this.length;e++)this.getLView(e)[Ie].$index=e}getLView(e){return lM(this.lContainer,e)}};function Zt(t){let e=F(null),n=_n();try{let r=q(),o=r[k],i=r[n],s=n+1,a=ll(r,s);if(i.liveCollection===void 0){let c=Of(o,s);i.liveCollection=new Ff(a,r,c)}else i.liveCollection.reset();let l=i.liveCollection;if(oM(l,t,i.trackByFn,e),l.updateIndexes(),i.hasEmptyBlock){let c=ho(),f=l.length===0;if(vn(r,c,f)){let h=n+2,p=ll(r,h);if(f){let m=Of(o,h),g=fE(p,m,r),y=_l(r,m,void 0,{dehydratedView:g});vl(p,y,0,ki(m,g))}else o.firstUpdatePass&&Zb(p),cE(p,0)}}}finally{F(e)}}function ll(t,e){return t[e]}function iM(t,e){if(t.length<=Ee)return;let n=Ee+e,r=t[n],o=r?r[vr]:void 0;if(r&&o&&o.detachedLeaveAnimationFns&&o.detachedLeaveAnimationFns.length>0){let i=r[hn];ib(i,o),Sr.delete(r[mn]),o.detachedLeaveAnimationFns=void 0}}function sM(t,e){if(t.length<=Ee)return;let n=Ee+e,r=t[n],o=r?r[vr]:void 0;o&&o.leave&&o.leave.size>0&&(o.detachedLeaveAnimationFns=[])}function aM(t,e){return Oi(t,e)}function lM(t,e){return uE(t,e)}function Of(t,e){return Ii(t,e)}function Te(t,e,n){let r=q(),o=ho();if(vn(r,o,e)){let i=Re(),s=Yd();Zv(s,r,t,e,r[ge],n)}return Te}function av(t,e,n,r,o){oh(e,t,n,o?"class":"style",r)}function v(t,e,n,r){let o=q(),i=o[k],s=t+pe,a=i.firstCreatePass?ah(s,o,2,e,th,La(),n,r):i.data[s];if(nh(a,o,t,e,OE),lo(a)){let l=o[k];yl(l,o,a),qf(l,a,o)}return r!=null&&Wi(o,a),v}function E(){let t=Re(),e=Ve(),n=rh(e);return t.firstCreatePass&&lh(t,n),Bd(n)&&Hd(),Ud(),n.classesWithoutHost!=null&&dS(n)&&av(t,n,q(),n.classesWithoutHost,!0),n.stylesWithoutHost!=null&&fS(n)&&av(t,n,q(),n.stylesWithoutHost,!1),E}function Y(t,e,n,r){return v(t,e,n,r),E(),Y}function zn(t,e,n,r){let o=q(),i=o[k],s=t+pe,a=i.firstCreatePass?fA(s,i,2,e,n,r):i.data[s];return nh(a,o,t,e,OE),r!=null&&Wi(o,a),zn}function Cn(){let t=Ve(),e=rh(t);return Bd(e)&&Hd(),Ud(),Cn}function bo(t,e,n,r){return zn(t,e,n,r),Cn(),bo}var OE=(t,e,n,r,o)=>(bi(!0),Vv(e[ge],r,A_()));function gh(t,e,n){let r=q(),o=r[k],i=t+pe,s=o.firstCreatePass?ah(i,r,8,"ng-container",th,La(),e,n):o.data[i];if(nh(s,r,t,"ng-container",uM),lo(s)){let a=r[k];yl(a,r,s),qf(a,s,r)}return n!=null&&Wi(r,s),gh}function yh(){let t=Re(),e=Ve(),n=rh(e);return t.firstCreatePass&&lh(t,n),yh}function Ao(t,e,n){return gh(t,e,n),yh(),Ao}var uM=(t,e,n,r,o)=>(bi(!0),HS(e[ge],""));function Il(){return q()}var Mi=void 0;function cM(t){let e=Math.floor(Math.abs(t)),n=t.toString().replace(/^[^.]*\.?/,"").length;return e===1&&n===0?1:5}var dM=["en",[["a","p"],["AM","PM"]],[["AM","PM"]],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Mi,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Mi,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm\u202Fa","h:mm:ss\u202Fa","h:mm:ss\u202Fa z","h:mm:ss\u202Fa zzzz"],["{1}, {0}",Mi,Mi,Mi],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",cM],Ri={};function _h(t,e,n){typeof e!="string"&&(n=e,e=t[he.LocaleId]),e=e.toLowerCase().replace(/_/g,"-"),Ri[e]=t,n&&(Ri[e][he.ExtraData]=n)}function je(t){let e=fM(t),n=lv(e);if(n)return n;let r=e.split("-")[0];if(n=lv(r),n)return n;if(r==="en")return dM;throw new O(701,!1)}function lv(t){return t in Ri||(Ri[t]=pr.ng&&pr.ng.common&&pr.ng.common.locales&&pr.ng.common.locales[t]),Ri[t]}var he=(function(t){return t[t.LocaleId=0]="LocaleId",t[t.DayPeriodsFormat=1]="DayPeriodsFormat",t[t.DayPeriodsStandalone=2]="DayPeriodsStandalone",t[t.DaysFormat=3]="DaysFormat",t[t.DaysStandalone=4]="DaysStandalone",t[t.MonthsFormat=5]="MonthsFormat",t[t.MonthsStandalone=6]="MonthsStandalone",t[t.Eras=7]="Eras",t[t.FirstDayOfWeek=8]="FirstDayOfWeek",t[t.WeekendRange=9]="WeekendRange",t[t.DateFormat=10]="DateFormat",t[t.TimeFormat=11]="TimeFormat",t[t.DateTimeFormat=12]="DateTimeFormat",t[t.NumberSymbols=13]="NumberSymbols",t[t.NumberFormats=14]="NumberFormats",t[t.CurrencyCode=15]="CurrencyCode",t[t.CurrencySymbol=16]="CurrencySymbol",t[t.CurrencyName=17]="CurrencyName",t[t.Currencies=18]="Currencies",t[t.Directionality=19]="Directionality",t[t.PluralCase=20]="PluralCase",t[t.ExtraData=21]="ExtraData",t})(he||{});function fM(t){return t.toLowerCase().replace(/_/g,"-")}var Ji="en-US",hM="USD";var pM=Ji;function LE(t){typeof t=="string"&&(pM=t.toLowerCase().replace(/_/g,"-"))}function me(t,e,n){let r=q(),o=Re(),i=Ve();return VE(o,r,r[ge],i,t,e,n),me}function VE(t,e,n,r,o,i,s){let a=!0,l=null;if((r.type&3||s)&&(l??=nf(r,e,i),pA(r,t,e,s,n,o,i,l)&&(a=!1)),a){let c=r.outputs?.[o],f=r.hostDirectiveOutputs?.[o];if(f&&f.length)for(let h=0;h<f.length;h+=2){let p=f[h],m=f[h+1];l??=nf(r,e,i),tv(r,e,p,m,o,l)}if(c&&c.length)for(let h of c)l??=nf(r,e,i),tv(r,e,h,o,o,l)}}function le(t=1){return b_(t)}function wl(t,e,n,r){return HA(t,LA(e,n,r)),wl}function vh(t=1){Ua(I_()+t)}function Eh(t){let e=g_();return wi(e,pe+t)}function Wa(t,e){return t<<17|e<<2}function Ar(t){return t>>17&32767}function mM(t){return(t&2)==2}function gM(t,e){return t&131071|e<<17}function Lf(t){return t|2}function Do(t){return(t&131068)>>2}function af(t,e){return t&-131069|e<<2}function yM(t){return(t&1)===1}function Vf(t){return t|1}function _M(t,e,n,r,o,i){let s=i?e.classBindings:e.styleBindings,a=Ar(s),l=Do(s);t[r]=n;let c=!1,f;if(Array.isArray(n)){let h=n;f=h[1],(f===null||oo(h,f)>0)&&(c=!0)}else f=n;if(o)if(l!==0){let p=Ar(t[a+1]);t[r+1]=Wa(p,a),p!==0&&(t[p+1]=af(t[p+1],r)),t[a+1]=gM(t[a+1],r)}else t[r+1]=Wa(a,0),a!==0&&(t[a+1]=af(t[a+1],r)),a=r;else t[r+1]=Wa(l,0),a===0?a=r:t[l+1]=af(t[l+1],r),l=r;c&&(t[r+1]=Lf(t[r+1])),uv(t,f,r,!0),uv(t,f,r,!1),vM(e,f,t,r,i),s=Wa(a,l),i?e.classBindings=s:e.styleBindings=s}function vM(t,e,n,r,o){let i=o?t.residualClasses:t.residualStyles;i!=null&&typeof e=="string"&&oo(i,e)>=0&&(n[r+1]=Vf(n[r+1]))}function uv(t,e,n,r){let o=t[n+1],i=e===null,s=r?Ar(o):Do(o),a=!1;for(;s!==0&&(a===!1||i);){let l=t[s],c=t[s+1];EM(l,e)&&(a=!0,t[s+1]=r?Vf(c):Lf(c)),s=r?Ar(c):Do(c)}a&&(t[n+1]=r?Lf(o):Vf(o))}function EM(t,e){return t===null||e==null||(Array.isArray(t)?t[1]:t)===e?!0:Array.isArray(t)&&typeof e=="string"?oo(t,e)>=0:!1}function bt(t,e,n){return UE(t,e,n,!1),bt}function xe(t,e){return UE(t,e,null,!0),xe}function UE(t,e,n,r){let o=q(),i=Re(),s=Wd(2);if(i.firstUpdatePass&&DM(i,t,s,r),e!==mt&&vn(o,s,e)){let a=i.data[_n()];bM(i,a,o,o[ge],t,o[s+1]=AM(e,n),r,s)}}function CM(t,e){return e>=t.expandoStartIndex}function DM(t,e,n,r){let o=t.data;if(o[n+1]===null){let i=o[_n()],s=CM(t,n);MM(i,r)&&e===null&&!s&&(e=!1),e=IM(o,i,e,r),_M(o,i,e,n,s,r)}}function IM(t,e,n,r){let o=D_(t),i=r?e.residualClasses:e.residualStyles;if(o===null)(r?e.classBindings:e.styleBindings)===0&&(n=lf(null,t,e,n,r),n=Bi(n,e.attrs,r),i=null);else{let s=e.directiveStylingLast;if(s===-1||t[s]!==o)if(n=lf(o,t,e,n,r),i===null){let l=wM(t,e,r);l!==void 0&&Array.isArray(l)&&(l=lf(null,t,e,l[1],r),l=Bi(l,e.attrs,r),TM(t,e,r,l))}else i=SM(t,e,r)}return i!==void 0&&(r?e.residualClasses=i:e.residualStyles=i),n}function wM(t,e,n){let r=n?e.classBindings:e.styleBindings;if(Do(r)!==0)return t[Ar(r)]}function TM(t,e,n,r){let o=n?e.classBindings:e.styleBindings;t[Ar(o)]=r}function SM(t,e,n){let r,o=e.directiveEnd;for(let i=1+e.directiveStylingLast;i<o;i++){let s=t[i].hostAttrs;r=Bi(r,s,n)}return Bi(r,e.attrs,n)}function lf(t,e,n,r,o){let i=null,s=n.directiveEnd,a=n.directiveStylingLast;for(a===-1?a=n.directiveStart:a++;a<s&&(i=e[a],r=Bi(r,i.hostAttrs,o),i!==t);)a++;return t!==null&&(n.directiveStylingLast=a),r}function Bi(t,e,n){let r=n?1:2,o=-1;if(e!==null)for(let i=0;i<e.length;i++){let s=e[i];typeof s=="number"?o=s:o===r&&(Array.isArray(t)||(t=t===void 0?[]:["",t]),Xy(t,s,n?!0:e[++i]))}return t===void 0?null:t}function bM(t,e,n,r,o,i,s,a){if(!(e.type&3))return;let l=t.data,c=l[a+1],f=yM(c)?cv(l,e,n,o,Do(c),s):void 0;if(!ul(f)){ul(i)||mM(c)&&(i=cv(l,null,n,o,a,s));let h=Rd(_n(),n);Eb(r,s,h,o,i)}}function cv(t,e,n,r,o,i){let s=e===null,a;for(;o>0;){let l=t[o],c=Array.isArray(l),f=c?l[1]:l,h=f===null,p=n[o+1];p===mt&&(p=h?Ke:void 0);let m=h?Na(p,r):f===r?p:void 0;if(c&&!ul(m)&&(m=Na(l,r)),ul(m)&&(a=m,s))return a;let g=t[o+1];o=s?Ar(g):Do(g)}if(e!==null){let l=i?e.residualClasses:e.residualStyles;l!=null&&(a=Na(l,r))}return a}function ul(t){return t!==void 0}function AM(t,e){return t==null||t===""||(typeof e=="string"?t=t+e:typeof t=="object"&&(t=Rn(Wf(t)))),t}function MM(t,e){return(t.flags&(e?8:16))!==0}function D(t,e=""){let n=q(),r=Re(),o=t+pe,i=r.firstCreatePass?zi(r,o,1,e,null):r.data[o],s=xM(r,n,i,e,t);n[o]=s,Ga()&&Xf(r,n,s,i),fo(i,!1)}var xM=(t,e,n,r,o)=>(bi(!0),US(e[ge],r));function NM(t,e,n,r=""){return vn(t,ho(),n)?e+yi(n)+r:mt}function RM(t,e,n,r,o,i=""){let s=y_(),a=ol(t,s,n,o);return Wd(2),a?e+yi(n)+r+yi(o)+i:mt}function ye(t){return _e("",t),ye}function _e(t,e,n){let r=q(),o=NM(r,t,e,n);return o!==mt&&BE(r,_n(),o),_e}function Tl(t,e,n,r,o){let i=q(),s=RM(i,t,e,n,r,o);return s!==mt&&BE(i,_n(),s),Tl}function BE(t,e,n){let r=Rd(e,t);BS(t[ge],r,n)}function Xt(t,e,n){ch(e)&&(e=e());let r=q(),o=ho();if(vn(r,o,e)){let i=Re(),s=Yd();Zv(s,r,t,e,r[ge],n)}return Xt}function Dn(t,e){let n=ch(t);return n&&t.set(e),n}function en(t,e){let n=q(),r=Re(),o=Ve();return VE(r,n,n[ge],o,t,e),en}function dv(t,e,n){let r=Re();r.firstCreatePass&&HE(e,r.data,r.blueprint,qt(t),n)}function HE(t,e,n,r,o){if(t=Fe(t),Array.isArray(t))for(let i=0;i<t.length;i++)HE(t[i],e,n,r,o);else{let i=Re(),s=q(),a=Ve(),l=dr(t)?t:Fe(t.provide),c=Sd(t),f=a.providerIndexes&1048575,h=a.directiveStart,p=a.providerIndexes>>20;if(dr(t)||!t.multi){let m=new Tr(c,o,ae,null),g=cf(l,e,o?f:f+p,h);g===-1?(ff(el(a,s),i,l),uf(i,t,e.length),e.push(l),a.directiveStart++,a.directiveEnd++,o&&(a.providerIndexes+=1048576),n.push(m),s.push(m)):(n[g]=m,s[g]=m)}else{let m=cf(l,e,f+p,h),g=cf(l,e,f,f+p),y=m>=0&&n[m],_=g>=0&&n[g];if(o&&!_||!o&&!y){ff(el(a,s),i,l);let C=FM(o?kM:PM,n.length,o,r,c,t);!o&&_&&(n[g].providerFactory=C),uf(i,t,e.length,0),e.push(l),a.directiveStart++,a.directiveEnd++,o&&(a.providerIndexes+=1048576),n.push(C),s.push(C)}else{let C=GE(n[o?g:m],c,!o&&r);uf(i,t,m>-1?m:g,C)}!o&&r&&_&&n[g].componentProviders++}}}function uf(t,e,n,r){let o=dr(e),i=r_(e);if(o||i){let l=(i?Fe(e.useClass):e).prototype.ngOnDestroy;if(l){let c=t.destroyHooks||(t.destroyHooks=[]);if(!o&&e.multi){let f=c.indexOf(n);f===-1?c.push(n,[r,l]):c[f+1].push(r,l)}else c.push(n,l)}}}function GE(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function cf(t,e,n,r){for(let o=n;o<r;o++)if(e[o]===t)return o;return-1}function PM(t,e,n,r,o){return Uf(this.multi,[])}function kM(t,e,n,r,o){let i=this.multi,s;if(this.providerFactory){let a=this.providerFactory.componentProviders,l=Pi(r,r[k],this.providerFactory.index,o);s=l.slice(0,a),Uf(i,s);for(let c=a;c<l.length;c++)s.push(l[c])}else s=[],Uf(i,s);return s}function Uf(t,e){for(let n=0;n<t.length;n++){let r=t[n];e.push(r())}return e}function FM(t,e,n,r,o,i){let s=new Tr(t,n,ae,null);return s.multi=[],s.index=e,s.componentProviders=0,GE(s,o,r&&!n),s}function Ki(t,e){return n=>{n.providersResolver=(r,o)=>dv(r,o?o(t):t,!1),e&&(n.viewProvidersResolver=(r,o)=>dv(r,o?o(e):e,!0))}}function Qi(t,e,n){return $E(q(),Si(),t,e,n)}function Ch(t,e){let n=t[e];return n===mt?void 0:n}function $E(t,e,n,r,o,i){let s=e+n;return vn(t,s,o)?uh(t,s+1,i?r.call(i,o):r(o)):Ch(t,s+1)}function OM(t,e,n,r,o,i,s){let a=e+n;return ol(t,a,o,i)?uh(t,a+2,s?r.call(s,o,i):r(o,i)):Ch(t,a+2)}function LM(t,e,n,r,o,i,s,a,l){let c=e+n;return hA(t,c,o,i,s,a)?uh(t,c+4,l?r.call(l,o,i,s,a):r(o,i,s,a)):Ch(t,c+4)}function He(t,e){let n=Re(),r,o=t+pe;n.firstCreatePass?(r=VM(e,n.pipeRegistry),n.data[o]=r,r.onDestroy&&(n.destroyHooks??=[]).push(o,r.onDestroy)):r=n.data[o];let i=r.factory||(r.factory=Pn(r.type,!0)),s,a=ze(ae);try{let l=Xa(!1),c=i();return Xa(l),Pd(n,q(),o,c),c}finally{ze(a)}}function VM(t,e){if(e)for(let n=e.length-1;n>=0;n--){let r=e[n];if(t===r.name)return r}}function Dh(t,e,n){let r=t+pe,o=q(),i=wi(o,r);return Ih(o,r)?$E(o,Si(),e,i.transform,n,i):i.transform(n)}function gt(t,e,n,r){let o=t+pe,i=q(),s=wi(i,o);return Ih(i,o)?OM(i,Si(),e,s.transform,n,r,s):s.transform(n,r)}function Zi(t,e,n,r,o,i){let s=t+pe,a=q(),l=wi(a,s);return Ih(a,s)?LM(a,Si(),e,l.transform,n,r,o,i,l):l.transform(n,r,o,i)}function Ih(t,e){return t[k].data[e].pure}function wh(t,e){return El(t,e)}var qE=(()=>{class t{applicationErrorHandler=K(Ir);appRef=K(Yi);taskService=K(mo);ngZone=K(lt);zonelessEnabled=K(Ai);tracing=K(qi,{optional:!0});zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new We;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(pi):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(K(Zd,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{let n=this.taskService.add();if(!this.runningTick&&(this.cleanup(),!this.zonelessEnabled||this.appRef.includeAllTestViews)){this.taskService.remove(n);return}this.switchToMicrotaskScheduler(),this.taskService.remove(n)})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()}))}switchToMicrotaskScheduler(){this.ngZone.runOutsideAngular(()=>{let n=this.taskService.add();this.useMicrotaskScheduler=!0,queueMicrotask(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(n)})})}notify(n){if(!this.zonelessEnabled&&n===5)return;switch(n){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2;break}case 12:{this.appRef.dirtyFlags|=16;break}case 13:{this.appRef.dirtyFlags|=2;break}case 11:break;default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick())return;let r=this.useMicrotaskScheduler?P_:Jd;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>r(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(){return!(this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(pi+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let n=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){this.applicationErrorHandler(r)}finally{this.taskService.remove(n),this.cleanup()}}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let n=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(n)}}static \u0275fac=function(r){return new(r||t)};static \u0275prov=fe({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Th(){return qn("NgZoneless"),Id([...Sh(),[]])}function Sh(){return[{provide:hr,useExisting:qE},{provide:lt,useClass:mi},{provide:Ai,useValue:!0}]}function UM(){return typeof $localize<"u"&&$localize.locale||Ji}var In=new B("",{factory:()=>K(In,{optional:!0,skipSelf:!0})||UM()}),bh=new B("",{factory:()=>hM});function jn(t,e){return si(t,e?.equal)}var JE=Symbol("InputSignalNode#UNSET"),QM=W(x({},ta),{transformFn:void 0,applyValueToInputSignal(t,e){ai(t,e)}});function KE(t,e){let n=Object.create(QM);n.value=t,n.transformFn=e?.transform;function r(){if(ri(n),n.value===JE){let o=null;throw new O(-950,o)}return n.value}return r[ke]=n,r}function WE(t,e){return KE(t,e)}function ZM(t){return KE(JE,t)}var Qe=(WE.required=ZM,WE);function zE(t,e){return TE(e)}function XM(t,e){return SE(e)}var Mh=(zE.required=XM,zE);var Ah=new B(""),ex=new B("");function Xi(t){return!t.moduleRef}function tx(t){let e=Xi(t)?t.r3Injector:t.moduleRef.injector,n=e.get(lt);return n.run(()=>{Xi(t)?t.r3Injector.resolveInjectorInitializers():t.moduleRef.resolveInjectorInitializers();let r=e.get(Ir),o;if(n.runOutsideAngular(()=>{o=n.onError.subscribe({next:r})}),Xi(t)){let i=()=>e.destroy(),s=t.platformInjector.get(Ah);s.add(i),e.onDestroy(()=>{o.unsubscribe(),s.delete(i)})}else{let i=()=>t.moduleRef.destroy(),s=t.platformInjector.get(Ah);s.add(i),t.moduleRef.onDestroy(()=>{Ni(t.allPlatformModules,t.moduleRef),o.unsubscribe(),s.delete(i)})}return rx(r,n,()=>{let i=e.get(mo),s=i.add(),a=e.get(hh);return a.runInitializers(),a.donePromise.then(()=>{let l=e.get(In,Ji);if(LE(l||Ji),!e.get(ex,!0))return Xi(t)?e.get(Yi):(t.allPlatformModules.push(t.moduleRef),t.moduleRef);if(Xi(t)){let f=e.get(Yi);return t.rootComponent!==void 0&&f.bootstrap(t.rootComponent),f}else return nx?.(t.moduleRef,t.allPlatformModules),t.moduleRef}).finally(()=>{i.remove(s)})})})}var nx;function rx(t,e,n){try{let r=n();return So(r)?r.catch(o=>{throw e.runOutsideAngular(()=>t(o)),o}):r}catch(r){throw e.runOutsideAngular(()=>t(r)),r}}var Sl=null;function ox(t=[],e){return Ht.create({name:e,providers:[{provide:Ei,useValue:"platform"},{provide:Ah,useValue:new Set([()=>Sl=null])},...t]})}function ix(t=[]){if(Sl)return Sl;let e=ox(t);return Sl=e,kE(),sx(e),e}function sx(t){let e=t.get(fl,null);Ra(t,()=>{e?.forEach(n=>n())})}var ax=1e4;var ej=ax-1e3;var Al=(()=>{class t{static __NG_ELEMENT_ID__=lx}return t})();function lx(t){return ux(Ve(),q(),(t&16)===16)}function ux(t,e,n){if(Hn(t)&&!n){let r=ft(t.index,e);return new $n(r,r)}else if(t.type&175){let r=e[it];return new $n(r,e)}return null}function QE(t){let{rootComponent:e,appProviders:n,platformProviders:r,platformRef:o}=t;ie(X.BootstrapApplicationStart);try{let i=o?.injector??ix(r),s=[Sh(),F_,...n||[]],a=new Ui({providers:s,parent:i,debugName:"",runEnvironmentInitializers:!1});return tx({r3Injector:a.injector,platformInjector:i,rootComponent:e})}catch(i){return Promise.reject(i)}finally{ie(X.BootstrapApplicationEnd)}}function xh(t){return typeof t=="boolean"?t:t!=null&&t!=="false"}var ZE=null;function Yn(){return ZE}function Nh(t){ZE??=t}var es=class{};var nC={ADP:[void 0,void 0,0],AFN:[void 0,"\u060B",0],ALL:[void 0,void 0,0],AMD:[void 0,"\u058F",2],AOA:[void 0,"Kz"],ARS:[void 0,"$"],AUD:["A$","$"],AZN:[void 0,"\u20BC"],BAM:[void 0,"KM"],BBD:[void 0,"$"],BDT:[void 0,"\u09F3"],BHD:[void 0,void 0,3],BIF:[void 0,void 0,0],BMD:[void 0,"$"],BND:[void 0,"$"],BOB:[void 0,"Bs"],BRL:["R$"],BSD:[void 0,"$"],BWP:[void 0,"P"],BYN:[void 0,void 0,2],BYR:[void 0,void 0,0],BZD:[void 0,"$"],CAD:["CA$","$",2],CHF:[void 0,void 0,2],CLF:[void 0,void 0,4],CLP:[void 0,"$",0],CNY:["CN\xA5","\xA5"],COP:[void 0,"$",2],CRC:[void 0,"\u20A1",2],CUC:[void 0,"$"],CUP:[void 0,"$"],CZK:[void 0,"K\u010D",2],DJF:[void 0,void 0,0],DKK:[void 0,"kr",2],DOP:[void 0,"$"],EGP:[void 0,"E\xA3"],ESP:[void 0,"\u20A7",0],EUR:["\u20AC"],FJD:[void 0,"$"],FKP:[void 0,"\xA3"],GBP:["\xA3"],GEL:[void 0,"\u20BE"],GHS:[void 0,"GH\u20B5"],GIP:[void 0,"\xA3"],GNF:[void 0,"FG",0],GTQ:[void 0,"Q"],GYD:[void 0,"$",2],HKD:["HK$","$"],HNL:[void 0,"L"],HRK:[void 0,"kn"],HUF:[void 0,"Ft",2],IDR:[void 0,"Rp",2],ILS:["\u20AA"],INR:["\u20B9"],IQD:[void 0,void 0,0],IRR:[void 0,void 0,0],ISK:[void 0,"kr",0],ITL:[void 0,void 0,0],JMD:[void 0,"$"],JOD:[void 0,void 0,3],JPY:["\xA5",void 0,0],KGS:[void 0,"\u20C0"],KHR:[void 0,"\u17DB"],KMF:[void 0,"CF",0],KPW:[void 0,"\u20A9",0],KRW:["\u20A9",void 0,0],KWD:[void 0,void 0,3],KYD:[void 0,"$"],KZT:[void 0,"\u20B8"],LAK:[void 0,"\u20AD",0],LBP:[void 0,"L\xA3",0],LKR:[void 0,"Rs"],LRD:[void 0,"$"],LTL:[void 0,"Lt"],LUF:[void 0,void 0,0],LVL:[void 0,"Ls"],LYD:[void 0,void 0,3],MGA:[void 0,"Ar",0],MGF:[void 0,void 0,0],MMK:[void 0,"K",0],MNT:[void 0,"\u20AE",2],MRO:[void 0,void 0,0],MUR:[void 0,"Rs",2],MXN:["MX$","$"],MYR:[void 0,"RM"],NAD:[void 0,"$"],NGN:[void 0,"\u20A6"],NIO:[void 0,"C$"],NOK:[void 0,"kr",2],NPR:[void 0,"Rs"],NZD:["NZ$","$"],OMR:[void 0,void 0,3],PHP:["\u20B1"],PKR:[void 0,"Rs",2],PLN:[void 0,"z\u0142"],PYG:[void 0,"\u20B2",0],RON:[void 0,"lei"],RSD:[void 0,void 0,0],RUB:[void 0,"\u20BD"],RWF:[void 0,"RF",0],SBD:[void 0,"$"],SEK:[void 0,"kr",2],SGD:[void 0,"$"],SHP:[void 0,"\xA3"],SLE:[void 0,void 0,2],SLL:[void 0,void 0,0],SOS:[void 0,void 0,0],SRD:[void 0,"$"],SSP:[void 0,"\xA3"],STD:[void 0,void 0,0],STN:[void 0,"Db"],SYP:[void 0,"\xA3",0],THB:[void 0,"\u0E3F"],TMM:[void 0,void 0,0],TND:[void 0,void 0,3],TOP:[void 0,"T$"],TRL:[void 0,void 0,0],TRY:[void 0,"\u20BA"],TTD:[void 0,"$"],TWD:["NT$","$",2],TZS:[void 0,void 0,2],UAH:[void 0,"\u20B4"],UGX:[void 0,void 0,0],USD:["$"],UYI:[void 0,void 0,0],UYU:[void 0,"$"],UYW:[void 0,void 0,4],UZS:[void 0,void 0,2],VEF:[void 0,"Bs",2],VND:["\u20AB",void 0,0],VUV:[void 0,void 0,0],XAF:["FCFA",void 0,0],XCD:["EC$","$"],XCG:["Cg."],XOF:["F\u202FCFA",void 0,0],XPF:["CFPF",void 0,0],XXX:["\xA4"],YER:[void 0,void 0,0],ZAR:[void 0,"R"],ZMK:[void 0,void 0,0],ZMW:[void 0,"ZK"],ZWD:[void 0,void 0,0]},Ol=(function(t){return t[t.Decimal=0]="Decimal",t[t.Percent=1]="Percent",t[t.Currency=2]="Currency",t[t.Scientific=3]="Scientific",t})(Ol||{});var Ge=(function(t){return t[t.Format=0]="Format",t[t.Standalone=1]="Standalone",t})(Ge||{}),se=(function(t){return t[t.Narrow=0]="Narrow",t[t.Abbreviated=1]="Abbreviated",t[t.Wide=2]="Wide",t[t.Short=3]="Short",t})(se||{}),Ze=(function(t){return t[t.Short=0]="Short",t[t.Medium=1]="Medium",t[t.Long=2]="Long",t[t.Full=3]="Full",t})(Ze||{}),Oe={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function rC(t){return je(t)[he.LocaleId]}function oC(t,e,n){let r=je(t),o=[r[he.DayPeriodsFormat],r[he.DayPeriodsStandalone]],i=yt(o,e);return yt(i,n)}function iC(t,e,n){let r=je(t),o=[r[he.DaysFormat],r[he.DaysStandalone]],i=yt(o,e);return yt(i,n)}function sC(t,e,n){let r=je(t),o=[r[he.MonthsFormat],r[he.MonthsStandalone]],i=yt(o,e);return yt(i,n)}function aC(t,e){let r=je(t)[he.Eras];return yt(r,e)}function ts(t,e){let n=je(t);return yt(n[he.DateFormat],e)}function ns(t,e){let n=je(t);return yt(n[he.TimeFormat],e)}function rs(t,e){let r=je(t)[he.DateTimeFormat];return yt(r,e)}function Mt(t,e){let n=je(t),r=n[he.NumberSymbols][e];if(typeof r>"u"){if(e===Oe.CurrencyDecimal)return n[he.NumberSymbols][Oe.Decimal];if(e===Oe.CurrencyGroup)return n[he.NumberSymbols][Oe.Group]}return r}function Lh(t,e){return je(t)[he.NumberFormats][e]}function cx(t){return je(t)[he.Currencies]}function lC(t){if(!t[he.ExtraData])throw new O(2303,!1)}function uC(t){let e=je(t);return lC(e),(e[he.ExtraData][2]||[]).map(r=>typeof r=="string"?Rh(r):[Rh(r[0]),Rh(r[1])])}function cC(t,e,n){let r=je(t);lC(r);let o=[r[he.ExtraData][0],r[he.ExtraData][1]],i=yt(o,e)||[];return yt(i,n)||[]}function yt(t,e){for(let n=e;n>-1;n--)if(typeof t[n]<"u")return t[n];throw new O(2304,!1)}function Rh(t){let[e,n]=t.split(":");return{hours:+e,minutes:+n}}function dC(t,e,n="en"){let r=cx(n)[t]||nC[t]||[],o=r[1];return e==="narrow"&&typeof o=="string"?o:r[0]||t}var dx=2;function fC(t){let e,n=nC[t];return n&&(e=n[2]),typeof e=="number"?e:dx}var fx=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,Ml={},hx=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;function hC(t,e,n,r){let o=Dx(t);e=Tn(n,e)||e;let s=[],a;for(;e;)if(a=hx.exec(e),a){s=s.concat(a.slice(1));let f=s.pop();if(!f)break;e=f}else{s.push(e);break}let l=o.getTimezoneOffset();r&&(l=mC(r,l),o=Cx(o,r));let c="";return s.forEach(f=>{let h=vx(f);c+=h?h(o,n,l):f==="''"?"'":f.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),c}function kl(t,e,n){let r=new Date(0);return r.setFullYear(t,e,n),r.setHours(0,0,0),r}function Tn(t,e){let n=rC(t);if(Ml[n]??={},Ml[n][e])return Ml[n][e];let r="";switch(e){case"shortDate":r=ts(t,Ze.Short);break;case"mediumDate":r=ts(t,Ze.Medium);break;case"longDate":r=ts(t,Ze.Long);break;case"fullDate":r=ts(t,Ze.Full);break;case"shortTime":r=ns(t,Ze.Short);break;case"mediumTime":r=ns(t,Ze.Medium);break;case"longTime":r=ns(t,Ze.Long);break;case"fullTime":r=ns(t,Ze.Full);break;case"short":let o=Tn(t,"shortTime"),i=Tn(t,"shortDate");r=xl(rs(t,Ze.Short),[o,i]);break;case"medium":let s=Tn(t,"mediumTime"),a=Tn(t,"mediumDate");r=xl(rs(t,Ze.Medium),[s,a]);break;case"long":let l=Tn(t,"longTime"),c=Tn(t,"longDate");r=xl(rs(t,Ze.Long),[l,c]);break;case"full":let f=Tn(t,"fullTime"),h=Tn(t,"fullDate");r=xl(rs(t,Ze.Full),[f,h]);break}return r&&(Ml[n][e]=r),r}function xl(t,e){return e&&(t=t.replace(/\{([^}]+)}/g,function(n,r){return e!=null&&r in e?e[r]:n})),t}function At(t,e,n="-",r,o){let i="";(t<0||o&&t<=0)&&(o?t=-t+1:(t=-t,i=n));let s=String(t);for(;s.length<e;)s="0"+s;return r&&(s=s.slice(s.length-e)),i+s}function px(t,e){return At(t,3).substring(0,e)}function Se(t,e,n=0,r=!1,o=!1){return function(i,s){let a=mx(t,i);if((n>0||a>-n)&&(a+=n),t===3)a===0&&n===-12&&(a=12);else if(t===6)return px(a,e);let l=Mt(s,Oe.MinusSign);return At(a,e,l,r,o)}}function mx(t,e){switch(t){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();case 3:return e.getHours();case 4:return e.getMinutes();case 5:return e.getSeconds();case 6:return e.getMilliseconds();case 7:return e.getDay();default:throw new O(2301,!1)}}function ue(t,e,n=Ge.Format,r=!1){return function(o,i){return gx(o,i,t,e,n,r)}}function gx(t,e,n,r,o,i){switch(n){case 2:return sC(e,o,r)[t.getMonth()];case 1:return iC(e,o,r)[t.getDay()];case 0:let s=t.getHours(),a=t.getMinutes();if(i){let c=uC(e),f=cC(e,o,r),h=c.findIndex(p=>{if(Array.isArray(p)){let[m,g]=p,y=s>=m.hours&&a>=m.minutes,_=s<g.hours||s===g.hours&&a<g.minutes;if(m.hours<g.hours){if(y&&_)return!0}else if(y||_)return!0}else if(p.hours===s&&p.minutes===a)return!0;return!1});if(h!==-1)return f[h]}return oC(e,o,r)[s<12?0:1];case 3:return aC(e,r)[t.getFullYear()<=0?0:1];default:let l=n;throw new O(2302,!1)}}function Nl(t){return function(e,n,r){let o=-1*r,i=Mt(n,Oe.MinusSign),s=o>0?Math.floor(o/60):Math.ceil(o/60);switch(t){case 0:return(o>=0?"+":"")+At(s,2,i)+At(Math.abs(o%60),2,i);case 1:return"GMT"+(o>=0?"+":"")+At(s,1,i);case 2:return"GMT"+(o>=0?"+":"")+At(s,2,i)+":"+At(Math.abs(o%60),2,i);case 3:return r===0?"Z":(o>=0?"+":"")+At(s,2,i)+":"+At(Math.abs(o%60),2,i);default:throw new O(2310,!1)}}}var yx=0,Pl=4;function _x(t){let e=kl(t,yx,1).getDay();return kl(t,0,1+(e<=Pl?Pl:Pl+7)-e)}function pC(t){let e=t.getDay(),n=e===0?-3:Pl-e;return kl(t.getFullYear(),t.getMonth(),t.getDate()+n)}function Ph(t,e=!1){return function(n,r){let o;if(e){let i=new Date(n.getFullYear(),n.getMonth(),1).getDay()-1,s=n.getDate();o=1+Math.floor((s+i)/7)}else{let i=pC(n),s=_x(i.getFullYear()),a=i.getTime()-s.getTime();o=1+Math.round(a/6048e5)}return At(o,t,Mt(r,Oe.MinusSign))}}function Rl(t,e=!1){return function(n,r){let i=pC(n).getFullYear();return At(i,t,Mt(r,Oe.MinusSign),e)}}var kh={};function vx(t){if(kh[t])return kh[t];let e;switch(t){case"G":case"GG":case"GGG":e=ue(3,se.Abbreviated);break;case"GGGG":e=ue(3,se.Wide);break;case"GGGGG":e=ue(3,se.Narrow);break;case"y":e=Se(0,1,0,!1,!0);break;case"yy":e=Se(0,2,0,!0,!0);break;case"yyy":e=Se(0,3,0,!1,!0);break;case"yyyy":e=Se(0,4,0,!1,!0);break;case"Y":e=Rl(1);break;case"YY":e=Rl(2,!0);break;case"YYY":e=Rl(3);break;case"YYYY":e=Rl(4);break;case"M":case"L":e=Se(1,1,1);break;case"MM":case"LL":e=Se(1,2,1);break;case"MMM":e=ue(2,se.Abbreviated);break;case"MMMM":e=ue(2,se.Wide);break;case"MMMMM":e=ue(2,se.Narrow);break;case"LLL":e=ue(2,se.Abbreviated,Ge.Standalone);break;case"LLLL":e=ue(2,se.Wide,Ge.Standalone);break;case"LLLLL":e=ue(2,se.Narrow,Ge.Standalone);break;case"w":e=Ph(1);break;case"ww":e=Ph(2);break;case"W":e=Ph(1,!0);break;case"d":e=Se(2,1);break;case"dd":e=Se(2,2);break;case"c":case"cc":e=Se(7,1);break;case"ccc":e=ue(1,se.Abbreviated,Ge.Standalone);break;case"cccc":e=ue(1,se.Wide,Ge.Standalone);break;case"ccccc":e=ue(1,se.Narrow,Ge.Standalone);break;case"cccccc":e=ue(1,se.Short,Ge.Standalone);break;case"E":case"EE":case"EEE":e=ue(1,se.Abbreviated);break;case"EEEE":e=ue(1,se.Wide);break;case"EEEEE":e=ue(1,se.Narrow);break;case"EEEEEE":e=ue(1,se.Short);break;case"a":case"aa":case"aaa":e=ue(0,se.Abbreviated);break;case"aaaa":e=ue(0,se.Wide);break;case"aaaaa":e=ue(0,se.Narrow);break;case"b":case"bb":case"bbb":e=ue(0,se.Abbreviated,Ge.Standalone,!0);break;case"bbbb":e=ue(0,se.Wide,Ge.Standalone,!0);break;case"bbbbb":e=ue(0,se.Narrow,Ge.Standalone,!0);break;case"B":case"BB":case"BBB":e=ue(0,se.Abbreviated,Ge.Format,!0);break;case"BBBB":e=ue(0,se.Wide,Ge.Format,!0);break;case"BBBBB":e=ue(0,se.Narrow,Ge.Format,!0);break;case"h":e=Se(3,1,-12);break;case"hh":e=Se(3,2,-12);break;case"H":e=Se(3,1);break;case"HH":e=Se(3,2);break;case"m":e=Se(4,1);break;case"mm":e=Se(4,2);break;case"s":e=Se(5,1);break;case"ss":e=Se(5,2);break;case"S":e=Se(6,1);break;case"SS":e=Se(6,2);break;case"SSS":e=Se(6,3);break;case"Z":case"ZZ":case"ZZZ":e=Nl(0);break;case"ZZZZZ":e=Nl(3);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=Nl(1);break;case"OOOO":case"ZZZZ":case"zzzz":e=Nl(2);break;default:return null}return kh[t]=e,e}function mC(t,e){t=t.replace(/:/g,"");let n=Date.parse("Jan 01, 1970 00:00:00 "+t)/6e4;return isNaN(n)?e:n}function Ex(t,e){return t=new Date(t.getTime()),t.setMinutes(t.getMinutes()+e),t}function Cx(t,e,n){let o=t.getTimezoneOffset(),i=mC(e,o);return Ex(t,-1*(i-o))}function Dx(t){if(XE(t))return t;if(typeof t=="number"&&!isNaN(t))return new Date(t);if(typeof t=="string"){if(t=t.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(t)){let[o,i=1,s=1]=t.split("-").map(a=>+a);return kl(o,i-1,s)}let n=parseFloat(t);if(!isNaN(t-n))return new Date(n);let r;if(r=t.match(fx))return Ix(r)}let e=new Date(t);if(!XE(e))throw new O(2311,!1);return e}function Ix(t){let e=new Date(0),n=0,r=0,o=t[8]?e.setUTCFullYear:e.setFullYear,i=t[8]?e.setUTCHours:e.setHours;t[9]&&(n=Number(t[9]+t[10]),r=Number(t[9]+t[11])),o.call(e,Number(t[1]),Number(t[2])-1,Number(t[3]));let s=Number(t[4]||0)-n,a=Number(t[5]||0)-r,l=Number(t[6]||0),c=Math.floor(parseFloat("0."+(t[7]||0))*1e3);return i.call(e,s,a,l,c),e}function XE(t){return t instanceof Date&&!isNaN(t.valueOf())}var wx=/^(\d+)?\.((\d+)(-(\d+))?)?$/,eC=22,Fl=".",os="0",Tx=";",Sx=",",Fh="#",tC="\xA4";function gC(t,e,n,r,o,i,s=!1){let a="",l=!1;if(!isFinite(t))a=Mt(n,Oe.Infinity);else{let c=Ax(t);s&&(c=bx(c));let f=e.minInt,h=e.minFrac,p=e.maxFrac;if(i){let I=i.match(wx);if(I===null)throw new O(2306,!1);let w=I[1],A=I[3],R=I[5];w!=null&&(f=Oh(w)),A!=null&&(h=Oh(A)),R!=null?p=Oh(R):A!=null&&h>p&&(p=h)}Mx(c,h,p);let m=c.digits,g=c.integerLen,y=c.exponent,_=[];for(l=m.every(I=>!I);g<f;g++)m.unshift(0);for(;g<0;g++)m.unshift(0);g>0?_=m.splice(g,m.length):(_=m,m=[0]);let C=[];for(m.length>=e.lgSize&&C.unshift(m.splice(-e.lgSize,m.length).join(""));m.length>e.gSize;)C.unshift(m.splice(-e.gSize,m.length).join(""));m.length&&C.unshift(m.join("")),a=C.join(Mt(n,r)),_.length&&(a+=Mt(n,o)+_.join("")),y&&(a+=Mt(n,Oe.Exponential)+"+"+y)}return t<0&&!l?a=e.negPre+a+e.negSuf:a=e.posPre+a+e.posSuf,a}function yC(t,e,n,r,o){let i=Lh(e,Ol.Currency),s=vC(i,Mt(e,Oe.MinusSign));return s.minFrac=fC(r),s.maxFrac=s.minFrac,gC(t,s,e,Oe.CurrencyGroup,Oe.CurrencyDecimal,o).replace(tC,n).replace(tC,"").trim()}function _C(t,e,n){let r=Lh(e,Ol.Decimal),o=vC(r,Mt(e,Oe.MinusSign));return gC(t,o,e,Oe.Group,Oe.Decimal,n)}function vC(t,e="-"){let n={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=t.split(Tx),o=r[0],i=r[1],s=o.indexOf(Fl)!==-1?o.split(Fl):[o.substring(0,o.lastIndexOf(os)+1),o.substring(o.lastIndexOf(os)+1)],a=s[0],l=s[1]||"";n.posPre=a.substring(0,a.indexOf(Fh));for(let f=0;f<l.length;f++){let h=l.charAt(f);h===os?n.minFrac=n.maxFrac=f+1:h===Fh?n.maxFrac=f+1:n.posSuf+=h}let c=a.split(Sx);if(n.gSize=c[1]?c[1].length:0,n.lgSize=c[2]||c[1]?(c[2]||c[1]).length:0,i){let f=o.length-n.posPre.length-n.posSuf.length,h=i.indexOf(Fh);n.negPre=i.substring(0,h).replace(/'/g,""),n.negSuf=i.slice(h+f).replace(/'/g,"")}else n.negPre=e+n.posPre,n.negSuf=n.posSuf;return n}function bx(t){if(t.digits[0]===0)return t;let e=t.digits.length-t.integerLen;return t.exponent?t.exponent+=2:(e===0?t.digits.push(0,0):e===1&&t.digits.push(0),t.integerLen+=2),t}function Ax(t){let e=Math.abs(t)+"",n=0,r,o,i,s,a;for((o=e.indexOf(Fl))>-1&&(e=e.replace(Fl,"")),(i=e.search(/e/i))>0?(o<0&&(o=i),o+=+e.slice(i+1),e=e.substring(0,i)):o<0&&(o=e.length),i=0;e.charAt(i)===os;i++);if(i===(a=e.length))r=[0],o=1;else{for(a--;e.charAt(a)===os;)a--;for(o-=i,r=[],s=0;i<=a;i++,s++)r[s]=Number(e.charAt(i))}return o>eC&&(r=r.splice(0,eC-1),n=o-1,o=1),{digits:r,exponent:n,integerLen:o}}function Mx(t,e,n){if(e>n)throw new O(2307,!1);let r=t.digits,o=r.length-t.integerLen,i=Math.min(Math.max(e,o),n),s=i+t.integerLen,a=r[s];if(s>0){r.splice(Math.max(t.integerLen,s));for(let h=s;h<r.length;h++)r[h]=0}else{o=Math.max(0,o),t.integerLen=1,r.length=Math.max(1,s=i+1),r[0]=0;for(let h=1;h<s;h++)r[h]=0}if(a>=5)if(s-1<0){for(let h=0;h>s;h--)r.unshift(0),t.integerLen++;r.unshift(1),t.integerLen++}else r[s-1]++;for(;o<Math.max(0,i);o++)r.push(0);let l=i!==0,c=e+t.integerLen,f=r.reduceRight(function(h,p,m,g){return p=p+h,g[m]=p<10?p:p-10,l&&(g[m]===0&&m>=c?g.pop():l=!1),p>=10?1:0},0);f&&(r.unshift(f),t.integerLen++)}function Oh(t){let e=parseInt(t);if(isNaN(e))throw new O(2305,!1);return e}var Vh=(()=>{class t{_viewContainerRef;_viewRef=null;ngTemplateOutletContext=null;ngTemplateOutlet=null;ngTemplateOutletInjector=null;constructor(n){this._viewContainerRef=n}ngOnChanges(n){if(this._shouldRecreateView(n)){let r=this._viewContainerRef;if(this._viewRef&&r.remove(r.indexOf(this._viewRef)),!this.ngTemplateOutlet){this._viewRef=null;return}let o=this._createContextForwardProxy();this._viewRef=r.createEmbeddedView(this.ngTemplateOutlet,o,{injector:this.ngTemplateOutletInjector??void 0})}}_shouldRecreateView(n){return!!n.ngTemplateOutlet||!!n.ngTemplateOutletInjector}_createContextForwardProxy(){return new Proxy({},{set:(n,r,o)=>this.ngTemplateOutletContext?Reflect.set(this.ngTemplateOutletContext,r,o):!1,get:(n,r,o)=>{if(this.ngTemplateOutletContext)return Reflect.get(this.ngTemplateOutletContext,r,o)}})}static \u0275fac=function(r){return new(r||t)(ae(To))};static \u0275dir=Kt({type:t,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},features:[Gi]})}return t})();function Uh(t,e){return new O(2100,!1)}var xx="mediumDate",EC=new B(""),CC=new B(""),Bh=(()=>{class t{locale;defaultTimezone;defaultOptions;constructor(n,r,o){this.locale=n,this.defaultTimezone=r,this.defaultOptions=o}transform(n,r,o,i){if(n==null||n===""||n!==n)return null;try{let s=r??this.defaultOptions?.dateFormat??xx,a=o??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return hC(n,s,i||this.locale,a)}catch(s){throw Uh(t,s.message)}}static \u0275fac=function(r){return new(r||t)(ae(In,16),ae(EC,24),ae(CC,24))};static \u0275pipe=ji({name:"date",type:t,pure:!0})}return t})();var Hh=(()=>{class t{_locale;constructor(n){this._locale=n}transform(n,r,o){if(!DC(n))return null;o||=this._locale;try{let i=IC(n);return _C(i,o,r)}catch(i){throw Uh(t,i.message)}}static \u0275fac=function(r){return new(r||t)(ae(In,16))};static \u0275pipe=ji({name:"number",type:t,pure:!0})}return t})();var Gh=(()=>{class t{_locale;_defaultCurrencyCode;constructor(n,r="USD"){this._locale=n,this._defaultCurrencyCode=r}transform(n,r=this._defaultCurrencyCode,o="symbol",i,s){if(!DC(n))return null;s||=this._locale,typeof o=="boolean"&&(o=o?"symbol":"code");let a=r||this._defaultCurrencyCode;o!=="code"&&(o==="symbol"||o==="symbol-narrow"?a=dC(a,o==="symbol"?"wide":"narrow",s):a=o);try{let l=IC(n);return yC(l,s,a,r,i)}catch(l){throw Uh(t,l.message)}}static \u0275fac=function(r){return new(r||t)(ae(In,16),ae(bh,16))};static \u0275pipe=ji({name:"currency",type:t,pure:!0})}return t})();function DC(t){return!(t==null||t===""||t!==t)}function IC(t){if(typeof t=="string"&&!isNaN(Number(t)-parseFloat(t)))return Number(t);if(typeof t!="number")throw new O(2309,!1);return t}var tn=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Mr({type:t});static \u0275inj=Ln({})}return t})();function $h(t,e){e=encodeURIComponent(e);for(let n of t.split(";")){let r=n.indexOf("="),[o,i]=r==-1?[n,""]:[n.slice(0,r),n.slice(r+1)];if(o.trim()===e)return decodeURIComponent(i)}return null}var is=class{};function wC(t,e,n){return _h(t,e,n)}var TC="browser";var ss=class{_doc;constructor(e){this._doc=e}manager},Ll=(()=>{class t extends ss{constructor(n){super(n)}supports(n){return!0}addEventListener(n,r,o,i){return n.addEventListener(r,o,i),()=>this.removeEventListener(n,r,o,i)}removeEventListener(n,r,o,i){return n.removeEventListener(r,o,i)}static \u0275fac=function(r){return new(r||t)(te(pt))};static \u0275prov=fe({token:t,factory:t.\u0275fac})}return t})(),Bl=new B(""),jh=(()=>{class t{_zone;_plugins;_eventNameToPlugin=new Map;constructor(n,r){this._zone=r,n.forEach(s=>{s.manager=this});let o=n.filter(s=>!(s instanceof Ll));this._plugins=o.slice().reverse();let i=n.find(s=>s instanceof Ll);i&&this._plugins.push(i)}addEventListener(n,r,o,i){return this._findPluginFor(r).addEventListener(n,r,o,i)}getZone(){return this._zone}_findPluginFor(n){let r=this._eventNameToPlugin.get(n);if(r)return r;if(r=this._plugins.find(i=>i.supports(n)),!r)throw new O(5101,!1);return this._eventNameToPlugin.set(n,r),r}static \u0275fac=function(r){return new(r||t)(te(Bl),te(lt))};static \u0275prov=fe({token:t,factory:t.\u0275fac})}return t})(),qh="ng-app-id";function SC(t){for(let e of t)e.remove()}function bC(t,e){let n=e.createElement("style");return n.textContent=t,n}function Px(t,e,n,r){let o=t.head?.querySelectorAll(`style[${qh}="${e}"],link[${qh}="${e}"]`);if(o)for(let i of o)i.removeAttribute(qh),i instanceof HTMLLinkElement?r.set(i.href.slice(i.href.lastIndexOf("/")+1),{usage:0,elements:[i]}):i.textContent&&n.set(i.textContent,{usage:0,elements:[i]})}function zh(t,e){let n=e.createElement("link");return n.setAttribute("rel","stylesheet"),n.setAttribute("href",t),n}var Yh=(()=>{class t{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(n,r,o,i={}){this.doc=n,this.appId=r,this.nonce=o,Px(n,r,this.inline,this.external),this.hosts.add(n.head)}addStyles(n,r){for(let o of n)this.addUsage(o,this.inline,bC);r?.forEach(o=>this.addUsage(o,this.external,zh))}removeStyles(n,r){for(let o of n)this.removeUsage(o,this.inline);r?.forEach(o=>this.removeUsage(o,this.external))}addUsage(n,r,o){let i=r.get(n);i?i.usage++:r.set(n,{usage:1,elements:[...this.hosts].map(s=>this.addElement(s,o(n,this.doc)))})}removeUsage(n,r){let o=r.get(n);o&&(o.usage--,o.usage<=0&&(SC(o.elements),r.delete(n)))}ngOnDestroy(){for(let[,{elements:n}]of[...this.inline,...this.external])SC(n);this.hosts.clear()}addHost(n){this.hosts.add(n);for(let[r,{elements:o}]of this.inline)o.push(this.addElement(n,bC(r,this.doc)));for(let[r,{elements:o}]of this.external)o.push(this.addElement(n,zh(r,this.doc)))}removeHost(n){this.hosts.delete(n)}addElement(n,r){return this.nonce&&r.setAttribute("nonce",this.nonce),n.appendChild(r)}static \u0275fac=function(r){return new(r||t)(te(pt),te(dl),te(hl,8),te($i))};static \u0275prov=fe({token:t,factory:t.\u0275fac})}return t})(),Wh={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Jh=/%COMP%/g;var MC="%COMP%",kx=`_nghost-${MC}`,Fx=`_ngcontent-${MC}`,Ox=!0,Lx=new B("",{factory:()=>Ox});function Vx(t){return Fx.replace(Jh,t)}function Ux(t){return kx.replace(Jh,t)}function xC(t,e){return e.map(n=>n.replace(Jh,t))}var Kh=(()=>{class t{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;constructor(n,r,o,i,s,a,l=null,c=null){this.eventManager=n,this.sharedStylesHost=r,this.appId=o,this.removeStylesOnCompDestroy=i,this.doc=s,this.ngZone=a,this.nonce=l,this.tracingService=c,this.defaultRenderer=new as(n,s,a,this.tracingService)}createRenderer(n,r){if(!n||!r)return this.defaultRenderer;let o=this.getOrCreateRenderer(n,r);return o instanceof Ul?o.applyToHost(n):o instanceof ls&&o.applyStyles(),o}getOrCreateRenderer(n,r){let o=this.rendererByCompId,i=o.get(r.id);if(!i){let s=this.doc,a=this.ngZone,l=this.eventManager,c=this.sharedStylesHost,f=this.removeStylesOnCompDestroy,h=this.tracingService;switch(r.encapsulation){case St.Emulated:i=new Ul(l,c,r,this.appId,f,s,a,h);break;case St.ShadowDom:return new Vl(l,n,r,s,a,this.nonce,h,c);case St.ExperimentalIsolatedShadowDom:return new Vl(l,n,r,s,a,this.nonce,h);default:i=new ls(l,c,r,f,s,a,h);break}o.set(r.id,i)}return i}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(n){this.rendererByCompId.delete(n)}static \u0275fac=function(r){return new(r||t)(te(jh),te(Yh),te(dl),te(Lx),te(pt),te(lt),te(hl),te(qi,8))};static \u0275prov=fe({token:t,factory:t.\u0275fac})}return t})(),as=class{eventManager;doc;ngZone;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,n,r,o){this.eventManager=e,this.doc=n,this.ngZone=r,this.tracingService=o}destroy(){}destroyNode=null;createElement(e,n){return n?this.doc.createElementNS(Wh[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(AC(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(AC(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){n.remove()}selectRootElement(e,n){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new O(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,o){if(o){n=o+":"+n;let i=Wh[o];i?e.setAttributeNS(i,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){let o=Wh[r];o?e.removeAttributeNS(o,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,o){o&(Yt.DashCase|Yt.Important)?e.style.setProperty(n,r,o&Yt.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&Yt.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e!=null&&(e[n]=r)}setValue(e,n){e.nodeValue=n}listen(e,n,r,o){if(typeof e=="string"&&(e=Yn().getGlobalEventTarget(this.doc,e),!e))throw new O(5102,!1);let i=this.decoratePreventDefault(r);return this.tracingService?.wrapEventListener&&(i=this.tracingService.wrapEventListener(e,n,i)),this.eventManager.addEventListener(e,n,i,o)}decoratePreventDefault(e){return n=>{if(n==="__ngUnwrap__")return e;e(n)===!1&&n.preventDefault()}}};function AC(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var Vl=class extends as{hostEl;sharedStylesHost;shadowRoot;constructor(e,n,r,o,i,s,a,l){super(e,o,i,a),this.hostEl=n,this.sharedStylesHost=l,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost&&this.sharedStylesHost.addHost(this.shadowRoot);let c=r.styles;c=xC(r.id,c);for(let h of c){let p=document.createElement("style");s&&p.setAttribute("nonce",s),p.textContent=h,this.shadowRoot.appendChild(p)}let f=r.getExternalStyles?.();if(f)for(let h of f){let p=zh(h,o);s&&p.setAttribute("nonce",s),this.shadowRoot.appendChild(p)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(null,n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost&&this.sharedStylesHost.removeHost(this.shadowRoot)}},ls=class extends as{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,n,r,o,i,s,a,l){super(e,i,s,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=o;let c=r.styles;this.styles=l?xC(l,c):c,this.styleUrls=r.getExternalStyles?.(l)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&Sr.size===0&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},Ul=class extends ls{contentAttr;hostAttr;constructor(e,n,r,o,i,s,a,l){let c=o+"-"+r.id;super(e,n,r,i,s,a,l,c),this.contentAttr=Vx(c),this.hostAttr=Ux(c)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){let r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}};var Hl=class t extends es{supportsDOMEvents=!0;static makeCurrent(){Nh(new t)}onAndCancel(e,n,r,o){return e.addEventListener(n,r,o),()=>{e.removeEventListener(n,r,o)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.remove()}createElement(e,n){return n=n||this.getDefaultDocument(),n.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return n==="window"?window:n==="document"?e:n==="body"?e.body:null}getBaseHref(e){let n=Bx();return n==null?null:Hx(n)}resetBaseElement(){us=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return $h(document.cookie,e)}},us=null;function Bx(){return us=us||document.head.querySelector("base"),us?us.getAttribute("href"):null}function Hx(t){return new URL(t,document.baseURI).pathname}var Gx=(()=>{class t{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||t)};static \u0275prov=fe({token:t,factory:t.\u0275fac})}return t})(),NC=["alt","control","meta","shift"],$x={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},qx={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},RC=(()=>{class t extends ss{constructor(n){super(n)}supports(n){return t.parseEventName(n)!=null}addEventListener(n,r,o,i){let s=t.parseEventName(r),a=t.eventCallback(s.fullKey,o,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Yn().onAndCancel(n,s.domEventName,a,i))}static parseEventName(n){let r=n.toLowerCase().split("."),o=r.shift();if(r.length===0||!(o==="keydown"||o==="keyup"))return null;let i=t._normalizeKey(r.pop()),s="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),s="code."),NC.forEach(c=>{let f=r.indexOf(c);f>-1&&(r.splice(f,1),s+=c+".")}),s+=i,r.length!=0||i.length===0)return null;let l={};return l.domEventName=o,l.fullKey=s,l}static matchEventFullKeyCode(n,r){let o=$x[n.key]||n.key,i="";return r.indexOf("code.")>-1&&(o=n.code,i="code."),o==null||!o?!1:(o=o.toLowerCase(),o===" "?o="space":o==="."&&(o="dot"),NC.forEach(s=>{if(s!==o){let a=qx[s];a(n)&&(i+=s+".")}}),i+=o,i===r)}static eventCallback(n,r,o){return i=>{t.matchEventFullKeyCode(i,n)&&o.runGuarded(()=>r(i))}}static _normalizeKey(n){return n==="esc"?"escape":n}static \u0275fac=function(r){return new(r||t)(te(pt))};static \u0275prov=fe({token:t,factory:t.\u0275fac})}return t})();async function Qh(t,e,n){let r=x({rootComponent:t},Wx(e,n));return QE(r)}function Wx(t,e){return{platformRef:e?.platformRef,appProviders:[...Kx,...t?.providers??[]],platformProviders:Jx}}function zx(){Hl.makeCurrent()}function jx(){return new fn}function Yx(){return Gf(document),document}var Jx=[{provide:$i,useValue:TC},{provide:fl,useValue:zx,multi:!0},{provide:pt,useFactory:Yx}];var Kx=[{provide:Ei,useValue:"root"},{provide:fn,useFactory:jx},{provide:Bl,useClass:Ll,multi:!0},{provide:Bl,useClass:RC,multi:!0},Kh,Yh,jh,{provide:br,useExisting:Kh},{provide:is,useClass:Gx},[]];var PC=()=>{};var Zh={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};var S=function(t,e){if(!t)throw Rr(e)},Rr=function(t){return new Error("Firebase Database ("+Zh.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};var OC=function(t){let e=[],n=0;for(let r=0;r<t.length;r++){let o=t.charCodeAt(r);o<128?e[n++]=o:o<2048?(e[n++]=o>>6|192,e[n++]=o&63|128):(o&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(o=65536+((o&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=o>>18|240,e[n++]=o>>12&63|128,e[n++]=o>>6&63|128,e[n++]=o&63|128):(e[n++]=o>>12|224,e[n++]=o>>6&63|128,e[n++]=o&63|128)}return e},Qx=function(t){let e=[],n=0,r=0;for(;n<t.length;){let o=t[n++];if(o<128)e[r++]=String.fromCharCode(o);else if(o>191&&o<224){let i=t[n++];e[r++]=String.fromCharCode((o&31)<<6|i&63)}else if(o>239&&o<365){let i=t[n++],s=t[n++],a=t[n++],l=((o&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{let i=t[n++],s=t[n++];e[r++]=String.fromCharCode((o&15)<<12|(i&63)<<6|s&63)}}return e.join("")},ql={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();let n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let o=0;o<t.length;o+=3){let i=t[o],s=o+1<t.length,a=s?t[o+1]:0,l=o+2<t.length,c=l?t[o+2]:0,f=i>>2,h=(i&3)<<4|a>>4,p=(a&15)<<2|c>>6,m=c&63;l||(m=64,s||(p=64)),r.push(n[f],n[h],n[p],n[m])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(OC(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Qx(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();let n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let o=0;o<t.length;){let i=n[t.charAt(o++)],a=o<t.length?n[t.charAt(o)]:0;++o;let c=o<t.length?n[t.charAt(o)]:64;++o;let h=o<t.length?n[t.charAt(o)]:64;if(++o,i==null||a==null||c==null||h==null)throw new Xh;let p=i<<2|a>>4;if(r.push(p),c!==64){let m=a<<4&240|c>>2;if(r.push(m),h!==64){let g=c<<6&192|h;r.push(g)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},Xh=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},ep=function(t){let e=OC(t);return ql.encodeByteArray(e,!0)},ds=function(t){return ep(t).replace(/\./g,"")},Gl=function(t){try{return ql.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function LC(t){return VC(void 0,t)}function VC(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:let n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(let n in e)!e.hasOwnProperty(n)||!Zx(n)||(t[n]=VC(t[n],e[n]));return t}function Zx(t){return t!=="__proto__"}function Xx(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var eN=()=>Xx().__FIREBASE_DEFAULTS__,tN=()=>{if(typeof process>"u"||typeof process.env>"u")return;let t=process.env.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},nN=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=t&&Gl(t[1]);return e&&JSON.parse(e)},UC=()=>{try{return PC()||eN()||tN()||nN()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},rN=t=>UC()?.emulatorHosts?.[t],BC=t=>{let e=rN(t);if(!e)return;let n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},tp=()=>UC()?.config;var Jn=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}};function Wl(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function HC(t){return(await fetch(t,{credentials:"include"})).ok}function GC(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let n={alg:"none",type:"JWT"},r=e||"demo-project",o=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let s=x({iss:`https://securetoken.google.com/${r}`,aud:r,iat:o,exp:o+3600,auth_time:o,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[ds(JSON.stringify(n)),ds(JSON.stringify(s)),""].join(".")}var cs={};function oN(){let t={prod:[],emulator:[]};for(let e of Object.keys(cs))cs[e]?t.emulator.push(e):t.prod.push(e);return t}function iN(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}var kC=!1;function $C(t,e){if(typeof window>"u"||typeof document>"u"||!Wl(window.location.host)||cs[t]===e||cs[t]||kC)return;cs[t]=e;function n(p){return`__firebase__banner__${p}`}let r="__firebase__banner",i=oN().prod.length>0;function s(){let p=document.getElementById(r);p&&p.remove()}function a(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function l(p,m){p.setAttribute("width","24"),p.setAttribute("id",m),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function c(){let p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{kC=!0,s()},p}function f(p,m){p.setAttribute("id",m),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function h(){let p=iN(r),m=n("text"),g=document.getElementById(m)||document.createElement("span"),y=n("learnmore"),_=document.getElementById(y)||document.createElement("a"),C=n("preprendIcon"),I=document.getElementById(C)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){let w=p.element;a(w),f(_,y);let A=c();l(I,C),w.append(I,g,_,A),document.body.appendChild(w)}i?(g.innerText="Preview backend disconnected.",I.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(I.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,g.innerText="Preview backend running in this workspace."),g.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}function sN(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function np(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(sN())}function qC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function nn(){return Zh.NODE_CLIENT===!0||Zh.NODE_ADMIN===!0}function WC(){try{return typeof indexedDB=="object"}catch{return!1}}function zC(){return new Promise((t,e)=>{try{let n=!0,r="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(r);o.onsuccess=()=>{o.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},o.onupgradeneeded=()=>{n=!1},o.onerror=()=>{e(o.error?.message||"")}}catch(n){e(n)}})}var aN="FirebaseError",Nr=class t extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=aN,Object.setPrototypeOf(this,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,fs.prototype.create)}},fs=class{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){let r=n[0]||{},o=`${this.service}/${e}`,i=this.errors[e],s=i?lN(i,r):"Error",a=`${this.serviceName}: ${s} (${o}).`;return new Nr(o,a,r)}};function lN(t,e){return t.replace(uN,(n,r)=>{let o=e[r];return o!=null?String(o):`<${r}?>`})}var uN=/\{\$([^}]+)}/g;function Mo(t){return JSON.parse(t)}function be(t){return JSON.stringify(t)}var jC=function(t){let e={},n={},r={},o="";try{let i=t.split(".");e=Mo(Gl(i[0])||""),n=Mo(Gl(i[1])||""),o=i[2],r=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:r,signature:o}};var YC=function(t){let e=jC(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},JC=function(t){let e=jC(t).claims;return typeof e=="object"&&e.admin===!0};function rn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Pr(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function rp(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function hs(t,e,n){let r={};for(let o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=e.call(n,t[o],o,t));return r}function xo(t,e){if(t===e)return!0;let n=Object.keys(t),r=Object.keys(e);for(let o of n){if(!r.includes(o))return!1;let i=t[o],s=e[o];if(FC(i)&&FC(s)){if(!xo(i,s))return!1}else if(i!==s)return!1}for(let o of r)if(!n.includes(o))return!1;return!0}function FC(t){return t!==null&&typeof t=="object"}function KC(t){let e=[];for(let[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(o=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}var $l=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);let r=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)r[h]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let h=0;h<16;h++)r[h]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let h=16;h<80;h++){let p=r[h-3]^r[h-8]^r[h-14]^r[h-16];r[h]=(p<<1|p>>>31)&4294967295}let o=this.chain_[0],i=this.chain_[1],s=this.chain_[2],a=this.chain_[3],l=this.chain_[4],c,f;for(let h=0;h<80;h++){h<40?h<20?(c=a^i&(s^a),f=1518500249):(c=i^s^a,f=1859775393):h<60?(c=i&s|a&(i|s),f=2400959708):(c=i^s^a,f=3395469782);let p=(o<<5|o>>>27)+c+l+f+r[h]&4294967295;l=a,a=s,s=(i<<30|i>>>2)&4294967295,i=o,o=p}this.chain_[0]=this.chain_[0]+o&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+s&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);let r=n-this.blockSize,o=0,i=this.buf_,s=this.inbuf_;for(;o<n;){if(s===0)for(;o<=r;)this.compress_(e,o),o+=this.blockSize;if(typeof e=="string"){for(;o<n;)if(i[s]=e.charCodeAt(o),++s,++o,s===this.blockSize){this.compress_(i),s=0;break}}else for(;o<n;)if(i[s]=e[o],++s,++o,s===this.blockSize){this.compress_(i),s=0;break}}this.inbuf_=s,this.total_+=n}digest(){let e=[],n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let o=this.blockSize-1;o>=56;o--)this.buf_[o]=n&255,n/=256;this.compress_(this.buf_);let r=0;for(let o=0;o<5;o++)for(let i=24;i>=0;i-=8)e[r]=this.chain_[o]>>i&255,++r;return e}};function zl(t,e){return`${t} failed: ${e} argument `}var QC=function(t){let e=[],n=0;for(let r=0;r<t.length;r++){let o=t.charCodeAt(r);if(o>=55296&&o<=56319){let i=o-55296;r++,S(r<t.length,"Surrogate pair missing trail surrogate.");let s=t.charCodeAt(r)-56320;o=65536+(i<<10)+s}o<128?e[n++]=o:o<2048?(e[n++]=o>>6|192,e[n++]=o&63|128):o<65536?(e[n++]=o>>12|224,e[n++]=o>>6&63|128,e[n++]=o&63|128):(e[n++]=o>>18|240,e[n++]=o>>12&63|128,e[n++]=o>>6&63|128,e[n++]=o&63|128)}return e},ps=function(t){let e=0;for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};var q9=14400*1e3;function kr(t){return t&&t._delegate?t._delegate:t}var Sn=class{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Fr="[DEFAULT]";var jl=class{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){let r=new Jn;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{let o=this.getOrInitializeService({instanceIdentifier:n});o&&r.resolve(o)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){let n=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(o){if(r)return null;throw o}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(dN(e))try{this.getOrInitializeService({instanceIdentifier:Fr})}catch{}for(let[n,r]of this.instancesDeferred.entries()){let o=this.normalizeInstanceIdentifier(n);try{let i=this.getOrInitializeService({instanceIdentifier:o});r.resolve(i)}catch{}}}}clearInstance(e=Fr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Fr){return this.instances.has(e)}getOptions(e=Fr){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let o=this.getOrInitializeService({instanceIdentifier:r,options:n});for(let[i,s]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(i);r===a&&s.resolve(o)}return o}onInit(e,n){let r=this.normalizeInstanceIdentifier(n),o=this.onInitCallbacks.get(r)??new Set;o.add(e),this.onInitCallbacks.set(r,o);let i=this.instances.get(r);return i&&e(i,r),()=>{o.delete(e)}}invokeOnInitCallbacks(e,n){let r=this.onInitCallbacks.get(n);if(r)for(let o of r)try{o(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:cN(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Fr){return this.component?this.component.multipleInstances?e:Fr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function cN(t){return t===Fr?void 0:t}function dN(t){return t.instantiationMode==="EAGER"}var ms=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let n=new jl(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}};var fN=[],ce=(function(t){return t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT",t})(ce||{}),hN={debug:ce.DEBUG,verbose:ce.VERBOSE,info:ce.INFO,warn:ce.WARN,error:ce.ERROR,silent:ce.SILENT},pN=ce.INFO,mN={[ce.DEBUG]:"log",[ce.VERBOSE]:"log",[ce.INFO]:"info",[ce.WARN]:"warn",[ce.ERROR]:"error"},gN=(t,e,...n)=>{if(e<t.logLevel)return;let r=new Date().toISOString(),o=mN[e];if(o)console[o](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},No=class{constructor(e){this.name=e,this._logLevel=pN,this._logHandler=gN,this._userLogHandler=null,fN.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ce))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?hN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ce.DEBUG,...e),this._logHandler(this,ce.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ce.VERBOSE,...e),this._logHandler(this,ce.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ce.INFO,...e),this._logHandler(this,ce.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ce.WARN,...e),this._logHandler(this,ce.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ce.ERROR,...e),this._logHandler(this,ce.ERROR,...e)}};var yN=(t,e)=>e.some(n=>t instanceof n),ZC,XC;function _N(){return ZC||(ZC=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function vN(){return XC||(XC=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var e0=new WeakMap,ip=new WeakMap,t0=new WeakMap,op=new WeakMap,ap=new WeakMap;function EN(t){let e=new Promise((n,r)=>{let o=()=>{t.removeEventListener("success",i),t.removeEventListener("error",s)},i=()=>{n(on(t.result)),o()},s=()=>{r(t.error),o()};t.addEventListener("success",i),t.addEventListener("error",s)});return e.then(n=>{n instanceof IDBCursor&&e0.set(n,t)}).catch(()=>{}),ap.set(e,t),e}function CN(t){if(ip.has(t))return;let e=new Promise((n,r)=>{let o=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",s),t.removeEventListener("abort",s)},i=()=>{n(),o()},s=()=>{r(t.error||new DOMException("AbortError","AbortError")),o()};t.addEventListener("complete",i),t.addEventListener("error",s),t.addEventListener("abort",s)});ip.set(t,e)}var sp={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return ip.get(t);if(e==="objectStoreNames")return t.objectStoreNames||t0.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return on(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function n0(t){sp=t(sp)}function DN(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){let r=t.call(Yl(this),e,...n);return t0.set(r,e.sort?e.sort():[e]),on(r)}:vN().includes(t)?function(...e){return t.apply(Yl(this),e),on(e0.get(this))}:function(...e){return on(t.apply(Yl(this),e))}}function IN(t){return typeof t=="function"?DN(t):(t instanceof IDBTransaction&&CN(t),yN(t,_N())?new Proxy(t,sp):t)}function on(t){if(t instanceof IDBRequest)return EN(t);if(op.has(t))return op.get(t);let e=IN(t);return e!==t&&(op.set(t,e),ap.set(e,t)),e}var Yl=t=>ap.get(t);function o0(t,e,{blocked:n,upgrade:r,blocking:o,terminated:i}={}){let s=indexedDB.open(t,e),a=on(s);return r&&s.addEventListener("upgradeneeded",l=>{r(on(s.result),l.oldVersion,l.newVersion,on(s.transaction),l)}),n&&s.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),o&&l.addEventListener("versionchange",c=>o(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}var wN=["get","getKey","getAll","getAllKeys","count"],TN=["put","add","delete","clear"],lp=new Map;function r0(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(lp.get(e))return lp.get(e);let n=e.replace(/FromIndex$/,""),r=e!==n,o=TN.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(o||wN.includes(n)))return;let i=async function(s,...a){let l=this.transaction(s,o?"readwrite":"readonly"),c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),o&&l.done]))[0]};return lp.set(e,i),i}n0(t=>W(x({},t),{get:(e,n,r)=>r0(e,n)||t.get(e,n,r),has:(e,n)=>!!r0(e,n)||t.has(e,n)}));var cp=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(SN(n)){let r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}};function SN(t){return t.getComponent()?.type==="VERSION"}var dp="@firebase/app",i0="0.14.7";var bn=new No("@firebase/app"),bN="@firebase/app-compat",AN="@firebase/analytics-compat",MN="@firebase/analytics",xN="@firebase/app-check-compat",NN="@firebase/app-check",RN="@firebase/auth",PN="@firebase/auth-compat",kN="@firebase/database",FN="@firebase/data-connect",ON="@firebase/database-compat",LN="@firebase/functions",VN="@firebase/functions-compat",UN="@firebase/installations",BN="@firebase/installations-compat",HN="@firebase/messaging",GN="@firebase/messaging-compat",$N="@firebase/performance",qN="@firebase/performance-compat",WN="@firebase/remote-config",zN="@firebase/remote-config-compat",jN="@firebase/storage",YN="@firebase/storage-compat",JN="@firebase/firestore",KN="@firebase/ai",QN="@firebase/firestore-compat",ZN="firebase",XN="12.8.0";var fp="[DEFAULT]",eR={[dp]:"fire-core",[bN]:"fire-core-compat",[MN]:"fire-analytics",[AN]:"fire-analytics-compat",[NN]:"fire-app-check",[xN]:"fire-app-check-compat",[RN]:"fire-auth",[PN]:"fire-auth-compat",[kN]:"fire-rtdb",[FN]:"fire-data-connect",[ON]:"fire-rtdb-compat",[LN]:"fire-fn",[VN]:"fire-fn-compat",[UN]:"fire-iid",[BN]:"fire-iid-compat",[HN]:"fire-fcm",[GN]:"fire-fcm-compat",[$N]:"fire-perf",[qN]:"fire-perf-compat",[WN]:"fire-rc",[zN]:"fire-rc-compat",[jN]:"fire-gcs",[YN]:"fire-gcs-compat",[JN]:"fire-fst",[QN]:"fire-fst-compat",[KN]:"fire-vertex","fire-js":"fire-js",[ZN]:"fire-js-all"};var Jl=new Map,tR=new Map,hp=new Map;function s0(t,e){try{t.container.addComponent(e)}catch(n){bn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function gs(t){let e=t.name;if(hp.has(e))return bn.debug(`There were multiple attempts to register component ${e}.`),!1;hp.set(e,t);for(let n of Jl.values())s0(n,t);for(let n of tR.values())s0(n,t);return!0}function c0(t,e){let n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function d0(t){return t==null?!1:t.settings!==void 0}var nR={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Kn=new fs("app","Firebase",nR);var pp=class{constructor(e,n,r){this._isDeleted=!1,this._options=x({},e),this._config=x({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Sn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Kn.create("app-deleted",{appName:this._name})}};var f0=XN;function yp(t,e={}){let n=t;typeof e!="object"&&(e={name:e});let r=x({name:fp,automaticDataCollectionEnabled:!0},e),o=r.name;if(typeof o!="string"||!o)throw Kn.create("bad-app-name",{appName:String(o)});if(n||(n=tp()),!n)throw Kn.create("no-options");let i=Jl.get(o);if(i){if(xo(n,i.options)&&xo(r,i.config))return i;throw Kn.create("duplicate-app",{appName:o})}let s=new ms(o);for(let l of hp.values())s.addComponent(l);let a=new pp(n,r,s);return Jl.set(o,a),a}function h0(t=fp){let e=Jl.get(t);if(!e&&t===fp&&tp())return yp();if(!e)throw Kn.create("no-app",{appName:t});return e}function Qn(t,e,n){let r=eR[t]??t;n&&(r+=`-${n}`);let o=r.match(/\s|\//),i=e.match(/\s|\//);if(o||i){let s=[`Unable to register library "${r}" with version "${e}":`];o&&s.push(`library name "${r}" contains illegal characters (whitespace or "/")`),o&&i&&s.push("and"),i&&s.push(`version name "${e}" contains illegal characters (whitespace or "/")`),bn.warn(s.join(" "));return}gs(new Sn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}var rR="firebase-heartbeat-database",oR=1,ys="firebase-heartbeat-store",up=null;function p0(){return up||(up=o0(rR,oR,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ys)}catch(n){console.warn(n)}}}}).catch(t=>{throw Kn.create("idb-open",{originalErrorMessage:t.message})})),up}async function iR(t){try{let n=(await p0()).transaction(ys),r=await n.objectStore(ys).get(m0(t));return await n.done,r}catch(e){if(e instanceof Nr)bn.warn(e.message);else{let n=Kn.create("idb-get",{originalErrorMessage:e?.message});bn.warn(n.message)}}}async function a0(t,e){try{let r=(await p0()).transaction(ys,"readwrite");await r.objectStore(ys).put(e,m0(t)),await r.done}catch(n){if(n instanceof Nr)bn.warn(n.message);else{let r=Kn.create("idb-set",{originalErrorMessage:n?.message});bn.warn(r.message)}}}function m0(t){return`${t.name}!${t.options.appId}`}var sR=1024,aR=30,mp=class{constructor(e){this.container=e,this._heartbeatsCache=null;let n=this.container.getProvider("app").getImmediate();this._storage=new gp(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{let n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=l0();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(o=>o.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>aR){let o=uR(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){bn.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";let e=l0(),{heartbeatsToSend:n,unsentEntries:r}=lR(this._heartbeatsCache.heartbeats),o=ds(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(e){return bn.warn(e),""}}};function l0(){return new Date().toISOString().substring(0,10)}function lR(t,e=sR){let n=[],r=t.slice();for(let o of t){let i=n.find(s=>s.agent===o.agent);if(i){if(i.dates.push(o.date),u0(n)>e){i.dates.pop();break}}else if(n.push({agent:o.agent,dates:[o.date]}),u0(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}var gp=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return WC()?zC().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let n=await iR(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){let r=await this.read();return a0(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){let r=await this.read();return a0(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}};function u0(t){return ds(JSON.stringify({version:2,heartbeats:t})).length}function uR(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}function cR(t){gs(new Sn("platform-logger",e=>new cp(e),"PRIVATE")),gs(new Sn("heartbeat",e=>new mp(e),"PRIVATE")),Qn(dp,i0,t),Qn(dp,i0,"esm2020"),Qn("fire-js","")}cR("");var dR="firebase",fR="12.8.0";Qn(dR,fR,"app");var g0="@firebase/database",y0="1.1.0";var _m="";function hR(t){_m=t}var Tp=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),be(n))}get(e){let n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:Mo(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var Sp=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return rn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var J0=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){let e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new Tp(e)}}catch{}return new Sp},Lr=J0("localStorage"),bp=J0("sessionStorage");var ko=new No("@firebase/database"),pR=(function(){let t=1;return function(){return t++}})(),K0=function(t){let e=QC(t),n=new $l;n.update(e);let r=n.digest();return ql.encodeByteArray(r)},Fs=function(...t){let e="";for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Fs.apply(null,r):typeof r=="object"?e+=be(r):e+=r,e+=" "}return e},Ur=null,_0=!0,mR=function(t,e){S(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(ko.logLevel=ce.VERBOSE,Ur=ko.log.bind(ko),e&&bp.set("logging_enabled",!0)):typeof t=="function"?Ur=t:(Ur=null,bp.remove("logging_enabled"))},$e=function(...t){if(_0===!0&&(_0=!1,Ur===null&&bp.get("logging_enabled")===!0&&mR(!0)),Ur){let e=Fs.apply(null,t);Ur(e)}},Os=function(t){return function(...e){$e(t,...e)}},Ap=function(...t){let e="FIREBASE INTERNAL ERROR: "+Fs(...t);ko.error(e)},An=function(...t){let e=`FIREBASE FATAL ERROR: ${Fs(...t)}`;throw ko.error(e),new Error(e)},Xe=function(...t){let e="FIREBASE WARNING: "+Fs(...t);ko.warn(e)},gR=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Xe("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Q0=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},yR=function(t){if(nn()||document.readyState==="complete")t();else{let e=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Oo="[MIN_NAME]",Br="[MAX_NAME]",$o=function(t,e){if(t===e)return 0;if(t===Oo||e===Br)return-1;if(e===Oo||t===Br)return 1;{let n=v0(t),r=v0(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},_R=function(t,e){return t===e?0:t<e?-1:1},_s=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+be(e))},vm=function(t){if(typeof t!="object"||t===null)return be(t);let e=[];for(let r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=be(e[r]),n+=":",n+=vm(t[e[r]]);return n+="}",n},Z0=function(t,e){let n=t.length;if(n<=e)return[t];let r=[];for(let o=0;o<n;o+=e)o+e>n?r.push(t.substring(o,n)):r.push(t.substring(o,o+e));return r};function et(t,e){for(let n in t)t.hasOwnProperty(n)&&e(n,t[n])}var X0=function(t){S(!Q0(t),"Invalid JSON number");let e=11,n=52,r=(1<<e-1)-1,o,i,s,a,l;t===0?(i=0,s=0,o=1/t===-1/0?1:0):(o=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),i=a+r,s=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(i=0,s=Math.round(t/Math.pow(2,1-r-n))));let c=[];for(l=n;l;l-=1)c.push(s%2?1:0),s=Math.floor(s/2);for(l=e;l;l-=1)c.push(i%2?1:0),i=Math.floor(i/2);c.push(o?1:0),c.reverse();let f=c.join(""),h="";for(l=0;l<64;l+=8){let p=parseInt(f.substr(l,8),2).toString(16);p.length===1&&(p="0"+p),h=h+p}return h.toLowerCase()},vR=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},ER=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function CR(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");let r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}var DR=new RegExp("^-?(0*)\\d{1,10}$"),IR=-2147483648,wR=2147483647,v0=function(t){if(DR.test(t)){let e=Number(t);if(e>=IR&&e<=wR)return e}return null},qo=function(t){try{t()}catch(e){setTimeout(()=>{let n=e.stack||"";throw Xe("Exception was thrown by user callback.",n),e},Math.floor(0))}},TR=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Is=function(t,e){let n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};var Mp=class{constructor(e,n){this.appCheckProvider=n,this.appName=e.name,d0(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(r=>this.appCheck=r)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.appCheckProvider?.get().then(n=>n.addTokenListener(e))}notifyForInvalidToken(){Xe(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}};var xp=class{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(o=>this.auth_=o)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?($e("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Xe(e)}},ws=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}t.OWNER="owner";return t})(),Ql="5",eD="v",tD="s",nD="r",rD="f",oD=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,iD="ls",sD="p",Np="ac",aD="websocket",lD="long_polling";var Zl=class{constructor(e,n,r,o,i=!1,s="",a=!1,l=!1,c=null){this.secure=n,this.namespace=r,this.webSocketOnly=o,this.nodeAdmin=i,this.persistenceKey=s,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this.emulatorOptions=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Lr.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Lr.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}};function SR(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function uD(t,e,n){S(typeof e=="string","typeof type must == string"),S(typeof n=="object","typeof params must == object");let r;if(e===aD)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===lD)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);SR(t)&&(n.ns=t.namespace);let o=[];return et(n,(i,s)=>{o.push(i+"="+s)}),r+o.join("&")}var Rp=class{constructor(){this.counters_={}}incrementCounter(e,n=1){rn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return LC(this.counters_)}};var _p={},vp={};function Em(t){let e=t.toString();return _p[e]||(_p[e]=new Rp),_p[e]}function bR(t,e){let n=t.toString();return vp[n]||(vp[n]=e()),vp[n]}var Pp=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let o=0;o<r.length;++o)r[o]&&qo(()=>{this.onMessage_(r[o])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var E0="start",AR="close",MR="pLPCommand",xR="pRTLPCB",cD="id",dD="pw",fD="ser",NR="cb",RR="seg",PR="ts",kR="d",FR="dframe",hD=1870,pD=30,OR=hD-pD,LR=25e3,VR=3e4,kp=class t{constructor(e,n,r,o,i,s,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=o,this.authToken=i,this.transportSessionId=s,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Os(e),this.stats_=Em(n),this.urlFn=l=>(this.appCheckToken&&(l[Np]=this.appCheckToken),uD(n,lD,l))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new Pp(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(VR)),yR(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Fp((...i)=>{let[s,a,l,c,f]=i;if(this.incrementIncomingBytes_(i),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,s===E0)this.id=a,this.password=l;else if(s===AR)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+s)},(...i)=>{let[s,a]=i;this.incrementIncomingBytes_(i),this.myPacketOrderer.handleResponse(s,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[E0]="t",r[fD]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[NR]=this.scriptTagHolder.uniqueCallbackIdentifier),r[eD]=Ql,this.transportSessionId&&(r[tD]=this.transportSessionId),this.lastSessionId&&(r[iD]=this.lastSessionId),this.applicationId&&(r[sD]=this.applicationId),this.appCheckToken&&(r[Np]=this.appCheckToken),typeof location<"u"&&location.hostname&&oD.test(location.hostname)&&(r[nD]=rD);let o=this.urlFn(r);this.log_("Connecting via long-poll to "+o),this.scriptTagHolder.addTag(o,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){t.forceAllow_=!0}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){return nn()?!1:t.forceAllow_?!0:!t.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!vR()&&!ER()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let n=be(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let r=ep(n),o=Z0(r,OR);for(let i=0;i<o.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,o.length,o[i]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if(nn())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[FR]="t",r[cD]=e,r[dD]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let n=be(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}},Fp=class t{constructor(e,n,r,o){if(this.onDisconnect=r,this.urlFn=o,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,nn())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=pR(),window[MR+this.uniqueCallbackIdentifier]=e,window[xR+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();let i="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(i='<script>document.domain="'+document.domain+'";<\/script>');let s="<html><body>"+i+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(s),this.myIFrame.doc.close()}catch(a){$e("frame writing exception"),a.stack&&$e(a.stack),$e(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||$e("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[cD]=this.myID,e[dD]=this.myPW,e[fD]=this.currentSerial;let n=this.urlFn(e),r="",o=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+pD+r.length<=hD;){let s=this.pendingSegs.shift();r=r+"&"+RR+o+"="+s.seg+"&"+PR+o+"="+s.ts+"&"+kR+o+"="+s.d,o++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);let r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},o=setTimeout(r,Math.floor(LR)),i=()=>{clearTimeout(o),r()};this.addTag(e,i)}addTag(e,n){nn()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let o=r.readyState;(!o||o==="loaded"||o==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{$e("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var UR=16384,BR=45e3,Xl=null;typeof MozWebSocket<"u"?Xl=MozWebSocket:typeof WebSocket<"u"&&(Xl=WebSocket);var vs=(()=>{class t{constructor(n,r,o,i,s,a,l){this.connId=n,this.applicationId=o,this.appCheckToken=i,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Os(this.connId),this.stats_=Em(r),this.connURL=t.connectionURL_(r,a,l,i,o),this.nodeAdmin=r.nodeAdmin}static connectionURL_(n,r,o,i,s){let a={};return a[eD]=Ql,!nn()&&typeof location<"u"&&location.hostname&&oD.test(location.hostname)&&(a[nD]=rD),r&&(a[tD]=r),o&&(a[iD]=o),i&&(a[Np]=i),s&&(a[sD]=s),uD(n,aD,a)}open(n,r){this.onDisconnect=r,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Lr.set("previous_websocket_failure",!0);try{let o;if(nn()){let i=this.nodeAdmin?"AdminNode":"Node";o={headers:{"User-Agent":`Firebase/${Ql}/${_m}/${process.platform}/${i}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(o.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(o.headers["X-Firebase-AppCheck"]=this.appCheckToken);let s=process.env,a=this.connURL.indexOf("wss://")===0?s.HTTPS_PROXY||s.https_proxy:s.HTTP_PROXY||s.http_proxy;a&&(o.proxy={origin:a})}this.mySock=new Xl(this.connURL,[],o)}catch(o){this.log_("Error instantiating WebSocket.");let i=o.message||o.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=o=>{this.handleIncomingFrame(o)},this.mySock.onerror=o=>{this.log_("WebSocket error.  Closing connection.");let i=o.message||o.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,o=navigator.userAgent.match(r);o&&o.length>1&&parseFloat(o[1])<4.4&&(n=!0)}return!n&&Xl!==null&&!t.forceDisallow_}static previouslyFailed(){return Lr.isInMemoryStorage||Lr.get("previous_websocket_failure")===!0}markConnectionHealthy(){Lr.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let o=Mo(r);this.onMessage(o)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if(S(this.frames===null,"We already have a frame buffer"),n.length<=6){let r=Number(n);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(this.mySock===null)return;let r=n.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let o=this.extractFrameCount_(r);o!==null&&this.appendFrame_(o)}}send(n){this.resetKeepAlive();let r=be(n);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let o=Z0(r,UR);o.length>1&&this.sendString_(String(o.length));for(let i=0;i<o.length;i++)this.sendString_(o[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(BR))}sendString_(n){try{this.mySock.send(n)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4;return t})(),HR=(()=>{class t{static get ALL_TRANSPORTS(){return[kp,vs]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(n){this.initTransports_(n)}initTransports_(n){let r=vs&&vs.isAvailable(),o=r&&!vs.previouslyFailed();if(n.webSocketOnly&&(r||Xe("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),o=!0),o)this.transports_=[vs];else{let i=this.transports_=[];for(let s of t.ALL_TRANSPORTS)s&&s.isAvailable()&&i.push(s);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}t.globalTransportInitialized_=!1;return t})(),GR=6e4,$R=5e3,qR=10*1024,WR=100*1024,Ep="t",C0="d",zR="s",D0="r",jR="e",I0="o",w0="a",T0="n",S0="p",YR="h",Op=class{constructor(e,n,r,o,i,s,a,l,c,f){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=o,this.authToken_=i,this.onMessage_=s,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=f,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Os("c:"+this.id+":"),this.transportManager_=new HR(n),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));let o=e.healthyTimeout||0;o>0&&(this.healthyTimeout_=Is(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>WR?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>qR?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(o)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){let n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Ep in e){let n=e[Ep];n===w0?this.upgradeIfSecondaryHealthy_():n===D0?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===I0&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let n=_s("t",e),r=_s("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:S0,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:w0,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:T0,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let n=_s("t",e),r=_s("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let n=_s(Ep,e);if(C0 in e){let r=e[C0];if(n===YR){let o=x({},r);this.repoInfo_.isUsingEmulator&&(o.h=this.repoInfo_.host),this.onHandshake_(o)}else if(n===T0){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let o=0;o<this.pendingDataMessages.length;++o)this.onDataMessage_(this.pendingDataMessages[o]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===zR?this.onConnectionShutdown_(r):n===D0?this.onReset_(r):n===jR?Ap("Server Error: "+r):n===I0?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Ap("Unknown control packet command: "+n)}}onHandshake_(e){let n=e.ts,r=e.v,o=e.h;this.sessionId=e.s,this.repoInfo_.host=o,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Ql!==r&&Xe("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),Is(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(GR))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Is(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor($R))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:S0,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Lr.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var eu=class{put(e,n,r,o){}merge(e,n,r,o){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}};var tu=class{constructor(e){this.allowedEvents_=e,this.listeners_={},S(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let o=0;o<r.length;o++)r[o].callback.apply(r[o].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});let o=this.getInitialEvent(e);o&&n.apply(r,o)}off(e,n,r){this.validateEventType_(e);let o=this.listeners_[e]||[];for(let i=0;i<o.length;i++)if(o[i].callback===n&&(!r||r===o[i].context)){o.splice(i,1);return}}validateEventType_(e){S(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}};var nu=class t extends tu{static getInstance(){return new t}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!np()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return S(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var b0=32,A0=768,ne=class{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let o=0;o<this.pieces_.length;o++)this.pieces_[o].length>0&&(this.pieces_[r]=this.pieces_[o],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}};function Q(){return new ne("")}function z(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function er(t){return t.pieces_.length-t.pieceNum_}function de(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new ne(t.pieces_,e)}function mD(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function JR(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function gD(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function yD(t){if(t.pieceNum_>=t.pieces_.length)return null;let e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new ne(e,0)}function Ne(t,e){let n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof ne)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{let r=e.split("/");for(let o=0;o<r.length;o++)r[o].length>0&&n.push(r[o])}return new ne(n,0)}function J(t){return t.pieceNum_>=t.pieces_.length}function Ye(t,e){let n=z(t),r=z(e);if(n===null)return e;if(n===r)return Ye(de(t),de(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function Cm(t,e){if(er(t)!==er(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function Nt(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(er(t)>er(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}var Lp=class{constructor(e,n){this.errorPrefix_=n,this.parts_=gD(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=ps(this.parts_[r]);_D(this)}};function KR(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=ps(e),_D(t)}function QR(t){let e=t.parts_.pop();t.byteLength_-=ps(e),t.parts_.length>0&&(t.byteLength_-=1)}function _D(t){if(t.byteLength_>A0)throw new Error(t.errorPrefix_+"has a key path longer than "+A0+" bytes ("+t.byteLength_+").");if(t.parts_.length>b0)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+b0+") or object contains a cycle "+Or(t))}function Or(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}var Vp=class t extends tu{static getInstance(){return new t}constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}getInitialEvent(e){return S(e==="visible","Unknown event type: "+e),[this.visible_]}};var Es=1e3,ZR=300*1e3,M0=30*1e3,XR=1.3,eP=3e4,tP="server_kill",x0=3,Dm=(()=>{class t extends eu{constructor(n,r,o,i,s,a,l,c){if(super(),this.repoInfo_=n,this.applicationId_=r,this.onDataUpdate_=o,this.onConnectStatus_=i,this.onServerInfoUpdate_=s,this.authTokenProvider_=a,this.appCheckTokenProvider_=l,this.authOverride_=c,this.id=t.nextPersistentConnectionId_++,this.log_=Os("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Es,this.maxReconnectDelay_=ZR,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!nn())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Vp.getInstance().on("visible",this.onVisible_,this),n.host.indexOf("fblocal")===-1&&nu.getInstance().on("online",this.onOnline_,this)}sendRequest(n,r,o){let i=++this.requestNumber_,s={r:i,a:n,b:r};this.log_(be(s)),S(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),o&&(this.requestCBHash_[i]=o)}get(n){this.initConnection_();let r=new Jn,i={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:a=>{let l=a.d;a.s==="ok"?r.resolve(l):r.reject(l)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;let s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),r.promise}listen(n,r,o,i){this.initConnection_();let s=n._queryIdentifier,a=n._path.toString();this.log_("Listen called for "+a+" "+s),this.listens.has(a)||this.listens.set(a,new Map),S(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),S(!this.listens.get(a).has(s),"listen() called twice for same path/queryId.");let l={onComplete:i,hashFn:r,query:n,tag:o};this.listens.get(a).set(s,l),this.connected_&&this.sendListen_(l)}sendGet_(n){let r=this.outstandingGets_[n];this.sendRequest("g",r.request,o=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(o)})}sendListen_(n){let r=n.query,o=r._path.toString(),i=r._queryIdentifier;this.log_("Listen on "+o+" for "+i);let s={p:o},a="q";n.tag&&(s.q=r._queryObject,s.t=n.tag),s.h=n.hashFn(),this.sendRequest(a,s,l=>{let c=l.d,f=l.s;t.warnOnListenWarnings_(c,r),(this.listens.get(o)&&this.listens.get(o).get(i))===n&&(this.log_("listen response",l),f!=="ok"&&this.removeListen_(o,i),n.onComplete&&n.onComplete(f,c))})}static warnOnListenWarnings_(n,r){if(n&&typeof n=="object"&&rn(n,"w")){let o=Pr(n,"w");if(Array.isArray(o)&&~o.indexOf("no_index")){let i='".indexOn": "'+r._queryParams.getIndex().toString()+'"',s=r._path.toString();Xe(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&n.length===40||JC(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=M0)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let n=this.authToken_,r=YC(n)?"auth":"gauth",o={cred:n};this.authOverride_===null?o.noauth=!0:typeof this.authOverride_=="object"&&(o.authvar=this.authOverride_),this.sendRequest(r,o,i=>{let s=i.s,a=i.d||"error";this.authToken_===n&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{let r=n.s,o=n.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,o)})}unlisten(n,r){let o=n._path.toString(),i=n._queryIdentifier;this.log_("Unlisten called for "+o+" "+i),S(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(o,i)&&this.connected_&&this.sendUnlisten_(o,i,n._queryObject,r)}sendUnlisten_(n,r,o,i){this.log_("Unlisten on "+n+" for "+r);let s={p:n},a="n";i&&(s.q=o,s.t=i),this.sendRequest(a,s)}onDisconnectPut(n,r,o){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,r,o):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:r,onComplete:o})}onDisconnectMerge(n,r,o){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,r,o):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:r,onComplete:o})}onDisconnectCancel(n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(n,r,o,i){let s={p:r,d:o};this.log_("onDisconnect "+n,s),this.sendRequest(n,s,a=>{i&&setTimeout(()=>{i(a.s,a.d)},Math.floor(0))})}put(n,r,o,i){this.putInternal("p",n,r,o,i)}merge(n,r,o,i){this.putInternal("m",n,r,o,i)}putInternal(n,r,o,i,s){this.initConnection_();let a={p:r,d:o};s!==void 0&&(a.h=s),this.outstandingPuts_.push({action:n,request:a,onComplete:i}),this.outstandingPutCount_++;let l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+r)}sendPut_(n){let r=this.outstandingPuts_[n].action,o=this.outstandingPuts_[n].request,i=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(r,o,s=>{this.log_(r+" response",s),delete this.outstandingPuts_[n],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(s.s,s.d)})}reportStats(n){if(this.connected_){let r={c:n};this.log_("reportStats",r),this.sendRequest("s",r,o=>{if(o.s!=="ok"){let s=o.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+be(n));let r=n.r,o=this.requestCBHash_[r];o&&(delete this.requestCBHash_[r],o(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,r){this.log_("handleServerMessage",n,r),n==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):n==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):n==="c"?this.onListenRevoked_(r.p,r.q):n==="ac"?this.onAuthRevoked_(r.s,r.d):n==="apc"?this.onAppCheckRevoked_(r.s,r.d):n==="sd"?this.onSecurityDebugPacket_(r):Ap("Unrecognized action received from server: "+be(n)+`
Are you using the latest client?`)}onReady_(n,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(n),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){S(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Es,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=Es,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>eP&&(this.reconnectDelay_=Es),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let n=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_),r=Math.max(0,this.reconnectDelay_-n);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*XR)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let n=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),o=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+t.nextConnectionId_++,s=this.lastSessionId,a=!1,l=null,c=function(){l?l.close():(a=!0,o())},f=function(p){S(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(p)};this.realtime_={close:c,sendRequest:f};let h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[p,m]=await Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);a?$e("getToken() completed but was canceled"):($e("getToken() completed. Creating connection."),this.authToken_=p&&p.accessToken,this.appCheckToken_=m&&m.token,l=new Op(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,n,r,o,g=>{Xe(g+" ("+this.repoInfo_.toString()+")"),this.interrupt(tP)},s))}catch(p){this.log_("Failed to get token: "+p),a||(this.repoInfo_.nodeAdmin&&Xe(p),c())}}}interrupt(n){$e("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){$e("Resuming connection for reason: "+n),delete this.interruptReasons_[n],rp(this.interruptReasons_)&&(this.reconnectDelay_=Es,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){let r=n-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){let r=this.outstandingPuts_[n];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(n,r){let o;r?o=r.map(s=>vm(s)).join("$"):o="default";let i=this.removeListen_(n,o);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(n,r){let o=new ne(n).toString(),i;if(this.listens.has(o)){let s=this.listens.get(o);i=s.get(r),s.delete(r),s.size===0&&this.listens.delete(o)}else i=void 0;return i}onAuthRevoked_(n,r){$e("Auth token revoked: "+n+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(n==="invalid_token"||n==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=x0&&(this.reconnectDelay_=M0,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,r){$e("App check token revoked: "+n+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(n==="invalid_token"||n==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=x0&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let n of this.listens.values())for(let r of n.values())this.sendListen_(r);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){let n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){let n={},r="js";nn()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),n["sdk."+r+"."+_m.replace(/\./g,"-")]=1,np()?n["framework.cordova"]=1:qC()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){let n=nu.getInstance().currentlyOnline();return rp(this.interruptReasons_)&&n}}t.nextPersistentConnectionId_=0,t.nextConnectionId_=0;return t})(),j=class t{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new t(e,n)}};var Lo=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){let r=new j(Oo,e),o=new j(Oo,n);return this.compare(r,o)!==0}minPost(){return j.MIN}};var Kl,ru=class extends Lo{static get __EMPTY_NODE(){return Kl}static set __EMPTY_NODE(e){Kl=e}compare(e,n){return $o(e.name,n.name)}isDefinedOn(e){throw Rr("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return j.MIN}maxPost(){return new j(Br,Kl)}makePost(e,n){return S(typeof e=="string","KeyIndex indexValue must always be a string."),new j(e,Kl)}toString(){return".key"}},Fo=new ru;var Po=class{constructor(e,n,r,o,i=null){this.isReverse_=o,this.resultGenerator_=i,this.nodeStack_=[];let s=1;for(;!e.isEmpty();)if(e=e,s=n?r(e.key,n):1,o&&(s*=-1),s<0)this.isReverse_?e=e.left:e=e.right;else if(s===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},xt=(()=>{class t{constructor(n,r,o,i,s){this.key=n,this.value=r,this.color=o??t.RED,this.left=i??_t.EMPTY_NODE,this.right=s??_t.EMPTY_NODE}copy(n,r,o,i,s){return new t(n??this.key,r??this.value,o??this.color,i??this.left,s??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,r,o){let i=this,s=o(n,i.key);return s<0?i=i.copy(null,null,null,i.left.insert(n,r,o),null):s===0?i=i.copy(null,r,null,null,null):i=i.copy(null,null,null,null,i.right.insert(n,r,o)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return _t.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,r){let o,i;if(o=this,r(n,o.key)<0)!o.left.isEmpty()&&!o.left.isRed_()&&!o.left.left.isRed_()&&(o=o.moveRedLeft_()),o=o.copy(null,null,null,o.left.remove(n,r),null);else{if(o.left.isRed_()&&(o=o.rotateRight_()),!o.right.isEmpty()&&!o.right.isRed_()&&!o.right.left.isRed_()&&(o=o.moveRedRight_()),r(n,o.key)===0){if(o.right.isEmpty())return _t.EMPTY_NODE;i=o.right.min_(),o=o.copy(i.key,i.value,null,null,o.right.removeMin_())}o=o.copy(null,null,null,null,o.right.remove(n,r))}return o.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){let n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){let n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){let n=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,r)}checkMaxDepth_(){let n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})(),Up=class{copy(e,n,r,o,i){return this}insert(e,n,r){return new xt(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},_t=class t{constructor(e,n=t.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,xt.BLACK,null,null))}remove(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,xt.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,o=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return o?o.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(o=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Po(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Po(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Po(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Po(this.root_,null,this.comparator_,!0,e)}};_t.EMPTY_NODE=new Up;function nP(t,e){return $o(t.name,e.name)}function Im(t,e){return $o(t,e)}var Bp;function rP(t){Bp=t}var vD=function(t){return typeof t=="number"?"number:"+X0(t):"string:"+t},ED=function(t){if(t.isLeafNode()){let e=t.val();S(typeof e=="string"||typeof e=="number"||typeof e=="object"&&rn(e,".sv"),"Priority must be a string or number.")}else S(t===Bp||t.isEmpty(),"priority of unexpected type.");S(t===Bp||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var N0,Vo=(()=>{class t{static set __childrenNodeConstructor(n){N0=n}static get __childrenNodeConstructor(){return N0}constructor(n,r=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=r,this.lazyHash_=null,S(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),ED(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return n===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return J(n)?this:z(n)===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,r){return null}updateImmediateChild(n,r){return n===".priority"?this.updatePriority(r):r.isEmpty()&&n!==".priority"?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,r).updatePriority(this.priorityNode_)}updateChild(n,r){let o=z(n);return o===null?r:r.isEmpty()&&o!==".priority"?this:(S(o!==".priority"||er(n)===1,".priority must be the last token in a path"),this.updateImmediateChild(o,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(de(n),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,r){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+vD(this.priorityNode_.val())+":");let r=typeof this.value_;n+=r+":",r==="number"?n+=X0(this.value_):n+=this.value_,this.lazyHash_=K0(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:(S(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){let r=typeof n.value_,o=typeof this.value_,i=t.VALUE_TYPE_ORDER.indexOf(r),s=t.VALUE_TYPE_ORDER.indexOf(o);return S(i>=0,"Unknown leaf type: "+r),S(s>=0,"Unknown leaf type: "+o),i===s?o==="object"?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:s-i}withIndex(){return this}isIndexed(){return!0}equals(n){if(n===this)return!0;if(n.isLeafNode()){let r=n;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}t.VALUE_TYPE_ORDER=["object","boolean","number","string"];return t})(),CD,DD;function oP(t){CD=t}function iP(t){DD=t}var Hp=class extends Lo{compare(e,n){let r=e.node.getPriority(),o=n.node.getPriority(),i=r.compareTo(o);return i===0?$o(e.name,n.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return j.MIN}maxPost(){return new j(Br,new Vo("[PRIORITY-POST]",DD))}makePost(e,n){let r=CD(e);return new j(n,new Vo("[PRIORITY-POST]",r))}toString(){return".priority"}},Ce=new Hp;var sP=Math.log(2),Gp=class{constructor(e){let n=i=>parseInt(Math.log(i)/sP,10),r=i=>parseInt(Array(i+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;let o=r(this.count);this.bits_=e+1&o}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},ou=function(t,e,n,r){t.sort(e);let o=function(l,c){let f=c-l,h,p;if(f===0)return null;if(f===1)return h=t[l],p=n?n(h):h,new xt(p,h.node,xt.BLACK,null,null);{let m=parseInt(f/2,10)+l,g=o(l,m),y=o(m+1,c);return h=t[m],p=n?n(h):h,new xt(p,h.node,xt.BLACK,g,y)}},i=function(l){let c=null,f=null,h=t.length,p=function(g,y){let _=h-g,C=h;h-=g;let I=o(_+1,C),w=t[_],A=n?n(w):w;m(new xt(A,w.node,y,null,I))},m=function(g){c?(c.left=g,c=g):(f=g,c=g)};for(let g=0;g<l.count;++g){let y=l.nextBitIsOne(),_=Math.pow(2,l.count-(g+1));y?p(_,xt.BLACK):(p(_,xt.BLACK),p(_,xt.RED))}return f},s=new Gp(t.length),a=i(s);return new _t(r||e,a)};var Cp,Ro={},Uo=class t{static get Default(){return S(Ro&&Ce,"ChildrenNode.ts has not been loaded"),Cp=Cp||new t({".priority":Ro},{".priority":Ce}),Cp}constructor(e,n){this.indexes_=e,this.indexSet_=n}get(e){let n=Pr(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof _t?n:null}hasIndex(e){return rn(this.indexSet_,e.toString())}addIndex(e,n){S(e!==Fo,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],o=!1,i=n.getIterator(j.Wrap),s=i.getNext();for(;s;)o=o||e.isDefinedOn(s.node),r.push(s),s=i.getNext();let a;o?a=ou(r,e.getCompare()):a=Ro;let l=e.toString(),c=x({},this.indexSet_);c[l]=e;let f=x({},this.indexes_);return f[l]=a,new t(f,c)}addToIndexes(e,n){let r=hs(this.indexes_,(o,i)=>{let s=Pr(this.indexSet_,i);if(S(s,"Missing index implementation for "+i),o===Ro)if(s.isDefinedOn(e.node)){let a=[],l=n.getIterator(j.Wrap),c=l.getNext();for(;c;)c.name!==e.name&&a.push(c),c=l.getNext();return a.push(e),ou(a,s.getCompare())}else return Ro;else{let a=n.get(e.name),l=o;return a&&(l=l.remove(new j(e.name,a))),l.insert(e,e.node)}});return new t(r,this.indexSet_)}removeFromIndexes(e,n){let r=hs(this.indexes_,o=>{if(o===Ro)return o;{let i=n.get(e.name);return i?o.remove(new j(e.name,i)):o}});return new t(r,this.indexSet_)}};var Cs,G=(()=>{class t{static get EMPTY_NODE(){return Cs||(Cs=new t(new _t(Im),null,Uo.Default))}constructor(n,r,o){this.children_=n,this.priorityNode_=r,this.indexMap_=o,this.lazyHash_=null,this.priorityNode_&&ED(this.priorityNode_),this.children_.isEmpty()&&S(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Cs}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(n===".priority")return this.getPriority();{let r=this.children_.get(n);return r===null?Cs:r}}getChild(n){let r=z(n);return r===null?this:this.getImmediateChild(r).getChild(de(n))}hasChild(n){return this.children_.get(n)!==null}updateImmediateChild(n,r){if(S(r,"We should always be passing snapshot nodes"),n===".priority")return this.updatePriority(r);{let o=new j(n,r),i,s;r.isEmpty()?(i=this.children_.remove(n),s=this.indexMap_.removeFromIndexes(o,this.children_)):(i=this.children_.insert(n,r),s=this.indexMap_.addToIndexes(o,this.children_));let a=i.isEmpty()?Cs:this.priorityNode_;return new t(i,a,s)}}updateChild(n,r){let o=z(n);if(o===null)return r;{S(z(n)!==".priority"||er(n)===1,".priority must be the last token in a path");let i=this.getImmediateChild(o).updateChild(de(n),r);return this.updateImmediateChild(o,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;let r={},o=0,i=0,s=!0;if(this.forEachChild(Ce,(a,l)=>{r[a]=l.val(n),o++,s&&t.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):s=!1}),!n&&s&&i<2*o){let a=[];for(let l in r)a[l]=r[l];return a}else return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let n="";this.getPriority().isEmpty()||(n+="priority:"+vD(this.getPriority().val())+":"),this.forEachChild(Ce,(r,o)=>{let i=o.hash();i!==""&&(n+=":"+r+":"+i)}),this.lazyHash_=n===""?"":K0(n)}return this.lazyHash_}getPredecessorChildName(n,r,o){let i=this.resolveIndex_(o);if(i){let s=i.getPredecessorKey(new j(n,r));return s?s.name:null}else return this.children_.getPredecessorKey(n)}getFirstChildName(n){let r=this.resolveIndex_(n);if(r){let o=r.minKey();return o&&o.name}else return this.children_.minKey()}getFirstChild(n){let r=this.getFirstChildName(n);return r?new j(r,this.children_.get(r)):null}getLastChildName(n){let r=this.resolveIndex_(n);if(r){let o=r.maxKey();return o&&o.name}else return this.children_.maxKey()}getLastChild(n){let r=this.getLastChildName(n);return r?new j(r,this.children_.get(r)):null}forEachChild(n,r){let o=this.resolveIndex_(n);return o?o.inorderTraversal(i=>r(i.name,i.node)):this.children_.inorderTraversal(r)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,r){let o=this.resolveIndex_(r);if(o)return o.getIteratorFrom(n,i=>i);{let i=this.children_.getIteratorFrom(n.name,j.Wrap),s=i.peek();for(;s!=null&&r.compare(s,n)<0;)i.getNext(),s=i.peek();return i}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,r){let o=this.resolveIndex_(r);if(o)return o.getReverseIteratorFrom(n,i=>i);{let i=this.children_.getReverseIteratorFrom(n.name,j.Wrap),s=i.peek();for(;s!=null&&r.compare(s,n)>0;)i.getNext(),s=i.peek();return i}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===Ls?-1:0}withIndex(n){if(n===Fo||this.indexMap_.hasIndex(n))return this;{let r=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,r)}}isIndexed(n){return n===Fo||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{let r=n;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let o=this.getIterator(Ce),i=r.getIterator(Ce),s=o.getNext(),a=i.getNext();for(;s&&a;){if(s.name!==a.name||!s.node.equals(a.node))return!1;s=o.getNext(),a=i.getNext()}return s===null&&a===null}else return!1;else return!1}}resolveIndex_(n){return n===Fo?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})(),$p=class extends G{constructor(){super(new _t(Im),G.EMPTY_NODE,Uo.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return G.EMPTY_NODE}isEmpty(){return!1}},Ls=new $p;Object.defineProperties(j,{MIN:{value:new j(Oo,G.EMPTY_NODE)},MAX:{value:new j(Br,Ls)}});ru.__EMPTY_NODE=G.EMPTY_NODE;Vo.__childrenNodeConstructor=G;rP(Ls);iP(Ls);var aP=!0;function Pe(t,e=null){if(t===null)return G.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),S(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){let n=t;return new Vo(n,Pe(e))}if(!(t instanceof Array)&&aP){let n=[],r=!1;if(et(t,(s,a)=>{if(s.substring(0,1)!=="."){let l=Pe(a);l.isEmpty()||(r=r||!l.getPriority().isEmpty(),n.push(new j(s,l)))}}),n.length===0)return G.EMPTY_NODE;let i=ou(n,nP,s=>s.name,Im);if(r){let s=ou(n,Ce.getCompare());return new G(i,Pe(e),new Uo({".priority":s},{".priority":Ce}))}else return new G(i,Pe(e),Uo.Default)}else{let n=G.EMPTY_NODE;return et(t,(r,o)=>{if(rn(t,r)&&r.substring(0,1)!=="."){let i=Pe(o);(i.isLeafNode()||!i.isEmpty())&&(n=n.updateImmediateChild(r,i))}}),n.updatePriority(Pe(e))}}oP(Pe);var qp=class extends Lo{constructor(e){super(),this.indexPath_=e,S(!J(e)&&z(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){let r=this.extractChild(e.node),o=this.extractChild(n.node),i=r.compareTo(o);return i===0?$o(e.name,n.name):i}makePost(e,n){let r=Pe(e),o=G.EMPTY_NODE.updateChild(this.indexPath_,r);return new j(n,o)}maxPost(){let e=G.EMPTY_NODE.updateChild(this.indexPath_,Ls);return new j(Br,e)}toString(){return gD(this.indexPath_,0).join("/")}};var Wp=class extends Lo{compare(e,n){let r=e.node.compareTo(n.node);return r===0?$o(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return j.MIN}maxPost(){return j.MAX}makePost(e,n){let r=Pe(e);return new j(n,r)}toString(){return".value"}},lP=new Wp;function ID(t){return{type:"value",snapshotNode:t}}function Bo(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function As(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Ms(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function uP(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}var xs=class{constructor(e){this.index_=e}updateChild(e,n,r,o,i,s){S(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(n);return a.getChild(o).equals(r.getChild(o))&&a.isEmpty()===r.isEmpty()||(s!=null&&(r.isEmpty()?e.hasChild(n)?s.trackChildChange(As(n,a)):S(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?s.trackChildChange(Bo(n,r)):s.trackChildChange(Ms(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Ce,(o,i)=>{n.hasChild(o)||r.trackChildChange(As(o,i))}),n.isLeafNode()||n.forEachChild(Ce,(o,i)=>{if(e.hasChild(o)){let s=e.getImmediateChild(o);s.equals(i)||r.trackChildChange(Ms(o,i,s))}else r.trackChildChange(Bo(o,i))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?G.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var iu=class t{constructor(e){this.indexedFilter_=new xs(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,o,i,s){return this.matches(new j(n,r))||(r=G.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,o,i,s)}updateFullNode(e,n,r){n.isLeafNode()&&(n=G.EMPTY_NODE);let o=n.withIndex(this.index_);o=o.updatePriority(G.EMPTY_NODE);let i=this;return n.forEachChild(Ce,(s,a)=>{i.matches(new j(s,a))||(o=o.updateImmediateChild(s,G.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,o,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}};var zp=class{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{let r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new iu(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,o,i,s){return this.rangedFilter_.matches(new j(n,r))||(r=G.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,o,i,s):this.fullLimitUpdateChild_(e,n,r,i,s)}updateFullNode(e,n,r){let o;if(n.isLeafNode()||n.isEmpty())o=G.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){o=G.EMPTY_NODE.withIndex(this.index_);let i;this.reverse_?i=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):i=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let s=0;for(;i.hasNext()&&s<this.limit_;){let a=i.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))o=o.updateImmediateChild(a.name,a.node),s++;else break;else continue}}else{o=n.withIndex(this.index_),o=o.updatePriority(G.EMPTY_NODE);let i;this.reverse_?i=o.getReverseIterator(this.index_):i=o.getIterator(this.index_);let s=0;for(;i.hasNext();){let a=i.getNext();s<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?s++:o=o.updateImmediateChild(a.name,G.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,o,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,o,i){let s;if(this.reverse_){let h=this.index_.getCompare();s=(p,m)=>h(m,p)}else s=this.index_.getCompare();let a=e;S(a.numChildren()===this.limit_,"");let l=new j(n,r),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),f=this.rangedFilter_.matches(l);if(a.hasChild(n)){let h=a.getImmediateChild(n),p=o.getChildAfterChild(this.index_,c,this.reverse_);for(;p!=null&&(p.name===n||a.hasChild(p.name));)p=o.getChildAfterChild(this.index_,p,this.reverse_);let m=p==null?1:s(p,l);if(f&&!r.isEmpty()&&m>=0)return i?.trackChildChange(Ms(n,r,h)),a.updateImmediateChild(n,r);{i?.trackChildChange(As(n,h));let y=a.updateImmediateChild(n,G.EMPTY_NODE);return p!=null&&this.rangedFilter_.matches(p)?(i?.trackChildChange(Bo(p.name,p.node)),y.updateImmediateChild(p.name,p.node)):y}}else return r.isEmpty()?e:f&&s(c,l)>=0?(i!=null&&(i.trackChildChange(As(c.name,c.node)),i.trackChildChange(Bo(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(c.name,G.EMPTY_NODE)):e}};var jp=class t{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ce}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return S(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return S(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Oo}hasEnd(){return this.endSet_}getIndexEndValue(){return S(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return S(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Br}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return S(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ce}copy(){let e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function cP(t){return t.loadsAllData()?new xs(t.getIndex()):t.hasLimit()?new zp(t):new iu(t)}function R0(t){let e={};if(t.isDefault())return e;let n;if(t.index_===Ce?n="$priority":t.index_===lP?n="$value":t.index_===Fo?n="$key":(S(t.index_ instanceof qp,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=be(n),t.startSet_){let r=t.startAfterSet_?"startAfter":"startAt";e[r]=be(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+be(t.indexStartName_))}if(t.endSet_){let r=t.endBeforeSet_?"endBefore":"endAt";e[r]=be(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+be(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function P0(t){let e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Ce&&(e.i=t.index_.toString()),e}var Yp=class t extends eu{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(S(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,n,r,o){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=o,this.log_=Os("p:rest:"),this.listens_={}}listen(e,n,r,o){let i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);let s=t.getListenId_(e,r),a={};this.listens_[s]=a;let l=R0(e._queryParams);this.restRequest_(i+".json",l,(c,f)=>{let h=f;if(c===404&&(h=null,c=null),c===null&&this.onDataUpdate_(i,h,!1,r),Pr(this.listens_,s)===a){let p;c?c===401?p="permission_denied":p="rest_error:"+c:p="ok",o(p,null)}})}unlisten(e,n){let r=t.getListenId_(e,n);delete this.listens_[r]}get(e){let n=R0(e._queryParams),r=e._path.toString(),o=new Jn;return this.restRequest_(r+".json",n,(i,s)=>{let a=s;i===404&&(a=null,i=null),i===null?(this.onDataUpdate_(r,a,!1,null),o.resolve(a)):o.reject(new Error(a))}),o.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([o,i])=>{o&&o.accessToken&&(n.auth=o.accessToken),i&&i.token&&(n.ac=i.token);let s=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+KC(n);this.log_("Sending REST request for "+s);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+s+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=Mo(a.responseText)}catch{Xe("Failed to parse JSON response for "+s+": "+a.responseText)}r(null,l)}else a.status!==401&&a.status!==404&&Xe("Got unsuccessful REST response for "+s+" Status: "+a.status),r(a.status);r=null}},a.open("GET",s,!0),a.send()})}};var Jp=class{constructor(){this.rootNode_=G.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}};function su(){return{value:null,children:new Map}}function wD(t,e,n){if(J(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{let r=z(e);t.children.has(r)||t.children.set(r,su());let o=t.children.get(r);e=de(e),wD(o,e,n)}}function Kp(t,e,n){t.value!==null?n(e,t.value):dP(t,(r,o)=>{let i=new ne(e.toString()+"/"+r);Kp(o,i,n)})}function dP(t,e){t.children.forEach((n,r)=>{e(r,n)})}var Qp=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),n=x({},e);return this.last_&&et(this.last_,(r,o)=>{n[r]=n[r]-o}),this.last_=e,n}};var k0=10*1e3,fP=30*1e3,hP=300*1e3,Zp=class{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new Qp(e);let r=k0+(fP-k0)*Math.random();Is(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),n={},r=!1;et(e,(o,i)=>{i>0&&rn(this.statsToReport_,o)&&(n[o]=i,r=!0)}),r&&this.server_.reportStats(n),Is(this.reportStats_.bind(this),Math.floor(Math.random()*2*hP))}};var sn=(function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t})(sn||{});function TD(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function wm(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Tm(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var Xp=class t{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=sn.ACK_USER_WRITE,this.source=TD()}operationForChild(e){if(J(this.path)){if(this.affectedTree.value!=null)return S(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let n=this.affectedTree.subtree(new ne(e));return new t(Q(),n,this.revert)}}else return S(z(this.path)===e,"operationForChild called for unrelated child."),new t(de(this.path),this.affectedTree,this.revert)}};var au=class t{constructor(e,n){this.source=e,this.path=n,this.type=sn.LISTEN_COMPLETE}operationForChild(e){return J(this.path)?new t(this.source,Q()):new t(this.source,de(this.path))}};var Ho=class t{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=sn.OVERWRITE}operationForChild(e){return J(this.path)?new t(this.source,Q(),this.snap.getImmediateChild(e)):new t(this.source,de(this.path),this.snap)}};var lu=class t{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=sn.MERGE}operationForChild(e){if(J(this.path)){let n=this.children.subtree(new ne(e));return n.isEmpty()?null:n.value?new Ho(this.source,Q(),n.value):new t(this.source,Q(),n)}else return S(z(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,de(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var an=class{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(J(e))return this.isFullyInitialized()&&!this.filtered_;let n=z(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var em=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function pP(t,e,n,r){let o=[],i=[];return e.forEach(s=>{s.type==="child_changed"&&t.index_.indexedValueChanged(s.oldSnap,s.snapshotNode)&&i.push(uP(s.childName,s.snapshotNode))}),Ds(t,o,"child_removed",e,r,n),Ds(t,o,"child_added",e,r,n),Ds(t,o,"child_moved",i,r,n),Ds(t,o,"child_changed",e,r,n),Ds(t,o,"value",e,r,n),o}function Ds(t,e,n,r,o,i){let s=r.filter(a=>a.type===n);s.sort((a,l)=>gP(t,a,l)),s.forEach(a=>{let l=mP(t,a,i);o.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(l,t.query_))})})}function mP(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function gP(t,e,n){if(e.childName==null||n.childName==null)throw Rr("Should only compare child_ events.");let r=new j(e.childName,e.snapshotNode),o=new j(n.childName,n.snapshotNode);return t.index_.compare(r,o)}function Iu(t,e){return{eventCache:t,serverCache:e}}function Ts(t,e,n,r){return Iu(new an(e,n,r),t.serverCache)}function SD(t,e,n,r){return Iu(t.eventCache,new an(e,n,r))}function uu(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Hr(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var Dp,yP=()=>(Dp||(Dp=new _t(_R)),Dp),tt=class t{static fromObject(e){let n=new t(null);return et(e,(r,o)=>{n=n.set(new ne(r),o)}),n}constructor(e,n=yP()){this.value=e,this.children=n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:Q(),value:this.value};if(J(e))return null;{let r=z(e),o=this.children.get(r);if(o!==null){let i=o.findRootMostMatchingPathAndValue(de(e),n);return i!=null?{path:Ne(new ne(r),i.path),value:i.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(J(e))return this;{let n=z(e),r=this.children.get(n);return r!==null?r.subtree(de(e)):new t(null)}}set(e,n){if(J(e))return new t(n,this.children);{let r=z(e),i=(this.children.get(r)||new t(null)).set(de(e),n),s=this.children.insert(r,i);return new t(this.value,s)}}remove(e){if(J(e))return this.children.isEmpty()?new t(null):new t(null,this.children);{let n=z(e),r=this.children.get(n);if(r){let o=r.remove(de(e)),i;return o.isEmpty()?i=this.children.remove(n):i=this.children.insert(n,o),this.value===null&&i.isEmpty()?new t(null):new t(this.value,i)}else return this}}get(e){if(J(e))return this.value;{let n=z(e),r=this.children.get(n);return r?r.get(de(e)):null}}setTree(e,n){if(J(e))return n;{let r=z(e),i=(this.children.get(r)||new t(null)).setTree(de(e),n),s;return i.isEmpty()?s=this.children.remove(r):s=this.children.insert(r,i),new t(this.value,s)}}fold(e){return this.fold_(Q(),e)}fold_(e,n){let r={};return this.children.inorderTraversal((o,i)=>{r[o]=i.fold_(Ne(e,o),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,Q(),n)}findOnPath_(e,n,r){let o=this.value?r(n,this.value):!1;if(o)return o;if(J(e))return null;{let i=z(e),s=this.children.get(i);return s?s.findOnPath_(de(e),Ne(n,i),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,Q(),n)}foreachOnPath_(e,n,r){if(J(e))return this;{this.value&&r(n,this.value);let o=z(e),i=this.children.get(o);return i?i.foreachOnPath_(de(e),Ne(n,o),r):new t(null)}}foreach(e){this.foreach_(Q(),e)}foreach_(e,n){this.children.inorderTraversal((r,o)=>{o.foreach_(Ne(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}};var Rt=class t{constructor(e){this.writeTree_=e}static empty(){return new t(new tt(null))}};function Ss(t,e,n){if(J(e))return new Rt(new tt(n));{let r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){let o=r.path,i=r.value,s=Ye(o,e);return i=i.updateChild(s,n),new Rt(t.writeTree_.set(o,i))}else{let o=new tt(n),i=t.writeTree_.setTree(e,o);return new Rt(i)}}}function F0(t,e,n){let r=t;return et(n,(o,i)=>{r=Ss(r,Ne(e,o),i)}),r}function O0(t,e){if(J(e))return Rt.empty();{let n=t.writeTree_.setTree(e,new tt(null));return new Rt(n)}}function tm(t,e){return Gr(t,e)!=null}function Gr(t,e){let n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Ye(n.path,e)):null}function L0(t){let e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Ce,(r,o)=>{e.push(new j(r,o))}):t.writeTree_.children.inorderTraversal((r,o)=>{o.value!=null&&e.push(new j(r,o.value))}),e}function Zn(t,e){if(J(e))return t;{let n=Gr(t,e);return n!=null?new Rt(new tt(n)):new Rt(t.writeTree_.subtree(e))}}function nm(t){return t.writeTree_.isEmpty()}function Go(t,e){return bD(Q(),t.writeTree_,e)}function bD(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((o,i)=>{o===".priority"?(S(i.value!==null,"Priority writes must always be leaf nodes"),r=i.value):n=bD(Ne(t,o),i,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(Ne(t,".priority"),r)),n}}function wu(t,e){return ND(e,t)}function _P(t,e,n,r,o){S(r>t.lastWriteId,"Stacking an older write on top of newer ones"),o===void 0&&(o=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:o}),o&&(t.visibleWrites=Ss(t.visibleWrites,e,n)),t.lastWriteId=r}function vP(t,e){for(let n=0;n<t.allWrites.length;n++){let r=t.allWrites[n];if(r.writeId===e)return r}return null}function EP(t,e){let n=t.allWrites.findIndex(a=>a.writeId===e);S(n>=0,"removeWrite called with nonexistent writeId.");let r=t.allWrites[n];t.allWrites.splice(n,1);let o=r.visible,i=!1,s=t.allWrites.length-1;for(;o&&s>=0;){let a=t.allWrites[s];a.visible&&(s>=n&&CP(a,r.path)?o=!1:Nt(r.path,a.path)&&(i=!0)),s--}if(o){if(i)return DP(t),!0;if(r.snap)t.visibleWrites=O0(t.visibleWrites,r.path);else{let a=r.children;et(a,l=>{t.visibleWrites=O0(t.visibleWrites,Ne(r.path,l))})}return!0}else return!1}function CP(t,e){if(t.snap)return Nt(t.path,e);for(let n in t.children)if(t.children.hasOwnProperty(n)&&Nt(Ne(t.path,n),e))return!0;return!1}function DP(t){t.visibleWrites=AD(t.allWrites,IP,Q()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function IP(t){return t.visible}function AD(t,e,n){let r=Rt.empty();for(let o=0;o<t.length;++o){let i=t[o];if(e(i)){let s=i.path,a;if(i.snap)Nt(n,s)?(a=Ye(n,s),r=Ss(r,a,i.snap)):Nt(s,n)&&(a=Ye(s,n),r=Ss(r,Q(),i.snap.getChild(a)));else if(i.children){if(Nt(n,s))a=Ye(n,s),r=F0(r,a,i.children);else if(Nt(s,n))if(a=Ye(s,n),J(a))r=F0(r,Q(),i.children);else{let l=Pr(i.children,z(a));if(l){let c=l.getChild(de(a));r=Ss(r,Q(),c)}}}else throw Rr("WriteRecord should have .snap or .children")}}return r}function MD(t,e,n,r,o){if(!r&&!o){let i=Gr(t.visibleWrites,e);if(i!=null)return i;{let s=Zn(t.visibleWrites,e);if(nm(s))return n;if(n==null&&!tm(s,Q()))return null;{let a=n||G.EMPTY_NODE;return Go(s,a)}}}else{let i=Zn(t.visibleWrites,e);if(!o&&nm(i))return n;if(!o&&n==null&&!tm(i,Q()))return null;{let s=function(c){return(c.visible||o)&&(!r||!~r.indexOf(c.writeId))&&(Nt(c.path,e)||Nt(e,c.path))},a=AD(t.allWrites,s,e),l=n||G.EMPTY_NODE;return Go(a,l)}}}function wP(t,e,n){let r=G.EMPTY_NODE,o=Gr(t.visibleWrites,e);if(o)return o.isLeafNode()||o.forEachChild(Ce,(i,s)=>{r=r.updateImmediateChild(i,s)}),r;if(n){let i=Zn(t.visibleWrites,e);return n.forEachChild(Ce,(s,a)=>{let l=Go(Zn(i,new ne(s)),a);r=r.updateImmediateChild(s,l)}),L0(i).forEach(s=>{r=r.updateImmediateChild(s.name,s.node)}),r}else{let i=Zn(t.visibleWrites,e);return L0(i).forEach(s=>{r=r.updateImmediateChild(s.name,s.node)}),r}}function TP(t,e,n,r,o){S(r||o,"Either existingEventSnap or existingServerSnap must exist");let i=Ne(e,n);if(tm(t.visibleWrites,i))return null;{let s=Zn(t.visibleWrites,i);return nm(s)?o.getChild(n):Go(s,o.getChild(n))}}function SP(t,e,n,r){let o=Ne(e,n),i=Gr(t.visibleWrites,o);if(i!=null)return i;if(r.isCompleteForChild(n)){let s=Zn(t.visibleWrites,o);return Go(s,r.getNode().getImmediateChild(n))}else return null}function bP(t,e){return Gr(t.visibleWrites,e)}function AP(t,e,n,r,o,i,s){let a,l=Zn(t.visibleWrites,e),c=Gr(l,Q());if(c!=null)a=c;else if(n!=null)a=Go(l,n);else return[];if(a=a.withIndex(s),!a.isEmpty()&&!a.isLeafNode()){let f=[],h=s.getCompare(),p=i?a.getReverseIteratorFrom(r,s):a.getIteratorFrom(r,s),m=p.getNext();for(;m&&f.length<o;)h(m,r)!==0&&f.push(m),m=p.getNext();return f}else return[]}function MP(){return{visibleWrites:Rt.empty(),allWrites:[],lastWriteId:-1}}function cu(t,e,n,r){return MD(t.writeTree,t.treePath,e,n,r)}function Sm(t,e){return wP(t.writeTree,t.treePath,e)}function V0(t,e,n,r){return TP(t.writeTree,t.treePath,e,n,r)}function du(t,e){return bP(t.writeTree,Ne(t.treePath,e))}function xP(t,e,n,r,o,i){return AP(t.writeTree,t.treePath,e,n,r,o,i)}function bm(t,e,n){return SP(t.writeTree,t.treePath,e,n)}function xD(t,e){return ND(Ne(t.treePath,e),t.writeTree)}function ND(t,e){return{treePath:t,writeTree:e}}var rm=class{constructor(){this.changeMap=new Map}trackChildChange(e){let n=e.type,r=e.childName;S(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),S(r!==".priority","Only non-priority child changes can be tracked.");let o=this.changeMap.get(r);if(o){let i=o.type;if(n==="child_added"&&i==="child_removed")this.changeMap.set(r,Ms(r,e.snapshotNode,o.snapshotNode));else if(n==="child_removed"&&i==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&i==="child_changed")this.changeMap.set(r,As(r,o.oldSnap));else if(n==="child_changed"&&i==="child_added")this.changeMap.set(r,Bo(r,e.snapshotNode));else if(n==="child_changed"&&i==="child_changed")this.changeMap.set(r,Ms(r,e.snapshotNode,o.oldSnap));else throw Rr("Illegal combination of changes: "+e+" occurred after "+o)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var om=class{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}},RD=new om,Ns=class{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){let n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new an(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return bm(this.writes_,e,r)}}getChildAfterChild(e,n,r){let o=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Hr(this.viewCache_),i=xP(this.writes_,o,n,1,r,e);return i.length===0?null:i[0]}};function NP(t){return{filter:t}}function RP(t,e){S(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),S(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function PP(t,e,n,r,o){let i=new rm,s,a;if(n.type===sn.OVERWRITE){let c=n;c.source.fromUser?s=im(t,e,c.path,c.snap,r,o,i):(S(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!J(c.path),s=fu(t,e,c.path,c.snap,r,o,a,i))}else if(n.type===sn.MERGE){let c=n;c.source.fromUser?s=FP(t,e,c.path,c.children,r,o,i):(S(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),s=sm(t,e,c.path,c.children,r,o,a,i))}else if(n.type===sn.ACK_USER_WRITE){let c=n;c.revert?s=VP(t,e,c.path,r,o,i):s=OP(t,e,c.path,c.affectedTree,r,o,i)}else if(n.type===sn.LISTEN_COMPLETE)s=LP(t,e,n.path,r,i);else throw Rr("Unknown operation type: "+n.type);let l=i.getChanges();return kP(e,s,l),{viewCache:s,changes:l}}function kP(t,e,n){let r=e.eventCache;if(r.isFullyInitialized()){let o=r.getNode().isLeafNode()||r.getNode().isEmpty(),i=uu(t);(n.length>0||!t.eventCache.isFullyInitialized()||o&&!r.getNode().equals(i)||!r.getNode().getPriority().equals(i.getPriority()))&&n.push(ID(uu(e)))}}function PD(t,e,n,r,o,i){let s=e.eventCache;if(du(r,n)!=null)return e;{let a,l;if(J(n))if(S(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let c=Hr(e),f=c instanceof G?c:G.EMPTY_NODE,h=Sm(r,f);a=t.filter.updateFullNode(e.eventCache.getNode(),h,i)}else{let c=cu(r,Hr(e));a=t.filter.updateFullNode(e.eventCache.getNode(),c,i)}else{let c=z(n);if(c===".priority"){S(er(n)===1,"Can't have a priority with additional path components");let f=s.getNode();l=e.serverCache.getNode();let h=V0(r,n,f,l);h!=null?a=t.filter.updatePriority(f,h):a=s.getNode()}else{let f=de(n),h;if(s.isCompleteForChild(c)){l=e.serverCache.getNode();let p=V0(r,n,s.getNode(),l);p!=null?h=s.getNode().getImmediateChild(c).updateChild(f,p):h=s.getNode().getImmediateChild(c)}else h=bm(r,c,e.serverCache);h!=null?a=t.filter.updateChild(s.getNode(),c,h,f,o,i):a=s.getNode()}}return Ts(e,a,s.isFullyInitialized()||J(n),t.filter.filtersNodes())}}function fu(t,e,n,r,o,i,s,a){let l=e.serverCache,c,f=s?t.filter:t.filter.getIndexedFilter();if(J(n))c=f.updateFullNode(l.getNode(),r,null);else if(f.filtersNodes()&&!l.isFiltered()){let m=l.getNode().updateChild(n,r);c=f.updateFullNode(l.getNode(),m,null)}else{let m=z(n);if(!l.isCompleteForPath(n)&&er(n)>1)return e;let g=de(n),_=l.getNode().getImmediateChild(m).updateChild(g,r);m===".priority"?c=f.updatePriority(l.getNode(),_):c=f.updateChild(l.getNode(),m,_,g,RD,null)}let h=SD(e,c,l.isFullyInitialized()||J(n),f.filtersNodes()),p=new Ns(o,h,i);return PD(t,h,n,o,p,a)}function im(t,e,n,r,o,i,s){let a=e.eventCache,l,c,f=new Ns(o,e,i);if(J(n))c=t.filter.updateFullNode(e.eventCache.getNode(),r,s),l=Ts(e,c,!0,t.filter.filtersNodes());else{let h=z(n);if(h===".priority")c=t.filter.updatePriority(e.eventCache.getNode(),r),l=Ts(e,c,a.isFullyInitialized(),a.isFiltered());else{let p=de(n),m=a.getNode().getImmediateChild(h),g;if(J(p))g=r;else{let y=f.getCompleteChild(h);y!=null?mD(p)===".priority"&&y.getChild(yD(p)).isEmpty()?g=y:g=y.updateChild(p,r):g=G.EMPTY_NODE}if(m.equals(g))l=e;else{let y=t.filter.updateChild(a.getNode(),h,g,p,f,s);l=Ts(e,y,a.isFullyInitialized(),t.filter.filtersNodes())}}}return l}function U0(t,e){return t.eventCache.isCompleteForChild(e)}function FP(t,e,n,r,o,i,s){let a=e;return r.foreach((l,c)=>{let f=Ne(n,l);U0(e,z(f))&&(a=im(t,a,f,c,o,i,s))}),r.foreach((l,c)=>{let f=Ne(n,l);U0(e,z(f))||(a=im(t,a,f,c,o,i,s))}),a}function B0(t,e,n){return n.foreach((r,o)=>{e=e.updateChild(r,o)}),e}function sm(t,e,n,r,o,i,s,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,c;J(n)?c=r:c=new tt(null).setTree(n,r);let f=e.serverCache.getNode();return c.children.inorderTraversal((h,p)=>{if(f.hasChild(h)){let m=e.serverCache.getNode().getImmediateChild(h),g=B0(t,m,p);l=fu(t,l,new ne(h),g,o,i,s,a)}}),c.children.inorderTraversal((h,p)=>{let m=!e.serverCache.isCompleteForChild(h)&&p.value===null;if(!f.hasChild(h)&&!m){let g=e.serverCache.getNode().getImmediateChild(h),y=B0(t,g,p);l=fu(t,l,new ne(h),y,o,i,s,a)}}),l}function OP(t,e,n,r,o,i,s){if(du(o,n)!=null)return e;let a=e.serverCache.isFiltered(),l=e.serverCache;if(r.value!=null){if(J(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return fu(t,e,n,l.getNode().getChild(n),o,i,a,s);if(J(n)){let c=new tt(null);return l.getNode().forEachChild(Fo,(f,h)=>{c=c.set(new ne(f),h)}),sm(t,e,n,c,o,i,a,s)}else return e}else{let c=new tt(null);return r.foreach((f,h)=>{let p=Ne(n,f);l.isCompleteForPath(p)&&(c=c.set(f,l.getNode().getChild(p)))}),sm(t,e,n,c,o,i,a,s)}}function LP(t,e,n,r,o){let i=e.serverCache,s=SD(e,i.getNode(),i.isFullyInitialized()||J(n),i.isFiltered());return PD(t,s,n,r,RD,o)}function VP(t,e,n,r,o,i){let s;if(du(r,n)!=null)return e;{let a=new Ns(r,e,o),l=e.eventCache.getNode(),c;if(J(n)||z(n)===".priority"){let f;if(e.serverCache.isFullyInitialized())f=cu(r,Hr(e));else{let h=e.serverCache.getNode();S(h instanceof G,"serverChildren would be complete if leaf node"),f=Sm(r,h)}f=f,c=t.filter.updateFullNode(l,f,i)}else{let f=z(n),h=bm(r,f,e.serverCache);h==null&&e.serverCache.isCompleteForChild(f)&&(h=l.getImmediateChild(f)),h!=null?c=t.filter.updateChild(l,f,h,de(n),a,i):e.eventCache.getNode().hasChild(f)?c=t.filter.updateChild(l,f,G.EMPTY_NODE,de(n),a,i):c=l,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(s=cu(r,Hr(e)),s.isLeafNode()&&(c=t.filter.updateFullNode(c,s,i)))}return s=e.serverCache.isFullyInitialized()||du(r,Q())!=null,Ts(e,c,s,t.filter.filtersNodes())}}var am=class{constructor(e,n){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,o=new xs(r.getIndex()),i=cP(r);this.processor_=NP(i);let s=n.serverCache,a=n.eventCache,l=o.updateFullNode(G.EMPTY_NODE,s.getNode(),null),c=i.updateFullNode(G.EMPTY_NODE,a.getNode(),null),f=new an(l,s.isFullyInitialized(),o.filtersNodes()),h=new an(c,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=Iu(h,f),this.eventGenerator_=new em(this.query_)}get query(){return this.query_}};function UP(t){return t.viewCache_.serverCache.getNode()}function BP(t){return uu(t.viewCache_)}function HP(t,e){let n=Hr(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!J(e)&&!n.getImmediateChild(z(e)).isEmpty())?n.getChild(e):null}function H0(t){return t.eventRegistrations_.length===0}function GP(t,e){t.eventRegistrations_.push(e)}function G0(t,e,n){let r=[];if(n){S(e==null,"A cancel should cancel all event registrations.");let o=t.query._path;t.eventRegistrations_.forEach(i=>{let s=i.createCancelEvent(n,o);s&&r.push(s)})}if(e){let o=[];for(let i=0;i<t.eventRegistrations_.length;++i){let s=t.eventRegistrations_[i];if(!s.matches(e))o.push(s);else if(e.hasAnyCallback()){o=o.concat(t.eventRegistrations_.slice(i+1));break}}t.eventRegistrations_=o}else t.eventRegistrations_=[];return r}function $0(t,e,n,r){e.type===sn.MERGE&&e.source.queryId!==null&&(S(Hr(t.viewCache_),"We should always have a full cache before handling merges"),S(uu(t.viewCache_),"Missing event cache, even though we have a server cache"));let o=t.viewCache_,i=PP(t.processor_,o,e,n,r);return RP(t.processor_,i.viewCache),S(i.viewCache.serverCache.isFullyInitialized()||!o.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=i.viewCache,kD(t,i.changes,i.viewCache.eventCache.getNode(),null)}function $P(t,e){let n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Ce,(i,s)=>{r.push(Bo(i,s))}),n.isFullyInitialized()&&r.push(ID(n.getNode())),kD(t,r,n.getNode(),e)}function kD(t,e,n,r){let o=r?[r]:t.eventRegistrations_;return pP(t.eventGenerator_,e,n,o)}var hu,pu=class{constructor(){this.views=new Map}};function qP(t){S(!hu,"__referenceConstructor has already been defined"),hu=t}function WP(){return S(hu,"Reference.ts has not been loaded"),hu}function zP(t){return t.views.size===0}function Am(t,e,n,r){let o=e.source.queryId;if(o!==null){let i=t.views.get(o);return S(i!=null,"SyncTree gave us an op for an invalid query."),$0(i,e,n,r)}else{let i=[];for(let s of t.views.values())i=i.concat($0(s,e,n,r));return i}}function FD(t,e,n,r,o){let i=e._queryIdentifier,s=t.views.get(i);if(!s){let a=cu(n,o?r:null),l=!1;a?l=!0:r instanceof G?(a=Sm(n,r),l=!1):(a=G.EMPTY_NODE,l=!1);let c=Iu(new an(a,l,!1),new an(r,o,!1));return new am(e,c)}return s}function jP(t,e,n,r,o,i){let s=FD(t,e,r,o,i);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,s),GP(s,n),$P(s,n)}function YP(t,e,n,r){let o=e._queryIdentifier,i=[],s=[],a=tr(t);if(o==="default")for(let[l,c]of t.views.entries())s=s.concat(G0(c,n,r)),H0(c)&&(t.views.delete(l),c.query._queryParams.loadsAllData()||i.push(c.query));else{let l=t.views.get(o);l&&(s=s.concat(G0(l,n,r)),H0(l)&&(t.views.delete(o),l.query._queryParams.loadsAllData()||i.push(l.query)))}return a&&!tr(t)&&i.push(new(WP())(e._repo,e._path)),{removed:i,events:s}}function OD(t){let e=[];for(let n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function Xn(t,e){let n=null;for(let r of t.views.values())n=n||HP(r,e);return n}function LD(t,e){if(e._queryParams.loadsAllData())return Tu(t);{let r=e._queryIdentifier;return t.views.get(r)}}function VD(t,e){return LD(t,e)!=null}function tr(t){return Tu(t)!=null}function Tu(t){for(let e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var mu;function JP(t){S(!mu,"__referenceConstructor has already been defined"),mu=t}function KP(){return S(mu,"Reference.ts has not been loaded"),mu}var QP=1,gu=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new tt(null),this.pendingWriteTree_=MP(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function UD(t,e,n,r,o){return _P(t.pendingWriteTree_,e,n,r,o),o?Us(t,new Ho(TD(),e,n)):[]}function Vr(t,e,n=!1){let r=vP(t.pendingWriteTree_,e);if(EP(t.pendingWriteTree_,e)){let i=new tt(null);return r.snap!=null?i=i.set(Q(),!0):et(r.children,s=>{i=i.set(new ne(s),!0)}),Us(t,new Xp(r.path,i,n))}else return[]}function Vs(t,e,n){return Us(t,new Ho(wm(),e,n))}function ZP(t,e,n){let r=tt.fromObject(n);return Us(t,new lu(wm(),e,r))}function XP(t,e){return Us(t,new au(wm(),e))}function e1(t,e,n){let r=xm(t,n);if(r){let o=Nm(r),i=o.path,s=o.queryId,a=Ye(i,e),l=new au(Tm(s),a);return Rm(t,i,l)}else return[]}function yu(t,e,n,r,o=!1){let i=e._path,s=t.syncPointTree_.get(i),a=[];if(s&&(e._queryIdentifier==="default"||VD(s,e))){let l=YP(s,e,n,r);zP(s)&&(t.syncPointTree_=t.syncPointTree_.remove(i));let c=l.removed;if(a=l.events,!o){let f=c.findIndex(p=>p._queryParams.loadsAllData())!==-1,h=t.syncPointTree_.findOnPath(i,(p,m)=>tr(m));if(f&&!h){let p=t.syncPointTree_.subtree(i);if(!p.isEmpty()){let m=r1(p);for(let g=0;g<m.length;++g){let y=m[g],_=y.query,C=$D(t,y);t.listenProvider_.startListening(bs(_),Rs(t,_),C.hashFn,C.onComplete)}}}!h&&c.length>0&&!r&&(f?t.listenProvider_.stopListening(bs(e),null):c.forEach(p=>{let m=t.queryToTagMap.get(Su(p));t.listenProvider_.stopListening(bs(p),m)}))}o1(t,c)}return a}function BD(t,e,n,r){let o=xm(t,r);if(o!=null){let i=Nm(o),s=i.path,a=i.queryId,l=Ye(s,e),c=new Ho(Tm(a),l,n);return Rm(t,s,c)}else return[]}function t1(t,e,n,r){let o=xm(t,r);if(o){let i=Nm(o),s=i.path,a=i.queryId,l=Ye(s,e),c=tt.fromObject(n),f=new lu(Tm(a),l,c);return Rm(t,s,f)}else return[]}function lm(t,e,n,r=!1){let o=e._path,i=null,s=!1;t.syncPointTree_.foreachOnPath(o,(p,m)=>{let g=Ye(p,o);i=i||Xn(m,g),s=s||tr(m)});let a=t.syncPointTree_.get(o);a?(s=s||tr(a),i=i||Xn(a,Q())):(a=new pu,t.syncPointTree_=t.syncPointTree_.set(o,a));let l;i!=null?l=!0:(l=!1,i=G.EMPTY_NODE,t.syncPointTree_.subtree(o).foreachChild((m,g)=>{let y=Xn(g,Q());y&&(i=i.updateImmediateChild(m,y))}));let c=VD(a,e);if(!c&&!e._queryParams.loadsAllData()){let p=Su(e);S(!t.queryToTagMap.has(p),"View does not exist, but we have a tag");let m=i1();t.queryToTagMap.set(p,m),t.tagToQueryMap.set(m,p)}let f=wu(t.pendingWriteTree_,o),h=jP(a,e,n,f,i,l);if(!c&&!s&&!r){let p=LD(a,e);h=h.concat(s1(t,e,p))}return h}function Mm(t,e,n){let o=t.pendingWriteTree_,i=t.syncPointTree_.findOnPath(e,(s,a)=>{let l=Ye(s,e),c=Xn(a,l);if(c)return c});return MD(o,e,i,n,!0)}function n1(t,e){let n=e._path,r=null;t.syncPointTree_.foreachOnPath(n,(c,f)=>{let h=Ye(c,n);r=r||Xn(f,h)});let o=t.syncPointTree_.get(n);o?r=r||Xn(o,Q()):(o=new pu,t.syncPointTree_=t.syncPointTree_.set(n,o));let i=r!=null,s=i?new an(r,!0,!1):null,a=wu(t.pendingWriteTree_,e._path),l=FD(o,e,a,i?s.getNode():G.EMPTY_NODE,i);return BP(l)}function Us(t,e){return HD(e,t.syncPointTree_,null,wu(t.pendingWriteTree_,Q()))}function HD(t,e,n,r){if(J(t.path))return GD(t,e,n,r);{let o=e.get(Q());n==null&&o!=null&&(n=Xn(o,Q()));let i=[],s=z(t.path),a=t.operationForChild(s),l=e.children.get(s);if(l&&a){let c=n?n.getImmediateChild(s):null,f=xD(r,s);i=i.concat(HD(a,l,c,f))}return o&&(i=i.concat(Am(o,t,r,n))),i}}function GD(t,e,n,r){let o=e.get(Q());n==null&&o!=null&&(n=Xn(o,Q()));let i=[];return e.children.inorderTraversal((s,a)=>{let l=n?n.getImmediateChild(s):null,c=xD(r,s),f=t.operationForChild(s);f&&(i=i.concat(GD(f,a,l,c)))}),o&&(i=i.concat(Am(o,t,r,n))),i}function $D(t,e){let n=e.query,r=Rs(t,n);return{hashFn:()=>(UP(e)||G.EMPTY_NODE).hash(),onComplete:o=>{if(o==="ok")return r?e1(t,n._path,r):XP(t,n._path);{let i=CR(o,n);return yu(t,n,null,i)}}}}function Rs(t,e){let n=Su(e);return t.queryToTagMap.get(n)}function Su(t){return t._path.toString()+"$"+t._queryIdentifier}function xm(t,e){return t.tagToQueryMap.get(e)}function Nm(t){let e=t.indexOf("$");return S(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new ne(t.substr(0,e))}}function Rm(t,e,n){let r=t.syncPointTree_.get(e);S(r,"Missing sync point for query tag that we're tracking");let o=wu(t.pendingWriteTree_,e);return Am(r,n,o,null)}function r1(t){return t.fold((e,n,r)=>{if(n&&tr(n))return[Tu(n)];{let o=[];return n&&(o=OD(n)),et(r,(i,s)=>{o=o.concat(s)}),o}})}function bs(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(KP())(t._repo,t._path):t}function o1(t,e){for(let n=0;n<e.length;++n){let r=e[n];if(!r._queryParams.loadsAllData()){let o=Su(r),i=t.queryToTagMap.get(o);t.queryToTagMap.delete(o),t.tagToQueryMap.delete(i)}}}function i1(){return QP++}function s1(t,e,n){let r=e._path,o=Rs(t,e),i=$D(t,n),s=t.listenProvider_.startListening(bs(e),o,i.hashFn,i.onComplete),a=t.syncPointTree_.subtree(r);if(o)S(!tr(a.value),"If we're adding a query, it shouldn't be shadowed");else{let l=a.fold((c,f,h)=>{if(!J(c)&&f&&tr(f))return[Tu(f).query];{let p=[];return f&&(p=p.concat(OD(f).map(m=>m.query))),et(h,(m,g)=>{p=p.concat(g)}),p}});for(let c=0;c<l.length;++c){let f=l[c];t.listenProvider_.stopListening(bs(f),Rs(t,f))}}return s}var um=class t{constructor(e){this.node_=e}getImmediateChild(e){let n=this.node_.getImmediateChild(e);return new t(n)}node(){return this.node_}},cm=class t{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){let n=Ne(this.path_,e);return new t(this.syncTree_,n)}node(){return Mm(this.syncTree_,this.path_)}},a1=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},q0=function(t,e,n){if(!t||typeof t!="object")return t;if(S(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return l1(t[".sv"],e,n);if(typeof t[".sv"]=="object")return u1(t[".sv"],e);S(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},l1=function(t,e,n){if(t==="timestamp")return n.timestamp;S(!1,"Unexpected server value: "+t)},u1=function(t,e,n){t.hasOwnProperty("increment")||S(!1,"Unexpected server value: "+JSON.stringify(t,null,2));let r=t.increment;typeof r!="number"&&S(!1,"Unexpected increment value: "+r);let o=e.node();if(S(o!==null&&typeof o<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!o.isLeafNode())return r;let s=o.getValue();return typeof s!="number"?r:s+r},c1=function(t,e,n,r){return Pm(e,new cm(n,t),r)},qD=function(t,e,n){return Pm(t,new um(e),n)};function Pm(t,e,n){let r=t.getPriority().val(),o=q0(r,e.getImmediateChild(".priority"),n),i;if(t.isLeafNode()){let s=t,a=q0(s.getValue(),e,n);return a!==s.getValue()||o!==s.getPriority().val()?new Vo(a,Pe(o)):t}else{let s=t;return i=s,o!==s.getPriority().val()&&(i=i.updatePriority(new Vo(o))),s.forEachChild(Ce,(a,l)=>{let c=Pm(l,e.getImmediateChild(a),n);c!==l&&(i=i.updateImmediateChild(a,c))}),i}}var Ps=class{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}};function km(t,e){let n=e instanceof ne?e:new ne(e),r=t,o=z(n);for(;o!==null;){let i=Pr(r.node.children,o)||{children:{},childCount:0};r=new Ps(o,r,i),n=de(n),o=z(n)}return r}function Wo(t){return t.node.value}function WD(t,e){t.node.value=e,dm(t)}function zD(t){return t.node.childCount>0}function d1(t){return Wo(t)===void 0&&!zD(t)}function bu(t,e){et(t.node.children,(n,r)=>{e(new Ps(n,t,r))})}function jD(t,e,n,r){n&&!r&&e(t),bu(t,o=>{jD(o,e,!0,r)}),n&&r&&e(t)}function f1(t,e,n){let r=n?t:t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Bs(t){return new ne(t.parent===null?t.name:Bs(t.parent)+"/"+t.name)}function dm(t){t.parent!==null&&h1(t.parent,t.name,t)}function h1(t,e,n){let r=d1(n),o=rn(t.node.children,e);r&&o?(delete t.node.children[e],t.node.childCount--,dm(t)):!r&&!o&&(t.node.children[e]=n.node,t.node.childCount++,dm(t))}var p1=/[\[\].#$\/\u0000-\u001F\u007F]/,m1=/[\[\].#$\u0000-\u001F\u007F]/,Ip=10*1024*1024,YD=function(t){return typeof t=="string"&&t.length!==0&&!p1.test(t)},JD=function(t){return typeof t=="string"&&t.length!==0&&!m1.test(t)},g1=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),JD(t)};var y1=function(t,e,n,r){r&&e===void 0||Fm(zl(t,"value"),e,n)},Fm=function(t,e,n){let r=n instanceof ne?new Lp(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Or(r));if(typeof e=="function")throw new Error(t+"contains a function "+Or(r)+" with contents = "+e.toString());if(Q0(e))throw new Error(t+"contains "+e.toString()+" "+Or(r));if(typeof e=="string"&&e.length>Ip/3&&ps(e)>Ip)throw new Error(t+"contains a string greater than "+Ip+" utf8 bytes "+Or(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let o=!1,i=!1;if(et(e,(s,a)=>{if(s===".value")o=!0;else if(s!==".priority"&&s!==".sv"&&(i=!0,!YD(s)))throw new Error(t+" contains an invalid key ("+s+") "+Or(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);KR(r,s),Fm(t,a,r),QR(r)}),o&&i)throw new Error(t+' contains ".value" child '+Or(r)+" in addition to actual children.")}};var KD=function(t,e,n,r){if(!(r&&n===void 0)&&!JD(n))throw new Error(zl(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},_1=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),KD(t,e,n,r)},v1=function(t,e){if(z(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},E1=function(t,e){let n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!YD(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!g1(n))throw new Error(zl(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var fm=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function Om(t,e){let n=null;for(let r=0;r<e.length;r++){let o=e[r],i=o.getPath();n!==null&&!Cm(i,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:i}),n.events.push(o)}n&&t.eventLists_.push(n)}function QD(t,e,n){Om(t,n),ZD(t,r=>Cm(r,e))}function ln(t,e,n){Om(t,n),ZD(t,r=>Nt(r,e)||Nt(e,r))}function ZD(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){let o=t.eventLists_[r];if(o){let i=o.path;e(i)?(C1(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function C1(t){for(let e=0;e<t.events.length;e++){let n=t.events[e];if(n!==null){t.events[e]=null;let r=n.getEventRunner();Ur&&$e("event: "+n.toString()),qo(r)}}}var D1="repo_interrupt",I1=25,hm=class{constructor(e,n,r,o){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=o,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new fm,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=su(),this.transactionQueueTree_=new Ps,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function w1(t,e,n){if(t.stats_=Em(t.repoInfo_),t.forceRestClient_||TR())t.server_=new Yp(t.repoInfo_,(r,o,i,s)=>{W0(t,r,o,i,s)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>z0(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{be(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new Dm(t.repoInfo_,e,(r,o,i,s)=>{W0(t,r,o,i,s)},r=>{z0(t,r)},r=>{S1(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=bR(t.repoInfo_,()=>new Zp(t.stats_,t.server_)),t.infoData_=new Jp,t.infoSyncTree_=new gu({startListening:(r,o,i,s)=>{let a=[],l=t.infoData_.getNode(r._path);return l.isEmpty()||(a=Vs(t.infoSyncTree_,r._path,l),setTimeout(()=>{s("ok")},0)),a},stopListening:()=>{}}),Vm(t,"connected",!1),t.serverSyncTree_=new gu({startListening:(r,o,i,s)=>(t.server_.listen(r,i,o,(a,l)=>{let c=s(a,l);ln(t.eventQueue_,r._path,c)}),[]),stopListening:(r,o)=>{t.server_.unlisten(r,o)}})}function T1(t){let n=t.infoData_.getNode(new ne(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Lm(t){return a1({timestamp:T1(t)})}function W0(t,e,n,r,o){t.dataUpdateCount++;let i=new ne(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let s=[];if(o)if(r){let l=hs(n,c=>Pe(c));s=t1(t.serverSyncTree_,i,l,o)}else{let l=Pe(n);s=BD(t.serverSyncTree_,i,l,o)}else if(r){let l=hs(n,c=>Pe(c));s=ZP(t.serverSyncTree_,i,l)}else{let l=Pe(n);s=Vs(t.serverSyncTree_,i,l)}let a=i;s.length>0&&(a=Mu(t,i)),ln(t.eventQueue_,a,s)}function z0(t,e){Vm(t,"connected",e),e===!1&&M1(t)}function S1(t,e){et(e,(n,r)=>{Vm(t,n,r)})}function Vm(t,e,n){let r=new ne("/.info/"+e),o=Pe(n);t.infoData_.updateSnapshot(r,o);let i=Vs(t.infoSyncTree_,r,o);ln(t.eventQueue_,r,i)}function XD(t){return t.nextWriteId_++}function b1(t,e,n){let r=n1(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(o=>{let i=Pe(o).withIndex(e._queryParams.getIndex());lm(t.serverSyncTree_,e,n,!0);let s;if(e._queryParams.loadsAllData())s=Vs(t.serverSyncTree_,e._path,i);else{let a=Rs(t.serverSyncTree_,e);s=BD(t.serverSyncTree_,e._path,i,a)}return ln(t.eventQueue_,e._path,s),yu(t.serverSyncTree_,e,n,null,!0),i},o=>(Au(t,"get for query "+be(e)+" failed: "+o),Promise.reject(new Error(o))))}function A1(t,e,n,r,o){Au(t,"set",{path:e.toString(),value:n,priority:r});let i=Lm(t),s=Pe(n,r),a=Mm(t.serverSyncTree_,e),l=qD(s,a,i),c=XD(t),f=UD(t.serverSyncTree_,e,l,c,!0);Om(t.eventQueue_,f),t.server_.put(e.toString(),s.val(!0),(p,m)=>{let g=p==="ok";g||Xe("set at "+e+" failed: "+p);let y=Vr(t.serverSyncTree_,c,!g);ln(t.eventQueue_,e,y),R1(t,o,p,m)});let h=oI(t,e);Mu(t,h),ln(t.eventQueue_,h,[])}function M1(t){Au(t,"onDisconnectEvents");let e=Lm(t),n=su();Kp(t.onDisconnect_,Q(),(o,i)=>{let s=c1(o,i,t.serverSyncTree_,e);wD(n,o,s)});let r=[];Kp(n,Q(),(o,i)=>{r=r.concat(Vs(t.serverSyncTree_,o,i));let s=oI(t,o);Mu(t,s)}),t.onDisconnect_=su(),ln(t.eventQueue_,Q(),r)}function x1(t,e,n){let r;z(e._path)===".info"?r=lm(t.infoSyncTree_,e,n):r=lm(t.serverSyncTree_,e,n),QD(t.eventQueue_,e._path,r)}function j0(t,e,n){let r;z(e._path)===".info"?r=yu(t.infoSyncTree_,e,n):r=yu(t.serverSyncTree_,e,n),QD(t.eventQueue_,e._path,r)}function N1(t){t.persistentConnection_&&t.persistentConnection_.interrupt(D1)}function Au(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),$e(n,...e)}function R1(t,e,n,r){e&&qo(()=>{if(n==="ok")e(null);else{let o=(n||"error").toUpperCase(),i=o;r&&(i+=": "+r);let s=new Error(i);s.code=o,e(s)}})}function eI(t,e,n){return Mm(t.serverSyncTree_,e,n)||G.EMPTY_NODE}function Um(t,e=t.transactionQueueTree_){if(e||xu(t,e),Wo(e)){let n=nI(t,e);S(n.length>0,"Sending zero length transaction queue"),n.every(o=>o.status===0)&&P1(t,Bs(e),n)}else zD(e)&&bu(e,n=>{Um(t,n)})}function P1(t,e,n){let r=n.map(c=>c.currentWriteId),o=eI(t,e,r),i=o,s=o.hash();for(let c=0;c<n.length;c++){let f=n[c];S(f.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),f.status=1,f.retryCount++;let h=Ye(e,f.path);i=i.updateChild(h,f.currentOutputSnapshotRaw)}let a=i.val(!0),l=e;t.server_.put(l.toString(),a,c=>{Au(t,"transaction put response",{path:l.toString(),status:c});let f=[];if(c==="ok"){let h=[];for(let p=0;p<n.length;p++)n[p].status=2,f=f.concat(Vr(t.serverSyncTree_,n[p].currentWriteId)),n[p].onComplete&&h.push(()=>n[p].onComplete(null,!0,n[p].currentOutputSnapshotResolved)),n[p].unwatcher();xu(t,km(t.transactionQueueTree_,e)),Um(t,t.transactionQueueTree_),ln(t.eventQueue_,e,f);for(let p=0;p<h.length;p++)qo(h[p])}else{if(c==="datastale")for(let h=0;h<n.length;h++)n[h].status===3?n[h].status=4:n[h].status=0;else{Xe("transaction at "+l.toString()+" failed: "+c);for(let h=0;h<n.length;h++)n[h].status=4,n[h].abortReason=c}Mu(t,e)}},s)}function Mu(t,e){let n=tI(t,e),r=Bs(n),o=nI(t,n);return k1(t,o,r),r}function k1(t,e,n){if(e.length===0)return;let r=[],o=[],s=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let l=e[a],c=Ye(n,l.path),f=!1,h;if(S(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)f=!0,h=l.abortReason,o=o.concat(Vr(t.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=I1)f=!0,h="maxretry",o=o.concat(Vr(t.serverSyncTree_,l.currentWriteId,!0));else{let p=eI(t,l.path,s);l.currentInputSnapshot=p;let m=e[a].update(p.val());if(m!==void 0){Fm("transaction failed: Data returned ",m,l.path);let g=Pe(m);typeof m=="object"&&m!=null&&rn(m,".priority")||(g=g.updatePriority(p.getPriority()));let _=l.currentWriteId,C=Lm(t),I=qD(g,p,C);l.currentOutputSnapshotRaw=g,l.currentOutputSnapshotResolved=I,l.currentWriteId=XD(t),s.splice(s.indexOf(_),1),o=o.concat(UD(t.serverSyncTree_,l.path,I,l.currentWriteId,l.applyLocally)),o=o.concat(Vr(t.serverSyncTree_,_,!0))}else f=!0,h="nodata",o=o.concat(Vr(t.serverSyncTree_,l.currentWriteId,!0))}ln(t.eventQueue_,n,o),o=[],f&&(e[a].status=2,(function(p){setTimeout(p,Math.floor(0))})(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(h),!1,null))))}xu(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)qo(r[a]);Um(t,t.transactionQueueTree_)}function tI(t,e){let n,r=t.transactionQueueTree_;for(n=z(e);n!==null&&Wo(r)===void 0;)r=km(r,n),e=de(e),n=z(e);return r}function nI(t,e){let n=[];return rI(t,e,n),n.sort((r,o)=>r.order-o.order),n}function rI(t,e,n){let r=Wo(e);if(r)for(let o=0;o<r.length;o++)n.push(r[o]);bu(e,o=>{rI(t,o,n)})}function xu(t,e){let n=Wo(e);if(n){let r=0;for(let o=0;o<n.length;o++)n[o].status!==2&&(n[r]=n[o],r++);n.length=r,WD(e,n.length>0?n:void 0)}bu(e,r=>{xu(t,r)})}function oI(t,e){let n=Bs(tI(t,e)),r=km(t.transactionQueueTree_,e);return f1(r,o=>{wp(t,o)}),wp(t,r),jD(r,o=>{wp(t,o)}),n}function wp(t,e){let n=Wo(e);if(n){let r=[],o=[],i=-1;for(let s=0;s<n.length;s++)n[s].status===3||(n[s].status===1?(S(i===s-1,"All SENT items should be at beginning of queue."),i=s,n[s].status=3,n[s].abortReason="set"):(S(n[s].status===0,"Unexpected transaction status in abort"),n[s].unwatcher(),o=o.concat(Vr(t.serverSyncTree_,n[s].currentWriteId,!0)),n[s].onComplete&&r.push(n[s].onComplete.bind(null,new Error("set"),!1,null))));i===-1?WD(e,void 0):n.length=i+1,ln(t.eventQueue_,Bs(e),o);for(let s=0;s<r.length;s++)qo(r[s])}}function F1(t){let e="",n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let o=n[r];try{o=decodeURIComponent(o.replace(/\+/g," "))}catch{}e+="/"+o}return e}function O1(t){let e={};t.charAt(0)==="?"&&(t=t.substring(1));for(let n of t.split("&")){if(n.length===0)continue;let r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Xe(`Invalid query segment '${n}' in query '${t}'`)}return e}var Y0=function(t,e){let n=L1(t),r=n.namespace;n.domain==="firebase.com"&&An(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&An("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||gR();let o=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new Zl(n.host,n.secure,r,o,e,"",r!==n.subdomain),path:new ne(n.pathString)}},L1=function(t){let e="",n="",r="",o="",i="",s=!0,a="https",l=443;if(typeof t=="string"){let c=t.indexOf("//");c>=0&&(a=t.substring(0,c-1),t=t.substring(c+2));let f=t.indexOf("/");f===-1&&(f=t.length);let h=t.indexOf("?");h===-1&&(h=t.length),e=t.substring(0,Math.min(f,h)),f<h&&(o=F1(t.substring(f,h)));let p=O1(t.substring(Math.min(t.length,h)));c=e.indexOf(":"),c>=0?(s=a==="https"||a==="wss",l=parseInt(e.substring(c+1),10)):c=e.length;let m=e.slice(0,c);if(m.toLowerCase()==="localhost")n="localhost";else if(m.split(".").length<=2)n=m;else{let g=e.indexOf(".");r=e.substring(0,g).toLowerCase(),n=e.substring(g+1),i=r}"ns"in p&&(i=p.ns)}return{host:e,port:l,domain:n,subdomain:r,secure:s,scheme:a,pathString:o,namespace:i}};var _u=class{constructor(e,n,r,o){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=o}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+be(this.snapshot.exportVal())}},vu=class{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var Eu=class{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return S(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var pm=class t{constructor(e,n,r,o){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=o}get key(){return J(this._path)?null:mD(this._path)}get ref(){return new un(this._repo,this._path)}get _queryIdentifier(){let e=P0(this._queryParams),n=vm(e);return n==="{}"?"default":n}get _queryObject(){return P0(this._queryParams)}isEqual(e){if(e=kr(e),!(e instanceof t))return!1;let n=this._repo===e._repo,r=Cm(this._path,e._path),o=this._queryIdentifier===e._queryIdentifier;return n&&r&&o}toJSON(){return this.toString()}toString(){return this._repo.toString()+JR(this._path)}};var un=class t extends pm{constructor(e,n){super(e,n,new jp,!1)}get parent(){let e=yD(this._path);return e===null?null:new t(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},ks=class t{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let n=new ne(e),r=Cu(this.ref,e);return new t(this._node.getChild(n),r,Ce)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,o)=>e(new t(o,Cu(this.ref,r),Ce)))}hasChild(e){let n=new ne(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function Nu(t,e){return t=kr(t),t._checkNotDeleted("ref"),e!==void 0?Cu(t._root,e):t._root}function Cu(t,e){return t=kr(t),z(t._path)===null?_1("child","path",e,!1):KD("child","path",e,!1),new un(t._repo,Ne(t._path,e))}function iI(t,e){t=kr(t),v1("set",t._path),y1("set",e,t._path,!1);let n=new Jn;return A1(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function sI(t){t=kr(t);let e=new Eu(()=>{}),n=new Du(e);return b1(t._repo,t,n).then(r=>new ks(r,new un(t._repo,t._path),t._queryParams.getIndex()))}var Du=class t{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){let r=n._queryParams.getIndex();return new _u("value",this,new ks(e.snapshotNode,new un(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new vu(this,e,n):null}matches(e){return e instanceof t?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},mm=class t{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new vu(this,e,n):null}createEvent(e,n){S(e.childName!=null,"Child events should have a childName.");let r=Cu(new un(n._repo,n._path),e.childName),o=n._queryParams.getIndex();return new _u(e.type,this,new ks(e.snapshotNode,r,o),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof t?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function V1(t,e,n,r,o){let i;if(typeof r=="object"&&(i=void 0,o=r),typeof r=="function"&&(i=r),o&&o.onlyOnce){let l=n,c=(f,h)=>{j0(t._repo,t,a),l(f,h)};c.userCallback=n.userCallback,c.context=n.context,n=c}let s=new Eu(n,i||void 0),a=e==="value"?new Du(s):new mm(e,s);return x1(t._repo,t,a),()=>j0(t._repo,t,a)}function aI(t,e,n,r){return V1(t,"value",e,n,r)}qP(un);JP(un);var U1="FIREBASE_DATABASE_EMULATOR_HOST",gm={},B1=!1;function H1(t,e,n,r){let o=e.lastIndexOf(":"),i=e.substring(0,o),s=Wl(i);t.repoInfo_=new Zl(e,s,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0,n),r&&(t.authTokenProvider_=r)}function G1(t,e,n,r,o){let i=r||t.options.databaseURL;i===void 0&&(t.options.projectId||An("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),$e("Using default host for project ",t.options.projectId),i=`${t.options.projectId}-default-rtdb.firebaseio.com`);let s=Y0(i,o),a=s.repoInfo,l,c;typeof process<"u"&&process.env&&(c=process.env[U1]),c?(l=!0,i=`http://${c}?ns=${a.namespace}`,s=Y0(i,o),a=s.repoInfo):l=!s.repoInfo.secure;let f=o&&l?new ws(ws.OWNER):new xp(t.name,t.options,e);E1("Invalid Firebase Database URL",s),J(s.path)||An("Database URL must point to the root of a Firebase Database (not including a child path).");let h=q1(a,t,f,new Mp(t,n));return new ym(h,t)}function $1(t,e){let n=gm[e];(!n||n[t.key]!==t)&&An(`Database ${e}(${t.repoInfo_}) has already been deleted.`),N1(t),delete n[t.key]}function q1(t,e,n,r){let o=gm[e.name];o||(o={},gm[e.name]=o);let i=o[t.toURLString()];return i&&An("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new hm(t,B1,n,r),o[t.toURLString()]=i,i}var ym=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(w1(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new un(this._repo,Q())),this._rootInternal}_delete(){return this._rootInternal!==null&&($1(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&An("Cannot call "+e+" on a deleted database.")}};function lI(t=h0(),e){let n=c0(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){let r=BC("database");r&&W1(n,...r)}return n}function W1(t,e,n,r={}){t=kr(t),t._checkNotDeleted("useEmulator");let o=`${e}:${n}`,i=t._repoInternal;if(t._instanceStarted){if(o===t._repoInternal.repoInfo_.host&&xo(r,i.repoInfo_.emulatorOptions))return;An("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&An('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new ws(ws.OWNER);else if(r.mockUserToken){let a=typeof r.mockUserToken=="string"?r.mockUserToken:GC(r.mockUserToken,t.app.options.projectId);s=new ws(a)}Wl(e)&&(HC(e),$C("Database",!0)),H1(i,o,r,s)}function z1(t){hR(f0),gs(new Sn("database",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app").getImmediate(),o=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return G1(r,o,i,n)},"PUBLIC").setMultipleInstances(!0)),Qn(g0,y0,t),Qn(g0,y0,"esm2020")}Dm.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};Dm.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};z1();var Bm={apiKey:"AIzaSyArMDaPtSCgz20QUlJhnUhhq5cRT98G7RI",authDomain:"miproyectoindicadores.firebaseapp.com",databaseURL:"https://miproyectoindicadores-default-rtdb.firebaseio.com",projectId:"miproyectoindicadores",storageBucket:"miproyectoindicadores.firebasestorage.app",messagingSenderId:"572003613740",appId:"1:572003613740:web:4001cae49871f7f467589"},zo=class t{constructor(){this.safety=oe({daysWithoutAccident:87,recordDays:289,previousRecord:467,lti:0,mti:0,fac:0});this.warehouse=oe({ptReal:18500,ptCap:22e3,matReal:4200,matCap:5e3});this.freight=oe([]);this.stayTime=oe([]);this.crews=oe([]);this.waste=oe([]);this.downtime=oe([]);this.bonusObjectives=oe([]);this.layout=oe([{id:"safety",label:"Seguridad y Almac\xE9n"},{id:"freight",label:"Fleteo"},{id:"downtime",label:"Tiempo Perdido (Montacargas)"},{id:"stayTime",label:"Tiempo de Estancia"},{id:"waste_discipline",label:"Merma y Disciplina"},{id:"bonus",label:"Objetivos Bono Planta"},{id:"crew",label:"Resultados Tripulaci\xF3n"}]);this.announcement=oe("\u26A0\uFE0F AVISO: Auditor\xEDa de Seguridad programada para el pr\xF3ximo Jueves. Mantener \xE1reas despejadas. \u26A0\uFE0F");this.lastUpdate=oe(new Date);this.isSimulationActive=oe(!1);this.performanceMode=oe("high");this.syncStatus=oe("local");this.bonusGlobal=jn(()=>{let e=this.bonusObjectives(),n=0,r=0;e.forEach(s=>{let a=s.weight.replace("%",""),l=parseFloat(a);isNaN(l)||(r+=l,s.status==="Excelente"?n+=l:s.status==="Satisfactorio"?n+=l*.85:s.status==="Minimo"&&(n+=l*.7))});let o=r>0?n/r*100:0,i="Bajo";return o>=95?i="Alto":o>=80&&(i="Medio"),{percentage:Math.min(100,Math.round(o)),label:i}});this.bestCrew=jn(()=>this.crews().find(e=>e.ranking===1)||(this.crews().length>0?this.crews()[0]:{name:"-",totalSum:0}));this.STORAGE_KEY="dashboard_db_state_v4_kof";this.isRemoteUpdate=!1;this.isFirebaseConfigured=!1;this.detectHardware(),this.initDefaultData(),this.initPersistenceAndSync(),this.isSimulationActive()&&this.startSimulation()}ngOnDestroy(){this.stopSimulation()}detectHardware(){if(typeof navigator<"u"){let e=navigator.userAgent.toLowerCase(),n=navigator.platform?.toLowerCase()||"",r=e.includes("smart-tv")||e.includes("webos")||e.includes("tizen")||e.includes("bravia")||e.includes("netcast")||e.includes("maple")||e.includes("roku")||e.includes("vizio")||e.includes("hisense")||e.includes("tcl")||e.includes("philips")||e.includes("panasonic")||e.includes("samsung")&&e.includes("tv")||e.includes("lg")&&e.includes("tv")||n.includes("tv")||n.includes("linux")&&e.includes("chromium"),o=e.includes("msie")||e.includes("trident")||e.includes("chrome")&&!e.includes("chromium/7")&&parseInt(e.match(/chrome\/(\d+)/)?.[1]||"0")<70||e.includes("firefox")&&parseInt(e.match(/firefox\/(\d+)/)?.[1]||"0")<60,i=(navigator.hardwareConcurrency||4)<4,s=screen.width*screen.height<1920*1080,a=navigator.deviceMemory&&navigator.deviceMemory<2;r||o||i||s||a?this.performanceMode.set("eco"):this.performanceMode.set("high")}}togglePerformanceMode(){this.performanceMode.update(e=>e==="high"?"eco":"high")}forceSync(){if(this.isFirebaseConfigured&&this.db){let e=Nu(this.db,"dashboard_state");sI(e).then(n=>{let r=n.val();r&&(this.isRemoteUpdate=!0,this.applyState(r),this.isRemoteUpdate=!1)}).catch(n=>console.error("Force sync failed",n))}}initPersistenceAndSync(){if(Bm.apiKey&&Bm.apiKey!=="API_KEY_PLACEHOLDER")try{let n=yp(Bm);this.db=lI(n),this.isFirebaseConfigured=!0,this.syncStatus.set("cloud");let r=Nu(this.db,"dashboard_state");aI(r,o=>{let i=o.val();i&&(this.isRemoteUpdate=!0,this.applyState(i),this.isRemoteUpdate=!1)})}catch(n){console.error("Sync: Firebase init failed",n),this.syncStatus.set("local")}else this.syncStatus.set("local");let e=localStorage.getItem(this.STORAGE_KEY);if(e)try{let n=JSON.parse(e);this.applyState(n)}catch(n){console.error("Database: Failed to parse stored state",n)}go(()=>{let n={safety:this.safety(),warehouse:this.warehouse(),freight:this.freight(),stayTime:this.stayTime(),crews:this.crews(),waste:this.waste(),downtime:this.downtime(),bonusObjectives:this.bonusObjectives(),layout:this.layout(),announcement:this.announcement(),isSimulationActive:this.isSimulationActive(),performanceMode:this.performanceMode(),lastUpdate:this.lastUpdate().toISOString()};if(localStorage.setItem(this.STORAGE_KEY,JSON.stringify(n)),!this.isRemoteUpdate&&this.isFirebaseConfigured&&this.db){let r=Nu(this.db,"dashboard_state");iI(r,n).catch(o=>console.error("Sync: Push failed",o))}})}applyState(e){if(e){if(e.safety&&this.safety.set(e.safety),e.warehouse&&this.warehouse.set(e.warehouse),e.freight&&this.freight.set(e.freight),e.stayTime&&this.stayTime.set(e.stayTime),e.crews&&this.crews.set(e.crews),e.waste&&this.waste.set(e.waste),e.downtime&&this.downtime.set(e.downtime),e.bonusObjectives){let n=e.bonusObjectives.map(r=>W(x({},r),{status:this.calculateBonusStatus(r)}));this.bonusObjectives.set(n)}e.layout&&this.layout.set(e.layout),e.announcement&&this.announcement.set(e.announcement),e.lastUpdate&&this.lastUpdate.set(new Date(e.lastUpdate)),e.performanceMode&&this.performanceMode.set(e.performanceMode),e.isSimulationActive!==void 0&&this.isSimulationActive()!==e.isSimulationActive&&(this.isSimulationActive.set(e.isSimulationActive),e.isSimulationActive?this.startSimulation():this.stopSimulation())}}initDefaultData(){this.crews.set([{name:"ARMAGEDOM",pdf:1.12,stayTime:"00:50",plantTime:"00:46",palletsAverage:14433,security:5,totalSum:18,ranking:1},{name:"CRACKS",pdf:1.03,stayTime:"00:58",plantTime:"00:53",palletsAverage:15606,security:5,totalSum:16,ranking:2},{name:"GLADIADORES",pdf:.98,stayTime:"01:05",plantTime:"00:54",palletsAverage:20597,security:5,totalSum:14,ranking:3},{name:"X-MEN",pdf:1.06,stayTime:"00:52",plantTime:"00:45",palletsAverage:15980,security:5,totalSum:13,ranking:4}]);let n=[{description:"Merma producto terminado",min:319633,sat:312974,exc:306315,accumulated:3e5,weight:"20%",format:"currency",status:""},{description:"Cumplimiento programas Fleteo",min:97,sat:98,exc:99,accumulated:98.5,weight:"30%",format:"percent",status:""},{description:"Tiempo de estancia",min:65,sat:62,exc:60,accumulated:60,weight:"20%",format:"time",status:""},{description:"Desabasto / Tasa de llenado",min:.0079,sat:.007,exc:.0061,accumulated:.0065,weight:"30%",format:"number",status:""},{description:"Merma Materia Prima",min:12e3,sat:9e3,exc:7e3,accumulated:8500,weight:"N/A",format:"currency",status:""}].map(i=>W(x({},i),{status:this.calculateBonusStatus(i)}));this.bonusObjectives.set(n);let r=Array.from({length:22},(i,s)=>({d:`Dia ${s+1}`,p:3e3,r:2800+Math.floor(Math.random()*400)}));this.freight.set(r.map(i=>({day:i.d,planned:i.p,real:i.r})));let o=Array.from({length:22},(i,s)=>({d:`D${s+1}`,r:50+Math.floor(Math.random()*15),g:55}));this.stayTime.set(o.map(i=>({day:i.d,real:i.r,goal:i.g}))),this.waste.set([{material:"Pet",real:1250.5,target:800},{material:"Etiqueta",real:150,target:200},{material:"Taparrosca",real:450.75,target:300}]),this.downtime.set([{line:"LINEA001",lostTime:115,crew:"ARMAGEDOM",pdf:1.12},{line:"LINEA002",lostTime:204,crew:"CRACKS",pdf:1.03},{line:"LINEA003",lostTime:97,crew:"GLADIADORES",pdf:.98},{line:"LINEA004",lostTime:417,crew:"X-MEN",pdf:1.06}])}updateSafety(e){this.safety.update(n=>x(x({},n),e)),this.touchUpdate()}updateWarehouse(e){this.warehouse.update(n=>x(x({},n),e)),this.touchUpdate()}updateFreight(e){this.freight.set(e),this.touchUpdate()}updateStayTime(e){this.stayTime.set(e),this.touchUpdate()}updateWaste(e){this.waste.set(e),this.touchUpdate()}updateDowntime(e){this.downtime.set(e),this.touchUpdate()}updateAnnouncement(e){this.announcement.set(e),this.touchUpdate()}updateCrew(e,n){this.crews.update(r=>{let o=[...r];return o[e]=x(x({},o[e]),n),o}),this.touchUpdate()}calculateBonusStatus(e){let n=e.accumulated;return e.exc<e.min?n<=e.exc?"Excelente":n<=e.sat?"Satisfactorio":n<=e.min?"Minimo":"Bajo":n>=e.exc?"Excelente":n>=e.sat?"Satisfactorio":n>=e.min?"Minimo":"Bajo"}updateBonusResult(e,n){this.bonusObjectives.update(r=>r.map(o=>{if(o.description.toLowerCase().includes(e.toLowerCase())||e.toLowerCase().includes(o.description.toLowerCase())){let i=W(x({},o),{accumulated:n});return i.status=this.calculateBonusStatus(i),i}return o})),this.touchUpdate()}updateBonusRaw(e,n){this.bonusObjectives.update(r=>{let o=[...r],i=x(x({},o[e]),n);return i.status=this.calculateBonusStatus(i),o[e]=i,o}),this.touchUpdate()}moveWidget(e,n){this.layout.update(r=>{let o=[...r],i=n==="up"?e-1:e+1;return i>=0&&i<o.length&&([o[e],o[i]]=[o[i],o[e]]),o})}toggleSimulation(e){this.isSimulationActive.set(e),e?this.startSimulation():this.stopSimulation()}randomizeFreight(){this.freight.update(e=>e.map(n=>{let o=Math.random()>.3?Math.floor(Math.random()*25)+5:Math.floor(Math.random()*10)-5,i=Math.max(0,n.real+o);return i>n.planned*1.1&&(i=n.planned*.85),W(x({},n),{real:i})})),this.touchUpdate()}randomizeStayTime(){this.stayTime.update(e=>e.map(n=>W(x({},n),{real:Math.max(20,Math.min(120,n.real+Math.floor((Math.random()-.5)*10)))}))),this.touchUpdate()}randomizeSafetyAndWarehouse(){this.safety.update(e=>{let n=Math.random(),r=e.lti,o=e.mti;return n>.9&&(Math.random()>.5&&(r=Math.max(0,e.lti+(Math.random()>.5?1:-1))),Math.random()>.5&&(o=Math.max(0,e.mti+(Math.random()>.5?1:-1)))),W(x({},e),{lti:r,mti:o})}),this.warehouse.update(e=>{let n=Math.floor((Math.random()-.5)*500),r=Math.floor((Math.random()-.5)*200);return W(x({},e),{ptReal:Math.max(0,Math.min(e.ptCap,e.ptReal+n)),matReal:Math.max(0,Math.min(e.matCap,e.matReal+r))})}),this.touchUpdate()}startSimulation(){this.stopSimulation(),this.simulationInterval=setInterval(()=>{this.randomizeFreight(),this.randomizeStayTime()},3e4),this.fastSimulationInterval=setInterval(()=>{this.randomizeSafetyAndWarehouse()},15e3)}stopSimulation(){this.simulationInterval&&clearInterval(this.simulationInterval),this.fastSimulationInterval&&clearInterval(this.fastSimulationInterval)}touchUpdate(){this.lastUpdate.set(new Date)}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275prov=fe({token:t,factory:t.\u0275fac,providedIn:"root"})}};var j1=["chartContainer"],Y1=["tooltip"];function J1(t,e){if(t&1&&(zn(0,"div",4)(1,"div",9),bo(2,"div",10),Cn(),zn(3,"span",6),D(4),Cn()()),t&2){let n=le();T(),bt("background-color",n.lineColor()),T(),bt("background-color",n.lineColor()),T(2),ye(n.lineLabel())}}var Ru=class t{constructor(){this.data=Qe.required();this.xKey=Qe("day");this.barDataKey=Qe.required();this.lineDataKey=Qe(void 0);this.barLabel=Qe("Real");this.lineLabel=Qe("Plan");this.barColor=Qe("#F40000");this.lineColor=Qe("#1E1E1E");this.lowerIsBetter=Qe(!1);this.valueFormat=Qe("number");this.performanceMode=Qe("high");this.autoScroll=Qe(!1);this.windowSize=Qe(12);this.container=Mh("chartContainer");this.tooltipRef=Mh("tooltip");this.resizeObserver=null;this.currentOffset=0;go(()=>{let e=this.data(),n=this.container();n&&n.nativeElement&&e&&(requestAnimationFrame(()=>this.render()),this.resizeObserver||(this.resizeObserver=new ResizeObserver(()=>{requestAnimationFrame(()=>this.render())}),this.resizeObserver.observe(n.nativeElement)))}),go(()=>{this.autoScroll()?this.startScrolling():this.stopScrolling()})}get showLineLegend(){return!!this.lineDataKey()&&this.data().length>0&&this.lineDataKey()in this.data()[0]}ngOnDestroy(){this.resizeObserver?.disconnect(),this.stopScrolling()}startScrolling(){this.stopScrolling(),this.scrollInterval=setInterval(()=>{let e=this.data(),n=this.windowSize();!e||e.length<=n||(this.currentOffset++,this.currentOffset>e.length-n&&(this.currentOffset=0),this.render())},4e3)}stopScrolling(){this.scrollInterval&&clearInterval(this.scrollInterval)}formatValue(e){if(this.valueFormat()==="time"){let n=Math.floor(e/60),r=Math.round(e%60);return`${n}:${r.toString().padStart(2,"0")}`}return d3.format(",")(e)}render(){if(!this.container()?.nativeElement||!this.data())return;let e=this.data(),n=this.windowSize(),r=e;if(e.length>n){let o=Math.min(this.currentOffset+n,e.length);r=e.slice(this.currentOffset,o)}this.drawChart(this.container().nativeElement,r)}drawChart(e,n){if(!n||n.length===0||e.clientWidth===0||e.clientHeight===0)return;let r=this.performanceMode()==="eco",o=this.xKey(),i=this.barDataKey(),s=this.lineDataKey(),a=this.barColor(),l=this.lineColor(),c=d3.select(this.tooltipRef()?.nativeElement),f=!!s&&s in n[0],h={top:25,right:30,bottom:25,left:35},p=e.clientWidth-h.left-h.right,m=e.clientHeight-h.top-h.bottom,g=d3.select(e).select("svg"),y;g.empty()?(g=d3.select(e).append("svg").attr("width","100%").attr("height","100%"),y=g.append("g").attr("class","chart-content").attr("transform",`translate(${h.left},${h.top})`),y.append("g").attr("class","grid"),y.append("g").attr("class","x-axis"),y.append("g").attr("class","y-axis"),y.append("g").attr("class","bars-group"),y.append("g").attr("class","labels-group"),y.append("g").attr("class","line-group"),y.append("g").attr("class","line-labels-group")):(y=g.select(".chart-content"),y.attr("transform",`translate(${h.left},${h.top})`)),g.attr("viewBox",`0 0 ${e.clientWidth} ${e.clientHeight}`);let _=d3.scaleBand().domain(n.map(P=>P[o])).range([0,p]).padding(.35),C=d3.max(n,P=>{let b=P[i]||0,N=f&&P[s]||0;return Math.max(b,N)})||100,I=d3.scaleLinear().domain([0,C*1.2]).range([m,0]),w=r?0:750,A=d3.transition().duration(w).ease(d3.easeQuadOut);y.select(".grid").transition(A).call(d3.axisRight(I).tickSize(p).tickFormat("").ticks(5)).style("stroke-opacity",.1).call(P=>P.select(".domain").remove()),y.select(".x-axis").attr("transform",`translate(0,${m})`).transition(A).call(d3.axisBottom(_).tickSize(0)).selectAll("text").style("text-anchor","middle").attr("dy","12px").style("fill","#64748B"),y.select(".x-axis").select(".domain").attr("stroke","#CBD5E1"),y.select(".y-axis").transition(A).call(d3.axisLeft(I).ticks(5).tickFormat(P=>this.formatValue(P)).tickSize(0)).select(".domain").remove(),y.select(".bars-group").selectAll(".bar").data(n,P=>P[o]).join(P=>P.append("rect").attr("class","bar").attr("fill",a).attr("x",b=>_(b[o])).attr("width",_.bandwidth()).attr("y",m).attr("height",0).attr("opacity",0).call(b=>b.transition(A).attr("y",N=>I(N[i]||0)).attr("height",N=>m-I(N[i]||0)).attr("opacity",1)),P=>P.call(b=>b.transition(A).attr("x",N=>_(N[o])).attr("width",_.bandwidth()).attr("y",N=>I(N[i]||0)).attr("height",N=>m-I(N[i]||0)).attr("fill",a)),P=>P.call(b=>b.transition(A).attr("y",m).attr("height",0).attr("opacity",0).remove())).on("mouseover",()=>c.classed("hidden",!1)).on("mousemove",(P,b)=>this.updateTooltip(P,b,e,c,a,f,s,i)).on("mouseout",()=>c.classed("hidden",!0)),y.select(".labels-group").selectAll(".bar-label").data(n,P=>P[o]).join(P=>P.append("text").attr("class","bar-label").attr("text-anchor","middle").attr("fill","#334155").attr("font-size","9px").attr("font-weight","700").style("pointer-events","none").attr("x",b=>_(b[o])+_.bandwidth()/2).attr("y",m).attr("opacity",0).text(b=>this.formatValue(b[i]||0)).call(b=>b.transition(A).attr("y",N=>I(N[i]||0)-6).attr("opacity",1)),P=>P.text(b=>this.formatValue(b[i]||0)).call(b=>b.transition(A).attr("x",N=>_(N[o])+_.bandwidth()/2).attr("y",N=>I(N[i]||0)-6).attr("opacity",1)),P=>P.transition(A).attr("opacity",0).remove());let L=y.select(".line-group");if(L.selectAll("*").remove(),f){let P=d3.line().curve(d3.curveMonotoneX).x(b=>_(b[o])+_.bandwidth()/2).y(b=>I(b[s]||0));L.append("path").datum(n).attr("fill","none").attr("stroke",l).attr("stroke-width",2.5).attr("stroke-linejoin","round").attr("stroke-linecap","round").attr("opacity",0).attr("d",P).transition(A).attr("opacity",1),L.selectAll(".point").data(n,b=>b[o]).join("circle").attr("class","point").attr("r",4.5).attr("fill","#FFFFFF").attr("stroke",l).attr("stroke-width",2.5).attr("cx",b=>_(b[o])+_.bandwidth()/2).attr("cy",b=>I(b[s]||0)).attr("opacity",0).transition(A).attr("opacity",1)}}updateTooltip(e,n,r,o,i,s,a,l){let[c,f]=d3.pointer(e,r),h=r.clientWidth,p=r.clientHeight,m=r.offsetTop,g=r.offsetLeft,y=this.formatValue(n[l]||0),_=`
        <div class="flex flex-col gap-1.5">
           <div class="font-bold border-b border-gray-600 pb-1.5 text-slate-300 text-[10px] uppercase tracking-wider leading-none">
              ${n[this.xKey()]}
           </div>
           
           <div class="flex justify-between items-center gap-6">
              <div class="flex items-center gap-1.5">
                <span class="w-2 h-2 rounded-full shadow-sm" style="background-color:${i}"></span>
                <span class="font-semibold text-gray-300 text-[11px]">${this.barLabel()}</span>
              </div>
              <span class="font-bold text-white text-xs font-mono">${y}</span>
           </div>
      `;if(s&&a){let I=this.formatValue(n[a]||0),w=(n[l]||0)-(n[a]||0),A=w>=0;this.lowerIsBetter()&&(A=w<=0);let R=A?"text-emerald-400":"text-rose-400",$=w>0?"+":"",L=this.valueFormat()==="time"?$+this.formatValue(Math.abs(w)):$+d3.format(",")(w),P=this.valueFormat()==="time"?" min":"";_+=`
           <div class="flex justify-between items-center gap-6">
              <div class="flex items-center gap-1.5">
                <div class="w-2 h-0.5" style="background-color: ${this.lineColor()}"></div>
                <span class="font-semibold text-gray-400 text-[11px]">${this.lineLabel()}</span>
              </div>
              <span class="font-bold text-gray-300 text-xs font-mono">${I}</span>
           </div>
           
           <div class="mt-1 pt-1.5 border-t border-slate-700 flex justify-between items-center text-[10px]">
              <span class="text-slate-500 font-semibold uppercase tracking-tight">Variaci\xF3n</span>
              <div class="bg-slate-900/50 px-1.5 py-0.5 rounded border border-slate-700/50">
                  <span class="font-black ${R} font-mono">${L}${P}</span>
              </div>
           </div>
         `}_+="</div>",o.html(_);let C=o.node();if(C){let I=C.getBoundingClientRect(),w=c+g+16,A=f+m-I.height/2;w+I.width>h+g&&(w=c+g-I.width-16),A+I.height>p+m&&(A=p+m-I.height-4),A<m&&(A=m+4),w<0&&(w=4),o.style("left",w+"px").style("top",A+"px")}}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=En({type:t,selectors:[["app-d3-bar-chart"]],viewQuery:function(n,r){n&1&&wl(r.container,j1,5)(r.tooltipRef,Y1,5),n&2&&vh(2)},inputs:{data:[1,"data"],xKey:[1,"xKey"],barDataKey:[1,"barDataKey"],lineDataKey:[1,"lineDataKey"],barLabel:[1,"barLabel"],lineLabel:[1,"lineLabel"],barColor:[1,"barColor"],lineColor:[1,"lineColor"],lowerIsBetter:[1,"lowerIsBetter"],valueFormat:[1,"valueFormat"],performanceMode:[1,"performanceMode"],autoScroll:[1,"autoScroll"],windowSize:[1,"windowSize"]},decls:11,vars:4,consts:[["chartContainer",""],["tooltip",""],[1,"relative","w-full","h-full","flex","flex-col","group","overflow-hidden"],[1,"flex","justify-end","items-center","gap-4","text-[10px]","md:text-xs","mb-1","px-4","shrink-0","opacity-80","hover:opacity-100","transition-opacity"],[1,"flex","items-center","gap-1.5"],[1,"w-2.5","h-2.5","rounded-sm","shadow-sm"],[1,"font-bold","text-gray-600"],[1,"w-full","flex-1","min-h-0","relative","z-10"],[1,"absolute","hidden","bg-slate-800/95","backdrop-blur","text-white","text-xs","rounded","shadow-2xl","border","border-slate-600","whitespace-nowrap","z-[50]","pointer-events-none","transition-opacity","duration-75","p-3","select-none"],[1,"w-4","h-[2px]","relative","flex","justify-center","items-center"],[1,"w-1.5","h-1.5","rotate-45","border","border-white"]],template:function(n,r){n&1&&(zn(0,"div",2)(1,"div",3)(2,"div",4),bo(3,"span",5),zn(4,"span",6),D(5),Cn()(),Ue(6,J1,5,5,"div",4),Cn(),bo(7,"div",7,0)(9,"div",8,1),Cn()),n&2&&(T(3),bt("background-color",r.barColor()),T(2),ye(r.barLabel()),T(),Be(r.showLineLegend?6:-1))},dependencies:[tn],styles:[`:host{display:block;width:100%;height:100%}.axis text{font-size:10px;font-family:Inter,sans-serif;fill:#64748b;font-weight:600}.axis path,.axis line{stroke:#e2e8f0}.grid line{stroke:#f1f5f9;stroke-dasharray:4}.bar{cursor:crosshair;rx:3px;ry:3px;shape-rendering:geometricPrecision}.bar:hover{filter:brightness(1.1);stroke:#fff3;stroke-width:1px}
`],encapsulation:2})}};var Hm=t=>({val:t}),K1=(t,e)=>e.id,Q1=(t,e)=>e.line,Z1=(t,e)=>e.material,X1=(t,e)=>e.description,ek=(t,e)=>e.name;function tk(t,e){if(t&1&&(v(0,"div",24)(1,"div",30),Y(2,"div",31),v(3,"div",32)(4,"h3",33),D(5,"Seguridad Industrial"),E(),v(6,"div",34)(7,"div",35),D(8),E(),v(9,"div",36),D(10,"D\xEDas sin Accidentes"),E()(),v(11,"div",37)(12,"div",38)(13,"span",39),D(14,"R\xE9cord"),E(),v(15,"span",40),D(16),E()(),v(17,"div",38)(18,"span",39),D(19,"Anterior"),E(),v(20,"span",40),D(21),E()()()()(),v(22,"div",41)(23,"h3",42),D(24,"Saturaci\xF3n Almac\xE9n"),E(),v(25,"div",43)(26,"div",44)(27,"span",45),D(28,"Prod. Terminado"),E(),v(29,"span",46),D(30),He(31,"number"),E()(),v(32,"div",47),Y(33,"div",48),E()(),v(34,"div")(35,"div",44)(36,"span",45),D(37,"Materiales"),E(),v(38,"span",46),D(39),He(40,"number"),E()(),v(41,"div",47),Y(42,"div",48),E()()()()),t&2){let n=le(2);T(8),_e(" ",n.store.safety().daysWithoutAccident," "),T(8),ye(n.store.safety().recordDays),T(5),ye(n.store.safety().previousRecord);let r=n.store.warehouse().ptReal/n.store.warehouse().ptCap*100,o=n.store.warehouse().matReal/n.store.warehouse().matCap*100;T(9),_e("",gt(31,21,r,"1.0-0"),"%"),T(3),bt("width",r,"%"),xe("bg-emerald-500",r<=85)("bg-amber-400",r>85&&r<=95)("bg-rose-500",r>95),T(6),_e("",gt(40,24,o,"1.0-0"),"%"),T(3),bt("width",o,"%"),xe("bg-emerald-500",o<=85)("bg-amber-400",o>85&&o<=95)("bg-rose-500",o>95)}}function nk(t,e){if(t&1&&(v(0,"div",25)(1,"div",49)(2,"span",50),D(3," Cumplimiento al Programa de Fleteo "),E(),v(4,"span",51),D(5,"MENSUAL"),E()(),v(6,"div",52),Y(7,"app-d3-bar-chart",53),E()()),t&2){let n=le(2);T(7),Te("data",n.store.freight())("autoScroll",!0)("windowSize",15)("performanceMode",n.store.performanceMode())}}function rk(t,e){if(t&1&&(v(0,"tr",63)(1,"td",64),D(2),E(),v(3,"td",65),D(4),E(),v(5,"td",66),D(6),E(),v(7,"td",67),Y(8,"span",68),E()()),t&2){let n=e.$implicit,r=le(3);T(2),ye(n.line),T(2),ye(r.minutesToTime(n.lostTime)),T(),Te("title",n.crew),T(),ye(n.crew),T(2),xe("bg-emerald-500",n.pdf>=1)("bg-amber-400",n.pdf<1&&n.pdf>=.9)("bg-rose-500",n.pdf<.9)}}function ok(t,e){if(t&1&&(v(0,"div",26)(1,"div",54)(2,"h3",55),D(3," Tiempo Perdido (Montacargas) "),E()(),v(4,"div",56)(5,"table",57)(6,"thead",58)(7,"tr")(8,"th",59),D(9,"Linea"),E(),v(10,"th",60),D(11,"Min"),E(),v(12,"th",61),D(13,"Trip"),E(),v(14,"th",60),D(15,"Est"),E()()(),v(16,"tbody",62),Qt(17,rk,9,10,"tr",63,Q1),E()()()()),t&2){let n=le(2);T(17),Zt(n.store.downtime())}}function ik(t,e){if(t&1&&(v(0,"div",27)(1,"div",69)(2,"h3",70),D(3," Tiempo de Estancia "),E(),v(4,"span",71),D(5,"Promedio"),E()(),v(6,"div",72),Y(7,"app-d3-bar-chart",73),E()()),t&2){let n=le(2);T(7),Te("data",n.store.stayTime())("autoScroll",!0)("windowSize",12)("performanceMode",n.store.performanceMode())("lowerIsBetter",!0)}}function sk(t,e){if(t&1&&(v(0,"tr")(1,"td",88),D(2),E(),v(3,"td",89),D(4),He(5,"currency"),E(),v(6,"td",90),D(7),He(8,"currency"),E()()),t&2){let n=e.$implicit;T(2),ye(n.material),T(),xe("text-rose-600",n.real>n.target)("text-emerald-600",n.real<=n.target),T(),_e(" ",Zi(5,7,n.real,"MXN","symbol","1.0-0")," "),T(3),ye(Zi(8,12,n.target,"MXN","symbol","1.0-0"))}}function ak(t,e){if(t&1&&(v(0,"div",26)(1,"div",74)(2,"h3",75),D(3,"Disciplina Operativa"),E(),v(4,"div",76)(5,"table",77)(6,"tbody",78)(7,"tr")(8,"td",79),D(9,"Faltas Injustificadas"),E(),v(10,"td",80),D(11,"2"),E()(),v(12,"tr")(13,"td",79),D(14,"Retardos"),E(),v(15,"td",81),D(16,"5"),E()()()()()(),v(17,"div",82)(18,"h3",75),D(19,"Merma Operativa ($)"),E(),v(20,"div",83)(21,"table",84)(22,"thead",85)(23,"tr")(24,"th",86),D(25,"Mat"),E(),v(26,"th",87),D(27,"Real"),E(),v(28,"th",87),D(29,"Obj"),E()()(),v(30,"tbody",62),Qt(31,sk,9,17,"tr",null,Z1),E()()()()()),t&2){let n=le(2);T(31),Zt(n.store.waste())}}function lk(t,e){if(t&1&&(D(0),He(1,"currency")),t&2){let n=le().val;_e(" ",Zi(1,1,n,"MXN","symbol","1.0-0")," ")}}function uk(t,e){if(t&1&&D(0),t&2){let n=le().val,r=le(4);_e(" ",r.minutesToTime(n)," ")}}function ck(t,e){if(t&1&&(D(0),He(1,"number")),t&2){let n=le().val;_e(" ",gt(1,1,n,"1.1-1"),"% ")}}function dk(t,e){if(t&1&&(D(0),He(1,"number")),t&2){let n=le().val;_e(" ",gt(1,1,n,"1.4-4")," ")}}function fk(t,e){if(t&1&&Ue(0,lk,2,6)(1,uk,1,1)(2,ck,2,4)(3,dk,2,4),t&2){let n=le().$implicit;Be(n.format==="currency"?0:n.format==="time"?1:n.format==="percent"?2:3)}}function hk(t,e){t&1&&Ao(0)}function pk(t,e){t&1&&Ao(0)}function mk(t,e){t&1&&D(0," \u2197 ")}function gk(t,e){t&1&&D(0," \u2198 ")}function yk(t,e){t&1&&Ao(0)}function _k(t,e){if(t&1&&(v(0,"tr",110)(1,"td",123),D(2),E(),xr(3,fk,4,1,"ng-template",null,0,wh),v(5,"td",124),xr(6,hk,1,0,"ng-container",125),E(),v(7,"td",126)(8,"span",127),xr(9,pk,1,0,"ng-container",125),E(),v(10,"span",128),Ue(11,mk,1,0)(12,gk,1,0),E(),v(13,"span",129),xr(14,yk,1,0,"ng-container",125),E()(),v(15,"td",130),D(16),E(),v(17,"td",106)(18,"span",131),D(19),E()()()),t&2){let n=e.$implicit,r=Eh(4);T(),Te("title",n.description),T(),ye(n.description),T(4),Te("ngTemplateOutlet",r)("ngTemplateOutletContext",Qi(23,Hm,n.accumulated)),T(3),Te("ngTemplateOutlet",r)("ngTemplateOutletContext",Qi(25,Hm,n.sat)),T(2),Be(n.exc>n.sat?11:12),T(3),Te("ngTemplateOutlet",r)("ngTemplateOutletContext",Qi(27,Hm,n.exc)),T(2),ye(n.weight),T(2),xe("bg-emerald-50",n.status==="Excelente")("text-emerald-700",n.status==="Excelente")("bg-amber-50",n.status==="Satisfactorio"||n.status==="Minimo")("text-amber-700",n.status==="Satisfactorio"||n.status==="Minimo")("bg-rose-50",n.status==="Bajo")("text-rose-700",n.status==="Bajo"),T(),_e(" ",n.status," ")}}function vk(t,e){if(t&1&&(v(0,"div",28)(1,"div",91)(2,"div",92)(3,"h2",93),D(4,"Bono Planta Hoy"),E(),v(5,"span",94),D(6,"Logro Ponderado"),E()(),v(7,"div",95)(8,"div",96),Y(9,"div",97),v(10,"span",98),D(11),E()(),v(12,"div",99)(13,"span",100),D(14,"Si cerr\xE1ramos hoy:"),E(),v(15,"span",101),D(16),E()()()(),v(17,"div",102)(18,"table",103)(19,"thead",104)(20,"tr")(21,"th",105),D(22,"Indicador"),E(),v(23,"th",106),D(24,"Resultado"),E(),v(25,"th",107),D(26,"Rango Objetivo (SAT \u2198 EXC)"),E(),v(27,"th",108),D(28,"Peso"),E(),v(29,"th",106),D(30,"Estado"),E()()(),v(31,"tbody",109),Qt(32,_k,20,29,"tr",110,X1),E()()(),v(34,"div",111)(35,"p",112),D(36," Estos indicadores se construyen con el desempe\xF1o diario de las tripulaciones. "),E(),v(37,"div",113),Y(38,"div",114),v(39,"div",115),wt(),v(40,"svg",116),Y(41,"path",117)(42,"path",118),E()(),po(),v(43,"div",119)(44,"span",120),D(45,"Mejor Tripulaci\xF3n"),E(),v(46,"span",121),D(47),E()(),v(48,"div",122),D(49),He(50,"number"),E()()()()),t&2){let n=le(2);T(9),bt("width",n.store.bonusGlobal().percentage,"%"),xe("bg-emerald-500",n.store.bonusGlobal().percentage>=80)("bg-amber-400",n.store.bonusGlobal().percentage>=60&&n.store.bonusGlobal().percentage<80)("bg-rose-500",n.store.bonusGlobal().percentage<60),T(2),_e(" ",n.store.bonusGlobal().percentage,"% "),T(4),xe("text-emerald-600",n.store.bonusGlobal().label==="Alto")("text-amber-500",n.store.bonusGlobal().label==="Medio")("text-rose-600",n.store.bonusGlobal().label==="Bajo"),T(),_e(" ",n.store.bonusGlobal().label," "),T(16),Zt(n.store.bonusObjectives()),T(15),ye(n.store.bestCrew().name),T(2),_e(" ",gt(50,18,n.store.bestCrew().totalSum,"1.0-0")," pts ")}}function Ek(t,e){if(t&1&&(v(0,"tr",144)(1,"td",145),D(2),E(),v(3,"td",146),D(4),He(5,"number"),Y(6,"span",147),E(),v(7,"td",146),D(8),Y(9,"span",147),E(),v(10,"td",148),D(11),He(12,"number"),E(),v(13,"td",149)(14,"div",150),Y(15,"div",151),E(),v(16,"span",152),D(17),He(18,"number"),E()()()),t&2){let n=e.$implicit;T(2),ye(n.name),T(2),_e(" ",gt(5,15,n.pdf,"1.2-2")," "),T(2),xe("bg-emerald-500",n.pdf>=1)("bg-rose-500",n.pdf<1),T(2),_e(" ",n.stayTime," "),T(),xe("bg-emerald-500",n.stayTime<="00:55")("bg-rose-500",n.stayTime>"00:55"),T(2),ye(Dh(12,18,n.palletsAverage)),T(4),bt("width",n.totalSum/20*100,"%"),T(2),ye(gt(18,20,n.totalSum,"1.1-1"))}}function Ck(t,e){if(t&1&&(v(0,"div",29)(1,"div",132)(2,"span",133),D(3,"Resultados Tripulaci\xF3n"),E(),v(4,"span",100),D(5,"Turno Matutino"),E()(),v(6,"div",134)(7,"table",135)(8,"thead",136)(9,"tr",137)(10,"th",138),D(11,"Tripulaci\xF3n"),E(),v(12,"th",139),D(13,"PDF "),v(14,"span",140),D(15,"Obj: 1.0"),E()(),v(16,"th",139),D(17,"Estancia "),v(18,"span",140),D(19,"Obj: 55m"),E()(),v(20,"th",141),D(21,"Tarimas "),v(22,"span",140),D(23,"Promedio"),E()(),v(24,"th",142),D(25,"Score "),v(26,"span",140),D(27,"Total"),E()()()(),v(28,"tbody",143),Qt(29,Ek,19,23,"tr",144,ek),E()()()()),t&2){let n=le(2);T(29),Zt(n.store.crews())}}function Dk(t,e){if(t&1&&Ue(0,tk,43,27,"div",24)(1,nk,8,4,"div",25)(2,ok,19,0,"div",26)(3,ik,8,5,"div",27)(4,ak,33,0,"div",26)(5,vk,51,21,"div",28)(6,Ck,31,0,"div",29),t&2){let n,r=e.$implicit;Be((n=r.id)==="safety"?0:n==="freight"?1:n==="downtime"?2:n==="stayTime"?3:n==="waste_discipline"?4:n==="bonus"?5:n==="crew"?6:-1)}}var Pu=class t{constructor(){this.store=K(zo)}formatPercent(e){return e.toFixed(1)+"%"}minutesToTime(e){let n=Math.floor(e/60),r=Math.floor(e%60);return`${n.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`}forceGlobalSync(){this.store.forceSync()}toggleFullScreen(){document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():document.documentElement.requestFullscreen().catch(e=>{console.error(`Error attempting to enable full-screen mode: ${e.message} (${e.name})`)})}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=En({type:t,selectors:[["app-dashboard"]],decls:37,vars:15,consts:[["valTemplate",""],[1,"h-auto","lg:h-screen","w-full","flex","flex-col","bg-gray-100","font-sans","text-xs","md:text-sm","xl:text-base","lg:overflow-hidden","select-none","transition-colors","duration-500"],[1,"bg-slate-900","text-white","shadow-md","px-4","sm:px-6","py-3","lg:py-2","flex","flex-col","sm:flex-row","justify-between","items-center","shrink-0","z-20","min-h-[auto]","lg:h-[8vh]","gap-3","border-b-2","border-coke-red","relative","overflow-hidden"],[1,"absolute","right-0","top-0","h-full","w-1/3","bg-gradient-to-l","from-white/5","to-transparent","pointer-events-none"],[1,"flex","items-center","gap-4","w-full","sm:w-auto","justify-center","sm:justify-start","z-10"],[1,"w-10","h-10","lg:w-12","lg:h-12","bg-white","text-coke-red","rounded-full","flex","items-center","justify-center","font-black","text-xs","md:text-sm","shadow-sm","ring-2","ring-slate-700","shrink-0"],[1,"text-center","sm:text-left"],[1,"text-sm","sm:text-lg","lg:text-xl","font-bold","tracking-tight","leading-tight","uppercase","text-gray-100"],[1,"font-light","opacity-75"],[1,"flex","items-center","gap-2","justify-center","sm:justify-start"],[1,"w-2","h-2","bg-emerald-500","rounded-full","animate-pulse","shadow-[0_0_8px_rgba(16,185,129,0.5)]"],[1,"text-slate-400","uppercase","text-[10px]","sm:text-xs","font-medium","tracking-widest"],[1,"text-center","sm:text-right","w-full","sm:w-auto","flex","justify-between","sm:block","border-t","border-slate-700","sm:border-0","pt-2","sm:pt-0","z-10"],[1,"text-lg","sm:text-2xl","lg:text-3xl","font-bold","leading-none","tracking-tight","text-white","font-mono"],[1,"text-slate-400","text-[10px]","sm:text-xs","uppercase","font-semibold","tracking-wide"],["title","Sincronizar globalmente con la base de datos",1,"mt-1","sm:mt-0","sm:ml-2","px-2","py-1","bg-coke-red","hover:bg-red-700","text-white","text-xs","font-bold","rounded","shadow-sm","transition-colors",3,"click"],[1,"flex-1","p-3","md:p-4","bg-gray-100","w-full","overflow-y-auto","lg:overflow-hidden","h-auto","lg:h-[88vh]"],[1,"grid","grid-cols-1","lg:grid-cols-12","auto-rows-auto","lg:grid-rows-[minmax(0,1fr)_minmax(0,1fr)_minmax(0,1fr)]","gap-4","lg:gap-4","h-auto","lg:h-full","w-full","pb-20","lg:pb-0"],[1,"h-[4vh]","bg-black","text-white","flex","items-center","overflow-hidden","whitespace-nowrap","relative","border-t-2","border-coke-red","fixed","bottom-0","w-full","lg:relative","z-20","shadow-2xl"],[1,"absolute","left-0","top-0","bottom-0","bg-black","z-20","px-3","flex","items-center","shadow-[2px_0_10px_rgba(0,0,0,1)]"],[1,"text-[10px]","xl:text-xs","font-black","text-yellow-400","uppercase","tracking-widest","flex","items-center","gap-2"],[1,"w-2","h-2","rounded-full","bg-red-600","animate-pulse","border","border-red-400"],[1,"animate-marquee","inline-block","pl-[100%]"],[1,"text-xs","xl:text-sm","font-semibold","tracking-wide","text-gray-200"],[1,"col-span-1","lg:col-span-3","lg:row-span-1","flex","flex-col","gap-3","h-auto","lg:h-full","min-h-[220px]","lg:min-h-0"],[1,"col-span-1","lg:col-span-9","lg:row-span-1","bg-white","shadow-sm","rounded-lg","flex","flex-col","h-[280px]","lg:h-full","min-h-0","overflow-hidden","border","border-gray-200"],[1,"col-span-1","lg:col-span-3","lg:row-span-1","bg-white","shadow-sm","rounded-lg","flex","flex-col","h-[220px]","lg:h-full","min-h-0","overflow-hidden","border","border-gray-200"],[1,"col-span-1","lg:col-span-6","lg:row-span-1","bg-white","shadow-sm","rounded-lg","flex","flex-col","h-[280px]","lg:h-full","min-h-0","overflow-hidden","border","border-gray-200"],[1,"col-span-1","lg:col-span-8","lg:row-span-1","bg-white","shadow-sm","rounded-lg","flex","flex-col","h-auto","min-h-[300px]","lg:min-h-0","lg:h-full","z-0","overflow-hidden","border","border-gray-200"],[1,"col-span-1","lg:col-span-4","lg:row-span-1","bg-white","shadow-sm","rounded-lg","flex","flex-col","h-auto","min-h-[300px]","lg:min-h-0","lg:h-full","z-0","overflow-hidden","border","border-gray-200"],[1,"bg-white","rounded-lg","shadow-sm","border","border-gray-200","flex-[2]","flex","flex-col","relative","overflow-hidden","group"],[1,"h-1","w-full","bg-slate-800"],[1,"p-3","flex","flex-col","h-full"],[1,"font-bold","text-gray-400","uppercase","text-[10px]","lg:text-xs","mb-1","tracking-wider"],[1,"flex-1","flex","flex-col","items-center","justify-center","py-2","lg:py-0"],[1,"text-6xl","lg:text-6xl","xl:text-7xl","font-black","text-slate-800","leading-none","tracking-tighter"],[1,"text-slate-500","font-bold","text-xs","uppercase","tracking-widest","mt-1"],[1,"grid","grid-cols-2","gap-2","mt-2","text-center"],[1,"bg-gray-50","rounded","py-1","px-2","border","border-gray-100"],[1,"block","text-gray-400","text-[9px]","uppercase","font-bold"],[1,"font-bold","text-slate-700","text-sm"],[1,"bg-white","rounded-lg","shadow-sm","border","border-gray-200","flex-1","flex","flex-col","justify-center","px-3","py-2","min-h-[100px]","lg:min-h-0","relative"],[1,"font-bold","text-gray-400","uppercase","text-[10px]","tracking-wide","mb-2"],[1,"mb-2"],[1,"flex","justify-between","text-[10px]","font-bold","mb-0.5"],[1,"text-slate-600"],[1,"text-slate-800"],[1,"w-full","bg-gray-100","rounded-full","h-1.5","overflow-hidden"],[1,"h-1.5","rounded-full"],[1,"bg-slate-50","border-b","border-gray-200","px-4","py-2","flex","justify-between","items-center","shrink-0","h-[40px]","lg:h-[12%]"],[1,"font-bold","uppercase","tracking-wide","text-xs","md:text-sm","text-slate-700","flex","items-center","gap-2"],[1,"bg-white","border","border-gray-200","text-gray-500","px-2","py-0.5","rounded","text-[10px]","font-bold","tracking-wider"],[1,"flex-1","w-full","min-h-0","relative","p-3","h-[calc(100%-40px)]","lg:h-[88%]"],["xKey","day","barDataKey","real","lineDataKey","planned","barLabel","Cargados","lineLabel","Plan","barColor","#334155","lineColor","#000000",3,"data","autoScroll","windowSize","performanceMode"],[1,"bg-gray-50","border-b","border-gray-200","px-4","py-2","shrink-0"],[1,"font-bold","text-gray-500","uppercase","text-[10px]","md:text-xs","tracking-wide","truncate"],[1,"flex-1","overflow-auto","min-h-0","px-2"],[1,"w-full","text-[10px]","xl:text-xs","text-left"],[1,"sticky","top-0","bg-white","border-b","border-gray-100","text-gray-400","font-medium"],[1,"py-2","pl-2"],[1,"py-2","text-center"],[1,"py-2"],[1,"divide-y","divide-gray-50"],[1,"group","hover:bg-gray-50","transition-colors"],[1,"py-2","pl-2","font-bold","text-slate-600"],[1,"py-2","text-center","font-bold","text-slate-800","bg-gray-50","rounded"],[1,"py-2","truncate","max-w-[50px]","text-gray-500","pl-1",3,"title"],[1,"py-2","flex","justify-center"],[1,"w-2","h-2","rounded-full"],[1,"flex","justify-between","items-center","border-b","border-gray-200","px-4","py-2","shrink-0","h-[40px]","lg:h-[12%]","bg-slate-50"],[1,"font-bold","text-slate-700","uppercase","text-[10px]","md:text-xs","tracking-wide"],[1,"text-[9px]","text-white","font-bold","bg-slate-600","px-2","py-0.5","rounded-full"],[1,"flex-1","min-h-0","w-full","relative","h-[calc(100%-40px)]","lg:h-[88%]","p-3"],["xKey","day","barDataKey","real","lineDataKey","goal","valueFormat","time","barColor","#94a3b8","barLabel","Real","lineLabel","Meta","lineColor","#334155",3,"data","autoScroll","windowSize","performanceMode","lowerIsBetter"],[1,"flex-1","p-3","border-b","border-gray-100","min-h-0","flex","flex-col","bg-gray-50"],[1,"font-bold","text-gray-500","uppercase","mb-1","text-[10px]","xl:text-xs","shrink-0","tracking-wide"],[1,"flex-1","flex","flex-col","justify-center"],[1,"w-full","text-[10px]","xl:text-xs"],[1,"divide-y","divide-gray-200"],[1,"py-2","text-slate-600","font-medium"],[1,"py-2","text-right","text-rose-600","font-bold"],[1,"py-2","text-right","text-amber-600","font-bold"],[1,"flex-1","p-3","min-h-0","flex","flex-col"],[1,"flex-1","overflow-auto"],[1,"w-full","text-[9px]","xl:text-xs","text-left"],[1,"text-gray-400","font-medium"],[1,"py-1"],[1,"py-1","text-right"],[1,"py-1.5","font-bold","text-slate-600","truncate","max-w-[50px]"],[1,"py-1.5","text-right","font-bold"],[1,"py-1.5","text-right","text-gray-400"],[1,"flex","items-center","justify-between","px-6","py-2","border-b","border-gray-100","bg-gray-50","shrink-0","h-[22%]"],[1,"flex","flex-col","justify-center"],[1,"text-lg","lg:text-2xl","font-black","text-slate-800","uppercase","tracking-tight","leading-none"],[1,"text-[10px]","lg:text-xs","font-bold","text-gray-400","tracking-wider","mt-1","uppercase"],[1,"flex","items-center","gap-6","flex-1","justify-end","max-w-xl"],[1,"flex-1","bg-gray-200","h-6","rounded-full","overflow-hidden","relative","shadow-inner"],[1,"h-full","rounded-full","transition-all","duration-1000","ease-out"],[1,"absolute","inset-0","flex","items-center","justify-center","text-xs","font-black","text-slate-700","mix-blend-multiply"],[1,"flex","flex-col","items-end","justify-center"],[1,"text-[10px]","text-gray-400","font-medium"],[1,"text-xl","lg:text-2xl","font-black","uppercase","tracking-tight","leading-none"],[1,"flex-1","overflow-hidden","bg-white","px-6","py-1"],[1,"w-full","text-left","border-collapse","h-full"],[1,"text-[10px]","uppercase","text-gray-400","font-bold","tracking-wider","border-b","border-gray-100","h-[30px]"],[1,"py-1","w-[40%]","align-middle"],[1,"py-1","text-right","align-middle"],[1,"py-1","text-center","text-[9px]","w-[20%]","align-middle"],[1,"py-1","text-center","align-middle"],[1,"text-xs","lg:text-sm","font-medium","text-slate-600","divide-y","divide-gray-50"],[1,"group","hover:bg-slate-50","transition-colors"],[1,"h-[15%]","bg-gray-50","border-t","border-gray-100","flex","items-center","justify-between","px-6","py-2","shrink-0"],[1,"text-[10px]","text-gray-500","italic","max-w-[50%]","border-l-2","border-gray-300","pl-3"],[1,"flex","items-center","gap-3","bg-gradient-to-br","from-amber-50","to-yellow-100","border","border-amber-300","shadow-sm","rounded-lg","px-4","py-1.5","relative","overflow-hidden","group","hover:shadow-md","transition-shadow"],[1,"absolute","inset-0","bg-white/30","translate-x-[-100%]","group-hover:translate-x-[100%]","transition-transform","duration-1000","skew-x-12"],[1,"w-8","h-8","rounded-full","bg-amber-100","border","border-amber-200","flex","items-center","justify-center","shrink-0","text-amber-500"],["xmlns","http://www.w3.org/2000/svg","width","18","height","18","viewBox","0 0 24 24","fill","currentColor"],["d","M5 2H2v6a2 2 0 0 0 2 2h2a2 2 0 0 0 2-2V2H5zm14 0h-3v6a2 2 0 0 0 2 2h2a2 2 0 0 0 2-2V2h-3zM7 2h10v2H7V2zm3.5 12a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7z"],["d","M12 15a4 4 0 1 0 0-8 4 4 0 0 0 0 8zm-2 1v2H8v2h8v-2h-2v-2h-2z"],[1,"flex","flex-col","items-end","z-10"],[1,"text-[9px]","uppercase","font-black","text-amber-600","tracking-widest"],[1,"text-sm","font-black","text-slate-800","leading-none"],[1,"bg-amber-400","text-amber-900","font-bold","text-xs","px-2","py-0.5","rounded","shadow-sm","z-10","border","border-amber-500"],[1,"py-1","font-bold","text-slate-700","pr-2","truncate","max-w-[200px]","align-middle",3,"title"],[1,"py-1","text-right","font-black","text-slate-800","text-sm","align-middle"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"py-1","text-center","text-xs","font-mono","text-gray-500","align-middle"],[1,"opacity-75"],[1,"mx-1","text-gray-300","font-bold"],[1,"font-bold","text-slate-600"],[1,"py-1","text-center","font-bold","text-gray-400","text-xs","align-middle"],[1,"px-2","py-0.5","rounded","text-[10px]","font-bold","uppercase","tracking-wide","inline-block","w-[90px]","text-center"],[1,"bg-slate-900","text-white","px-4","py-3","flex","justify-between","items-center","shrink-0","border-b-2","border-coke-red"],[1,"font-semibold","tracking-wide","text-xs","md:text-sm","text-gray-100","uppercase"],[1,"flex-1","w-full","min-h-0","p-0","flex","flex-col","overflow-auto","bg-white"],[1,"w-full","text-[11px]","md:text-xs","text-left","border-collapse","h-full","min-w-[320px]"],[1,"bg-white","text-gray-500","border-b","border-gray-200","shrink-0"],[1,"uppercase","text-[9px]","md:text-[10px]","font-semibold","tracking-wider"],[1,"py-3","pl-4","text-left"],[1,"py-3","text-right"],[1,"block","text-[8px]","text-gray-400","font-normal","normal-case"],[1,"py-3","text-right","hidden","sm:table-cell"],[1,"py-3","text-right","pr-4","w-[25%]"],[1,"divide-y","divide-gray-100"],[1,"hover:bg-slate-50","transition-colors","h-1/4"],[1,"py-2","pl-4","text-slate-700","font-bold","text-xs","lg:text-sm"],[1,"py-2","text-right","font-mono","text-slate-600","font-medium"],[1,"inline-block","w-2","h-2","rounded-full","ml-1"],[1,"py-2","text-right","text-slate-500","hidden","sm:table-cell","font-mono","text-xs"],[1,"py-2","pr-4","relative","align-middle","text-right"],[1,"absolute","right-4","top-3","bottom-3","bg-slate-100","rounded","w-full","max-w-[80px]","ml-auto","overflow-hidden"],[1,"h-full","bg-slate-300","rounded"],[1,"relative","z-10","font-bold","text-slate-800","text-xs"]],template:function(n,r){n&1&&(v(0,"div",1)(1,"header",2),Y(2,"div",3),v(3,"div",4)(4,"div",5),D(5," KOF "),E(),v(6,"div",6)(7,"h1",7),D(8," Resultados "),v(9,"span",8),D(10),He(11,"date"),E()(),v(12,"div",9),Y(13,"span",10),v(14,"p",11),D(15,"Planta Central \u2022 En Vivo"),E()()()(),v(16,"div",12)(17,"div",13),D(18),He(19,"date"),E(),v(20,"div",14),D(21),He(22,"date"),E(),v(23,"button",15),me("click",function(){return r.forceGlobalSync()}),D(24," \u{1F504} SYNC "),E()()(),v(25,"main",16)(26,"div",17),Qt(27,Dk,7,1,null,null,K1),E()(),v(29,"footer",18)(30,"div",19)(31,"span",20),Y(32,"span",21),D(33," AVISOS "),E()(),v(34,"div",22)(35,"span",23),D(36),E()()()()),n&2&&(xe("eco-mode",r.store.performanceMode()==="eco"),T(10),ye(gt(11,6,r.store.lastUpdate(),"MMM yyyy")),T(8),_e(" ",gt(19,9,r.store.lastUpdate(),"HH:mm")," "),T(3),_e(" ",gt(22,12,r.store.lastUpdate(),"EEEE, d MMM")," "),T(6),Zt(r.store.layout()),T(9),ye(r.store.announcement()))},dependencies:[tn,Vh,Ru,Hh,Gh,Bh],styles:[".eco-mode[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{box-shadow:none!important;text-shadow:none!important;backdrop-filter:none!important;background-image:none!important;-webkit-backdrop-filter:none!important;transition:none!important}.eco-mode[_ngcontent-%COMP%]   .shadow-sm[_ngcontent-%COMP%], .eco-mode[_ngcontent-%COMP%]   .shadow-md[_ngcontent-%COMP%], .eco-mode[_ngcontent-%COMP%]   .shadow-lg[_ngcontent-%COMP%], .eco-mode[_ngcontent-%COMP%]   .shadow-xl[_ngcontent-%COMP%]{border:1px solid #d1d5db!important}.eco-mode[_ngcontent-%COMP%]   .animate-pulse[_ngcontent-%COMP%], .eco-mode[_ngcontent-%COMP%]   .animate-bounce[_ngcontent-%COMP%], .eco-mode[_ngcontent-%COMP%]   .animate-pulse-soft[_ngcontent-%COMP%], .eco-mode[_ngcontent-%COMP%]   .animate-fade-in[_ngcontent-%COMP%]{animation:none!important}"]})}};var gI=(()=>{class t{_renderer;_elementRef;onChange=n=>{};onTouched=()=>{};constructor(n,r){this._renderer=n,this._elementRef=r}setProperty(n,r){this._renderer.setProperty(this._elementRef.nativeElement,n,r)}registerOnTouched(n){this.onTouched=n}registerOnChange(n){this.onChange=n}setDisabledState(n){this.setProperty("disabled",n)}static \u0275fac=function(r){return new(r||t)(ae(wo),ae(Jt))};static \u0275dir=Kt({type:t})}return t})(),yI=(()=>{class t extends gI{static \u0275fac=(()=>{let n;return function(o){return(n||(n=cl(t)))(o||t)}})();static \u0275dir=Kt({type:t,features:[Wn]})}return t})(),jm=new B("");var Ik={provide:jm,useExisting:On(()=>Vu),multi:!0};function wk(){let t=Yn()?Yn().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var Tk=new B(""),Vu=(()=>{class t extends gI{_compositionMode;_composing=!1;constructor(n,r,o){super(n,r),this._compositionMode=o,this._compositionMode==null&&(this._compositionMode=!wk())}writeValue(n){let r=n??"";this.setProperty("value",r)}_handleInput(n){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(n)}_compositionStart(){this._composing=!0}_compositionEnd(n){this._composing=!1,this._compositionMode&&this.onChange(n)}static \u0275fac=function(r){return new(r||t)(ae(wo),ae(Jt),ae(Tk,8))};static \u0275dir=Kt({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,o){r&1&&me("input",function(s){return o._handleInput(s.target.value)})("blur",function(){return o.onTouched()})("compositionstart",function(){return o._compositionStart()})("compositionend",function(s){return o._compositionEnd(s.target.value)})},standalone:!1,features:[Ki([Ik]),Wn]})}return t})();var Sk=new B(""),bk=new B("");function _I(t){return t!=null}function vI(t){return So(t)?Yc(t):t}function EI(t){let e={};return t.forEach(n=>{e=n!=null?x(x({},e),n):e}),Object.keys(e).length===0?null:e}function CI(t,e){return e.map(n=>n(t))}function Ak(t){return!t.validate}function DI(t){return t.map(e=>Ak(e)?e:n=>e.validate(n))}function Mk(t){if(!t)return null;let e=t.filter(_I);return e.length==0?null:function(n){return EI(CI(n,e))}}function II(t){return t!=null?Mk(DI(t)):null}function xk(t){if(!t)return null;let e=t.filter(_I);return e.length==0?null:function(n){let r=CI(n,e).map(vI);return Jc(r).pipe(lr(EI))}}function wI(t){return t!=null?xk(DI(t)):null}function uI(t,e){return t===null?[e]:Array.isArray(t)?[...t,e]:[t,e]}function Nk(t){return t._rawValidators}function Rk(t){return t._rawAsyncValidators}function Gm(t){return t?Array.isArray(t)?t:[t]:[]}function Fu(t,e){return Array.isArray(t)?t.includes(e):t===e}function cI(t,e){let n=Gm(e);return Gm(t).forEach(o=>{Fu(n,o)||n.push(o)}),n}function dI(t,e){return Gm(e).filter(n=>!Fu(t,n))}var Ou=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=II(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=wI(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,n){return this.control?this.control.hasError(e,n):!1}getError(e,n){return this.control?this.control.getError(e,n):null}},$m=class extends Ou{name;get formDirective(){return null}get path(){return null}},Ws=class extends Ou{_parent=null;name=null;valueAccessor=null},qm=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}};var TI=(()=>{class t extends qm{constructor(n){super(n)}static \u0275fac=function(r){return new(r||t)(ae(Ws,2))};static \u0275dir=Kt({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,o){r&2&&xe("ng-untouched",o.isUntouched)("ng-touched",o.isTouched)("ng-pristine",o.isPristine)("ng-dirty",o.isDirty)("ng-valid",o.isValid)("ng-invalid",o.isInvalid)("ng-pending",o.isPending)},standalone:!1,features:[Wn]})}return t})();var Hs="VALID",ku="INVALID",jo="PENDING",Gs="DISABLED",$r=class{},Lu=class extends $r{value;source;constructor(e,n){super(),this.value=e,this.source=n}},$s=class extends $r{pristine;source;constructor(e,n){super(),this.pristine=e,this.source=n}},qs=class extends $r{touched;source;constructor(e,n){super(),this.touched=e,this.source=n}},Yo=class extends $r{status;source;constructor(e,n){super(),this.status=e,this.source=n}};var Wm=class extends $r{source;constructor(e){super(),this.source=e}};function Pk(t){return(Uu(t)?t.validators:t)||null}function kk(t){return Array.isArray(t)?II(t):t||null}function Fk(t,e){return(Uu(e)?e.asyncValidators:t)||null}function Ok(t){return Array.isArray(t)?wI(t):t||null}function Uu(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}var zm=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,n){this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return zt(this.statusReactive)}set status(e){zt(()=>this.statusReactive.set(e))}_status=jn(()=>this.statusReactive());statusReactive=oe(void 0);get valid(){return this.status===Hs}get invalid(){return this.status===ku}get pending(){return this.status==jo}get disabled(){return this.status===Gs}get enabled(){return this.status!==Gs}errors;get pristine(){return zt(this.pristineReactive)}set pristine(e){zt(()=>this.pristineReactive.set(e))}_pristine=jn(()=>this.pristineReactive());pristineReactive=oe(!0);get dirty(){return!this.pristine}get touched(){return zt(this.touchedReactive)}set touched(e){zt(()=>this.touchedReactive.set(e))}_touched=jn(()=>this.touchedReactive());touchedReactive=oe(!1);get untouched(){return!this.touched}_events=new Ct;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(cI(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(cI(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(dI(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(dI(e,this._rawAsyncValidators))}hasValidator(e){return Fu(this._rawValidators,e)}hasAsyncValidator(e){return Fu(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let n=this.touched===!1;this.touched=!0;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(W(x({},e),{sourceControl:r})),n&&e.emitEvent!==!1&&this._events.next(new qs(!0,r))}markAllAsDirty(e={}){this.markAsDirty({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(n=>n.markAllAsDirty(e))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(n=>n.markAllAsTouched(e))}markAsUntouched(e={}){let n=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=e.sourceControl??this;this._forEachChild(o=>{o.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:r})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,r),n&&e.emitEvent!==!1&&this._events.next(new qs(!1,r))}markAsDirty(e={}){let n=this.pristine===!0;this.pristine=!1;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(W(x({},e),{sourceControl:r})),n&&e.emitEvent!==!1&&this._events.next(new $s(!1,r))}markAsPristine(e={}){let n=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=e.sourceControl??this;this._forEachChild(o=>{o.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,r),n&&e.emitEvent!==!1&&this._events.next(new $s(!0,r))}markAsPending(e={}){this.status=jo;let n=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Yo(this.status,n)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(W(x({},e),{sourceControl:n}))}disable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=Gs,this.errors=null,this._forEachChild(o=>{o.disable(W(x({},e),{onlySelf:!0}))}),this._updateValue();let r=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Lu(this.value,r)),this._events.next(new Yo(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(W(x({},e),{skipPristineCheck:n}),this),this._onDisabledChange.forEach(o=>o(!0))}enable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=Hs,this._forEachChild(r=>{r.enable(W(x({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(W(x({},e),{skipPristineCheck:n}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e,n){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},n),this._parent._updateTouched({},n))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Hs||this.status===jo)&&this._runAsyncValidator(r,e.emitEvent)}let n=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Lu(this.value,n)),this._events.next(new Yo(this.status,n)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(W(x({},e),{sourceControl:n}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Gs:Hs}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,n){if(this.asyncValidator){this.status=jo,this._hasOwnPendingAsyncValidator={emitEvent:n!==!1,shouldHaveEmitted:e!==!1};let r=vI(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(o=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(o,{emitEvent:n,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(n.emitEvent!==!1,this,n.shouldHaveEmitted)}get(e){let n=e;return n==null||(Array.isArray(n)||(n=n.split(".")),n.length===0)?null:n.reduce((r,o)=>r&&r._find(o),this)}getError(e,n){let r=n?this.get(n):this;return r&&r.errors?r.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,n,r){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||r)&&this._events.next(new Yo(this.status,n)),this._parent&&this._parent._updateControlsErrors(e,n,r)}_initObservables(){this.valueChanges=new ot,this.statusChanges=new ot}_calculateStatus(){return this._allControlsDisabled()?Gs:this.errors?ku:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(jo)?jo:this._anyControlsHaveStatus(ku)?ku:Hs}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,n){let r=!this._anyControlsDirty(),o=this.pristine!==r;this.pristine=r,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,n),o&&this._events.next(new $s(this.pristine,n))}_updateTouched(e={},n){this.touched=this._anyControlsTouched(),this._events.next(new qs(this.touched,n)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,n)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Uu(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let n=this._parent&&this._parent.dirty;return!e&&!!n&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=kk(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=Ok(this._rawAsyncValidators)}};var SI=new B("",{factory:()=>Ym}),Ym="always";function Lk(t,e){return[...e.path,t]}function Vk(t,e,n=Ym){Bk(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||n==="always")&&e.valueAccessor.setDisabledState?.(t.disabled),Hk(t,e),$k(t,e),Gk(t,e),Uk(t,e)}function fI(t,e){t.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function Uk(t,e){if(e.valueAccessor.setDisabledState){let n=r=>{e.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}function Bk(t,e){let n=Nk(t);e.validator!==null?t.setValidators(uI(n,e.validator)):typeof n=="function"&&t.setValidators([n]);let r=Rk(t);e.asyncValidator!==null?t.setAsyncValidators(uI(r,e.asyncValidator)):typeof r=="function"&&t.setAsyncValidators([r]);let o=()=>t.updateValueAndValidity();fI(e._rawValidators,o),fI(e._rawAsyncValidators,o)}function Hk(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&bI(t,e)})}function Gk(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&bI(t,e),t.updateOn!=="submit"&&t.markAsTouched()})}function bI(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function $k(t,e){let n=(r,o)=>{e.valueAccessor.writeValue(r),o&&e.viewToModelUpdate(r)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}function qk(t,e){if(!t.hasOwnProperty("model"))return!1;let n=t.model;return n.isFirstChange()?!0:!Object.is(e,n.currentValue)}function Wk(t){return Object.getPrototypeOf(t.constructor)===yI}function zk(t,e){if(!e)return null;Array.isArray(e);let n,r,o;return e.forEach(i=>{i.constructor===Vu?n=i:Wk(i)?r=i:o=i}),o||r||n||null}function hI(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function pI(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var jk=class extends zm{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,n,r){super(Pk(n),Fk(r,n)),this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Uu(n)&&(n.nonNullable||n.initialValueIsDefault)&&(pI(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&n.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,n.emitViewToModelChange!==!1)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),n.overwriteDefaultValue&&(this.defaultValue=this.value),this._pendingChange=!1,n?.emitEvent!==!1&&this._events.next(new Wm(this))}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){hI(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){hI(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){pI(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var Yk={provide:Ws,useExisting:On(()=>Jm)},mI=Promise.resolve(),Jm=(()=>{class t extends Ws{_changeDetectorRef;callSetDisabledState;control=new jk;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new ot;constructor(n,r,o,i,s,a){super(),this._changeDetectorRef=s,this.callSetDisabledState=a,this._parent=n,this._setValidators(r),this._setAsyncValidators(o),this.valueAccessor=zk(this,i)}ngOnChanges(n){if(this._checkForErrors(),!this._registered||"name"in n){if(this._registered&&(this._checkName(),this.formDirective)){let r=n.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in n&&this._updateDisabled(n),qk(n,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){Vk(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(n){mI.then(()=>{this.control.setValue(n,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(n){let r=n.isDisabled.currentValue,o=r!==0&&xh(r);mI.then(()=>{o&&!this.control.disabled?this.control.disable():!o&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(n){return this._parent?Lk(n,this._parent):[n]}static \u0275fac=function(r){return new(r||t)(ae($m,9),ae(Sk,10),ae(bk,10),ae(jm,10),ae(Al,8),ae(SI,8))};static \u0275dir=Kt({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[Ki([Yk]),Wn,Gi]})}return t})();var Jk={provide:jm,useExisting:On(()=>Km),multi:!0},Km=(()=>{class t extends yI{writeValue(n){let r=n??"";this.setProperty("value",r)}registerOnChange(n){this.onChange=r=>{n(r==""?null:parseFloat(r))}}static \u0275fac=(()=>{let n;return function(o){return(n||(n=cl(t)))(o||t)}})();static \u0275dir=Kt({type:t,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(r,o){r&1&&me("input",function(s){return o.onChange(s.target.value)})("blur",function(){return o.onTouched()})},standalone:!1,features:[Ki([Jk]),Wn]})}return t})();var Kk=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Mr({type:t});static \u0275inj=Ln({})}return t})();var AI=(()=>{class t{static withConfig(n){return{ngModule:t,providers:[{provide:SI,useValue:n.callSetDisabledState??Ym}]}}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Mr({type:t});static \u0275inj=Ln({imports:[Kk]})}return t})();var Zk,Xk;function eF(){return{geminiUrl:Zk,vertexUrl:Xk}}function tF(t,e,n,r){var o,i;if(!t?.baseUrl){let s=eF();return e?(o=s.vertexUrl)!==null&&o!==void 0?o:n:(i=s.geminiUrl)!==null&&i!==void 0?i:r}return t.baseUrl}var Ft=class{};function M(t,e){let n=/\{([^}]+)\}/g;return t.replace(n,(r,o)=>{if(Object.prototype.hasOwnProperty.call(e,o)){let i=e[o];return i!=null?String(i):""}else throw new Error(`Key '${o}' not found in valueMap.`)})}function d(t,e,n){for(let i=0;i<e.length-1;i++){let s=e[i];if(s.endsWith("[]")){let a=s.slice(0,-2);if(!(a in t))if(Array.isArray(n))t[a]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${s}`);if(Array.isArray(t[a])){let l=t[a];if(Array.isArray(n))for(let c=0;c<l.length;c++){let f=l[c];d(f,e.slice(i+1),n[c])}else for(let c of l)d(c,e.slice(i+1),n)}return}else if(s.endsWith("[0]")){let a=s.slice(0,-3);a in t||(t[a]=[{}]);let l=t[a];d(l[0],e.slice(i+1),n);return}(!t[s]||typeof t[s]!="object")&&(t[s]={}),t=t[s]}let r=e[e.length-1],o=t[r];if(o!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===o)return;if(typeof o=="object"&&typeof n=="object"&&o!==null&&n!==null)Object.assign(o,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else r==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(t,n):t[r]=n}function u(t,e,n=void 0){try{if(e.length===1&&e[0]==="_self")return t;for(let r=0;r<e.length;r++){if(typeof t!="object"||t===null)return n;let o=e[r];if(o.endsWith("[]")){let i=o.slice(0,-2);if(i in t){let s=t[i];return Array.isArray(s)?s.map(a=>u(a,e.slice(r+1),n)):n}else return n}else t=t[o]}return t}catch(r){if(r instanceof TypeError)return n;throw r}}function nF(t,e){for(let[n,r]of Object.entries(e)){let o=n.split("."),i=r.split("."),s=new Set,a=-1;for(let l=0;l<o.length;l++)if(o[l]==="*"){a=l;break}if(a!==-1&&i.length>a)for(let l=a;l<i.length;l++){let c=i[l];c!=="*"&&!c.endsWith("[]")&&!c.endsWith("[0]")&&s.add(c)}Xm(t,o,i,0,s)}}function Xm(t,e,n,r,o){if(r>=e.length||typeof t!="object"||t===null)return;let i=e[r];if(i.endsWith("[]")){let s=i.slice(0,-2),a=t;if(s in a&&Array.isArray(a[s]))for(let l of a[s])Xm(l,e,n,r+1,o)}else if(i==="*"){if(typeof t=="object"&&t!==null&&!Array.isArray(t)){let s=t,a=Object.keys(s).filter(c=>!c.startsWith("_")&&!o.has(c)),l={};for(let c of a)l[c]=s[c];for(let[c,f]of Object.entries(l)){let h=[];for(let p of n.slice(r))p==="*"?h.push(c):h.push(p);d(s,h,f)}for(let c of a)delete s[c]}}else{let s=t;i in s&&Xm(s[i],e,n,r+1,o)}}function Qg(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}function rF(t){let e={},n=u(t,["operationName"]);n!=null&&d(e,["operationName"],n);let r=u(t,["resourceName"]);return r!=null&&d(e,["_url","resourceName"],r),e}function oF(t){let e={},n=u(t,["name"]);n!=null&&d(e,["name"],n);let r=u(t,["metadata"]);r!=null&&d(e,["metadata"],r);let o=u(t,["done"]);o!=null&&d(e,["done"],o);let i=u(t,["error"]);i!=null&&d(e,["error"],i);let s=u(t,["response","generateVideoResponse"]);return s!=null&&d(e,["response"],sF(s)),e}function iF(t){let e={},n=u(t,["name"]);n!=null&&d(e,["name"],n);let r=u(t,["metadata"]);r!=null&&d(e,["metadata"],r);let o=u(t,["done"]);o!=null&&d(e,["done"],o);let i=u(t,["error"]);i!=null&&d(e,["error"],i);let s=u(t,["response"]);return s!=null&&d(e,["response"],aF(s)),e}function sF(t){let e={},n=u(t,["generatedSamples"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>lF(s))),d(e,["generatedVideos"],i)}let r=u(t,["raiMediaFilteredCount"]);r!=null&&d(e,["raiMediaFilteredCount"],r);let o=u(t,["raiMediaFilteredReasons"]);return o!=null&&d(e,["raiMediaFilteredReasons"],o),e}function aF(t){let e={},n=u(t,["videos"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>uF(s))),d(e,["generatedVideos"],i)}let r=u(t,["raiMediaFilteredCount"]);r!=null&&d(e,["raiMediaFilteredCount"],r);let o=u(t,["raiMediaFilteredReasons"]);return o!=null&&d(e,["raiMediaFilteredReasons"],o),e}function lF(t){let e={},n=u(t,["video"]);return n!=null&&d(e,["video"],mF(n)),e}function uF(t){let e={},n=u(t,["_self"]);return n!=null&&d(e,["video"],gF(n)),e}function cF(t){let e={},n=u(t,["operationName"]);return n!=null&&d(e,["_url","operationName"],n),e}function dF(t){let e={},n=u(t,["operationName"]);return n!=null&&d(e,["_url","operationName"],n),e}function fF(t){let e={},n=u(t,["name"]);n!=null&&d(e,["name"],n);let r=u(t,["metadata"]);r!=null&&d(e,["metadata"],r);let o=u(t,["done"]);o!=null&&d(e,["done"],o);let i=u(t,["error"]);i!=null&&d(e,["error"],i);let s=u(t,["response"]);return s!=null&&d(e,["response"],hF(s)),e}function hF(t){let e={},n=u(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);let r=u(t,["parent"]);r!=null&&d(e,["parent"],r);let o=u(t,["documentName"]);return o!=null&&d(e,["documentName"],o),e}function ew(t){let e={},n=u(t,["name"]);n!=null&&d(e,["name"],n);let r=u(t,["metadata"]);r!=null&&d(e,["metadata"],r);let o=u(t,["done"]);o!=null&&d(e,["done"],o);let i=u(t,["error"]);i!=null&&d(e,["error"],i);let s=u(t,["response"]);return s!=null&&d(e,["response"],pF(s)),e}function pF(t){let e={},n=u(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);let r=u(t,["parent"]);r!=null&&d(e,["parent"],r);let o=u(t,["documentName"]);return o!=null&&d(e,["documentName"],o),e}function mF(t){let e={},n=u(t,["uri"]);n!=null&&d(e,["uri"],n);let r=u(t,["encodedVideo"]);r!=null&&d(e,["videoBytes"],Qg(r));let o=u(t,["encoding"]);return o!=null&&d(e,["mimeType"],o),e}function gF(t){let e={},n=u(t,["gcsUri"]);n!=null&&d(e,["uri"],n);let r=u(t,["bytesBase64Encoded"]);r!=null&&d(e,["videoBytes"],Qg(r));let o=u(t,["mimeType"]);return o!=null&&d(e,["mimeType"],o),e}var zr=(function(t){return t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL",t})(zr||{});var eg=(function(t){return t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO",t})(eg||{});var tw=(function(t){return t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED",t})(tw||{});var nw=(function(t){return t.COLLECTION="COLLECTION",t})(nw||{});var js=(function(t){return t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT",t})(js||{});var Js=class{constructor(e){let n={};for(let r of e.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}};var Wr=class{get text(){var e,n,r,o,i,s,a,l;if(((o=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let c="",f=!1,h=[];for(let p of(l=(a=(s=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(let[m,g]of Object.entries(p))m!=="text"&&m!=="thought"&&m!=="thoughtSignature"&&(g!==null||g!==void 0)&&h.push(m);if(typeof p.text=="string"){if(typeof p.thought=="boolean"&&p.thought)continue;f=!0,c+=p.text}}return h.length>0&&console.warn(`there are non-text parts ${h} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),f?c:void 0}get data(){var e,n,r,o,i,s,a,l;if(((o=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let c="",f=[];for(let h of(l=(a=(s=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(let[p,m]of Object.entries(h))p!=="inlineData"&&(m!==null||m!==void 0)&&f.push(p);h.inlineData&&typeof h.inlineData.data=="string"&&(c+=atob(h.inlineData.data))}return f.length>0&&console.warn(`there are non-data parts ${f} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),c.length>0?btoa(c):void 0}get functionCalls(){var e,n,r,o,i,s,a,l;if(((o=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");let c=(l=(a=(s=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(f=>f.functionCall).map(f=>f.functionCall).filter(f=>f!==void 0);if(c?.length!==0)return c}get executableCode(){var e,n,r,o,i,s,a,l,c;if(((o=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");let f=(l=(a=(s=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(h=>h.executableCode).map(h=>h.executableCode).filter(h=>h!==void 0);if(f?.length!==0)return(c=f?.[0])===null||c===void 0?void 0:c.code}get codeExecutionResult(){var e,n,r,o,i,s,a,l,c;if(((o=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");let f=(l=(a=(s=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(h=>h.codeExecutionResult).map(h=>h.codeExecutionResult).filter(h=>h!==void 0);if(f?.length!==0)return(c=f?.[0])===null||c===void 0?void 0:c.output}},ju=class{},Yu=class{},tg=class{},ng=class{},rg=class{},og=class{},Ju=class{},Ku=class{},Qu=class{},ig=class{};var Zu=class t{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){let r=new t,o,i=e;return n?o=iF(i):o=oF(i),Object.assign(r,o),r}},Xu=class{},ec=class{},tc=class{},nc=class{},sg=class{},ag=class{},lg=class{};var ug=class t{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){let r=new t,i=fF(e);return Object.assign(r,i),r}},cg=class{},dg=class{},fg=class{};var rc=class{};var hg=class{get text(){var e,n,r;let o="",i=!1,s=[];for(let a of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(let[l,c]of Object.entries(a))l!=="text"&&l!=="thought"&&c!==null&&s.push(l);if(typeof a.text=="string"){if(typeof a.thought=="boolean"&&a.thought)continue;i=!0,o+=a.text}}return s.length>0&&console.warn(`there are non-text parts ${s} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),i?o:void 0}get data(){var e,n,r;let o="",i=[];for(let s of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(let[a,l]of Object.entries(s))a!=="inlineData"&&l!==null&&i.push(a);s.inlineData&&typeof s.inlineData.data=="string"&&(o+=atob(s.inlineData.data))}return i.length>0&&console.warn(`there are non-data parts ${i} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),o.length>0?btoa(o):void 0}};var pg=class{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}};var mg=class t{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){let r=new t,i=ew(e);return Object.assign(r,i),r}};function Z(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){let n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function rw(t,e){let n=Z(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function ow(t){return Array.isArray(t)?t.map(e=>oc(e)):[oc(t)]}function oc(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function iw(t){let e=oc(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function sw(t){let e=oc(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function MI(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function aw(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>MI(e)):[MI(t)]}function gg(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function xI(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function NI(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function qe(t){if(t==null)throw new Error("ContentUnion is required");return gg(t)?t:{role:"user",parts:aw(t)}}function Zg(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{let r=qe(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){let n=qe(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>qe(n)):[qe(e)]}function vt(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(xI(t)||NI(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[qe(t)]}let e=[],n=[],r=gg(t[0]);for(let o of t){let i=gg(o);if(i!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(i)e.push(o);else{if(xI(o)||NI(o))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(o)}}return r||e.push({role:"user",parts:aw(n)}),e}function yF(t,e){t.includes("null")&&(e.nullable=!0);let n=t.filter(r=>r!=="null");if(n.length===1)e.type=Object.values(zr).includes(n[0].toUpperCase())?n[0].toUpperCase():zr.TYPE_UNSPECIFIED;else{e.anyOf=[];for(let r of n)e.anyOf.push({type:Object.values(zr).includes(r.toUpperCase())?r.toUpperCase():zr.TYPE_UNSPECIFIED})}}function Ko(t){let e={},n=["items"],r=["anyOf"],o=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");let i=t.anyOf;i!=null&&i.length==2&&(i[0].type==="null"?(e.nullable=!0,t=i[1]):i[1].type==="null"&&(e.nullable=!0,t=i[0])),t.type instanceof Array&&yF(t.type,e);for(let[s,a]of Object.entries(t))if(a!=null)if(s=="type"){if(a==="null")throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;e.type=Object.values(zr).includes(a.toUpperCase())?a.toUpperCase():zr.TYPE_UNSPECIFIED}else if(n.includes(s))e[s]=Ko(a);else if(r.includes(s)){let l=[];for(let c of a){if(c.type=="null"){e.nullable=!0;continue}l.push(Ko(c))}e[s]=l}else if(o.includes(s)){let l={};for(let[c,f]of Object.entries(a))l[c]=Ko(f);e[s]=l}else{if(s==="additionalProperties")continue;e[s]=a}return e}function Xg(t){return Ko(t)}function ey(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function ty(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function ei(t){if(t.functionDeclarations)for(let e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Ko(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Ko(e.response));return t}function ti(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");let e=[];for(let n of t)e.push(n);return e}function _F(t,e,n,r=1){let o=!e.startsWith(`${n}/`)&&e.split("/").length===r;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:o?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:o?`${n}/${e}`:e}function xn(t,e){if(typeof e!="string")throw new Error("name must be a string");return _F(t,e,"cachedContents")}function lw(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function nr(t){return Qg(t)}function vF(t){return t!=null&&typeof t=="object"&&"name"in t}function EF(t){return t!=null&&typeof t=="object"&&"video"in t}function CF(t){return t!=null&&typeof t=="object"&&"uri"in t}function uw(t){var e;let n;if(vF(t)&&(n=t.name),!(CF(t)&&(n=t.uri,n===void 0))&&!(EF(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){let o=n.split("files/")[1].match(/[a-z0-9]+/);if(o===null)throw new Error(`Could not extract file name from URI ${n}`);n=o[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function cw(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function dw(t){for(let e of["models","tunedModels","publisherModels"])if(DF(t,e))return t[e];return[]}function DF(t,e){return t!==null&&typeof t=="object"&&e in t}function IF(t,e={}){let n=t,r={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(r.responseJsonSchema=n.outputSchema),e.behavior&&(r.behavior=e.behavior),{functionDeclarations:[r]}}function wF(t,e={}){let n=[],r=new Set;for(let o of t){let i=o.name;if(r.has(i))throw new Error(`Duplicate function name ${i} found in MCP tools. Please ensure function names are unique.`);r.add(i);let s=IF(o,e);s.functionDeclarations&&n.push(...s.functionDeclarations)}return{functionDeclarations:n}}function fw(t,e){let n;if(typeof e=="string")if(t.isVertexAI())if(e.startsWith("gs://"))n={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))n={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))n={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:e}}else n=e;let r=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,o=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(t.isVertexAI()){if(o>0||r!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(r>0||o!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function TF(t){if(typeof t!="string")return t;let e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function hw(t){if(typeof t!="object"||t===null)return{};let e=t,n=e.inlinedResponses;if(typeof n!="object"||n===null)return t;let o=n.inlinedResponses;if(!Array.isArray(o)||o.length===0)return t;let i=!1;for(let s of o){if(typeof s!="object"||s===null)continue;let l=s.response;if(typeof l!="object"||l===null)continue;if(l.embedding!==void 0){i=!0;break}}return i&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),t}function ni(t,e){let n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function pw(t){let e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}function SF(t){let e={},n=u(t,["responsesFile"]);n!=null&&d(e,["fileName"],n);let r=u(t,["inlinedResponses","inlinedResponses"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>sO(s))),d(e,["inlinedResponses"],i)}let o=u(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(s=>s)),d(e,["inlinedEmbedContentResponses"],i)}return e}function bF(t){let e={},n=u(t,["predictionsFormat"]);n!=null&&d(e,["format"],n);let r=u(t,["gcsDestination","outputUriPrefix"]);r!=null&&d(e,["gcsUri"],r);let o=u(t,["bigqueryDestination","outputUri"]);return o!=null&&d(e,["bigqueryUri"],o),e}function AF(t){let e={},n=u(t,["format"]);n!=null&&d(e,["predictionsFormat"],n);let r=u(t,["gcsUri"]);r!=null&&d(e,["gcsDestination","outputUriPrefix"],r);let o=u(t,["bigqueryUri"]);if(o!=null&&d(e,["bigqueryDestination","outputUri"],o),u(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(u(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(u(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function Wu(t){let e={},n=u(t,["name"]);n!=null&&d(e,["name"],n);let r=u(t,["metadata","displayName"]);r!=null&&d(e,["displayName"],r);let o=u(t,["metadata","state"]);o!=null&&d(e,["state"],pw(o));let i=u(t,["metadata","createTime"]);i!=null&&d(e,["createTime"],i);let s=u(t,["metadata","endTime"]);s!=null&&d(e,["endTime"],s);let a=u(t,["metadata","updateTime"]);a!=null&&d(e,["updateTime"],a);let l=u(t,["metadata","model"]);l!=null&&d(e,["model"],l);let c=u(t,["metadata","output"]);return c!=null&&d(e,["dest"],SF(hw(c))),e}function yg(t){let e={},n=u(t,["name"]);n!=null&&d(e,["name"],n);let r=u(t,["displayName"]);r!=null&&d(e,["displayName"],r);let o=u(t,["state"]);o!=null&&d(e,["state"],pw(o));let i=u(t,["error"]);i!=null&&d(e,["error"],i);let s=u(t,["createTime"]);s!=null&&d(e,["createTime"],s);let a=u(t,["startTime"]);a!=null&&d(e,["startTime"],a);let l=u(t,["endTime"]);l!=null&&d(e,["endTime"],l);let c=u(t,["updateTime"]);c!=null&&d(e,["updateTime"],c);let f=u(t,["model"]);f!=null&&d(e,["model"],f);let h=u(t,["inputConfig"]);h!=null&&d(e,["src"],MF(h));let p=u(t,["outputConfig"]);p!=null&&d(e,["dest"],bF(hw(p)));let m=u(t,["completionStats"]);return m!=null&&d(e,["completionStats"],m),e}function MF(t){let e={},n=u(t,["instancesFormat"]);n!=null&&d(e,["format"],n);let r=u(t,["gcsSource","uris"]);r!=null&&d(e,["gcsUri"],r);let o=u(t,["bigquerySource","inputUri"]);return o!=null&&d(e,["bigqueryUri"],o),e}function xF(t,e){let n={};if(u(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(u(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(u(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");let r=u(e,["fileName"]);r!=null&&d(n,["fileName"],r);let o=u(e,["inlinedRequests"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(s=>iO(t,s))),d(n,["requests","requests"],i)}return n}function NF(t){let e={},n=u(t,["format"]);n!=null&&d(e,["instancesFormat"],n);let r=u(t,["gcsUri"]);r!=null&&d(e,["gcsSource","uris"],r);let o=u(t,["bigqueryUri"]);if(o!=null&&d(e,["bigquerySource","inputUri"],o),u(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(u(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function RF(t){let e={},n=u(t,["data"]);if(n!=null&&d(e,["data"],n),u(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let r=u(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function PF(t,e){let n={},r=u(e,["name"]);return r!=null&&d(n,["_url","name"],ni(t,r)),n}function kF(t,e){let n={},r=u(e,["name"]);return r!=null&&d(n,["_url","name"],ni(t,r)),n}function FF(t){let e={},n=u(t,["content"]);n!=null&&d(e,["content"],n);let r=u(t,["citationMetadata"]);r!=null&&d(e,["citationMetadata"],OF(r));let o=u(t,["tokenCount"]);o!=null&&d(e,["tokenCount"],o);let i=u(t,["finishReason"]);i!=null&&d(e,["finishReason"],i);let s=u(t,["avgLogprobs"]);s!=null&&d(e,["avgLogprobs"],s);let a=u(t,["groundingMetadata"]);a!=null&&d(e,["groundingMetadata"],a);let l=u(t,["index"]);l!=null&&d(e,["index"],l);let c=u(t,["logprobsResult"]);c!=null&&d(e,["logprobsResult"],c);let f=u(t,["safetyRatings"]);if(f!=null){let p=f;Array.isArray(p)&&(p=p.map(m=>m)),d(e,["safetyRatings"],p)}let h=u(t,["urlContextMetadata"]);return h!=null&&d(e,["urlContextMetadata"],h),e}function OF(t){let e={},n=u(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(o=>o)),d(e,["citations"],r)}return e}function mw(t){let e={},n=u(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>hO(i))),d(e,["parts"],o)}let r=u(t,["role"]);return r!=null&&d(e,["role"],r),e}function LF(t,e){let n={},r=u(t,["displayName"]);if(e!==void 0&&r!=null&&d(e,["batch","displayName"],r),u(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function VF(t,e){let n={},r=u(t,["displayName"]);e!==void 0&&r!=null&&d(e,["displayName"],r);let o=u(t,["dest"]);return e!==void 0&&o!=null&&d(e,["outputConfig"],AF(TF(o))),n}function RI(t,e){let n={},r=u(e,["model"]);r!=null&&d(n,["_url","model"],Z(t,r));let o=u(e,["src"]);o!=null&&d(n,["batch","inputConfig"],xF(t,fw(t,o)));let i=u(e,["config"]);return i!=null&&LF(i,n),n}function UF(t,e){let n={},r=u(e,["model"]);r!=null&&d(n,["model"],Z(t,r));let o=u(e,["src"]);o!=null&&d(n,["inputConfig"],NF(fw(t,o)));let i=u(e,["config"]);return i!=null&&VF(i,n),n}function BF(t,e){let n={},r=u(t,["displayName"]);return e!==void 0&&r!=null&&d(e,["batch","displayName"],r),n}function HF(t,e){let n={},r=u(e,["model"]);r!=null&&d(n,["_url","model"],Z(t,r));let o=u(e,["src"]);o!=null&&d(n,["batch","inputConfig"],YF(t,o));let i=u(e,["config"]);return i!=null&&BF(i,n),n}function GF(t,e){let n={},r=u(e,["name"]);return r!=null&&d(n,["_url","name"],ni(t,r)),n}function $F(t,e){let n={},r=u(e,["name"]);return r!=null&&d(n,["_url","name"],ni(t,r)),n}function qF(t){let e={},n=u(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);let r=u(t,["name"]);r!=null&&d(e,["name"],r);let o=u(t,["done"]);o!=null&&d(e,["done"],o);let i=u(t,["error"]);return i!=null&&d(e,["error"],i),e}function WF(t){let e={},n=u(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);let r=u(t,["name"]);r!=null&&d(e,["name"],r);let o=u(t,["done"]);o!=null&&d(e,["done"],o);let i=u(t,["error"]);return i!=null&&d(e,["error"],i),e}function zF(t,e){let n={},r=u(e,["contents"]);if(r!=null){let i=Zg(t,r);Array.isArray(i)&&(i=i.map(s=>s)),d(n,["requests[]","request","content"],i)}let o=u(e,["config"]);return o!=null&&(d(n,["_self"],jF(o,n)),nF(n,{"requests[].*":"requests[].request.*"})),n}function jF(t,e){let n={},r=u(t,["taskType"]);e!==void 0&&r!=null&&d(e,["requests[]","taskType"],r);let o=u(t,["title"]);e!==void 0&&o!=null&&d(e,["requests[]","title"],o);let i=u(t,["outputDimensionality"]);if(e!==void 0&&i!=null&&d(e,["requests[]","outputDimensionality"],i),u(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(u(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function YF(t,e){let n={},r=u(e,["fileName"]);r!=null&&d(n,["file_name"],r);let o=u(e,["inlinedRequests"]);return o!=null&&d(n,["requests"],zF(t,o)),n}function JF(t){let e={};if(u(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let n=u(t,["fileUri"]);n!=null&&d(e,["fileUri"],n);let r=u(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function KF(t){let e={},n=u(t,["id"]);n!=null&&d(e,["id"],n);let r=u(t,["args"]);r!=null&&d(e,["args"],r);let o=u(t,["name"]);if(o!=null&&d(e,["name"],o),u(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(u(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function QF(t){let e={},n=u(t,["allowedFunctionNames"]);n!=null&&d(e,["allowedFunctionNames"],n);let r=u(t,["mode"]);if(r!=null&&d(e,["mode"],r),u(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function ZF(t,e,n){let r={},o=u(e,["systemInstruction"]);n!==void 0&&o!=null&&d(n,["systemInstruction"],mw(qe(o)));let i=u(e,["temperature"]);i!=null&&d(r,["temperature"],i);let s=u(e,["topP"]);s!=null&&d(r,["topP"],s);let a=u(e,["topK"]);a!=null&&d(r,["topK"],a);let l=u(e,["candidateCount"]);l!=null&&d(r,["candidateCount"],l);let c=u(e,["maxOutputTokens"]);c!=null&&d(r,["maxOutputTokens"],c);let f=u(e,["stopSequences"]);f!=null&&d(r,["stopSequences"],f);let h=u(e,["responseLogprobs"]);h!=null&&d(r,["responseLogprobs"],h);let p=u(e,["logprobs"]);p!=null&&d(r,["logprobs"],p);let m=u(e,["presencePenalty"]);m!=null&&d(r,["presencePenalty"],m);let g=u(e,["frequencyPenalty"]);g!=null&&d(r,["frequencyPenalty"],g);let y=u(e,["seed"]);y!=null&&d(r,["seed"],y);let _=u(e,["responseMimeType"]);_!=null&&d(r,["responseMimeType"],_);let C=u(e,["responseSchema"]);C!=null&&d(r,["responseSchema"],Xg(C));let I=u(e,["responseJsonSchema"]);if(I!=null&&d(r,["responseJsonSchema"],I),u(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(u(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");let w=u(e,["safetySettings"]);if(n!==void 0&&w!=null){let ve=w;Array.isArray(ve)&&(ve=ve.map(Vt=>pO(Vt))),d(n,["safetySettings"],ve)}let A=u(e,["tools"]);if(n!==void 0&&A!=null){let ve=ti(A);Array.isArray(ve)&&(ve=ve.map(Vt=>gO(ei(Vt)))),d(n,["tools"],ve)}let R=u(e,["toolConfig"]);if(n!==void 0&&R!=null&&d(n,["toolConfig"],mO(R)),u(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");let $=u(e,["cachedContent"]);n!==void 0&&$!=null&&d(n,["cachedContent"],xn(t,$));let L=u(e,["responseModalities"]);L!=null&&d(r,["responseModalities"],L);let P=u(e,["mediaResolution"]);P!=null&&d(r,["mediaResolution"],P);let b=u(e,["speechConfig"]);if(b!=null&&d(r,["speechConfig"],ey(b)),u(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");let N=u(e,["thinkingConfig"]);N!=null&&d(r,["thinkingConfig"],N);let we=u(e,["imageConfig"]);we!=null&&d(r,["imageConfig"],oO(we));let Lt=u(e,["enableEnhancedCivicAnswers"]);if(Lt!=null&&d(r,["enableEnhancedCivicAnswers"],Lt),u(e,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return r}function XF(t){let e={},n=u(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);let r=u(t,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>FF(c))),d(e,["candidates"],l)}let o=u(t,["modelVersion"]);o!=null&&d(e,["modelVersion"],o);let i=u(t,["promptFeedback"]);i!=null&&d(e,["promptFeedback"],i);let s=u(t,["responseId"]);s!=null&&d(e,["responseId"],s);let a=u(t,["usageMetadata"]);return a!=null&&d(e,["usageMetadata"],a),e}function eO(t,e){let n={},r=u(e,["name"]);return r!=null&&d(n,["_url","name"],ni(t,r)),n}function tO(t,e){let n={},r=u(e,["name"]);return r!=null&&d(n,["_url","name"],ni(t,r)),n}function nO(t){let e={};if(u(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");let n=u(t,["enableWidget"]);return n!=null&&d(e,["enableWidget"],n),e}function rO(t){let e={};if(u(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(u(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");let n=u(t,["timeRangeFilter"]);return n!=null&&d(e,["timeRangeFilter"],n),e}function oO(t){let e={},n=u(t,["aspectRatio"]);n!=null&&d(e,["aspectRatio"],n);let r=u(t,["imageSize"]);if(r!=null&&d(e,["imageSize"],r),u(t,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(u(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(u(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function iO(t,e){let n={},r=u(e,["model"]);r!=null&&d(n,["request","model"],Z(t,r));let o=u(e,["contents"]);if(o!=null){let a=vt(o);Array.isArray(a)&&(a=a.map(l=>mw(l))),d(n,["request","contents"],a)}let i=u(e,["metadata"]);i!=null&&d(n,["metadata"],i);let s=u(e,["config"]);return s!=null&&d(n,["request","generationConfig"],ZF(t,s,u(n,["request"],{}))),n}function sO(t){let e={},n=u(t,["response"]);n!=null&&d(e,["response"],XF(n));let r=u(t,["error"]);return r!=null&&d(e,["error"],r),e}function aO(t,e){let n={},r=u(t,["pageSize"]);e!==void 0&&r!=null&&d(e,["_query","pageSize"],r);let o=u(t,["pageToken"]);if(e!==void 0&&o!=null&&d(e,["_query","pageToken"],o),u(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function lO(t,e){let n={},r=u(t,["pageSize"]);e!==void 0&&r!=null&&d(e,["_query","pageSize"],r);let o=u(t,["pageToken"]);e!==void 0&&o!=null&&d(e,["_query","pageToken"],o);let i=u(t,["filter"]);return e!==void 0&&i!=null&&d(e,["_query","filter"],i),n}function uO(t){let e={},n=u(t,["config"]);return n!=null&&aO(n,e),e}function cO(t){let e={},n=u(t,["config"]);return n!=null&&lO(n,e),e}function dO(t){let e={},n=u(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);let r=u(t,["nextPageToken"]);r!=null&&d(e,["nextPageToken"],r);let o=u(t,["operations"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(s=>Wu(s))),d(e,["batchJobs"],i)}return e}function fO(t){let e={},n=u(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);let r=u(t,["nextPageToken"]);r!=null&&d(e,["nextPageToken"],r);let o=u(t,["batchPredictionJobs"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(s=>yg(s))),d(e,["batchJobs"],i)}return e}function hO(t){let e={},n=u(t,["mediaResolution"]);n!=null&&d(e,["mediaResolution"],n);let r=u(t,["codeExecutionResult"]);r!=null&&d(e,["codeExecutionResult"],r);let o=u(t,["executableCode"]);o!=null&&d(e,["executableCode"],o);let i=u(t,["fileData"]);i!=null&&d(e,["fileData"],JF(i));let s=u(t,["functionCall"]);s!=null&&d(e,["functionCall"],KF(s));let a=u(t,["functionResponse"]);a!=null&&d(e,["functionResponse"],a);let l=u(t,["inlineData"]);l!=null&&d(e,["inlineData"],RF(l));let c=u(t,["text"]);c!=null&&d(e,["text"],c);let f=u(t,["thought"]);f!=null&&d(e,["thought"],f);let h=u(t,["thoughtSignature"]);h!=null&&d(e,["thoughtSignature"],h);let p=u(t,["videoMetadata"]);return p!=null&&d(e,["videoMetadata"],p),e}function pO(t){let e={},n=u(t,["category"]);if(n!=null&&d(e,["category"],n),u(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");let r=u(t,["threshold"]);return r!=null&&d(e,["threshold"],r),e}function mO(t){let e={},n=u(t,["retrievalConfig"]);n!=null&&d(e,["retrievalConfig"],n);let r=u(t,["functionCallingConfig"]);return r!=null&&d(e,["functionCallingConfig"],QF(r)),e}function gO(t){let e={};if(u(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");let n=u(t,["computerUse"]);n!=null&&d(e,["computerUse"],n);let r=u(t,["fileSearch"]);r!=null&&d(e,["fileSearch"],r);let o=u(t,["codeExecution"]);if(o!=null&&d(e,["codeExecution"],o),u(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");let i=u(t,["functionDeclarations"]);if(i!=null){let f=i;Array.isArray(f)&&(f=f.map(h=>h)),d(e,["functionDeclarations"],f)}let s=u(t,["googleMaps"]);s!=null&&d(e,["googleMaps"],nO(s));let a=u(t,["googleSearch"]);a!=null&&d(e,["googleSearch"],rO(a));let l=u(t,["googleSearchRetrieval"]);l!=null&&d(e,["googleSearchRetrieval"],l);let c=u(t,["urlContext"]);return c!=null&&d(e,["urlContext"],c),e}var rr=(function(t){return t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents",t.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",t.PAGED_ITEM_DOCUMENTS="documents",t})(rr||{}),Mn=class{constructor(e,n,r,o){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,r,o)}init(e,n,r){var o,i;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n?.sdkHttpResponse,this.idxInternal=0;let s={config:{}};!r||Object.keys(r).length===0?s={config:{}}:typeof r=="object"?s=Object.assign({},r):s=r,s.config&&(s.config.pageToken=n.nextPageToken),this.paramsInternal=s,this.pageInternalSize=(i=(o=s.config)===null||o===void 0?void 0:o.pageSize)!==null&&i!==void 0?i:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};let e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");let e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}};var _g=class extends Ft{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Mn(rr.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)}}createInlinedGenerateContentRequest(e){let n=RI(this.apiClient,e),r=n._url,o=M("{model}:batchGenerateContent",r),a=n.batch.inputConfig.requests,l=a.requests,c=[];for(let f of l){let h=Object.assign({},f);if(h.systemInstruction){let p=h.systemInstruction;delete h.systemInstruction;let m=h.request;m.systemInstruction=p,h.request=m}c.push(h)}return a.requests=c,delete n.config,delete n._url,delete n._query,{path:o,body:n}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,n){let r=n?Object.assign({},n):{},o=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${o}`),r.dest===void 0){let i=this.getGcsUri(e),s=this.getBigqueryUri(e);if(i)i.endsWith(".jsonl")?r.dest=`${i.slice(0,-6)}/dest`:r.dest=`${i}_dest_${o}`;else if(s)r.dest=`${s}_dest_${o}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(e){var n,r,o,i;let s,a="",l={};if(this.apiClient.isVertexAI()){let c=UF(this.apiClient,e);return a=M("batchPredictionJobs",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s.then(f=>yg(f))}else{let c=RI(this.apiClient,e);return a=M("{model}:batchGenerateContent",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>Wu(f))}}async createEmbeddingsInternal(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let a=HF(this.apiClient,e);return i=M("{model}:asyncBatchEmbedContent",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),o.then(l=>Wu(l))}}async get(e){var n,r,o,i;let s,a="",l={};if(this.apiClient.isVertexAI()){let c=tO(this.apiClient,e);return a=M("batchPredictionJobs/{name}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s.then(f=>yg(f))}else{let c=eO(this.apiClient,e);return a=M("batches/{name}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>Wu(f))}}async cancel(e){var n,r,o,i;let s="",a={};if(this.apiClient.isVertexAI()){let l=kF(this.apiClient,e);s=M("batchPredictionJobs/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{let l=PF(this.apiClient,e);s=M("batches/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var n,r,o,i;let s,a="",l={};if(this.apiClient.isVertexAI()){let c=cO(e);return a=M("batchPredictionJobs",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{let p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{let h=fO(f),p=new rc;return Object.assign(p,h),p})}else{let c=uO(e);return a=M("batches",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(h=>{let p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{let h=dO(f),p=new rc;return Object.assign(p,h),p})}}async delete(e){var n,r,o,i;let s,a="",l={};if(this.apiClient.isVertexAI()){let c=$F(this.apiClient,e);return a=M("batchPredictionJobs/{name}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{let p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>WF(f))}else{let c=GF(this.apiClient,e);return a=M("batches/{name}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(h=>{let p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>qF(f))}}};function yO(t){let e={},n=u(t,["data"]);if(n!=null&&d(e,["data"],n),u(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let r=u(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function PI(t){let e={},n=u(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>BO(i))),d(e,["parts"],o)}let r=u(t,["role"]);return r!=null&&d(e,["role"],r),e}function _O(t,e){let n={},r=u(t,["ttl"]);e!==void 0&&r!=null&&d(e,["ttl"],r);let o=u(t,["expireTime"]);e!==void 0&&o!=null&&d(e,["expireTime"],o);let i=u(t,["displayName"]);e!==void 0&&i!=null&&d(e,["displayName"],i);let s=u(t,["contents"]);if(e!==void 0&&s!=null){let f=vt(s);Array.isArray(f)&&(f=f.map(h=>PI(h))),d(e,["contents"],f)}let a=u(t,["systemInstruction"]);e!==void 0&&a!=null&&d(e,["systemInstruction"],PI(qe(a)));let l=u(t,["tools"]);if(e!==void 0&&l!=null){let f=l;Array.isArray(f)&&(f=f.map(h=>GO(h))),d(e,["tools"],f)}let c=u(t,["toolConfig"]);if(e!==void 0&&c!=null&&d(e,["toolConfig"],HO(c)),u(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function vO(t,e){let n={},r=u(t,["ttl"]);e!==void 0&&r!=null&&d(e,["ttl"],r);let o=u(t,["expireTime"]);e!==void 0&&o!=null&&d(e,["expireTime"],o);let i=u(t,["displayName"]);e!==void 0&&i!=null&&d(e,["displayName"],i);let s=u(t,["contents"]);if(e!==void 0&&s!=null){let h=vt(s);Array.isArray(h)&&(h=h.map(p=>p)),d(e,["contents"],h)}let a=u(t,["systemInstruction"]);e!==void 0&&a!=null&&d(e,["systemInstruction"],qe(a));let l=u(t,["tools"]);if(e!==void 0&&l!=null){let h=l;Array.isArray(h)&&(h=h.map(p=>$O(p))),d(e,["tools"],h)}let c=u(t,["toolConfig"]);e!==void 0&&c!=null&&d(e,["toolConfig"],c);let f=u(t,["kmsKeyName"]);return e!==void 0&&f!=null&&d(e,["encryption_spec","kmsKeyName"],f),n}function EO(t,e){let n={},r=u(e,["model"]);r!=null&&d(n,["model"],rw(t,r));let o=u(e,["config"]);return o!=null&&_O(o,n),n}function CO(t,e){let n={},r=u(e,["model"]);r!=null&&d(n,["model"],rw(t,r));let o=u(e,["config"]);return o!=null&&vO(o,n),n}function DO(t,e){let n={},r=u(e,["name"]);return r!=null&&d(n,["_url","name"],xn(t,r)),n}function IO(t,e){let n={},r=u(e,["name"]);return r!=null&&d(n,["_url","name"],xn(t,r)),n}function wO(t){let e={},n=u(t,["sdkHttpResponse"]);return n!=null&&d(e,["sdkHttpResponse"],n),e}function TO(t){let e={},n=u(t,["sdkHttpResponse"]);return n!=null&&d(e,["sdkHttpResponse"],n),e}function SO(t){let e={};if(u(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let n=u(t,["fileUri"]);n!=null&&d(e,["fileUri"],n);let r=u(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function bO(t){let e={},n=u(t,["id"]);n!=null&&d(e,["id"],n);let r=u(t,["args"]);r!=null&&d(e,["args"],r);let o=u(t,["name"]);if(o!=null&&d(e,["name"],o),u(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(u(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function AO(t){let e={},n=u(t,["allowedFunctionNames"]);n!=null&&d(e,["allowedFunctionNames"],n);let r=u(t,["mode"]);if(r!=null&&d(e,["mode"],r),u(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function MO(t){let e={},n=u(t,["description"]);n!=null&&d(e,["description"],n);let r=u(t,["name"]);r!=null&&d(e,["name"],r);let o=u(t,["parameters"]);o!=null&&d(e,["parameters"],o);let i=u(t,["parametersJsonSchema"]);i!=null&&d(e,["parametersJsonSchema"],i);let s=u(t,["response"]);s!=null&&d(e,["response"],s);let a=u(t,["responseJsonSchema"]);if(a!=null&&d(e,["responseJsonSchema"],a),u(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function xO(t,e){let n={},r=u(e,["name"]);return r!=null&&d(n,["_url","name"],xn(t,r)),n}function NO(t,e){let n={},r=u(e,["name"]);return r!=null&&d(n,["_url","name"],xn(t,r)),n}function RO(t){let e={};if(u(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");let n=u(t,["enableWidget"]);return n!=null&&d(e,["enableWidget"],n),e}function PO(t){let e={};if(u(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(u(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");let n=u(t,["timeRangeFilter"]);return n!=null&&d(e,["timeRangeFilter"],n),e}function kO(t,e){let n={},r=u(t,["pageSize"]);e!==void 0&&r!=null&&d(e,["_query","pageSize"],r);let o=u(t,["pageToken"]);return e!==void 0&&o!=null&&d(e,["_query","pageToken"],o),n}function FO(t,e){let n={},r=u(t,["pageSize"]);e!==void 0&&r!=null&&d(e,["_query","pageSize"],r);let o=u(t,["pageToken"]);return e!==void 0&&o!=null&&d(e,["_query","pageToken"],o),n}function OO(t){let e={},n=u(t,["config"]);return n!=null&&kO(n,e),e}function LO(t){let e={},n=u(t,["config"]);return n!=null&&FO(n,e),e}function VO(t){let e={},n=u(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);let r=u(t,["nextPageToken"]);r!=null&&d(e,["nextPageToken"],r);let o=u(t,["cachedContents"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(s=>s)),d(e,["cachedContents"],i)}return e}function UO(t){let e={},n=u(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);let r=u(t,["nextPageToken"]);r!=null&&d(e,["nextPageToken"],r);let o=u(t,["cachedContents"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(s=>s)),d(e,["cachedContents"],i)}return e}function BO(t){let e={},n=u(t,["mediaResolution"]);n!=null&&d(e,["mediaResolution"],n);let r=u(t,["codeExecutionResult"]);r!=null&&d(e,["codeExecutionResult"],r);let o=u(t,["executableCode"]);o!=null&&d(e,["executableCode"],o);let i=u(t,["fileData"]);i!=null&&d(e,["fileData"],SO(i));let s=u(t,["functionCall"]);s!=null&&d(e,["functionCall"],bO(s));let a=u(t,["functionResponse"]);a!=null&&d(e,["functionResponse"],a);let l=u(t,["inlineData"]);l!=null&&d(e,["inlineData"],yO(l));let c=u(t,["text"]);c!=null&&d(e,["text"],c);let f=u(t,["thought"]);f!=null&&d(e,["thought"],f);let h=u(t,["thoughtSignature"]);h!=null&&d(e,["thoughtSignature"],h);let p=u(t,["videoMetadata"]);return p!=null&&d(e,["videoMetadata"],p),e}function HO(t){let e={},n=u(t,["retrievalConfig"]);n!=null&&d(e,["retrievalConfig"],n);let r=u(t,["functionCallingConfig"]);return r!=null&&d(e,["functionCallingConfig"],AO(r)),e}function GO(t){let e={};if(u(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");let n=u(t,["computerUse"]);n!=null&&d(e,["computerUse"],n);let r=u(t,["fileSearch"]);r!=null&&d(e,["fileSearch"],r);let o=u(t,["codeExecution"]);if(o!=null&&d(e,["codeExecution"],o),u(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");let i=u(t,["functionDeclarations"]);if(i!=null){let f=i;Array.isArray(f)&&(f=f.map(h=>h)),d(e,["functionDeclarations"],f)}let s=u(t,["googleMaps"]);s!=null&&d(e,["googleMaps"],RO(s));let a=u(t,["googleSearch"]);a!=null&&d(e,["googleSearch"],PO(a));let l=u(t,["googleSearchRetrieval"]);l!=null&&d(e,["googleSearchRetrieval"],l);let c=u(t,["urlContext"]);return c!=null&&d(e,["urlContext"],c),e}function $O(t){let e={},n=u(t,["retrieval"]);n!=null&&d(e,["retrieval"],n);let r=u(t,["computerUse"]);if(r!=null&&d(e,["computerUse"],r),u(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");let o=u(t,["codeExecution"]);o!=null&&d(e,["codeExecution"],o);let i=u(t,["enterpriseWebSearch"]);i!=null&&d(e,["enterpriseWebSearch"],i);let s=u(t,["functionDeclarations"]);if(s!=null){let h=s;Array.isArray(h)&&(h=h.map(p=>MO(p))),d(e,["functionDeclarations"],h)}let a=u(t,["googleMaps"]);a!=null&&d(e,["googleMaps"],a);let l=u(t,["googleSearch"]);l!=null&&d(e,["googleSearch"],l);let c=u(t,["googleSearchRetrieval"]);c!=null&&d(e,["googleSearchRetrieval"],c);let f=u(t,["urlContext"]);return f!=null&&d(e,["urlContext"],f),e}function qO(t,e){let n={},r=u(t,["ttl"]);e!==void 0&&r!=null&&d(e,["ttl"],r);let o=u(t,["expireTime"]);return e!==void 0&&o!=null&&d(e,["expireTime"],o),n}function WO(t,e){let n={},r=u(t,["ttl"]);e!==void 0&&r!=null&&d(e,["ttl"],r);let o=u(t,["expireTime"]);return e!==void 0&&o!=null&&d(e,["expireTime"],o),n}function zO(t,e){let n={},r=u(e,["name"]);r!=null&&d(n,["_url","name"],xn(t,r));let o=u(e,["config"]);return o!=null&&qO(o,n),n}function jO(t,e){let n={},r=u(e,["name"]);r!=null&&d(n,["_url","name"],xn(t,r));let o=u(e,["config"]);return o!=null&&WO(o,n),n}var vg=class extends Ft{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Mn(rr.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(e){var n,r,o,i;let s,a="",l={};if(this.apiClient.isVertexAI()){let c=CO(this.apiClient,e);return a=M("cachedContents",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s.then(f=>f)}else{let c=EO(this.apiClient,e);return a=M("cachedContents",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>f)}}async get(e){var n,r,o,i;let s,a="",l={};if(this.apiClient.isVertexAI()){let c=NO(this.apiClient,e);return a=M("{name}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s.then(f=>f)}else{let c=xO(this.apiClient,e);return a=M("{name}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>f)}}async delete(e){var n,r,o,i;let s,a="",l={};if(this.apiClient.isVertexAI()){let c=IO(this.apiClient,e);return a=M("{name}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{let p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{let h=TO(f),p=new tc;return Object.assign(p,h),p})}else{let c=DO(this.apiClient,e);return a=M("{name}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(h=>{let p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{let h=wO(f),p=new tc;return Object.assign(p,h),p})}}async update(e){var n,r,o,i;let s,a="",l={};if(this.apiClient.isVertexAI()){let c=jO(this.apiClient,e);return a=M("{name}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s.then(f=>f)}else{let c=zO(this.apiClient,e);return a=M("{name}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>f)}}async listInternal(e){var n,r,o,i;let s,a="",l={};if(this.apiClient.isVertexAI()){let c=LO(e);return a=M("cachedContents",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{let p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{let h=UO(f),p=new nc;return Object.assign(p,h),p})}else{let c=OO(e);return a=M("cachedContents",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(h=>{let p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{let h=VO(f),p=new nc;return Object.assign(p,h),p})}}};function ic(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n}function kI(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function U(t){return this instanceof U?(this.v=t,this):new U(t)}function Pt(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),o,i=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),o[Symbol.asyncIterator]=function(){return this},o;function s(m){return function(g){return Promise.resolve(g).then(m,h)}}function a(m,g){r[m]&&(o[m]=function(y){return new Promise(function(_,C){i.push([m,y,_,C])>1||l(m,y)})},g&&(o[m]=g(o[m])))}function l(m,g){try{c(r[m](g))}catch(y){p(i[0][3],y)}}function c(m){m.value instanceof U?Promise.resolve(m.value.v).then(f,h):p(i[0][2],m)}function f(m){l("next",m)}function h(m){l("throw",m)}function p(m,g){m(g),i.shift(),i.length&&l(i[0][0],i[0][1])}}function kt(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof kI=="function"?kI(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=t[i]&&function(s){return new Promise(function(a,l){s=t[i](s),o(a,l,s.done,s.value)})}}function o(i,s,a,l){Promise.resolve(l).then(function(c){i({value:c,done:a})},s)}}function YO(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;let n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:gw(n)}function gw(t){if(t.parts===void 0||t.parts.length===0)return!1;for(let e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function JO(t){if(t.length!==0){for(let e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function FI(t){if(t===void 0||t.length===0)return[];let e=[],n=t.length,r=0;for(;r<n;)if(t[r].role==="user")e.push(t[r]),r++;else{let o=[],i=!0;for(;r<n&&t[r].role==="model";)o.push(t[r]),i&&!gw(t[r])&&(i=!1),r++;i?e.push(...o):e.pop()}return e}var Eg=class{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new Cg(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}},Cg=class{constructor(e,n,r,o={},i=[]){this.apiClient=e,this.modelsModule=n,this.model=r,this.config=o,this.history=i,this.sendPromise=Promise.resolve(),JO(i)}async sendMessage(e){var n;await this.sendPromise;let r=qe(e.message),o=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var i,s,a;let l=await o,c=(s=(i=l.candidates)===null||i===void 0?void 0:i[0])===null||s===void 0?void 0:s.content,f=l.automaticFunctionCallingHistory,h=this.getHistory(!0).length,p=[];f!=null&&(p=(a=f.slice(h))!==null&&a!==void 0?a:[]);let m=c?[c]:[];this.recordHistory(r,m,p)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),o}async sendMessageStream(e){var n;await this.sendPromise;let r=qe(e.message),o=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=o.then(()=>{}).catch(()=>{});let i=await o;return this.processStreamResponse(i,r)}getHistory(e=!1){let n=e?FI(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){return Pt(this,arguments,function*(){var o,i,s,a,l,c;let f=[];try{for(var h=!0,p=kt(e),m;m=yield U(p.next()),o=m.done,!o;h=!0){a=m.value,h=!1;let g=a;if(YO(g)){let y=(c=(l=g.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content;y!==void 0&&f.push(y)}yield yield U(g)}}catch(g){i={error:g}}finally{try{!h&&!o&&(s=p.return)&&(yield U(s.call(p)))}finally{if(i)throw i.error}}this.recordHistory(n,f)})}recordHistory(e,n,r){let o=[];n.length>0&&n.every(i=>i.role!==void 0)?o=n:o.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...FI(r)):this.history.push(e),this.history.push(...o)}};var Ks=class t extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,t.prototype)}};function KO(t){let e={},n=u(t,["file"]);return n!=null&&d(e,["file"],n),e}function QO(t){let e={},n=u(t,["sdkHttpResponse"]);return n!=null&&d(e,["sdkHttpResponse"],n),e}function ZO(t){let e={},n=u(t,["name"]);return n!=null&&d(e,["_url","file"],uw(n)),e}function XO(t){let e={},n=u(t,["sdkHttpResponse"]);return n!=null&&d(e,["sdkHttpResponse"],n),e}function eL(t){let e={},n=u(t,["name"]);return n!=null&&d(e,["_url","file"],uw(n)),e}function tL(t,e){let n={},r=u(t,["pageSize"]);e!==void 0&&r!=null&&d(e,["_query","pageSize"],r);let o=u(t,["pageToken"]);return e!==void 0&&o!=null&&d(e,["_query","pageToken"],o),n}function nL(t){let e={},n=u(t,["config"]);return n!=null&&tL(n,e),e}function rL(t){let e={},n=u(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);let r=u(t,["nextPageToken"]);r!=null&&d(e,["nextPageToken"],r);let o=u(t,["files"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(s=>s)),d(e,["files"],i)}return e}var Dg=class extends Ft{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Mn(rr.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>n)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let a=nL(e);return i=M("files",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(c=>{let f=c;return f.sdkHttpResponse={headers:l.headers},f})),o.then(l=>{let c=rL(l),f=new cg;return Object.assign(f,c),f})}}async createInternal(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let a=KO(e);return i=M("upload/v1beta/files",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),o.then(l=>{let c=QO(l),f=new dg;return Object.assign(f,c),f})}}async get(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let a=eL(e);return i=M("files/{file}",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),o.then(l=>l)}}async delete(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let a=ZO(e);return i=M("files/{file}",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(c=>{let f=c;return f.sdkHttpResponse={headers:l.headers},f})),o.then(l=>{let c=XO(l),f=new fg;return Object.assign(f,c),f})}}};function zu(t){let e={},n=u(t,["data"]);if(n!=null&&d(e,["data"],n),u(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let r=u(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function oL(t){let e={},n=u(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>EL(i))),d(e,["parts"],o)}let r=u(t,["role"]);return r!=null&&d(e,["role"],r),e}function iL(t){let e={};if(u(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let n=u(t,["fileUri"]);n!=null&&d(e,["fileUri"],n);let r=u(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function sL(t){let e={},n=u(t,["id"]);n!=null&&d(e,["id"],n);let r=u(t,["args"]);r!=null&&d(e,["args"],r);let o=u(t,["name"]);if(o!=null&&d(e,["name"],o),u(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(u(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function aL(t){let e={},n=u(t,["description"]);n!=null&&d(e,["description"],n);let r=u(t,["name"]);r!=null&&d(e,["name"],r);let o=u(t,["parameters"]);o!=null&&d(e,["parameters"],o);let i=u(t,["parametersJsonSchema"]);i!=null&&d(e,["parametersJsonSchema"],i);let s=u(t,["response"]);s!=null&&d(e,["response"],s);let a=u(t,["responseJsonSchema"]);if(a!=null&&d(e,["responseJsonSchema"],a),u(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function lL(t){let e={},n=u(t,["modelSelectionConfig"]);n!=null&&d(e,["modelConfig"],n);let r=u(t,["responseJsonSchema"]);r!=null&&d(e,["responseJsonSchema"],r);let o=u(t,["audioTimestamp"]);o!=null&&d(e,["audioTimestamp"],o);let i=u(t,["candidateCount"]);i!=null&&d(e,["candidateCount"],i);let s=u(t,["enableAffectiveDialog"]);s!=null&&d(e,["enableAffectiveDialog"],s);let a=u(t,["frequencyPenalty"]);a!=null&&d(e,["frequencyPenalty"],a);let l=u(t,["logprobs"]);l!=null&&d(e,["logprobs"],l);let c=u(t,["maxOutputTokens"]);c!=null&&d(e,["maxOutputTokens"],c);let f=u(t,["mediaResolution"]);f!=null&&d(e,["mediaResolution"],f);let h=u(t,["presencePenalty"]);h!=null&&d(e,["presencePenalty"],h);let p=u(t,["responseLogprobs"]);p!=null&&d(e,["responseLogprobs"],p);let m=u(t,["responseMimeType"]);m!=null&&d(e,["responseMimeType"],m);let g=u(t,["responseModalities"]);g!=null&&d(e,["responseModalities"],g);let y=u(t,["responseSchema"]);y!=null&&d(e,["responseSchema"],y);let _=u(t,["routingConfig"]);_!=null&&d(e,["routingConfig"],_);let C=u(t,["seed"]);C!=null&&d(e,["seed"],C);let I=u(t,["speechConfig"]);I!=null&&d(e,["speechConfig"],I);let w=u(t,["stopSequences"]);w!=null&&d(e,["stopSequences"],w);let A=u(t,["temperature"]);A!=null&&d(e,["temperature"],A);let R=u(t,["thinkingConfig"]);R!=null&&d(e,["thinkingConfig"],R);let $=u(t,["topK"]);$!=null&&d(e,["topK"],$);let L=u(t,["topP"]);if(L!=null&&d(e,["topP"],L),u(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function uL(t){let e={};if(u(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");let n=u(t,["enableWidget"]);return n!=null&&d(e,["enableWidget"],n),e}function cL(t){let e={};if(u(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(u(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");let n=u(t,["timeRangeFilter"]);return n!=null&&d(e,["timeRangeFilter"],n),e}function dL(t,e){let n={},r=u(t,["generationConfig"]);e!==void 0&&r!=null&&d(e,["setup","generationConfig"],r);let o=u(t,["responseModalities"]);e!==void 0&&o!=null&&d(e,["setup","generationConfig","responseModalities"],o);let i=u(t,["temperature"]);e!==void 0&&i!=null&&d(e,["setup","generationConfig","temperature"],i);let s=u(t,["topP"]);e!==void 0&&s!=null&&d(e,["setup","generationConfig","topP"],s);let a=u(t,["topK"]);e!==void 0&&a!=null&&d(e,["setup","generationConfig","topK"],a);let l=u(t,["maxOutputTokens"]);e!==void 0&&l!=null&&d(e,["setup","generationConfig","maxOutputTokens"],l);let c=u(t,["mediaResolution"]);e!==void 0&&c!=null&&d(e,["setup","generationConfig","mediaResolution"],c);let f=u(t,["seed"]);e!==void 0&&f!=null&&d(e,["setup","generationConfig","seed"],f);let h=u(t,["speechConfig"]);e!==void 0&&h!=null&&d(e,["setup","generationConfig","speechConfig"],ty(h));let p=u(t,["thinkingConfig"]);e!==void 0&&p!=null&&d(e,["setup","generationConfig","thinkingConfig"],p);let m=u(t,["enableAffectiveDialog"]);e!==void 0&&m!=null&&d(e,["setup","generationConfig","enableAffectiveDialog"],m);let g=u(t,["systemInstruction"]);e!==void 0&&g!=null&&d(e,["setup","systemInstruction"],oL(qe(g)));let y=u(t,["tools"]);if(e!==void 0&&y!=null){let $=ti(y);Array.isArray($)&&($=$.map(L=>DL(ei(L)))),d(e,["setup","tools"],$)}let _=u(t,["sessionResumption"]);e!==void 0&&_!=null&&d(e,["setup","sessionResumption"],CL(_));let C=u(t,["inputAudioTranscription"]);e!==void 0&&C!=null&&d(e,["setup","inputAudioTranscription"],C);let I=u(t,["outputAudioTranscription"]);e!==void 0&&I!=null&&d(e,["setup","outputAudioTranscription"],I);let w=u(t,["realtimeInputConfig"]);e!==void 0&&w!=null&&d(e,["setup","realtimeInputConfig"],w);let A=u(t,["contextWindowCompression"]);e!==void 0&&A!=null&&d(e,["setup","contextWindowCompression"],A);let R=u(t,["proactivity"]);if(e!==void 0&&R!=null&&d(e,["setup","proactivity"],R),u(t,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}function fL(t,e){let n={},r=u(t,["generationConfig"]);e!==void 0&&r!=null&&d(e,["setup","generationConfig"],lL(r));let o=u(t,["responseModalities"]);e!==void 0&&o!=null&&d(e,["setup","generationConfig","responseModalities"],o);let i=u(t,["temperature"]);e!==void 0&&i!=null&&d(e,["setup","generationConfig","temperature"],i);let s=u(t,["topP"]);e!==void 0&&s!=null&&d(e,["setup","generationConfig","topP"],s);let a=u(t,["topK"]);e!==void 0&&a!=null&&d(e,["setup","generationConfig","topK"],a);let l=u(t,["maxOutputTokens"]);e!==void 0&&l!=null&&d(e,["setup","generationConfig","maxOutputTokens"],l);let c=u(t,["mediaResolution"]);e!==void 0&&c!=null&&d(e,["setup","generationConfig","mediaResolution"],c);let f=u(t,["seed"]);e!==void 0&&f!=null&&d(e,["setup","generationConfig","seed"],f);let h=u(t,["speechConfig"]);e!==void 0&&h!=null&&d(e,["setup","generationConfig","speechConfig"],ty(h));let p=u(t,["thinkingConfig"]);e!==void 0&&p!=null&&d(e,["setup","generationConfig","thinkingConfig"],p);let m=u(t,["enableAffectiveDialog"]);e!==void 0&&m!=null&&d(e,["setup","generationConfig","enableAffectiveDialog"],m);let g=u(t,["systemInstruction"]);e!==void 0&&g!=null&&d(e,["setup","systemInstruction"],qe(g));let y=u(t,["tools"]);if(e!==void 0&&y!=null){let L=ti(y);Array.isArray(L)&&(L=L.map(P=>IL(ei(P)))),d(e,["setup","tools"],L)}let _=u(t,["sessionResumption"]);e!==void 0&&_!=null&&d(e,["setup","sessionResumption"],_);let C=u(t,["inputAudioTranscription"]);e!==void 0&&C!=null&&d(e,["setup","inputAudioTranscription"],C);let I=u(t,["outputAudioTranscription"]);e!==void 0&&I!=null&&d(e,["setup","outputAudioTranscription"],I);let w=u(t,["realtimeInputConfig"]);e!==void 0&&w!=null&&d(e,["setup","realtimeInputConfig"],w);let A=u(t,["contextWindowCompression"]);e!==void 0&&A!=null&&d(e,["setup","contextWindowCompression"],A);let R=u(t,["proactivity"]);e!==void 0&&R!=null&&d(e,["setup","proactivity"],R);let $=u(t,["explicitVadSignal"]);return e!==void 0&&$!=null&&d(e,["setup","explicitVadSignal"],$),n}function hL(t,e){let n={},r=u(e,["model"]);r!=null&&d(n,["setup","model"],Z(t,r));let o=u(e,["config"]);return o!=null&&d(n,["config"],dL(o,n)),n}function pL(t,e){let n={},r=u(e,["model"]);r!=null&&d(n,["setup","model"],Z(t,r));let o=u(e,["config"]);return o!=null&&d(n,["config"],fL(o,n)),n}function mL(t){let e={},n=u(t,["musicGenerationConfig"]);return n!=null&&d(e,["musicGenerationConfig"],n),e}function gL(t){let e={},n=u(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(o=>o)),d(e,["weightedPrompts"],r)}return e}function yL(t){let e={},n=u(t,["media"]);if(n!=null){let c=ow(n);Array.isArray(c)&&(c=c.map(f=>zu(f))),d(e,["mediaChunks"],c)}let r=u(t,["audio"]);r!=null&&d(e,["audio"],zu(sw(r)));let o=u(t,["audioStreamEnd"]);o!=null&&d(e,["audioStreamEnd"],o);let i=u(t,["video"]);i!=null&&d(e,["video"],zu(iw(i)));let s=u(t,["text"]);s!=null&&d(e,["text"],s);let a=u(t,["activityStart"]);a!=null&&d(e,["activityStart"],a);let l=u(t,["activityEnd"]);return l!=null&&d(e,["activityEnd"],l),e}function _L(t){let e={},n=u(t,["media"]);if(n!=null){let c=ow(n);Array.isArray(c)&&(c=c.map(f=>f)),d(e,["mediaChunks"],c)}let r=u(t,["audio"]);r!=null&&d(e,["audio"],sw(r));let o=u(t,["audioStreamEnd"]);o!=null&&d(e,["audioStreamEnd"],o);let i=u(t,["video"]);i!=null&&d(e,["video"],iw(i));let s=u(t,["text"]);s!=null&&d(e,["text"],s);let a=u(t,["activityStart"]);a!=null&&d(e,["activityStart"],a);let l=u(t,["activityEnd"]);return l!=null&&d(e,["activityEnd"],l),e}function vL(t){let e={},n=u(t,["setupComplete"]);n!=null&&d(e,["setupComplete"],n);let r=u(t,["serverContent"]);r!=null&&d(e,["serverContent"],r);let o=u(t,["toolCall"]);o!=null&&d(e,["toolCall"],o);let i=u(t,["toolCallCancellation"]);i!=null&&d(e,["toolCallCancellation"],i);let s=u(t,["usageMetadata"]);s!=null&&d(e,["usageMetadata"],wL(s));let a=u(t,["goAway"]);a!=null&&d(e,["goAway"],a);let l=u(t,["sessionResumptionUpdate"]);l!=null&&d(e,["sessionResumptionUpdate"],l);let c=u(t,["voiceActivityDetectionSignal"]);c!=null&&d(e,["voiceActivityDetectionSignal"],c);let f=u(t,["voiceActivity"]);return f!=null&&d(e,["voiceActivity"],TL(f)),e}function EL(t){let e={},n=u(t,["mediaResolution"]);n!=null&&d(e,["mediaResolution"],n);let r=u(t,["codeExecutionResult"]);r!=null&&d(e,["codeExecutionResult"],r);let o=u(t,["executableCode"]);o!=null&&d(e,["executableCode"],o);let i=u(t,["fileData"]);i!=null&&d(e,["fileData"],iL(i));let s=u(t,["functionCall"]);s!=null&&d(e,["functionCall"],sL(s));let a=u(t,["functionResponse"]);a!=null&&d(e,["functionResponse"],a);let l=u(t,["inlineData"]);l!=null&&d(e,["inlineData"],zu(l));let c=u(t,["text"]);c!=null&&d(e,["text"],c);let f=u(t,["thought"]);f!=null&&d(e,["thought"],f);let h=u(t,["thoughtSignature"]);h!=null&&d(e,["thoughtSignature"],h);let p=u(t,["videoMetadata"]);return p!=null&&d(e,["videoMetadata"],p),e}function CL(t){let e={},n=u(t,["handle"]);if(n!=null&&d(e,["handle"],n),u(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function DL(t){let e={};if(u(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");let n=u(t,["computerUse"]);n!=null&&d(e,["computerUse"],n);let r=u(t,["fileSearch"]);r!=null&&d(e,["fileSearch"],r);let o=u(t,["codeExecution"]);if(o!=null&&d(e,["codeExecution"],o),u(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");let i=u(t,["functionDeclarations"]);if(i!=null){let f=i;Array.isArray(f)&&(f=f.map(h=>h)),d(e,["functionDeclarations"],f)}let s=u(t,["googleMaps"]);s!=null&&d(e,["googleMaps"],uL(s));let a=u(t,["googleSearch"]);a!=null&&d(e,["googleSearch"],cL(a));let l=u(t,["googleSearchRetrieval"]);l!=null&&d(e,["googleSearchRetrieval"],l);let c=u(t,["urlContext"]);return c!=null&&d(e,["urlContext"],c),e}function IL(t){let e={},n=u(t,["retrieval"]);n!=null&&d(e,["retrieval"],n);let r=u(t,["computerUse"]);if(r!=null&&d(e,["computerUse"],r),u(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");let o=u(t,["codeExecution"]);o!=null&&d(e,["codeExecution"],o);let i=u(t,["enterpriseWebSearch"]);i!=null&&d(e,["enterpriseWebSearch"],i);let s=u(t,["functionDeclarations"]);if(s!=null){let h=s;Array.isArray(h)&&(h=h.map(p=>aL(p))),d(e,["functionDeclarations"],h)}let a=u(t,["googleMaps"]);a!=null&&d(e,["googleMaps"],a);let l=u(t,["googleSearch"]);l!=null&&d(e,["googleSearch"],l);let c=u(t,["googleSearchRetrieval"]);c!=null&&d(e,["googleSearchRetrieval"],c);let f=u(t,["urlContext"]);return f!=null&&d(e,["urlContext"],f),e}function wL(t){let e={},n=u(t,["promptTokenCount"]);n!=null&&d(e,["promptTokenCount"],n);let r=u(t,["cachedContentTokenCount"]);r!=null&&d(e,["cachedContentTokenCount"],r);let o=u(t,["candidatesTokenCount"]);o!=null&&d(e,["responseTokenCount"],o);let i=u(t,["toolUsePromptTokenCount"]);i!=null&&d(e,["toolUsePromptTokenCount"],i);let s=u(t,["thoughtsTokenCount"]);s!=null&&d(e,["thoughtsTokenCount"],s);let a=u(t,["totalTokenCount"]);a!=null&&d(e,["totalTokenCount"],a);let l=u(t,["promptTokensDetails"]);if(l!=null){let m=l;Array.isArray(m)&&(m=m.map(g=>g)),d(e,["promptTokensDetails"],m)}let c=u(t,["cacheTokensDetails"]);if(c!=null){let m=c;Array.isArray(m)&&(m=m.map(g=>g)),d(e,["cacheTokensDetails"],m)}let f=u(t,["candidatesTokensDetails"]);if(f!=null){let m=f;Array.isArray(m)&&(m=m.map(g=>g)),d(e,["responseTokensDetails"],m)}let h=u(t,["toolUsePromptTokensDetails"]);if(h!=null){let m=h;Array.isArray(m)&&(m=m.map(g=>g)),d(e,["toolUsePromptTokensDetails"],m)}let p=u(t,["trafficType"]);return p!=null&&d(e,["trafficType"],p),e}function TL(t){let e={},n=u(t,["type"]);return n!=null&&d(e,["voiceActivityType"],n),e}function SL(t){let e={},n=u(t,["data"]);if(n!=null&&d(e,["data"],n),u(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let r=u(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function bL(t){let e={},n=u(t,["content"]);n!=null&&d(e,["content"],n);let r=u(t,["citationMetadata"]);r!=null&&d(e,["citationMetadata"],AL(r));let o=u(t,["tokenCount"]);o!=null&&d(e,["tokenCount"],o);let i=u(t,["finishReason"]);i!=null&&d(e,["finishReason"],i);let s=u(t,["avgLogprobs"]);s!=null&&d(e,["avgLogprobs"],s);let a=u(t,["groundingMetadata"]);a!=null&&d(e,["groundingMetadata"],a);let l=u(t,["index"]);l!=null&&d(e,["index"],l);let c=u(t,["logprobsResult"]);c!=null&&d(e,["logprobsResult"],c);let f=u(t,["safetyRatings"]);if(f!=null){let p=f;Array.isArray(p)&&(p=p.map(m=>m)),d(e,["safetyRatings"],p)}let h=u(t,["urlContextMetadata"]);return h!=null&&d(e,["urlContextMetadata"],h),e}function AL(t){let e={},n=u(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(o=>o)),d(e,["citations"],r)}return e}function ML(t,e){let n={},r=u(e,["model"]);r!=null&&d(n,["_url","model"],Z(t,r));let o=u(e,["contents"]);if(o!=null){let i=vt(o);Array.isArray(i)&&(i=i.map(s=>s)),d(n,["contents"],i)}return n}function xL(t){let e={},n=u(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);let r=u(t,["tokensInfo"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(i=>i)),d(e,["tokensInfo"],o)}return e}function NL(t){let e={},n=u(t,["values"]);n!=null&&d(e,["values"],n);let r=u(t,["statistics"]);return r!=null&&d(e,["statistics"],RL(r)),e}function RL(t){let e={},n=u(t,["truncated"]);n!=null&&d(e,["truncated"],n);let r=u(t,["token_count"]);return r!=null&&d(e,["tokenCount"],r),e}function Ec(t){let e={},n=u(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>HV(i))),d(e,["parts"],o)}let r=u(t,["role"]);return r!=null&&d(e,["role"],r),e}function PL(t){let e={},n=u(t,["controlType"]);n!=null&&d(e,["controlType"],n);let r=u(t,["enableControlImageComputation"]);return r!=null&&d(e,["computeControl"],r),e}function kL(t){let e={};if(u(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(u(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(u(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function FL(t,e){let n={},r=u(t,["systemInstruction"]);e!==void 0&&r!=null&&d(e,["systemInstruction"],qe(r));let o=u(t,["tools"]);if(e!==void 0&&o!=null){let s=o;Array.isArray(s)&&(s=s.map(a=>Ew(a))),d(e,["tools"],s)}let i=u(t,["generationConfig"]);return e!==void 0&&i!=null&&d(e,["generationConfig"],SV(i)),n}function OL(t,e){let n={},r=u(e,["model"]);r!=null&&d(n,["_url","model"],Z(t,r));let o=u(e,["contents"]);if(o!=null){let s=vt(o);Array.isArray(s)&&(s=s.map(a=>Ec(a))),d(n,["contents"],s)}let i=u(e,["config"]);return i!=null&&kL(i),n}function LL(t,e){let n={},r=u(e,["model"]);r!=null&&d(n,["_url","model"],Z(t,r));let o=u(e,["contents"]);if(o!=null){let s=vt(o);Array.isArray(s)&&(s=s.map(a=>a)),d(n,["contents"],s)}let i=u(e,["config"]);return i!=null&&FL(i,n),n}function VL(t){let e={},n=u(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);let r=u(t,["totalTokens"]);r!=null&&d(e,["totalTokens"],r);let o=u(t,["cachedContentTokenCount"]);return o!=null&&d(e,["cachedContentTokenCount"],o),e}function UL(t){let e={},n=u(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);let r=u(t,["totalTokens"]);return r!=null&&d(e,["totalTokens"],r),e}function BL(t,e){let n={},r=u(e,["model"]);return r!=null&&d(n,["_url","name"],Z(t,r)),n}function HL(t,e){let n={},r=u(e,["model"]);return r!=null&&d(n,["_url","name"],Z(t,r)),n}function GL(t){let e={},n=u(t,["sdkHttpResponse"]);return n!=null&&d(e,["sdkHttpResponse"],n),e}function $L(t){let e={},n=u(t,["sdkHttpResponse"]);return n!=null&&d(e,["sdkHttpResponse"],n),e}function qL(t,e){let n={},r=u(t,["outputGcsUri"]);e!==void 0&&r!=null&&d(e,["parameters","storageUri"],r);let o=u(t,["negativePrompt"]);e!==void 0&&o!=null&&d(e,["parameters","negativePrompt"],o);let i=u(t,["numberOfImages"]);e!==void 0&&i!=null&&d(e,["parameters","sampleCount"],i);let s=u(t,["aspectRatio"]);e!==void 0&&s!=null&&d(e,["parameters","aspectRatio"],s);let a=u(t,["guidanceScale"]);e!==void 0&&a!=null&&d(e,["parameters","guidanceScale"],a);let l=u(t,["seed"]);e!==void 0&&l!=null&&d(e,["parameters","seed"],l);let c=u(t,["safetyFilterLevel"]);e!==void 0&&c!=null&&d(e,["parameters","safetySetting"],c);let f=u(t,["personGeneration"]);e!==void 0&&f!=null&&d(e,["parameters","personGeneration"],f);let h=u(t,["includeSafetyAttributes"]);e!==void 0&&h!=null&&d(e,["parameters","includeSafetyAttributes"],h);let p=u(t,["includeRaiReason"]);e!==void 0&&p!=null&&d(e,["parameters","includeRaiReason"],p);let m=u(t,["language"]);e!==void 0&&m!=null&&d(e,["parameters","language"],m);let g=u(t,["outputMimeType"]);e!==void 0&&g!=null&&d(e,["parameters","outputOptions","mimeType"],g);let y=u(t,["outputCompressionQuality"]);e!==void 0&&y!=null&&d(e,["parameters","outputOptions","compressionQuality"],y);let _=u(t,["addWatermark"]);e!==void 0&&_!=null&&d(e,["parameters","addWatermark"],_);let C=u(t,["labels"]);e!==void 0&&C!=null&&d(e,["labels"],C);let I=u(t,["editMode"]);e!==void 0&&I!=null&&d(e,["parameters","editMode"],I);let w=u(t,["baseSteps"]);return e!==void 0&&w!=null&&d(e,["parameters","editConfig","baseSteps"],w),n}function WL(t,e){let n={},r=u(e,["model"]);r!=null&&d(n,["_url","model"],Z(t,r));let o=u(e,["prompt"]);o!=null&&d(n,["instances[0]","prompt"],o);let i=u(e,["referenceImages"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>jV(l))),d(n,["instances[0]","referenceImages"],a)}let s=u(e,["config"]);return s!=null&&qL(s,n),n}function zL(t){let e={},n=u(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);let r=u(t,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(i=>Cc(i))),d(e,["generatedImages"],o)}return e}function jL(t,e){let n={},r=u(t,["taskType"]);e!==void 0&&r!=null&&d(e,["requests[]","taskType"],r);let o=u(t,["title"]);e!==void 0&&o!=null&&d(e,["requests[]","title"],o);let i=u(t,["outputDimensionality"]);if(e!==void 0&&i!=null&&d(e,["requests[]","outputDimensionality"],i),u(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(u(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function YL(t,e){let n={},r=u(t,["taskType"]);e!==void 0&&r!=null&&d(e,["instances[]","task_type"],r);let o=u(t,["title"]);e!==void 0&&o!=null&&d(e,["instances[]","title"],o);let i=u(t,["outputDimensionality"]);e!==void 0&&i!=null&&d(e,["parameters","outputDimensionality"],i);let s=u(t,["mimeType"]);e!==void 0&&s!=null&&d(e,["instances[]","mimeType"],s);let a=u(t,["autoTruncate"]);return e!==void 0&&a!=null&&d(e,["parameters","autoTruncate"],a),n}function JL(t,e){let n={},r=u(e,["model"]);r!=null&&d(n,["_url","model"],Z(t,r));let o=u(e,["contents"]);if(o!=null){let a=Zg(t,o);Array.isArray(a)&&(a=a.map(l=>l)),d(n,["requests[]","content"],a)}let i=u(e,["config"]);i!=null&&jL(i,n);let s=u(e,["model"]);return s!==void 0&&d(n,["requests[]","model"],Z(t,s)),n}function KL(t,e){let n={},r=u(e,["model"]);r!=null&&d(n,["_url","model"],Z(t,r));let o=u(e,["contents"]);if(o!=null){let s=Zg(t,o);Array.isArray(s)&&(s=s.map(a=>a)),d(n,["instances[]","content"],s)}let i=u(e,["config"]);return i!=null&&YL(i,n),n}function QL(t){let e={},n=u(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);let r=u(t,["embeddings"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),d(e,["embeddings"],i)}let o=u(t,["metadata"]);return o!=null&&d(e,["metadata"],o),e}function ZL(t){let e={},n=u(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);let r=u(t,["predictions[]","embeddings"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>NL(s))),d(e,["embeddings"],i)}let o=u(t,["metadata"]);return o!=null&&d(e,["metadata"],o),e}function XL(t){let e={},n=u(t,["endpoint"]);n!=null&&d(e,["name"],n);let r=u(t,["deployedModelId"]);return r!=null&&d(e,["deployedModelId"],r),e}function eV(t){let e={};if(u(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let n=u(t,["fileUri"]);n!=null&&d(e,["fileUri"],n);let r=u(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function tV(t){let e={},n=u(t,["id"]);n!=null&&d(e,["id"],n);let r=u(t,["args"]);r!=null&&d(e,["args"],r);let o=u(t,["name"]);if(o!=null&&d(e,["name"],o),u(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(u(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function nV(t){let e={},n=u(t,["allowedFunctionNames"]);n!=null&&d(e,["allowedFunctionNames"],n);let r=u(t,["mode"]);if(r!=null&&d(e,["mode"],r),u(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function rV(t){let e={},n=u(t,["description"]);n!=null&&d(e,["description"],n);let r=u(t,["name"]);r!=null&&d(e,["name"],r);let o=u(t,["parameters"]);o!=null&&d(e,["parameters"],o);let i=u(t,["parametersJsonSchema"]);i!=null&&d(e,["parametersJsonSchema"],i);let s=u(t,["response"]);s!=null&&d(e,["response"],s);let a=u(t,["responseJsonSchema"]);if(a!=null&&d(e,["responseJsonSchema"],a),u(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function oV(t,e,n){let r={},o=u(e,["systemInstruction"]);n!==void 0&&o!=null&&d(n,["systemInstruction"],Ec(qe(o)));let i=u(e,["temperature"]);i!=null&&d(r,["temperature"],i);let s=u(e,["topP"]);s!=null&&d(r,["topP"],s);let a=u(e,["topK"]);a!=null&&d(r,["topK"],a);let l=u(e,["candidateCount"]);l!=null&&d(r,["candidateCount"],l);let c=u(e,["maxOutputTokens"]);c!=null&&d(r,["maxOutputTokens"],c);let f=u(e,["stopSequences"]);f!=null&&d(r,["stopSequences"],f);let h=u(e,["responseLogprobs"]);h!=null&&d(r,["responseLogprobs"],h);let p=u(e,["logprobs"]);p!=null&&d(r,["logprobs"],p);let m=u(e,["presencePenalty"]);m!=null&&d(r,["presencePenalty"],m);let g=u(e,["frequencyPenalty"]);g!=null&&d(r,["frequencyPenalty"],g);let y=u(e,["seed"]);y!=null&&d(r,["seed"],y);let _=u(e,["responseMimeType"]);_!=null&&d(r,["responseMimeType"],_);let C=u(e,["responseSchema"]);C!=null&&d(r,["responseSchema"],Xg(C));let I=u(e,["responseJsonSchema"]);if(I!=null&&d(r,["responseJsonSchema"],I),u(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(u(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");let w=u(e,["safetySettings"]);if(n!==void 0&&w!=null){let ve=w;Array.isArray(ve)&&(ve=ve.map(Vt=>YV(Vt))),d(n,["safetySettings"],ve)}let A=u(e,["tools"]);if(n!==void 0&&A!=null){let ve=ti(A);Array.isArray(ve)&&(ve=ve.map(Vt=>t2(ei(Vt)))),d(n,["tools"],ve)}let R=u(e,["toolConfig"]);if(n!==void 0&&R!=null&&d(n,["toolConfig"],e2(R)),u(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");let $=u(e,["cachedContent"]);n!==void 0&&$!=null&&d(n,["cachedContent"],xn(t,$));let L=u(e,["responseModalities"]);L!=null&&d(r,["responseModalities"],L);let P=u(e,["mediaResolution"]);P!=null&&d(r,["mediaResolution"],P);let b=u(e,["speechConfig"]);if(b!=null&&d(r,["speechConfig"],ey(b)),u(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");let N=u(e,["thinkingConfig"]);N!=null&&d(r,["thinkingConfig"],N);let we=u(e,["imageConfig"]);we!=null&&d(r,["imageConfig"],NV(we));let Lt=u(e,["enableEnhancedCivicAnswers"]);if(Lt!=null&&d(r,["enableEnhancedCivicAnswers"],Lt),u(e,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return r}function iV(t,e,n){let r={},o=u(e,["systemInstruction"]);n!==void 0&&o!=null&&d(n,["systemInstruction"],qe(o));let i=u(e,["temperature"]);i!=null&&d(r,["temperature"],i);let s=u(e,["topP"]);s!=null&&d(r,["topP"],s);let a=u(e,["topK"]);a!=null&&d(r,["topK"],a);let l=u(e,["candidateCount"]);l!=null&&d(r,["candidateCount"],l);let c=u(e,["maxOutputTokens"]);c!=null&&d(r,["maxOutputTokens"],c);let f=u(e,["stopSequences"]);f!=null&&d(r,["stopSequences"],f);let h=u(e,["responseLogprobs"]);h!=null&&d(r,["responseLogprobs"],h);let p=u(e,["logprobs"]);p!=null&&d(r,["logprobs"],p);let m=u(e,["presencePenalty"]);m!=null&&d(r,["presencePenalty"],m);let g=u(e,["frequencyPenalty"]);g!=null&&d(r,["frequencyPenalty"],g);let y=u(e,["seed"]);y!=null&&d(r,["seed"],y);let _=u(e,["responseMimeType"]);_!=null&&d(r,["responseMimeType"],_);let C=u(e,["responseSchema"]);C!=null&&d(r,["responseSchema"],Xg(C));let I=u(e,["responseJsonSchema"]);I!=null&&d(r,["responseJsonSchema"],I);let w=u(e,["routingConfig"]);w!=null&&d(r,["routingConfig"],w);let A=u(e,["modelSelectionConfig"]);A!=null&&d(r,["modelConfig"],A);let R=u(e,["safetySettings"]);if(n!==void 0&&R!=null){let cn=R;Array.isArray(cn)&&(cn=cn.map(Tc=>Tc)),d(n,["safetySettings"],cn)}let $=u(e,["tools"]);if(n!==void 0&&$!=null){let cn=ti($);Array.isArray(cn)&&(cn=cn.map(Tc=>Ew(ei(Tc)))),d(n,["tools"],cn)}let L=u(e,["toolConfig"]);n!==void 0&&L!=null&&d(n,["toolConfig"],L);let P=u(e,["labels"]);n!==void 0&&P!=null&&d(n,["labels"],P);let b=u(e,["cachedContent"]);n!==void 0&&b!=null&&d(n,["cachedContent"],xn(t,b));let N=u(e,["responseModalities"]);N!=null&&d(r,["responseModalities"],N);let we=u(e,["mediaResolution"]);we!=null&&d(r,["mediaResolution"],we);let Lt=u(e,["speechConfig"]);Lt!=null&&d(r,["speechConfig"],ey(Lt));let ve=u(e,["audioTimestamp"]);ve!=null&&d(r,["audioTimestamp"],ve);let Vt=u(e,["thinkingConfig"]);Vt!=null&&d(r,["thinkingConfig"],Vt);let ry=u(e,["imageConfig"]);if(ry!=null&&d(r,["imageConfig"],RV(ry)),u(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");let oy=u(e,["modelArmorConfig"]);return n!==void 0&&oy!=null&&d(n,["modelArmorConfig"],oy),r}function OI(t,e){let n={},r=u(e,["model"]);r!=null&&d(n,["_url","model"],Z(t,r));let o=u(e,["contents"]);if(o!=null){let s=vt(o);Array.isArray(s)&&(s=s.map(a=>Ec(a))),d(n,["contents"],s)}let i=u(e,["config"]);return i!=null&&d(n,["generationConfig"],oV(t,i,n)),n}function LI(t,e){let n={},r=u(e,["model"]);r!=null&&d(n,["_url","model"],Z(t,r));let o=u(e,["contents"]);if(o!=null){let s=vt(o);Array.isArray(s)&&(s=s.map(a=>a)),d(n,["contents"],s)}let i=u(e,["config"]);return i!=null&&d(n,["generationConfig"],iV(t,i,n)),n}function VI(t){let e={},n=u(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);let r=u(t,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>bL(c))),d(e,["candidates"],l)}let o=u(t,["modelVersion"]);o!=null&&d(e,["modelVersion"],o);let i=u(t,["promptFeedback"]);i!=null&&d(e,["promptFeedback"],i);let s=u(t,["responseId"]);s!=null&&d(e,["responseId"],s);let a=u(t,["usageMetadata"]);return a!=null&&d(e,["usageMetadata"],a),e}function UI(t){let e={},n=u(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);let r=u(t,["candidates"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(f=>f)),d(e,["candidates"],c)}let o=u(t,["createTime"]);o!=null&&d(e,["createTime"],o);let i=u(t,["modelVersion"]);i!=null&&d(e,["modelVersion"],i);let s=u(t,["promptFeedback"]);s!=null&&d(e,["promptFeedback"],s);let a=u(t,["responseId"]);a!=null&&d(e,["responseId"],a);let l=u(t,["usageMetadata"]);return l!=null&&d(e,["usageMetadata"],l),e}function sV(t,e){let n={};if(u(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(u(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");let r=u(t,["numberOfImages"]);e!==void 0&&r!=null&&d(e,["parameters","sampleCount"],r);let o=u(t,["aspectRatio"]);e!==void 0&&o!=null&&d(e,["parameters","aspectRatio"],o);let i=u(t,["guidanceScale"]);if(e!==void 0&&i!=null&&d(e,["parameters","guidanceScale"],i),u(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");let s=u(t,["safetyFilterLevel"]);e!==void 0&&s!=null&&d(e,["parameters","safetySetting"],s);let a=u(t,["personGeneration"]);e!==void 0&&a!=null&&d(e,["parameters","personGeneration"],a);let l=u(t,["includeSafetyAttributes"]);e!==void 0&&l!=null&&d(e,["parameters","includeSafetyAttributes"],l);let c=u(t,["includeRaiReason"]);e!==void 0&&c!=null&&d(e,["parameters","includeRaiReason"],c);let f=u(t,["language"]);e!==void 0&&f!=null&&d(e,["parameters","language"],f);let h=u(t,["outputMimeType"]);e!==void 0&&h!=null&&d(e,["parameters","outputOptions","mimeType"],h);let p=u(t,["outputCompressionQuality"]);if(e!==void 0&&p!=null&&d(e,["parameters","outputOptions","compressionQuality"],p),u(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(u(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");let m=u(t,["imageSize"]);if(e!==void 0&&m!=null&&d(e,["parameters","sampleImageSize"],m),u(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function aV(t,e){let n={},r=u(t,["outputGcsUri"]);e!==void 0&&r!=null&&d(e,["parameters","storageUri"],r);let o=u(t,["negativePrompt"]);e!==void 0&&o!=null&&d(e,["parameters","negativePrompt"],o);let i=u(t,["numberOfImages"]);e!==void 0&&i!=null&&d(e,["parameters","sampleCount"],i);let s=u(t,["aspectRatio"]);e!==void 0&&s!=null&&d(e,["parameters","aspectRatio"],s);let a=u(t,["guidanceScale"]);e!==void 0&&a!=null&&d(e,["parameters","guidanceScale"],a);let l=u(t,["seed"]);e!==void 0&&l!=null&&d(e,["parameters","seed"],l);let c=u(t,["safetyFilterLevel"]);e!==void 0&&c!=null&&d(e,["parameters","safetySetting"],c);let f=u(t,["personGeneration"]);e!==void 0&&f!=null&&d(e,["parameters","personGeneration"],f);let h=u(t,["includeSafetyAttributes"]);e!==void 0&&h!=null&&d(e,["parameters","includeSafetyAttributes"],h);let p=u(t,["includeRaiReason"]);e!==void 0&&p!=null&&d(e,["parameters","includeRaiReason"],p);let m=u(t,["language"]);e!==void 0&&m!=null&&d(e,["parameters","language"],m);let g=u(t,["outputMimeType"]);e!==void 0&&g!=null&&d(e,["parameters","outputOptions","mimeType"],g);let y=u(t,["outputCompressionQuality"]);e!==void 0&&y!=null&&d(e,["parameters","outputOptions","compressionQuality"],y);let _=u(t,["addWatermark"]);e!==void 0&&_!=null&&d(e,["parameters","addWatermark"],_);let C=u(t,["labels"]);e!==void 0&&C!=null&&d(e,["labels"],C);let I=u(t,["imageSize"]);e!==void 0&&I!=null&&d(e,["parameters","sampleImageSize"],I);let w=u(t,["enhancePrompt"]);return e!==void 0&&w!=null&&d(e,["parameters","enhancePrompt"],w),n}function lV(t,e){let n={},r=u(e,["model"]);r!=null&&d(n,["_url","model"],Z(t,r));let o=u(e,["prompt"]);o!=null&&d(n,["instances[0]","prompt"],o);let i=u(e,["config"]);return i!=null&&sV(i,n),n}function uV(t,e){let n={},r=u(e,["model"]);r!=null&&d(n,["_url","model"],Z(t,r));let o=u(e,["prompt"]);o!=null&&d(n,["instances[0]","prompt"],o);let i=u(e,["config"]);return i!=null&&aV(i,n),n}function cV(t){let e={},n=u(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);let r=u(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>DV(s))),d(e,["generatedImages"],i)}let o=u(t,["positivePromptSafetyAttributes"]);return o!=null&&d(e,["positivePromptSafetyAttributes"],_w(o)),e}function dV(t){let e={},n=u(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);let r=u(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>Cc(s))),d(e,["generatedImages"],i)}let o=u(t,["positivePromptSafetyAttributes"]);return o!=null&&d(e,["positivePromptSafetyAttributes"],vw(o)),e}function fV(t,e){let n={},r=u(t,["numberOfVideos"]);if(e!==void 0&&r!=null&&d(e,["parameters","sampleCount"],r),u(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(u(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");let o=u(t,["durationSeconds"]);if(e!==void 0&&o!=null&&d(e,["parameters","durationSeconds"],o),u(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");let i=u(t,["aspectRatio"]);e!==void 0&&i!=null&&d(e,["parameters","aspectRatio"],i);let s=u(t,["resolution"]);e!==void 0&&s!=null&&d(e,["parameters","resolution"],s);let a=u(t,["personGeneration"]);if(e!==void 0&&a!=null&&d(e,["parameters","personGeneration"],a),u(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");let l=u(t,["negativePrompt"]);e!==void 0&&l!=null&&d(e,["parameters","negativePrompt"],l);let c=u(t,["enhancePrompt"]);if(e!==void 0&&c!=null&&d(e,["parameters","enhancePrompt"],c),u(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");let f=u(t,["lastFrame"]);e!==void 0&&f!=null&&d(e,["instances[0]","lastFrame"],Dc(f));let h=u(t,["referenceImages"]);if(e!==void 0&&h!=null){let p=h;Array.isArray(p)&&(p=p.map(m=>p2(m))),d(e,["instances[0]","referenceImages"],p)}if(u(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(u(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function hV(t,e){let n={},r=u(t,["numberOfVideos"]);e!==void 0&&r!=null&&d(e,["parameters","sampleCount"],r);let o=u(t,["outputGcsUri"]);e!==void 0&&o!=null&&d(e,["parameters","storageUri"],o);let i=u(t,["fps"]);e!==void 0&&i!=null&&d(e,["parameters","fps"],i);let s=u(t,["durationSeconds"]);e!==void 0&&s!=null&&d(e,["parameters","durationSeconds"],s);let a=u(t,["seed"]);e!==void 0&&a!=null&&d(e,["parameters","seed"],a);let l=u(t,["aspectRatio"]);e!==void 0&&l!=null&&d(e,["parameters","aspectRatio"],l);let c=u(t,["resolution"]);e!==void 0&&c!=null&&d(e,["parameters","resolution"],c);let f=u(t,["personGeneration"]);e!==void 0&&f!=null&&d(e,["parameters","personGeneration"],f);let h=u(t,["pubsubTopic"]);e!==void 0&&h!=null&&d(e,["parameters","pubsubTopic"],h);let p=u(t,["negativePrompt"]);e!==void 0&&p!=null&&d(e,["parameters","negativePrompt"],p);let m=u(t,["enhancePrompt"]);e!==void 0&&m!=null&&d(e,["parameters","enhancePrompt"],m);let g=u(t,["generateAudio"]);e!==void 0&&g!=null&&d(e,["parameters","generateAudio"],g);let y=u(t,["lastFrame"]);e!==void 0&&y!=null&&d(e,["instances[0]","lastFrame"],Ot(y));let _=u(t,["referenceImages"]);if(e!==void 0&&_!=null){let w=_;Array.isArray(w)&&(w=w.map(A=>m2(A))),d(e,["instances[0]","referenceImages"],w)}let C=u(t,["mask"]);e!==void 0&&C!=null&&d(e,["instances[0]","mask"],h2(C));let I=u(t,["compressionQuality"]);return e!==void 0&&I!=null&&d(e,["parameters","compressionQuality"],I),n}function pV(t){let e={},n=u(t,["name"]);n!=null&&d(e,["name"],n);let r=u(t,["metadata"]);r!=null&&d(e,["metadata"],r);let o=u(t,["done"]);o!=null&&d(e,["done"],o);let i=u(t,["error"]);i!=null&&d(e,["error"],i);let s=u(t,["response","generateVideoResponse"]);return s!=null&&d(e,["response"],_V(s)),e}function mV(t){let e={},n=u(t,["name"]);n!=null&&d(e,["name"],n);let r=u(t,["metadata"]);r!=null&&d(e,["metadata"],r);let o=u(t,["done"]);o!=null&&d(e,["done"],o);let i=u(t,["error"]);i!=null&&d(e,["error"],i);let s=u(t,["response"]);return s!=null&&d(e,["response"],vV(s)),e}function gV(t,e){let n={},r=u(e,["model"]);r!=null&&d(n,["_url","model"],Z(t,r));let o=u(e,["prompt"]);o!=null&&d(n,["instances[0]","prompt"],o);let i=u(e,["image"]);i!=null&&d(n,["instances[0]","image"],Dc(i));let s=u(e,["video"]);s!=null&&d(n,["instances[0]","video"],Cw(s));let a=u(e,["source"]);a!=null&&EV(a,n);let l=u(e,["config"]);return l!=null&&fV(l,n),n}function yV(t,e){let n={},r=u(e,["model"]);r!=null&&d(n,["_url","model"],Z(t,r));let o=u(e,["prompt"]);o!=null&&d(n,["instances[0]","prompt"],o);let i=u(e,["image"]);i!=null&&d(n,["instances[0]","image"],Ot(i));let s=u(e,["video"]);s!=null&&d(n,["instances[0]","video"],Dw(s));let a=u(e,["source"]);a!=null&&CV(a,n);let l=u(e,["config"]);return l!=null&&hV(l,n),n}function _V(t){let e={},n=u(t,["generatedSamples"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>wV(s))),d(e,["generatedVideos"],i)}let r=u(t,["raiMediaFilteredCount"]);r!=null&&d(e,["raiMediaFilteredCount"],r);let o=u(t,["raiMediaFilteredReasons"]);return o!=null&&d(e,["raiMediaFilteredReasons"],o),e}function vV(t){let e={},n=u(t,["videos"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>TV(s))),d(e,["generatedVideos"],i)}let r=u(t,["raiMediaFilteredCount"]);r!=null&&d(e,["raiMediaFilteredCount"],r);let o=u(t,["raiMediaFilteredReasons"]);return o!=null&&d(e,["raiMediaFilteredReasons"],o),e}function EV(t,e){let n={},r=u(t,["prompt"]);e!==void 0&&r!=null&&d(e,["instances[0]","prompt"],r);let o=u(t,["image"]);e!==void 0&&o!=null&&d(e,["instances[0]","image"],Dc(o));let i=u(t,["video"]);return e!==void 0&&i!=null&&d(e,["instances[0]","video"],Cw(i)),n}function CV(t,e){let n={},r=u(t,["prompt"]);e!==void 0&&r!=null&&d(e,["instances[0]","prompt"],r);let o=u(t,["image"]);e!==void 0&&o!=null&&d(e,["instances[0]","image"],Ot(o));let i=u(t,["video"]);return e!==void 0&&i!=null&&d(e,["instances[0]","video"],Dw(i)),n}function DV(t){let e={},n=u(t,["_self"]);n!=null&&d(e,["image"],PV(n));let r=u(t,["raiFilteredReason"]);r!=null&&d(e,["raiFilteredReason"],r);let o=u(t,["_self"]);return o!=null&&d(e,["safetyAttributes"],_w(o)),e}function Cc(t){let e={},n=u(t,["_self"]);n!=null&&d(e,["image"],yw(n));let r=u(t,["raiFilteredReason"]);r!=null&&d(e,["raiFilteredReason"],r);let o=u(t,["_self"]);o!=null&&d(e,["safetyAttributes"],vw(o));let i=u(t,["prompt"]);return i!=null&&d(e,["enhancedPrompt"],i),e}function IV(t){let e={},n=u(t,["_self"]);n!=null&&d(e,["mask"],yw(n));let r=u(t,["labels"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(i=>i)),d(e,["labels"],o)}return e}function wV(t){let e={},n=u(t,["video"]);return n!=null&&d(e,["video"],d2(n)),e}function TV(t){let e={},n=u(t,["_self"]);return n!=null&&d(e,["video"],f2(n)),e}function SV(t){let e={},n=u(t,["modelSelectionConfig"]);n!=null&&d(e,["modelConfig"],n);let r=u(t,["responseJsonSchema"]);r!=null&&d(e,["responseJsonSchema"],r);let o=u(t,["audioTimestamp"]);o!=null&&d(e,["audioTimestamp"],o);let i=u(t,["candidateCount"]);i!=null&&d(e,["candidateCount"],i);let s=u(t,["enableAffectiveDialog"]);s!=null&&d(e,["enableAffectiveDialog"],s);let a=u(t,["frequencyPenalty"]);a!=null&&d(e,["frequencyPenalty"],a);let l=u(t,["logprobs"]);l!=null&&d(e,["logprobs"],l);let c=u(t,["maxOutputTokens"]);c!=null&&d(e,["maxOutputTokens"],c);let f=u(t,["mediaResolution"]);f!=null&&d(e,["mediaResolution"],f);let h=u(t,["presencePenalty"]);h!=null&&d(e,["presencePenalty"],h);let p=u(t,["responseLogprobs"]);p!=null&&d(e,["responseLogprobs"],p);let m=u(t,["responseMimeType"]);m!=null&&d(e,["responseMimeType"],m);let g=u(t,["responseModalities"]);g!=null&&d(e,["responseModalities"],g);let y=u(t,["responseSchema"]);y!=null&&d(e,["responseSchema"],y);let _=u(t,["routingConfig"]);_!=null&&d(e,["routingConfig"],_);let C=u(t,["seed"]);C!=null&&d(e,["seed"],C);let I=u(t,["speechConfig"]);I!=null&&d(e,["speechConfig"],I);let w=u(t,["stopSequences"]);w!=null&&d(e,["stopSequences"],w);let A=u(t,["temperature"]);A!=null&&d(e,["temperature"],A);let R=u(t,["thinkingConfig"]);R!=null&&d(e,["thinkingConfig"],R);let $=u(t,["topK"]);$!=null&&d(e,["topK"],$);let L=u(t,["topP"]);if(L!=null&&d(e,["topP"],L),u(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function bV(t,e){let n={},r=u(e,["model"]);return r!=null&&d(n,["_url","name"],Z(t,r)),n}function AV(t,e){let n={},r=u(e,["model"]);return r!=null&&d(n,["_url","name"],Z(t,r)),n}function MV(t){let e={};if(u(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");let n=u(t,["enableWidget"]);return n!=null&&d(e,["enableWidget"],n),e}function xV(t){let e={};if(u(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(u(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");let n=u(t,["timeRangeFilter"]);return n!=null&&d(e,["timeRangeFilter"],n),e}function NV(t){let e={},n=u(t,["aspectRatio"]);n!=null&&d(e,["aspectRatio"],n);let r=u(t,["imageSize"]);if(r!=null&&d(e,["imageSize"],r),u(t,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(u(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(u(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function RV(t){let e={},n=u(t,["aspectRatio"]);n!=null&&d(e,["aspectRatio"],n);let r=u(t,["imageSize"]);r!=null&&d(e,["imageSize"],r);let o=u(t,["personGeneration"]);o!=null&&d(e,["personGeneration"],o);let i=u(t,["outputMimeType"]);i!=null&&d(e,["imageOutputOptions","mimeType"],i);let s=u(t,["outputCompressionQuality"]);return s!=null&&d(e,["imageOutputOptions","compressionQuality"],s),e}function PV(t){let e={},n=u(t,["bytesBase64Encoded"]);n!=null&&d(e,["imageBytes"],nr(n));let r=u(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function yw(t){let e={},n=u(t,["gcsUri"]);n!=null&&d(e,["gcsUri"],n);let r=u(t,["bytesBase64Encoded"]);r!=null&&d(e,["imageBytes"],nr(r));let o=u(t,["mimeType"]);return o!=null&&d(e,["mimeType"],o),e}function Dc(t){let e={};if(u(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");let n=u(t,["imageBytes"]);n!=null&&d(e,["bytesBase64Encoded"],nr(n));let r=u(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function Ot(t){let e={},n=u(t,["gcsUri"]);n!=null&&d(e,["gcsUri"],n);let r=u(t,["imageBytes"]);r!=null&&d(e,["bytesBase64Encoded"],nr(r));let o=u(t,["mimeType"]);return o!=null&&d(e,["mimeType"],o),e}function kV(t,e,n){let r={},o=u(e,["pageSize"]);n!==void 0&&o!=null&&d(n,["_query","pageSize"],o);let i=u(e,["pageToken"]);n!==void 0&&i!=null&&d(n,["_query","pageToken"],i);let s=u(e,["filter"]);n!==void 0&&s!=null&&d(n,["_query","filter"],s);let a=u(e,["queryBase"]);return n!==void 0&&a!=null&&d(n,["_url","models_url"],cw(t,a)),r}function FV(t,e,n){let r={},o=u(e,["pageSize"]);n!==void 0&&o!=null&&d(n,["_query","pageSize"],o);let i=u(e,["pageToken"]);n!==void 0&&i!=null&&d(n,["_query","pageToken"],i);let s=u(e,["filter"]);n!==void 0&&s!=null&&d(n,["_query","filter"],s);let a=u(e,["queryBase"]);return n!==void 0&&a!=null&&d(n,["_url","models_url"],cw(t,a)),r}function OV(t,e){let n={},r=u(e,["config"]);return r!=null&&kV(t,r,n),n}function LV(t,e){let n={},r=u(e,["config"]);return r!=null&&FV(t,r,n),n}function VV(t){let e={},n=u(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);let r=u(t,["nextPageToken"]);r!=null&&d(e,["nextPageToken"],r);let o=u(t,["_self"]);if(o!=null){let i=dw(o);Array.isArray(i)&&(i=i.map(s=>Ig(s))),d(e,["models"],i)}return e}function UV(t){let e={},n=u(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);let r=u(t,["nextPageToken"]);r!=null&&d(e,["nextPageToken"],r);let o=u(t,["_self"]);if(o!=null){let i=dw(o);Array.isArray(i)&&(i=i.map(s=>wg(s))),d(e,["models"],i)}return e}function BV(t){let e={},n=u(t,["maskMode"]);n!=null&&d(e,["maskMode"],n);let r=u(t,["segmentationClasses"]);r!=null&&d(e,["maskClasses"],r);let o=u(t,["maskDilation"]);return o!=null&&d(e,["dilation"],o),e}function Ig(t){let e={},n=u(t,["name"]);n!=null&&d(e,["name"],n);let r=u(t,["displayName"]);r!=null&&d(e,["displayName"],r);let o=u(t,["description"]);o!=null&&d(e,["description"],o);let i=u(t,["version"]);i!=null&&d(e,["version"],i);let s=u(t,["_self"]);s!=null&&d(e,["tunedModelInfo"],n2(s));let a=u(t,["inputTokenLimit"]);a!=null&&d(e,["inputTokenLimit"],a);let l=u(t,["outputTokenLimit"]);l!=null&&d(e,["outputTokenLimit"],l);let c=u(t,["supportedGenerationMethods"]);c!=null&&d(e,["supportedActions"],c);let f=u(t,["temperature"]);f!=null&&d(e,["temperature"],f);let h=u(t,["maxTemperature"]);h!=null&&d(e,["maxTemperature"],h);let p=u(t,["topP"]);p!=null&&d(e,["topP"],p);let m=u(t,["topK"]);m!=null&&d(e,["topK"],m);let g=u(t,["thinking"]);return g!=null&&d(e,["thinking"],g),e}function wg(t){let e={},n=u(t,["name"]);n!=null&&d(e,["name"],n);let r=u(t,["displayName"]);r!=null&&d(e,["displayName"],r);let o=u(t,["description"]);o!=null&&d(e,["description"],o);let i=u(t,["versionId"]);i!=null&&d(e,["version"],i);let s=u(t,["deployedModels"]);if(s!=null){let h=s;Array.isArray(h)&&(h=h.map(p=>XL(p))),d(e,["endpoints"],h)}let a=u(t,["labels"]);a!=null&&d(e,["labels"],a);let l=u(t,["_self"]);l!=null&&d(e,["tunedModelInfo"],r2(l));let c=u(t,["defaultCheckpointId"]);c!=null&&d(e,["defaultCheckpointId"],c);let f=u(t,["checkpoints"]);if(f!=null){let h=f;Array.isArray(h)&&(h=h.map(p=>p)),d(e,["checkpoints"],h)}return e}function HV(t){let e={},n=u(t,["mediaResolution"]);n!=null&&d(e,["mediaResolution"],n);let r=u(t,["codeExecutionResult"]);r!=null&&d(e,["codeExecutionResult"],r);let o=u(t,["executableCode"]);o!=null&&d(e,["executableCode"],o);let i=u(t,["fileData"]);i!=null&&d(e,["fileData"],eV(i));let s=u(t,["functionCall"]);s!=null&&d(e,["functionCall"],tV(s));let a=u(t,["functionResponse"]);a!=null&&d(e,["functionResponse"],a);let l=u(t,["inlineData"]);l!=null&&d(e,["inlineData"],SL(l));let c=u(t,["text"]);c!=null&&d(e,["text"],c);let f=u(t,["thought"]);f!=null&&d(e,["thought"],f);let h=u(t,["thoughtSignature"]);h!=null&&d(e,["thoughtSignature"],h);let p=u(t,["videoMetadata"]);return p!=null&&d(e,["videoMetadata"],p),e}function GV(t){let e={},n=u(t,["productImage"]);return n!=null&&d(e,["image"],Ot(n)),e}function $V(t,e){let n={},r=u(t,["numberOfImages"]);e!==void 0&&r!=null&&d(e,["parameters","sampleCount"],r);let o=u(t,["baseSteps"]);e!==void 0&&o!=null&&d(e,["parameters","baseSteps"],o);let i=u(t,["outputGcsUri"]);e!==void 0&&i!=null&&d(e,["parameters","storageUri"],i);let s=u(t,["seed"]);e!==void 0&&s!=null&&d(e,["parameters","seed"],s);let a=u(t,["safetyFilterLevel"]);e!==void 0&&a!=null&&d(e,["parameters","safetySetting"],a);let l=u(t,["personGeneration"]);e!==void 0&&l!=null&&d(e,["parameters","personGeneration"],l);let c=u(t,["addWatermark"]);e!==void 0&&c!=null&&d(e,["parameters","addWatermark"],c);let f=u(t,["outputMimeType"]);e!==void 0&&f!=null&&d(e,["parameters","outputOptions","mimeType"],f);let h=u(t,["outputCompressionQuality"]);e!==void 0&&h!=null&&d(e,["parameters","outputOptions","compressionQuality"],h);let p=u(t,["enhancePrompt"]);e!==void 0&&p!=null&&d(e,["parameters","enhancePrompt"],p);let m=u(t,["labels"]);return e!==void 0&&m!=null&&d(e,["labels"],m),n}function qV(t,e){let n={},r=u(e,["model"]);r!=null&&d(n,["_url","model"],Z(t,r));let o=u(e,["source"]);o!=null&&zV(o,n);let i=u(e,["config"]);return i!=null&&$V(i,n),n}function WV(t){let e={},n=u(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(o=>Cc(o))),d(e,["generatedImages"],r)}return e}function zV(t,e){let n={},r=u(t,["prompt"]);e!==void 0&&r!=null&&d(e,["instances[0]","prompt"],r);let o=u(t,["personImage"]);e!==void 0&&o!=null&&d(e,["instances[0]","personImage","image"],Ot(o));let i=u(t,["productImages"]);if(e!==void 0&&i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>GV(a))),d(e,["instances[0]","productImages"],s)}return n}function jV(t){let e={},n=u(t,["referenceImage"]);n!=null&&d(e,["referenceImage"],Ot(n));let r=u(t,["referenceId"]);r!=null&&d(e,["referenceId"],r);let o=u(t,["referenceType"]);o!=null&&d(e,["referenceType"],o);let i=u(t,["maskImageConfig"]);i!=null&&d(e,["maskImageConfig"],BV(i));let s=u(t,["controlImageConfig"]);s!=null&&d(e,["controlImageConfig"],PL(s));let a=u(t,["styleImageConfig"]);a!=null&&d(e,["styleImageConfig"],a);let l=u(t,["subjectImageConfig"]);return l!=null&&d(e,["subjectImageConfig"],l),e}function _w(t){let e={},n=u(t,["safetyAttributes","categories"]);n!=null&&d(e,["categories"],n);let r=u(t,["safetyAttributes","scores"]);r!=null&&d(e,["scores"],r);let o=u(t,["contentType"]);return o!=null&&d(e,["contentType"],o),e}function vw(t){let e={},n=u(t,["safetyAttributes","categories"]);n!=null&&d(e,["categories"],n);let r=u(t,["safetyAttributes","scores"]);r!=null&&d(e,["scores"],r);let o=u(t,["contentType"]);return o!=null&&d(e,["contentType"],o),e}function YV(t){let e={},n=u(t,["category"]);if(n!=null&&d(e,["category"],n),u(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");let r=u(t,["threshold"]);return r!=null&&d(e,["threshold"],r),e}function JV(t){let e={},n=u(t,["image"]);return n!=null&&d(e,["image"],Ot(n)),e}function KV(t,e){let n={},r=u(t,["mode"]);e!==void 0&&r!=null&&d(e,["parameters","mode"],r);let o=u(t,["maxPredictions"]);e!==void 0&&o!=null&&d(e,["parameters","maxPredictions"],o);let i=u(t,["confidenceThreshold"]);e!==void 0&&i!=null&&d(e,["parameters","confidenceThreshold"],i);let s=u(t,["maskDilation"]);e!==void 0&&s!=null&&d(e,["parameters","maskDilation"],s);let a=u(t,["binaryColorThreshold"]);e!==void 0&&a!=null&&d(e,["parameters","binaryColorThreshold"],a);let l=u(t,["labels"]);return e!==void 0&&l!=null&&d(e,["labels"],l),n}function QV(t,e){let n={},r=u(e,["model"]);r!=null&&d(n,["_url","model"],Z(t,r));let o=u(e,["source"]);o!=null&&XV(o,n);let i=u(e,["config"]);return i!=null&&KV(i,n),n}function ZV(t){let e={},n=u(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(o=>IV(o))),d(e,["generatedMasks"],r)}return e}function XV(t,e){let n={},r=u(t,["prompt"]);e!==void 0&&r!=null&&d(e,["instances[0]","prompt"],r);let o=u(t,["image"]);e!==void 0&&o!=null&&d(e,["instances[0]","image"],Ot(o));let i=u(t,["scribbleImage"]);return e!==void 0&&i!=null&&d(e,["instances[0]","scribble"],JV(i)),n}function e2(t){let e={},n=u(t,["retrievalConfig"]);n!=null&&d(e,["retrievalConfig"],n);let r=u(t,["functionCallingConfig"]);return r!=null&&d(e,["functionCallingConfig"],nV(r)),e}function t2(t){let e={};if(u(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");let n=u(t,["computerUse"]);n!=null&&d(e,["computerUse"],n);let r=u(t,["fileSearch"]);r!=null&&d(e,["fileSearch"],r);let o=u(t,["codeExecution"]);if(o!=null&&d(e,["codeExecution"],o),u(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");let i=u(t,["functionDeclarations"]);if(i!=null){let f=i;Array.isArray(f)&&(f=f.map(h=>h)),d(e,["functionDeclarations"],f)}let s=u(t,["googleMaps"]);s!=null&&d(e,["googleMaps"],MV(s));let a=u(t,["googleSearch"]);a!=null&&d(e,["googleSearch"],xV(a));let l=u(t,["googleSearchRetrieval"]);l!=null&&d(e,["googleSearchRetrieval"],l);let c=u(t,["urlContext"]);return c!=null&&d(e,["urlContext"],c),e}function Ew(t){let e={},n=u(t,["retrieval"]);n!=null&&d(e,["retrieval"],n);let r=u(t,["computerUse"]);if(r!=null&&d(e,["computerUse"],r),u(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");let o=u(t,["codeExecution"]);o!=null&&d(e,["codeExecution"],o);let i=u(t,["enterpriseWebSearch"]);i!=null&&d(e,["enterpriseWebSearch"],i);let s=u(t,["functionDeclarations"]);if(s!=null){let h=s;Array.isArray(h)&&(h=h.map(p=>rV(p))),d(e,["functionDeclarations"],h)}let a=u(t,["googleMaps"]);a!=null&&d(e,["googleMaps"],a);let l=u(t,["googleSearch"]);l!=null&&d(e,["googleSearch"],l);let c=u(t,["googleSearchRetrieval"]);c!=null&&d(e,["googleSearchRetrieval"],c);let f=u(t,["urlContext"]);return f!=null&&d(e,["urlContext"],f),e}function n2(t){let e={},n=u(t,["baseModel"]);n!=null&&d(e,["baseModel"],n);let r=u(t,["createTime"]);r!=null&&d(e,["createTime"],r);let o=u(t,["updateTime"]);return o!=null&&d(e,["updateTime"],o),e}function r2(t){let e={},n=u(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&d(e,["baseModel"],n);let r=u(t,["createTime"]);r!=null&&d(e,["createTime"],r);let o=u(t,["updateTime"]);return o!=null&&d(e,["updateTime"],o),e}function o2(t,e){let n={},r=u(t,["displayName"]);e!==void 0&&r!=null&&d(e,["displayName"],r);let o=u(t,["description"]);e!==void 0&&o!=null&&d(e,["description"],o);let i=u(t,["defaultCheckpointId"]);return e!==void 0&&i!=null&&d(e,["defaultCheckpointId"],i),n}function i2(t,e){let n={},r=u(t,["displayName"]);e!==void 0&&r!=null&&d(e,["displayName"],r);let o=u(t,["description"]);e!==void 0&&o!=null&&d(e,["description"],o);let i=u(t,["defaultCheckpointId"]);return e!==void 0&&i!=null&&d(e,["defaultCheckpointId"],i),n}function s2(t,e){let n={},r=u(e,["model"]);r!=null&&d(n,["_url","name"],Z(t,r));let o=u(e,["config"]);return o!=null&&o2(o,n),n}function a2(t,e){let n={},r=u(e,["model"]);r!=null&&d(n,["_url","model"],Z(t,r));let o=u(e,["config"]);return o!=null&&i2(o,n),n}function l2(t,e){let n={},r=u(t,["outputGcsUri"]);e!==void 0&&r!=null&&d(e,["parameters","storageUri"],r);let o=u(t,["safetyFilterLevel"]);e!==void 0&&o!=null&&d(e,["parameters","safetySetting"],o);let i=u(t,["personGeneration"]);e!==void 0&&i!=null&&d(e,["parameters","personGeneration"],i);let s=u(t,["includeRaiReason"]);e!==void 0&&s!=null&&d(e,["parameters","includeRaiReason"],s);let a=u(t,["outputMimeType"]);e!==void 0&&a!=null&&d(e,["parameters","outputOptions","mimeType"],a);let l=u(t,["outputCompressionQuality"]);e!==void 0&&l!=null&&d(e,["parameters","outputOptions","compressionQuality"],l);let c=u(t,["enhanceInputImage"]);e!==void 0&&c!=null&&d(e,["parameters","upscaleConfig","enhanceInputImage"],c);let f=u(t,["imagePreservationFactor"]);e!==void 0&&f!=null&&d(e,["parameters","upscaleConfig","imagePreservationFactor"],f);let h=u(t,["labels"]);e!==void 0&&h!=null&&d(e,["labels"],h);let p=u(t,["numberOfImages"]);e!==void 0&&p!=null&&d(e,["parameters","sampleCount"],p);let m=u(t,["mode"]);return e!==void 0&&m!=null&&d(e,["parameters","mode"],m),n}function u2(t,e){let n={},r=u(e,["model"]);r!=null&&d(n,["_url","model"],Z(t,r));let o=u(e,["image"]);o!=null&&d(n,["instances[0]","image"],Ot(o));let i=u(e,["upscaleFactor"]);i!=null&&d(n,["parameters","upscaleConfig","upscaleFactor"],i);let s=u(e,["config"]);return s!=null&&l2(s,n),n}function c2(t){let e={},n=u(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);let r=u(t,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(i=>Cc(i))),d(e,["generatedImages"],o)}return e}function d2(t){let e={},n=u(t,["uri"]);n!=null&&d(e,["uri"],n);let r=u(t,["encodedVideo"]);r!=null&&d(e,["videoBytes"],nr(r));let o=u(t,["encoding"]);return o!=null&&d(e,["mimeType"],o),e}function f2(t){let e={},n=u(t,["gcsUri"]);n!=null&&d(e,["uri"],n);let r=u(t,["bytesBase64Encoded"]);r!=null&&d(e,["videoBytes"],nr(r));let o=u(t,["mimeType"]);return o!=null&&d(e,["mimeType"],o),e}function h2(t){let e={},n=u(t,["image"]);n!=null&&d(e,["_self"],Ot(n));let r=u(t,["maskMode"]);return r!=null&&d(e,["maskMode"],r),e}function p2(t){let e={},n=u(t,["image"]);n!=null&&d(e,["image"],Dc(n));let r=u(t,["referenceType"]);return r!=null&&d(e,["referenceType"],r),e}function m2(t){let e={},n=u(t,["image"]);n!=null&&d(e,["image"],Ot(n));let r=u(t,["referenceType"]);return r!=null&&d(e,["referenceType"],r),e}function Cw(t){let e={},n=u(t,["uri"]);n!=null&&d(e,["uri"],n);let r=u(t,["videoBytes"]);r!=null&&d(e,["encodedVideo"],nr(r));let o=u(t,["mimeType"]);return o!=null&&d(e,["encoding"],o),e}function Dw(t){let e={},n=u(t,["uri"]);n!=null&&d(e,["gcsUri"],n);let r=u(t,["videoBytes"]);r!=null&&d(e,["bytesBase64Encoded"],nr(r));let o=u(t,["mimeType"]);return o!=null&&d(e,["mimeType"],o),e}function g2(t,e){let n={},r=u(t,["displayName"]);return e!==void 0&&r!=null&&d(e,["displayName"],r),n}function y2(t){let e={},n=u(t,["config"]);return n!=null&&g2(n,e),e}function _2(t,e){let n={},r=u(t,["force"]);return e!==void 0&&r!=null&&d(e,["_query","force"],r),n}function v2(t){let e={},n=u(t,["name"]);n!=null&&d(e,["_url","name"],n);let r=u(t,["config"]);return r!=null&&_2(r,e),e}function E2(t){let e={},n=u(t,["name"]);return n!=null&&d(e,["_url","name"],n),e}function C2(t,e){let n={},r=u(t,["customMetadata"]);if(e!==void 0&&r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),d(e,["customMetadata"],i)}let o=u(t,["chunkingConfig"]);return e!==void 0&&o!=null&&d(e,["chunkingConfig"],o),n}function D2(t){let e={},n=u(t,["name"]);n!=null&&d(e,["name"],n);let r=u(t,["metadata"]);r!=null&&d(e,["metadata"],r);let o=u(t,["done"]);o!=null&&d(e,["done"],o);let i=u(t,["error"]);i!=null&&d(e,["error"],i);let s=u(t,["response"]);return s!=null&&d(e,["response"],w2(s)),e}function I2(t){let e={},n=u(t,["fileSearchStoreName"]);n!=null&&d(e,["_url","file_search_store_name"],n);let r=u(t,["fileName"]);r!=null&&d(e,["fileName"],r);let o=u(t,["config"]);return o!=null&&C2(o,e),e}function w2(t){let e={},n=u(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);let r=u(t,["parent"]);r!=null&&d(e,["parent"],r);let o=u(t,["documentName"]);return o!=null&&d(e,["documentName"],o),e}function T2(t,e){let n={},r=u(t,["pageSize"]);e!==void 0&&r!=null&&d(e,["_query","pageSize"],r);let o=u(t,["pageToken"]);return e!==void 0&&o!=null&&d(e,["_query","pageToken"],o),n}function S2(t){let e={},n=u(t,["config"]);return n!=null&&T2(n,e),e}function b2(t){let e={},n=u(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);let r=u(t,["nextPageToken"]);r!=null&&d(e,["nextPageToken"],r);let o=u(t,["fileSearchStores"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(s=>s)),d(e,["fileSearchStores"],i)}return e}function Iw(t,e){let n={},r=u(t,["mimeType"]);e!==void 0&&r!=null&&d(e,["mimeType"],r);let o=u(t,["displayName"]);e!==void 0&&o!=null&&d(e,["displayName"],o);let i=u(t,["customMetadata"]);if(e!==void 0&&i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),d(e,["customMetadata"],a)}let s=u(t,["chunkingConfig"]);return e!==void 0&&s!=null&&d(e,["chunkingConfig"],s),n}function A2(t){let e={},n=u(t,["fileSearchStoreName"]);n!=null&&d(e,["_url","file_search_store_name"],n);let r=u(t,["config"]);return r!=null&&Iw(r,e),e}function M2(t){let e={},n=u(t,["sdkHttpResponse"]);return n!=null&&d(e,["sdkHttpResponse"],n),e}var x2="Content-Type",N2="X-Server-Timeout",R2="User-Agent",Tg="x-goog-api-client",P2="1.38.0",k2=`google-genai-sdk/${P2}`,F2="v1beta1",O2="v1beta",Sg=class{constructor(e){var n,r,o;this.clientOptions=Object.assign({},e),this.customBaseUrl=(n=e.httpOptions)===null||n===void 0?void 0:n.baseUrl,this.clientOptions.vertexai&&(this.clientOptions.project&&this.clientOptions.location?this.clientOptions.apiKey=void 0:this.clientOptions.apiKey&&(this.clientOptions.project=void 0,this.clientOptions.location=void 0));let i={};if(this.clientOptions.vertexai){if(!this.clientOptions.location&&!this.clientOptions.apiKey&&!this.customBaseUrl&&(this.clientOptions.location="global"),!(this.clientOptions.project&&this.clientOptions.location||this.clientOptions.apiKey)&&!this.customBaseUrl)throw new Error("Authentication is not set up. Please provide either a project and location, or an API key, or a custom base URL.");let a=e.project&&e.location||!!e.apiKey;this.customBaseUrl&&!a?(i.baseUrl=this.customBaseUrl,this.clientOptions.project=void 0,this.clientOptions.location=void 0):this.clientOptions.apiKey||this.clientOptions.location==="global"?i.baseUrl="https://aiplatform.googleapis.com/":this.clientOptions.project&&this.clientOptions.location&&(i.baseUrl=`https://${this.clientOptions.location}-aiplatform.googleapis.com/`),i.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:F2}else{if(!this.clientOptions.apiKey)throw new Ks({message:"API key must be set when using the Gemini API.",status:403});i.apiVersion=(o=this.clientOptions.apiVersion)!==null&&o!==void 0?o:O2,i.baseUrl="https://generativelanguage.googleapis.com/"}i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getCustomBaseUrl(){return this.customBaseUrl}async getAuthHeaders(){let e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");let r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){let e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,r){let o=[this.getRequestUrlInternal(n)];return r&&o.push(this.getBaseResourcePath()),e!==""&&o.push(e),new URL(`${o.join("/")}`)}shouldPrependVertexProjectPath(e,n){return!(n.baseUrl&&n.baseUrlResourceScope===nw.COLLECTION||this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));let r=this.shouldPrependVertexProjectPath(e,n),o=this.constructUrl(e.path,n,r);if(e.queryParams)for(let[s,a]of Object.entries(e.queryParams))o.searchParams.append(s,String(a));let i={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else i.body=e.body;return i=await this.includeExtraHttpOptionsToRequestInit(i,n,o.toString(),e.abortSignal),this.unaryApiCall(o,i,e.httpMethod)}patchHttpOptions(e,n){let r=JSON.parse(JSON.stringify(e));for(let[o,i]of Object.entries(n))typeof i=="object"?r[o]=Object.assign(Object.assign({},r[o]),i):i!==void 0&&(r[o]=i);return r}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));let r=this.shouldPrependVertexProjectPath(e,n),o=this.constructUrl(e.path,n,r);(!o.searchParams.has("alt")||o.searchParams.get("alt")!=="sse")&&o.searchParams.set("alt","sse");let i={};return i.body=e.body,i=await this.includeExtraHttpOptionsToRequestInit(i,n,o.toString(),e.abortSignal),this.streamApiCall(o,i,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,r,o){if(n&&n.timeout||o){let i=new AbortController,s=i.signal;if(n.timeout&&n?.timeout>0){let a=setTimeout(()=>i.abort(),n.timeout);a&&typeof a.unref=="function"&&a.unref()}o&&o.addEventListener("abort",()=>{i.abort()}),e.signal=s}return n&&n.extraBody!==null&&L2(e,n.extraBody),e.headers=await this.getHeadersInternal(n,r),e}async unaryApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async o=>(await BI(o),new Js(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}async streamApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async o=>(await BI(o),this.processStreamResponse(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}processStreamResponse(e){return Pt(this,arguments,function*(){var r;let o=(r=e?.body)===null||r===void 0?void 0:r.getReader(),i=new TextDecoder("utf-8");if(!o)throw new Error("Response body is empty");try{let s="",a="data:",l=[`

`,"\r\r",`\r
\r
`];for(;;){let{done:c,value:f}=yield U(o.read());if(c){if(s.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}let h=i.decode(f,{stream:!0});try{let g=JSON.parse(h);if("error"in g){let y=JSON.parse(JSON.stringify(g.error)),_=y.status,C=y.code,I=`got status: ${_}. ${JSON.stringify(g)}`;if(C>=400&&C<600)throw new Ks({message:I,status:C})}}catch(g){if(g.name==="ApiError")throw g}s+=h;let p=-1,m=0;for(;;){p=-1,m=0;for(let _ of l){let C=s.indexOf(_);C!==-1&&(p===-1||C<p)&&(p=C,m=_.length)}if(p===-1)break;let g=s.substring(0,p);s=s.substring(p+m);let y=g.trim();if(y.startsWith(a)){let _=y.substring(a.length).trim();try{let C=new Response(_,{headers:e?.headers,status:e?.status,statusText:e?.statusText});yield yield U(new Js(C))}catch(C){throw new Error(`exception parsing stream chunk ${_}. ${C}`)}}}}}finally{o.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){let e={},n=k2+" "+this.clientOptions.userAgentExtra;return e[R2]=n,e[Tg]=n,e[x2]="application/json",e}async getHeadersInternal(e,n){let r=new Headers;if(e&&e.headers){for(let[o,i]of Object.entries(e.headers))r.append(o,i);e.timeout&&e.timeout>0&&r.append(N2,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(r,n),r}getFileName(e){var n;let r="";return typeof e=="string"&&(r=e.replace(/[/\\]+$/,""),r=(n=r.split(/[/\\]/).pop())!==null&&n!==void 0?n:""),r}async uploadFile(e,n){var r;let o={};n!=null&&(o.mimeType=n.mimeType,o.name=n.name,o.displayName=n.displayName),o.name&&!o.name.startsWith("files/")&&(o.name=`files/${o.name}`);let i=this.clientOptions.uploader,s=await i.stat(e);o.sizeBytes=String(s.size);let a=(r=n?.mimeType)!==null&&r!==void 0?r:s.type;if(a===void 0||a==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");o.mimeType=a;let l={file:o},c=this.getFileName(e),f=M("upload/v1beta/files",l._url),h=await this.fetchUploadUrl(f,o.sizeBytes,o.mimeType,c,l,n?.httpOptions);return i.upload(e,h,this)}async uploadFileToFileSearchStore(e,n,r){var o;let i=this.clientOptions.uploader,s=await i.stat(n),a=String(s.size),l=(o=r?.mimeType)!==null&&o!==void 0?o:s.type;if(l===void 0||l==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");let c=`upload/v1beta/${e}:uploadToFileSearchStore`,f=this.getFileName(n),h={};r!=null&&Iw(r,h);let p=await this.fetchUploadUrl(c,a,l,f,h,r?.httpOptions);return i.uploadToFileSearchStore(n,p,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n,r,o,i,s){var a;let l={};s?l=s:l={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n}`,"X-Goog-Upload-Header-Content-Type":`${r}`},o?{"X-Goog-Upload-File-Name":o}:{})};let c=await this.request({path:e,body:JSON.stringify(i),httpMethod:"POST",httpOptions:l});if(!c||!c?.headers)throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");let f=(a=c?.headers)===null||a===void 0?void 0:a["x-goog-upload-url"];if(f===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return f}};async function BI(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){let n=t.status,r;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await t.json():r={error:{message:await t.text(),code:t.status,status:t.statusText}};let o=JSON.stringify(r);throw n>=400&&n<600?new Ks({message:o,status:n}):new Error(o)}}function L2(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{let i=JSON.parse(t.body);if(typeof i=="object"&&i!==null&&!Array.isArray(i))n=i;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(i,s){let a=Object.assign({},i);for(let l in s)if(Object.prototype.hasOwnProperty.call(s,l)){let c=s[l],f=a[l];c&&typeof c=="object"&&!Array.isArray(c)&&f&&typeof f=="object"&&!Array.isArray(f)?a[l]=r(f,c):(f&&c&&typeof f!=typeof c&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${l}". Original type: ${typeof f}, New type: ${typeof c}. Overwriting.`),a[l]=c)}return a}let o=r(n,e);t.body=JSON.stringify(o)}var V2="mcp_used/unknown",U2=!1;function ww(t){for(let e of t)if(B2(e)||typeof e=="object"&&"inputSchema"in e)return!0;return U2}function Tw(t){var e;let n=(e=t[Tg])!==null&&e!==void 0?e:"";t[Tg]=(n+` ${V2}`).trimStart()}function B2(t){return t!==null&&typeof t=="object"&&t instanceof bg}function H2(t){return Pt(this,arguments,function*(n,r=100){let o,i=0;for(;i<r;){let s=yield U(n.listTools({cursor:o}));for(let a of s.tools)yield yield U(a),i++;if(!s.nextCursor)break;o=s.nextCursor}})}var bg=class t{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new t(e,n)}async initialize(){var e,n,r,o;if(this.mcpTools.length>0)return;let i={},s=[];for(let f of this.mcpClients)try{for(var a=!0,l=(n=void 0,kt(H2(f))),c;c=await l.next(),e=c.done,!e;a=!0){o=c.value,a=!1;let h=o;s.push(h);let p=h.name;if(i[p])throw new Error(`Duplicate function name ${p} found in MCP tools. Please ensure function names are unique.`);i[p]=f}}catch(h){n={error:h}}finally{try{!a&&!e&&(r=l.return)&&await r.call(l)}finally{if(n)throw n.error}}this.mcpTools=s,this.functionNameToMcpClient=i}async tool(){return await this.initialize(),wF(this.mcpTools,this.config)}async callTool(e){await this.initialize();let n=[];for(let r of e)if(r.name in this.functionNameToMcpClient){let o=this.functionNameToMcpClient[r.name],i;this.config.timeout&&(i={timeout:this.config.timeout});let s=await o.callTool({name:r.name,arguments:r.args},void 0,i);n.push({functionResponse:{name:r.name,response:s.isError?{error:s}:s}})}return n}};async function G2(t,e,n){let r=new pg,o;n.data instanceof Blob?o=JSON.parse(await n.data.text()):o=JSON.parse(n.data),Object.assign(r,o),e(r)}var Ag=class{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r}async connect(e){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");let o=this.apiClient.getWebsocketBaseUrl(),i=this.apiClient.getApiVersion(),s=q2(this.apiClient.getDefaultHeaders()),a=this.apiClient.getApiKey(),l=`${o}/ws/google.ai.generativelanguage.${i}.GenerativeService.BidiGenerateMusic?key=${a}`,c=()=>{},f=new Promise(w=>{c=w}),h=e.callbacks,p=function(){c({})},m=this.apiClient,g={onopen:p,onmessage:w=>{G2(m,h.onmessage,w)},onerror:(n=h?.onerror)!==null&&n!==void 0?n:function(w){},onclose:(r=h?.onclose)!==null&&r!==void 0?r:function(w){}},y=this.webSocketFactory.create(l,$2(s),g);y.connect(),await f;let I={setup:{model:Z(this.apiClient,e.model)}};return y.send(JSON.stringify(I)),new Mg(y,this.apiClient)}},Mg=class{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");let n=gL(e);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});let n=mL(e);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){let n={playbackControl:e};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(js.PLAY)}pause(){this.sendPlaybackControl(js.PAUSE)}stop(){this.sendPlaybackControl(js.STOP)}resetContext(){this.sendPlaybackControl(js.RESET_CONTEXT)}close(){this.conn.close()}};function $2(t){let e={};return t.forEach((n,r)=>{e[r]=n}),e}function q2(t){let e=new Headers;for(let[n,r]of Object.entries(t))e.append(n,r);return e}var W2="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function z2(t,e,n){let r=new hg,o;n.data instanceof Blob?o=await n.data.text():n.data instanceof ArrayBuffer?o=new TextDecoder().decode(n.data):o=n.data;let i=JSON.parse(o);if(t.isVertexAI()){let s=vL(i);Object.assign(r,s)}else Object.assign(r,i);e(r)}var xg=class{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r,this.music=new Ag(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,r,o,i,s,a;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");let l=this.apiClient.getWebsocketBaseUrl(),c=this.apiClient.getApiVersion(),f,h=this.apiClient.getHeaders();e.config&&e.config.tools&&ww(e.config.tools)&&Tw(h);let p=J2(h);if(this.apiClient.isVertexAI()){let b=this.apiClient.getProject(),N=this.apiClient.getLocation(),we=this.apiClient.getApiKey(),Lt=!!b&&!!N||!!we;this.apiClient.getCustomBaseUrl()&&!Lt?f=l:(f=`${l}/ws/google.cloud.aiplatform.${c}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(p,f))}else{let b=this.apiClient.getApiKey(),N="BidiGenerateContent",we="key";b?.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),c!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),N="BidiGenerateContentConstrained",we="access_token"),f=`${l}/ws/google.ai.generativelanguage.${c}.GenerativeService.${N}?${we}=${b}`}let m=()=>{},g=new Promise(b=>{m=b}),y=e.callbacks,_=function(){var b;(b=y?.onopen)===null||b===void 0||b.call(y),m({})},C=this.apiClient,I={onopen:_,onmessage:b=>{z2(C,y.onmessage,b)},onerror:(n=y?.onerror)!==null&&n!==void 0?n:function(b){},onclose:(r=y?.onclose)!==null&&r!==void 0?r:function(b){}},w=this.webSocketFactory.create(f,Y2(p),I);w.connect(),await g;let A=Z(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&A.startsWith("publishers/")){let b=this.apiClient.getProject(),N=this.apiClient.getLocation();b&&N&&(A=`projects/${b}/locations/${N}/`+A)}let R={};this.apiClient.isVertexAI()&&((o=e.config)===null||o===void 0?void 0:o.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[eg.AUDIO]}:e.config.responseModalities=[eg.AUDIO]),!((i=e.config)===null||i===void 0)&&i.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");let $=(a=(s=e.config)===null||s===void 0?void 0:s.tools)!==null&&a!==void 0?a:[],L=[];for(let b of $)if(this.isCallableTool(b)){let N=b;L.push(await N.tool())}else L.push(b);L.length>0&&(e.config.tools=L);let P={model:A,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?R=pL(this.apiClient,P):R=hL(this.apiClient,P),delete R.config,w.send(JSON.stringify(R)),new Ng(w,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}},j2={turnComplete:!0},Ng=class{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=vt(n.turns),e.isVertexAI()||(r=r.map(o=>Ec(o)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(let i of r){if(typeof i!="object"||i===null||!("name"in i)||!("response"in i))throw new Error(`Could not parse function response, type '${typeof i}'.`);if(!e.isVertexAI()&&!("id"in i))throw new Error(W2)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},j2),e);let n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:_L(e)}:n={realtimeInput:yL(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");let n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}};function Y2(t){let e={};return t.forEach((n,r)=>{e[r]=n}),e}function J2(t){let e=new Headers;for(let[n,r]of Object.entries(t))e.append(n,r);return e}var HI=10;function GI(t){var e,n,r;if(!((e=t?.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let o=!1;for(let s of(n=t?.tools)!==null&&n!==void 0?n:[])if(Qo(s)){o=!0;break}if(!o)return!0;let i=(r=t?.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return i&&(i<0||!Number.isInteger(i))||i==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",i),!0):!1}function Qo(t){return"callTool"in t&&typeof t.callTool=="function"}function K2(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(o=>Qo(o)))!==null&&r!==void 0?r:!1}function $I(t){var e;let n=[];return!((e=t?.config)===null||e===void 0)&&e.tools&&t.config.tools.forEach((r,o)=>{if(Qo(r))return;let i=r;i.functionDeclarations&&i.functionDeclarations.length>0&&n.push(o)}),n}function qI(t){var e;return!(!((e=t?.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}var Rg=class extends Ft{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var r,o,i,s,a;let l=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!K2(n)||GI(n.config))return await this.generateContentInternal(l);let c=$I(n);if(c.length>0){let y=c.map(_=>`tools[${_}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${y}.`)}let f,h,p=vt(l.contents),m=(i=(o=(r=l.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||o===void 0?void 0:o.maximumRemoteCalls)!==null&&i!==void 0?i:HI,g=0;for(;g<m&&(f=await this.generateContentInternal(l),!(!f.functionCalls||f.functionCalls.length===0));){let y=f.candidates[0].content,_=[];for(let C of(a=(s=n.config)===null||s===void 0?void 0:s.tools)!==null&&a!==void 0?a:[])if(Qo(C)){let w=await C.callTool(f.functionCalls);_.push(...w)}g++,h={role:"user",parts:_},l.contents=vt(l.contents),l.contents.push(y),l.contents.push(h),qI(l.config)&&(p.push(y),p.push(h))}return qI(l.config)&&(f.automaticFunctionCallingHistory=p),f},this.generateContentStream=async n=>{var r,o,i,s,a;if(this.maybeMoveToResponseJsonSchem(n),GI(n.config)){let h=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(h)}let l=$I(n);if(l.length>0){let h=l.map(p=>`tools[${p}]`).join(", ");throw new Error(`Incompatible tools found at ${h}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}let c=(i=(o=(r=n?.config)===null||r===void 0?void 0:r.toolConfig)===null||o===void 0?void 0:o.functionCallingConfig)===null||i===void 0?void 0:i.streamFunctionCallArguments,f=(a=(s=n?.config)===null||s===void 0?void 0:s.automaticFunctionCalling)===null||a===void 0?void 0:a.disable;if(c&&!f)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var o;let i,s=[];if(r?.generatedImages)for(let l of r.generatedImages)l&&l?.safetyAttributes&&((o=l?.safetyAttributes)===null||o===void 0?void 0:o.contentType)==="Positive Prompt"?i=l?.safetyAttributes:s.push(l);let a;return i?a={generatedImages:s,positivePromptSafetyAttributes:i,sdkHttpResponse:r.sdkHttpResponse}:a={generatedImages:s,sdkHttpResponse:r.sdkHttpResponse},a}),this.list=async n=>{var r;let s={config:Object.assign(Object.assign({},{queryBase:!0}),n?.config)};if(this.apiClient.isVertexAI()&&!s.config.queryBase){if(!((r=s.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");s.config.filter="labels.tune-type:*"}return new Mn(rr.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(s),s)},this.editImage=async n=>{let r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(o=>o.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));let o={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(o)},this.generateVideos=async n=>{var r,o,i,s,a,l;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((r=n.video)===null||r===void 0)&&r.uri&&(!((o=n.video)===null||o===void 0)&&o.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((s=(i=n.source)===null||i===void 0?void 0:i.video)===null||s===void 0)&&s.uri&&(!((l=(a=n.source)===null||a===void 0?void 0:a.video)===null||l===void 0)&&l.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var n,r,o;let i=(n=e.config)===null||n===void 0?void 0:n.tools;if(!i)return e;let s=await Promise.all(i.map(async l=>Qo(l)?await l.tool():l)),a={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:s})};if(a.config.tools=s,e.config&&e.config.tools&&ww(e.config.tools)){let l=(o=(r=e.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&o!==void 0?o:{},c=Object.assign({},l);Object.keys(c).length===0&&(c=this.apiClient.getDefaultHeaders()),Tw(c),a.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:c})}return a}async initAfcToolsMap(e){var n,r,o;let i=new Map;for(let s of(r=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(Qo(s)){let a=s,l=await a.tool();for(let c of(o=l.functionDeclarations)!==null&&o!==void 0?o:[]){if(!c.name)throw new Error("Function declaration name is required.");if(i.has(c.name))throw new Error(`Duplicate tool declaration name: ${c.name}`);i.set(c.name,a)}}return i}async processAfcStream(e){var n,r,o;let i=(o=(r=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&o!==void 0?o:HI,s=!1,a=0,l=await this.initAfcToolsMap(e);return(function(c,f,h){return Pt(this,arguments,function*(){for(var p,m,g,y,_,C;a<i;){s&&(a++,s=!1);let R=yield U(c.processParamsMaybeAddMcpUsage(h)),$=yield U(c.generateContentStreamInternal(R)),L=[],P=[];try{for(var I=!0,w=(m=void 0,kt($)),A;A=yield U(w.next()),p=A.done,!p;I=!0){y=A.value,I=!1;let b=y;if(yield yield U(b),b.candidates&&(!((_=b.candidates[0])===null||_===void 0)&&_.content)){P.push(b.candidates[0].content);for(let N of(C=b.candidates[0].content.parts)!==null&&C!==void 0?C:[])if(a<i&&N.functionCall){if(!N.functionCall.name)throw new Error("Function call name was not returned by the model.");if(f.has(N.functionCall.name)){let we=yield U(f.get(N.functionCall.name).callTool([N.functionCall]));L.push(...we)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${f.keys()}, mising tool: ${N.functionCall.name}`)}}}}catch(b){m={error:b}}finally{try{!I&&!p&&(g=w.return)&&(yield U(g.call(w)))}finally{if(m)throw m.error}}if(L.length>0){s=!0;let b=new Wr;b.candidates=[{content:{role:"user",parts:L}}],yield yield U(b);let N=[];N.push(...P),N.push({role:"user",parts:L});let we=vt(h.contents).concat(N);h.contents=we}else break}})})(this,l,e)}async generateContentInternal(e){var n,r,o,i;let s,a="",l={};if(this.apiClient.isVertexAI()){let c=LI(this.apiClient,e);return a=M("{model}:generateContent",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{let p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{let h=UI(f),p=new Wr;return Object.assign(p,h),p})}else{let c=OI(this.apiClient,e);return a=M("{model}:generateContent",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(h=>{let p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{let h=VI(f),p=new Wr;return Object.assign(p,h),p})}}async generateContentStreamInternal(e){var n,r,o,i;let s,a="",l={};if(this.apiClient.isVertexAI()){let c=LI(this.apiClient,e);return a=M("{model}:streamGenerateContent?alt=sse",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),s.then(function(h){return Pt(this,arguments,function*(){var p,m,g,y;try{for(var _=!0,C=kt(h),I;I=yield U(C.next()),p=I.done,!p;_=!0){y=I.value,_=!1;let w=y,A=UI(yield U(w.json()));A.sdkHttpResponse={headers:w.headers};let R=new Wr;Object.assign(R,A),yield yield U(R)}}catch(w){m={error:w}}finally{try{!_&&!p&&(g=C.return)&&(yield U(g.call(C)))}finally{if(m)throw m.error}}})})}else{let c=OI(this.apiClient,e);return a=M("{model}:streamGenerateContent?alt=sse",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),s.then(function(h){return Pt(this,arguments,function*(){var p,m,g,y;try{for(var _=!0,C=kt(h),I;I=yield U(C.next()),p=I.done,!p;_=!0){y=I.value,_=!1;let w=y,A=VI(yield U(w.json()));A.sdkHttpResponse={headers:w.headers};let R=new Wr;Object.assign(R,A),yield yield U(R)}}catch(w){m={error:w}}finally{try{!_&&!p&&(g=C.return)&&(yield U(g.call(C)))}finally{if(m)throw m.error}}})})}}async embedContent(e){var n,r,o,i;let s,a="",l={};if(this.apiClient.isVertexAI()){let c=KL(this.apiClient,e);return a=M("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{let p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{let h=ZL(f),p=new ju;return Object.assign(p,h),p})}else{let c=JL(this.apiClient,e);return a=M("{model}:batchEmbedContents",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(h=>{let p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{let h=QL(f),p=new ju;return Object.assign(p,h),p})}}async generateImagesInternal(e){var n,r,o,i;let s,a="",l={};if(this.apiClient.isVertexAI()){let c=uV(this.apiClient,e);return a=M("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{let p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{let h=dV(f),p=new Yu;return Object.assign(p,h),p})}else{let c=lV(this.apiClient,e);return a=M("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(h=>{let p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{let h=cV(f),p=new Yu;return Object.assign(p,h),p})}}async editImageInternal(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI()){let a=WL(this.apiClient,e);return i=M("{model}:predict",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(c=>{let f=c;return f.sdkHttpResponse={headers:l.headers},f})),o.then(l=>{let c=zL(l),f=new tg;return Object.assign(f,c),f})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI()){let a=u2(this.apiClient,e);return i=M("{model}:predict",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(c=>{let f=c;return f.sdkHttpResponse={headers:l.headers},f})),o.then(l=>{let c=c2(l),f=new ng;return Object.assign(f,c),f})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI()){let a=qV(this.apiClient,e);return i=M("{model}:predict",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),o.then(l=>{let c=WV(l),f=new rg;return Object.assign(f,c),f})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI()){let a=QV(this.apiClient,e);return i=M("{model}:predict",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),o.then(l=>{let c=ZV(l),f=new og;return Object.assign(f,c),f})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,r,o,i;let s,a="",l={};if(this.apiClient.isVertexAI()){let c=AV(this.apiClient,e);return a=M("{name}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s.then(f=>wg(f))}else{let c=bV(this.apiClient,e);return a=M("{name}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>Ig(f))}}async listInternal(e){var n,r,o,i;let s,a="",l={};if(this.apiClient.isVertexAI()){let c=LV(this.apiClient,e);return a=M("{models_url}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{let p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{let h=UV(f),p=new Ju;return Object.assign(p,h),p})}else{let c=OV(this.apiClient,e);return a=M("{models_url}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(h=>{let p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{let h=VV(f),p=new Ju;return Object.assign(p,h),p})}}async update(e){var n,r,o,i;let s,a="",l={};if(this.apiClient.isVertexAI()){let c=a2(this.apiClient,e);return a=M("{model}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s.then(f=>wg(f))}else{let c=s2(this.apiClient,e);return a=M("{name}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>Ig(f))}}async delete(e){var n,r,o,i;let s,a="",l={};if(this.apiClient.isVertexAI()){let c=HL(this.apiClient,e);return a=M("{name}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{let p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{let h=$L(f),p=new Ku;return Object.assign(p,h),p})}else{let c=BL(this.apiClient,e);return a=M("{name}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(h=>{let p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{let h=GL(f),p=new Ku;return Object.assign(p,h),p})}}async countTokens(e){var n,r,o,i;let s,a="",l={};if(this.apiClient.isVertexAI()){let c=LL(this.apiClient,e);return a=M("{model}:countTokens",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{let p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{let h=UL(f),p=new Qu;return Object.assign(p,h),p})}else{let c=OL(this.apiClient,e);return a=M("{model}:countTokens",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(h=>{let p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{let h=VL(f),p=new Qu;return Object.assign(p,h),p})}}async computeTokens(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI()){let a=ML(this.apiClient,e);return i=M("{model}:computeTokens",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(c=>{let f=c;return f.sdkHttpResponse={headers:l.headers},f})),o.then(l=>{let c=xL(l),f=new ig;return Object.assign(f,c),f})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var n,r,o,i;let s,a="",l={};if(this.apiClient.isVertexAI()){let c=yV(this.apiClient,e);return a=M("{model}:predictLongRunning",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s.then(f=>{let h=mV(f),p=new Zu;return Object.assign(p,h),p})}else{let c=gV(this.apiClient,e);return a=M("{model}:predictLongRunning",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>{let h=pV(f),p=new Zu;return Object.assign(p,h),p})}}};var Pg=class extends Ft{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){let n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){let o=n.name.split("/operations/")[0],i;r&&"httpOptions"in r&&(i=r.httpOptions);let s=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:o,config:{httpOptions:i}});return n._fromAPIResponse({apiResponse:s,_isVertexAI:!0})}else{let o=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:o,_isVertexAI:!1})}}async get(e){let n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){let o=n.name.split("/operations/")[0],i;r&&"httpOptions"in r&&(i=r.httpOptions);let s=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:o,config:{httpOptions:i}});return n._fromAPIResponse({apiResponse:s,_isVertexAI:!0})}else{let o=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:o,_isVertexAI:!1})}}async getVideosOperationInternal(e){var n,r,o,i;let s,a="",l={};if(this.apiClient.isVertexAI()){let c=dF(e);return a=M("{operationName}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s}else{let c=cF(e);return a=M("{operationName}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s}}async fetchPredictVideosOperationInternal(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI()){let a=rF(e);return i=M("{resourceName}:fetchPredictOperation",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),o}else throw new Error("This method is only supported by the Vertex AI.")}};function Q2(t){let e={},n=u(t,["data"]);if(n!=null&&d(e,["data"],n),u(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let r=u(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function Z2(t){let e={},n=u(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>aU(i))),d(e,["parts"],o)}let r=u(t,["role"]);return r!=null&&d(e,["role"],r),e}function X2(t,e,n){let r={},o=u(e,["expireTime"]);n!==void 0&&o!=null&&d(n,["expireTime"],o);let i=u(e,["newSessionExpireTime"]);n!==void 0&&i!=null&&d(n,["newSessionExpireTime"],i);let s=u(e,["uses"]);n!==void 0&&s!=null&&d(n,["uses"],s);let a=u(e,["liveConnectConstraints"]);n!==void 0&&a!=null&&d(n,["bidiGenerateContentSetup"],sU(t,a));let l=u(e,["lockAdditionalFields"]);return n!==void 0&&l!=null&&d(n,["fieldMask"],l),r}function eU(t,e){let n={},r=u(e,["config"]);return r!=null&&d(n,["config"],X2(t,r,n)),n}function tU(t){let e={};if(u(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let n=u(t,["fileUri"]);n!=null&&d(e,["fileUri"],n);let r=u(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function nU(t){let e={},n=u(t,["id"]);n!=null&&d(e,["id"],n);let r=u(t,["args"]);r!=null&&d(e,["args"],r);let o=u(t,["name"]);if(o!=null&&d(e,["name"],o),u(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(u(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function rU(t){let e={};if(u(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");let n=u(t,["enableWidget"]);return n!=null&&d(e,["enableWidget"],n),e}function oU(t){let e={};if(u(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(u(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");let n=u(t,["timeRangeFilter"]);return n!=null&&d(e,["timeRangeFilter"],n),e}function iU(t,e){let n={},r=u(t,["generationConfig"]);e!==void 0&&r!=null&&d(e,["setup","generationConfig"],r);let o=u(t,["responseModalities"]);e!==void 0&&o!=null&&d(e,["setup","generationConfig","responseModalities"],o);let i=u(t,["temperature"]);e!==void 0&&i!=null&&d(e,["setup","generationConfig","temperature"],i);let s=u(t,["topP"]);e!==void 0&&s!=null&&d(e,["setup","generationConfig","topP"],s);let a=u(t,["topK"]);e!==void 0&&a!=null&&d(e,["setup","generationConfig","topK"],a);let l=u(t,["maxOutputTokens"]);e!==void 0&&l!=null&&d(e,["setup","generationConfig","maxOutputTokens"],l);let c=u(t,["mediaResolution"]);e!==void 0&&c!=null&&d(e,["setup","generationConfig","mediaResolution"],c);let f=u(t,["seed"]);e!==void 0&&f!=null&&d(e,["setup","generationConfig","seed"],f);let h=u(t,["speechConfig"]);e!==void 0&&h!=null&&d(e,["setup","generationConfig","speechConfig"],ty(h));let p=u(t,["thinkingConfig"]);e!==void 0&&p!=null&&d(e,["setup","generationConfig","thinkingConfig"],p);let m=u(t,["enableAffectiveDialog"]);e!==void 0&&m!=null&&d(e,["setup","generationConfig","enableAffectiveDialog"],m);let g=u(t,["systemInstruction"]);e!==void 0&&g!=null&&d(e,["setup","systemInstruction"],Z2(qe(g)));let y=u(t,["tools"]);if(e!==void 0&&y!=null){let $=ti(y);Array.isArray($)&&($=$.map(L=>uU(ei(L)))),d(e,["setup","tools"],$)}let _=u(t,["sessionResumption"]);e!==void 0&&_!=null&&d(e,["setup","sessionResumption"],lU(_));let C=u(t,["inputAudioTranscription"]);e!==void 0&&C!=null&&d(e,["setup","inputAudioTranscription"],C);let I=u(t,["outputAudioTranscription"]);e!==void 0&&I!=null&&d(e,["setup","outputAudioTranscription"],I);let w=u(t,["realtimeInputConfig"]);e!==void 0&&w!=null&&d(e,["setup","realtimeInputConfig"],w);let A=u(t,["contextWindowCompression"]);e!==void 0&&A!=null&&d(e,["setup","contextWindowCompression"],A);let R=u(t,["proactivity"]);if(e!==void 0&&R!=null&&d(e,["setup","proactivity"],R),u(t,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}function sU(t,e){let n={},r=u(e,["model"]);r!=null&&d(n,["setup","model"],Z(t,r));let o=u(e,["config"]);return o!=null&&d(n,["config"],iU(o,n)),n}function aU(t){let e={},n=u(t,["mediaResolution"]);n!=null&&d(e,["mediaResolution"],n);let r=u(t,["codeExecutionResult"]);r!=null&&d(e,["codeExecutionResult"],r);let o=u(t,["executableCode"]);o!=null&&d(e,["executableCode"],o);let i=u(t,["fileData"]);i!=null&&d(e,["fileData"],tU(i));let s=u(t,["functionCall"]);s!=null&&d(e,["functionCall"],nU(s));let a=u(t,["functionResponse"]);a!=null&&d(e,["functionResponse"],a);let l=u(t,["inlineData"]);l!=null&&d(e,["inlineData"],Q2(l));let c=u(t,["text"]);c!=null&&d(e,["text"],c);let f=u(t,["thought"]);f!=null&&d(e,["thought"],f);let h=u(t,["thoughtSignature"]);h!=null&&d(e,["thoughtSignature"],h);let p=u(t,["videoMetadata"]);return p!=null&&d(e,["videoMetadata"],p),e}function lU(t){let e={},n=u(t,["handle"]);if(n!=null&&d(e,["handle"],n),u(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function uU(t){let e={};if(u(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");let n=u(t,["computerUse"]);n!=null&&d(e,["computerUse"],n);let r=u(t,["fileSearch"]);r!=null&&d(e,["fileSearch"],r);let o=u(t,["codeExecution"]);if(o!=null&&d(e,["codeExecution"],o),u(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");let i=u(t,["functionDeclarations"]);if(i!=null){let f=i;Array.isArray(f)&&(f=f.map(h=>h)),d(e,["functionDeclarations"],f)}let s=u(t,["googleMaps"]);s!=null&&d(e,["googleMaps"],rU(s));let a=u(t,["googleSearch"]);a!=null&&d(e,["googleSearch"],oU(a));let l=u(t,["googleSearchRetrieval"]);l!=null&&d(e,["googleSearchRetrieval"],l);let c=u(t,["urlContext"]);return c!=null&&d(e,["urlContext"],c),e}function cU(t){let e=[];for(let n in t)if(Object.prototype.hasOwnProperty.call(t,n)){let r=t[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){let o=Object.keys(r).map(i=>`${n}.${i}`);e.push(...o)}else e.push(n)}return e.join(",")}function dU(t,e){let n=null,r=t.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){let i=r.setup;typeof i=="object"&&i!==null?(t.bidiGenerateContentSetup=i,n=i):delete t.bidiGenerateContentSetup}else r!==void 0&&delete t.bidiGenerateContentSetup;let o=t.fieldMask;if(n){let i=cU(n);if(Array.isArray(e?.lockAdditionalFields)&&e?.lockAdditionalFields.length===0)i?t.fieldMask=i:delete t.fieldMask;else if(e?.lockAdditionalFields&&e.lockAdditionalFields.length>0&&o!==null&&Array.isArray(o)&&o.length>0){let s=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"],a=[];o.length>0&&(a=o.map(c=>s.includes(c)?`generationConfig.${c}`:c));let l=[];i&&l.push(i),a.length>0&&l.push(...a),l.length>0?t.fieldMask=l.join(","):delete t.fieldMask}else delete t.fieldMask}else o!==null&&Array.isArray(o)&&o.length>0?t.fieldMask=o.join(","):delete t.fieldMask;return t}var kg=class extends Ft{constructor(e){super(),this.apiClient=e}async create(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{let a=eU(this.apiClient,e);i=M("auth_tokens",a._url),s=a._query,delete a.config,delete a._url,delete a._query;let l=dU(a,e.config);return o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),o.then(c=>c)}}};function fU(t,e){let n={},r=u(t,["force"]);return e!==void 0&&r!=null&&d(e,["_query","force"],r),n}function hU(t){let e={},n=u(t,["name"]);n!=null&&d(e,["_url","name"],n);let r=u(t,["config"]);return r!=null&&fU(r,e),e}function pU(t){let e={},n=u(t,["name"]);return n!=null&&d(e,["_url","name"],n),e}function mU(t,e){let n={},r=u(t,["pageSize"]);e!==void 0&&r!=null&&d(e,["_query","pageSize"],r);let o=u(t,["pageToken"]);return e!==void 0&&o!=null&&d(e,["_query","pageToken"],o),n}function gU(t){let e={},n=u(t,["parent"]);n!=null&&d(e,["_url","parent"],n);let r=u(t,["config"]);return r!=null&&mU(r,e),e}function yU(t){let e={},n=u(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);let r=u(t,["nextPageToken"]);r!=null&&d(e,["nextPageToken"],r);let o=u(t,["documents"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(s=>s)),d(e,["documents"],i)}return e}var Fg=class extends Ft{constructor(e){super(),this.apiClient=e,this.list=async n=>new Mn(rr.PAGED_ITEM_DOCUMENTS,r=>this.listInternal({parent:n.parent,config:r.config}),await this.listInternal(n),n)}async get(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let a=pU(e);return i=M("{name}",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),o.then(l=>l)}}async delete(e){var n,r;let o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let s=hU(e);o=M("{name}",s._url),i=s._query,delete s._url,delete s._query,await this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(s),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let a=gU(e);return i=M("{parent}/documents",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),o.then(l=>{let c=yU(l),f=new sg;return Object.assign(f,c),f})}}};var Og=class extends Ft{constructor(e,n=new Fg(e)){super(),this.apiClient=e,this.documents=n,this.list=async(r={})=>new Mn(rr.PAGED_ITEM_FILE_SEARCH_STORES,o=>this.listInternal(o),await this.listInternal(r),r)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let a=y2(e);return i=M("fileSearchStores",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),o.then(l=>l)}}async get(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let a=E2(e);return i=M("{name}",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),o.then(l=>l)}}async delete(e){var n,r;let o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let s=v2(e);o=M("{name}",s._url),i=s._query,delete s._url,delete s._query,await this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(s),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let a=S2(e);return i=M("fileSearchStores",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),o.then(l=>{let c=b2(l),f=new ag;return Object.assign(f,c),f})}}async uploadToFileSearchStoreInternal(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let a=A2(e);return i=M("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),o.then(l=>{let c=M2(l),f=new lg;return Object.assign(f,c),f})}}async importFile(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let a=I2(e);return i=M("{file_search_store_name}:importFile",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),o.then(l=>{let c=D2(l),f=new ug;return Object.assign(f,c),f})}}};var Sw=function(){let{crypto:t}=globalThis;if(t?.randomUUID)return Sw=t.randomUUID.bind(t),t.randomUUID();let e=new Uint8Array(1),n=t?()=>t.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,r=>(+r^n()&15>>+r/4).toString(16))},_U=()=>Sw();function Lg(t){return typeof t=="object"&&t!==null&&("name"in t&&t.name==="AbortError"||"message"in t&&String(t.message).includes("FetchRequestCanceledException"))}var Vg=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null){try{if(Object.prototype.toString.call(t)==="[object Error]"){let e=new Error(t.message,t.cause?{cause:t.cause}:{});return t.stack&&(e.stack=t.stack),t.cause&&!e.cause&&(e.cause=t.cause),t.name&&(e.name=t.name),e}}catch{}try{return new Error(JSON.stringify(t))}catch{}}return new Error(t)};var nt=class extends Error{},rt=class t extends nt{constructor(e,n,r,o){super(`${t.makeMessage(e,n,r)}`),this.status=e,this.headers=o,this.error=n}static makeMessage(e,n,r){let o=n?.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return e&&o?`${e} ${o}`:e?`${e} status code (no body)`:o||"(no status code or body)"}static generate(e,n,r,o){if(!e||!o)return new Zo({message:r,cause:Vg(n)});let i=n;return e===400?new ac(e,i,r,o):e===401?new lc(e,i,r,o):e===403?new uc(e,i,r,o):e===404?new cc(e,i,r,o):e===409?new dc(e,i,r,o):e===422?new fc(e,i,r,o):e===429?new hc(e,i,r,o):e>=500?new pc(e,i,r,o):new t(e,i,r,o)}},Qs=class extends rt{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}},Zo=class extends rt{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}},sc=class extends Zo{constructor({message:e}={}){super({message:e??"Request timed out."})}},ac=class extends rt{},lc=class extends rt{},uc=class extends rt{},cc=class extends rt{},dc=class extends rt{},fc=class extends rt{},hc=class extends rt{},pc=class extends rt{};var vU=/^[a-z][a-z0-9+.-]*:/i,EU=t=>vU.test(t),Ug=t=>(Ug=Array.isArray,Ug(t)),CU=Ug,DU=CU,WI=DU;function IU(t){if(!t)return!0;for(let e in t)return!1;return!0}function wU(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var TU=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new nt(`${t} must be an integer`);if(e<0)throw new nt(`${t} must be a positive integer`);return e},SU=t=>{try{return JSON.parse(t)}catch{return}};var bU=t=>new Promise(e=>setTimeout(e,t));var Jo="0.0.1";function AU(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}var MU=()=>{var t,e,n,r,o;let i=AU();if(i==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Jo,"X-Stainless-OS":jI(Deno.build.os),"X-Stainless-Arch":zI(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(t=Deno.version)===null||t===void 0?void 0:t.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Jo,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(i==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Jo,"X-Stainless-OS":jI((n=globalThis.process.platform)!==null&&n!==void 0?n:"unknown"),"X-Stainless-Arch":zI((r=globalThis.process.arch)!==null&&r!==void 0?r:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(o=globalThis.process.version)!==null&&o!==void 0?o:"unknown"};let s=xU();return s?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Jo,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${s.browser}`,"X-Stainless-Runtime-Version":s.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Jo,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function xU(){if(typeof navigator>"u"||!navigator)return null;let t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(let{key:e,pattern:n}of t){let r=n.exec(navigator.userAgent);if(r){let o=r[1]||0,i=r[2]||0,s=r[3]||0;return{browser:e,version:`${o}.${i}.${s}`}}}return null}var zI=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",jI=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown"),Bu,NU=()=>Bu??(Bu=MU());function RU(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function bw(...t){let e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...t)}function PU(t){let e=Symbol.asyncIterator in t?t[Symbol.asyncIterator]():t[Symbol.iterator]();return bw({start(){},async pull(n){let{done:r,value:o}=await e.next();r?n.close():n.enqueue(o)},async cancel(){var n;await((n=e.return)===null||n===void 0?void 0:n.call(e))}})}function Aw(t){if(t[Symbol.asyncIterator])return t;let e=t.getReader();return{async next(){try{let n=await e.read();return n?.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){let n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function kU(t){var e,n;if(t===null||typeof t!="object")return;if(t[Symbol.asyncIterator]){await((n=(e=t[Symbol.asyncIterator]()).return)===null||n===void 0?void 0:n.call(e));return}let r=t.getReader(),o=r.cancel();r.releaseLock(),await o}var FU=({headers:t,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});var Mw=()=>{var t;if(typeof File>"u"){let{process:e}=globalThis,n=typeof((t=e?.versions)===null||t===void 0?void 0:t.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(n?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Qm(t,e,n){return Mw(),new File(t,e??"unknown_file",n)}function OU(t){return(typeof t=="object"&&t!==null&&("name"in t&&t.name&&String(t.name)||"url"in t&&t.url&&String(t.url)||"filename"in t&&t.filename&&String(t.filename)||"path"in t&&t.path&&String(t.path))||"").split(/[\\/]/).pop()||void 0}var LU=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function";var xw=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",VU=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&xw(t),UU=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function";async function BU(t,e,n){if(Mw(),t=await t,VU(t))return t instanceof File?t:Qm([await t.arrayBuffer()],t.name);if(UU(t)){let o=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()),Qm(await Bg(o),e,n)}let r=await Bg(t);if(e||(e=OU(t)),!n?.type){let o=r.find(i=>typeof i=="object"&&"type"in i&&i.type);typeof o=="string"&&(n=Object.assign(Object.assign({},n),{type:o}))}return Qm(r,e,n)}async function Bg(t){var e,n,r,o,i;let s=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)s.push(t);else if(xw(t))s.push(t instanceof Blob?t:await t.arrayBuffer());else if(LU(t))try{for(var a=!0,l=kt(t),c;c=await l.next(),e=c.done,!e;a=!0){o=c.value,a=!1;let f=o;s.push(...await Bg(f))}}catch(f){n={error:f}}finally{try{!a&&!e&&(r=l.return)&&await r.call(l)}finally{if(n)throw n.error}}else{let f=(i=t?.constructor)===null||i===void 0?void 0:i.name;throw new Error(`Unexpected data type: ${typeof t}${f?`; constructor: ${f}`:""}${HU(t)}`)}return s}function HU(t){return typeof t!="object"||t===null?"":`; props: [${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}var GU=(()=>{class t{constructor(n){this._client=n}}t._key=[];return t})();function Nw(t){return t.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}var YI=Object.freeze(Object.create(null)),$U=(t=Nw)=>function(n,...r){if(n.length===1)return n[0];let o=!1,i=[],s=n.reduce((f,h,p)=>{var m,g,y;/[?#]/.test(h)&&(o=!0);let _=r[p],C=(o?encodeURIComponent:t)(""+_);return p!==r.length&&(_==null||typeof _=="object"&&_.toString===((y=Object.getPrototypeOf((g=Object.getPrototypeOf((m=_.hasOwnProperty)!==null&&m!==void 0?m:YI))!==null&&g!==void 0?g:YI))===null||y===void 0?void 0:y.toString))&&(C=_+"",i.push({start:f.length+h.length,length:C.length,error:`Value of type ${Object.prototype.toString.call(_).slice(8,-1)} is not a valid path parameter`})),f+h+(p===r.length?"":C)},""),a=s.split(/[?#]/,1)[0],l=/(?<=^|\/)(?:\.|%2e){1,2}(?=\/|$)/gi,c;for(;(c=l.exec(a))!==null;)i.push({start:c.index,length:c[0].length,error:`Value "${c[0]}" can't be safely passed as a path parameter`});if(i.sort((f,h)=>f.start-h.start),i.length>0){let f=0,h=i.reduce((p,m)=>{let g=" ".repeat(m.start-f),y="^".repeat(m.length);return f=m.start+m.length,p+g+y},"");throw new nt(`Path parameters result in path with invalid segments:
${i.map(p=>p.error).join(`
`)}
${s}
${h}`)}return s},Hu=$U(Nw);var mc=class extends GU{create(e,n){var r;let{api_version:o=this._client.apiVersion}=e,i=ic(e,["api_version"]);if("model"in i&&"agent_config"in i)throw new nt("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in i&&"generation_config"in i)throw new nt("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(Hu`/${o}/interactions`,Object.assign(Object.assign({body:i},n),{stream:(r=e.stream)!==null&&r!==void 0?r:!1}))}delete(e,n={},r){let{api_version:o=this._client.apiVersion}=n??{};return this._client.delete(Hu`/${o}/interactions/${e}`,r)}cancel(e,n={},r){let{api_version:o=this._client.apiVersion}=n??{};return this._client.post(Hu`/${o}/interactions/${e}/cancel`,r)}get(e,n={},r){var o;let i=n??{},{api_version:s=this._client.apiVersion}=i,a=ic(i,["api_version"]);return this._client.get(Hu`/${s}/interactions/${e}`,Object.assign(Object.assign({query:a},r),{stream:(o=n?.stream)!==null&&o!==void 0?o:!1}))}};mc._key=Object.freeze(["interactions"]);var gc=class extends mc{};function qU(t){let e=0;for(let o of t)e+=o.length;let n=new Uint8Array(e),r=0;for(let o of t)n.set(o,r),r+=o.length;return n}var Gu;function ny(t){let e;return(Gu??(e=new globalThis.TextEncoder,Gu=e.encode.bind(e)))(t)}var $u;function JI(t){let e;return($u??(e=new globalThis.TextDecoder,$u=e.decode.bind(e)))(t)}var Xo=class{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];let n=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?ny(e):e;this.buffer=qU([this.buffer,n]);let r=[],o;for(;(o=WU(this.buffer,this.carriageReturnIndex))!=null;){if(o.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=o.index;continue}if(this.carriageReturnIndex!=null&&(o.index!==this.carriageReturnIndex+1||o.carriage)){r.push(JI(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}let i=this.carriageReturnIndex!==null?o.preceding-1:o.preceding,s=JI(this.buffer.subarray(0,i));r.push(s),this.buffer=this.buffer.subarray(o.index),this.carriageReturnIndex=null}return r}flush(){return this.buffer.length?this.decode(`
`):[]}};Xo.NEWLINE_CHARS=new Set([`
`,"\r"]);Xo.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function WU(t,e){for(let o=e??0;o<t.length;o++){if(t[o]===10)return{preceding:o,index:o+1,carriage:!1};if(t[o]===13)return{preceding:o,index:o+1,carriage:!0}}return null}function zU(t){for(let r=0;r<t.length-1;r++){if(t[r]===10&&t[r+1]===10||t[r]===13&&t[r+1]===13)return r+2;if(t[r]===13&&t[r+1]===10&&r+3<t.length&&t[r+2]===13&&t[r+3]===10)return r+4}return-1}var yc={off:0,error:200,warn:300,info:400,debug:500},KI=(t,e,n)=>{if(t){if(wU(yc,t))return t;Je(n).warn(`${e} was set to ${JSON.stringify(t)}, expected one of ${JSON.stringify(Object.keys(yc))}`)}};function Ys(){}function qu(t,e,n){return!e||yc[t]>yc[n]?Ys:e[t].bind(e)}var jU={error:Ys,warn:Ys,info:Ys,debug:Ys},QI=new WeakMap;function Je(t){var e;let n=t.logger,r=(e=t.logLevel)!==null&&e!==void 0?e:"off";if(!n)return jU;let o=QI.get(n);if(o&&o[0]===r)return o[1];let i={error:qu("error",n,r),warn:qu("warn",n,r),info:qu("info",n,r),debug:qu("debug",n,r)};return QI.set(n,[r,i]),i}var qr=t=>(t.options&&(t.options=Object.assign({},t.options),delete t.options.headers),t.headers&&(t.headers=Object.fromEntries((t.headers instanceof Headers?[...t.headers]:Object.entries(t.headers)).map(([e,n])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in t&&(t.retryOfRequestLogID&&(t.retryOf=t.retryOfRequestLogID),delete t.retryOfRequestLogID),t);var Hg=class t{constructor(e,n,r){this.iterator=e,this.controller=n,this.client=r}static fromSSEResponse(e,n,r){let o=!1,i=r?Je(r):console;function s(){return Pt(this,arguments,function*(){var l,c,f,h;if(o)throw new nt("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");o=!0;let p=!1;try{try{for(var m=!0,g=kt(YU(e,n)),y;y=yield U(g.next()),l=y.done,!l;m=!0){h=y.value,m=!1;let _=h;if(!p)if(_.data.startsWith("[DONE]")){p=!0;continue}else try{yield yield U(JSON.parse(_.data))}catch(C){throw i.error("Could not parse message into JSON:",_.data),i.error("From chunk:",_.raw),C}}}catch(_){c={error:_}}finally{try{!m&&!l&&(f=g.return)&&(yield U(f.call(g)))}finally{if(c)throw c.error}}p=!0}catch(_){if(Lg(_))return yield U(void 0);throw _}finally{p||n.abort()}})}return new t(s,n,r)}static fromReadableStream(e,n,r){let o=!1;function i(){return Pt(this,arguments,function*(){var l,c,f,h;let p=new Xo,m=Aw(e);try{for(var g=!0,y=kt(m),_;_=yield U(y.next()),l=_.done,!l;g=!0){h=_.value,g=!1;let C=h;for(let I of p.decode(C))yield yield U(I)}}catch(C){c={error:C}}finally{try{!g&&!l&&(f=y.return)&&(yield U(f.call(y)))}finally{if(c)throw c.error}}for(let C of p.flush())yield yield U(C)})}function s(){return Pt(this,arguments,function*(){var l,c,f,h;if(o)throw new nt("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");o=!0;let p=!1;try{try{for(var m=!0,g=kt(i()),y;y=yield U(g.next()),l=y.done,!l;m=!0){h=y.value,m=!1;let _=h;p||_&&(yield yield U(JSON.parse(_)))}}catch(_){c={error:_}}finally{try{!m&&!l&&(f=g.return)&&(yield U(f.call(g)))}finally{if(c)throw c.error}}p=!0}catch(_){if(Lg(_))return yield U(void 0);throw _}finally{p||n.abort()}})}return new t(s,n,r)}[Symbol.asyncIterator](){return this.iterator()}tee(){let e=[],n=[],r=this.iterator(),o=i=>({next:()=>{if(i.length===0){let s=r.next();e.push(s),n.push(s)}return i.shift()}});return[new t(()=>o(e),this.controller,this.client),new t(()=>o(n),this.controller,this.client)]}toReadableStream(){let e=this,n;return bw({async start(){n=e[Symbol.asyncIterator]()},async pull(r){try{let{value:o,done:i}=await n.next();if(i)return r.close();let s=ny(JSON.stringify(o)+`
`);r.enqueue(s)}catch(o){r.error(o)}},async cancel(){var r;await((r=n.return)===null||r===void 0?void 0:r.call(n))}})}};function YU(t,e){return Pt(this,arguments,function*(){var r,o,i,s;if(!t.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new nt("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new nt("Attempted to iterate over a response with no body");let a=new Gg,l=new Xo,c=Aw(t.body);try{for(var f=!0,h=kt(JU(c)),p;p=yield U(h.next()),r=p.done,!r;f=!0){s=p.value,f=!1;let m=s;for(let g of l.decode(m)){let y=a.decode(g);y&&(yield yield U(y))}}}catch(m){o={error:m}}finally{try{!f&&!r&&(i=h.return)&&(yield U(i.call(h)))}finally{if(o)throw o.error}}for(let m of l.flush()){let g=a.decode(m);g&&(yield yield U(g))}})}function JU(t){return Pt(this,arguments,function*(){var n,r,o,i;let s=new Uint8Array;try{for(var a=!0,l=kt(t),c;c=yield U(l.next()),n=c.done,!n;a=!0){i=c.value,a=!1;let f=i;if(f==null)continue;let h=f instanceof ArrayBuffer?new Uint8Array(f):typeof f=="string"?ny(f):f,p=new Uint8Array(s.length+h.length);p.set(s),p.set(h,s.length),s=p;let m;for(;(m=zU(s))!==-1;)yield yield U(s.slice(0,m)),s=s.slice(m)}}catch(f){r={error:f}}finally{try{!a&&!n&&(o=l.return)&&(yield U(o.call(l)))}finally{if(r)throw r.error}}s.length>0&&(yield yield U(s))})}var Gg=class{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;let i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,r,o]=KU(e,":");return o.startsWith(" ")&&(o=o.substring(1)),n==="event"?this.event=o:n==="data"&&this.data.push(o),null}};function KU(t,e){let n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}async function QU(t,e){let{response:n,requestLogID:r,retryOfRequestLogID:o,startTime:i}=e,s=await(async()=>{var a;if(e.options.stream)return Je(t).debug("response",n.status,n.url,n.headers,n.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(n,e.controller,t):Hg.fromSSEResponse(n,e.controller,t);if(n.status===204)return null;if(e.options.__binaryResponse)return n;let l=n.headers.get("content-type"),c=(a=l?.split(";")[0])===null||a===void 0?void 0:a.trim();return c?.includes("application/json")||c?.endsWith("+json")?await n.json():await n.text()})();return Je(t).debug(`[${r}] response parsed`,qr({retryOfRequestLogID:o,url:n.url,status:n.status,body:s,durationMs:Date.now()-i})),s}var $g=class t extends Promise{constructor(e,n,r=QU){super(o=>{o(null)}),this.responsePromise=n,this.parseResponse=r,this.client=e}_thenUnwrap(e){return new t(this.client,this.responsePromise,async(n,r)=>e(await this.parseResponse(n,r),r))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){let[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}};var Rw=Symbol("brand.privateNullableHeaders");function*ZU(t){if(!t)return;if(Rw in t){let{values:r,nulls:o}=t;yield*r.entries();for(let i of o)yield[i,null];return}let e=!1,n;t instanceof Headers?n=t.entries():WI(t)?n=t:(e=!0,n=Object.entries(t??{}));for(let r of n){let o=r[0];if(typeof o!="string")throw new TypeError("expected header name to be a string");let i=WI(r[1])?r[1]:[r[1]],s=!1;for(let a of i)a!==void 0&&(e&&!s&&(s=!0,yield[o,null]),yield[o,a])}}var zs=t=>{let e=new Headers,n=new Set;for(let r of t){let o=new Set;for(let[i,s]of ZU(r)){let a=i.toLowerCase();o.has(a)||(e.delete(i),o.add(a)),s===null?(e.delete(i),n.add(a)):(e.append(i,s),n.delete(a))}}return{[Rw]:!0,values:e,nulls:n}};var Zm=t=>{var e,n,r,o,i,s;if(typeof globalThis.process<"u")return(r=(n=(e=globalThis.process.env)===null||e===void 0?void 0:e[t])===null||n===void 0?void 0:n.trim())!==null&&r!==void 0?r:void 0;if(typeof globalThis.Deno<"u")return(s=(i=(o=globalThis.Deno.env)===null||o===void 0?void 0:o.get)===null||i===void 0?void 0:i.call(o,t))===null||s===void 0?void 0:s.trim()};var Pw,XU=(()=>{class t{constructor(n){var r,o,i,s,a,l,c,{baseURL:f=Zm("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:h=(r=Zm("GEMINI_API_KEY"))!==null&&r!==void 0?r:null,apiVersion:p="v1beta"}=n,m=ic(n,["baseURL","apiKey","apiVersion"]);let g=Object.assign(Object.assign({apiKey:h,apiVersion:p},m),{baseURL:f||"https://generativelanguage.googleapis.com"});this.baseURL=g.baseURL,this.timeout=(o=g.timeout)!==null&&o!==void 0?o:t.DEFAULT_TIMEOUT,this.logger=(i=g.logger)!==null&&i!==void 0?i:console;let y="warn";this.logLevel=y,this.logLevel=(a=(s=KI(g.logLevel,"ClientOptions.logLevel",this))!==null&&s!==void 0?s:KI(Zm("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&a!==void 0?a:y,this.fetchOptions=g.fetchOptions,this.maxRetries=(l=g.maxRetries)!==null&&l!==void 0?l:2,this.fetch=(c=g.fetch)!==null&&c!==void 0?c:RU(),this.encoder=FU,this._options=g,this.apiKey=h,this.apiVersion=p,this.clientAdapter=g.clientAdapter}withOptions(n){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),n))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:n,nulls:r}){if(!(n.has("authorization")||n.has("x-goog-api-key"))&&!(this.apiKey&&n.get("x-goog-api-key"))&&!r.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(n){let r=zs([n.headers]);if(!(r.values.has("authorization")||r.values.has("x-goog-api-key"))){if(this.apiKey)return zs([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return zs([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(n){return Object.entries(n).filter(([r,o])=>typeof o<"u").map(([r,o])=>{if(typeof o=="string"||typeof o=="number"||typeof o=="boolean")return`${encodeURIComponent(r)}=${encodeURIComponent(o)}`;if(o===null)return`${encodeURIComponent(r)}=`;throw new nt(`Cannot stringify type ${typeof o}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${Jo}`}defaultIdempotencyKey(){return`stainless-node-retry-${_U()}`}makeStatusError(n,r,o,i){return rt.generate(n,r,o,i)}buildURL(n,r,o){let i=!this.baseURLOverridden()&&o||this.baseURL,s=EU(n)?new URL(n):new URL(i+(i.endsWith("/")&&n.startsWith("/")?n.slice(1):n)),a=this.defaultQuery();return IU(a)||(r=Object.assign(Object.assign({},a),r)),typeof r=="object"&&r&&!Array.isArray(r)&&(s.search=this.stringifyQuery(r)),s.toString()}async prepareOptions(n){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!n.path.startsWith(`/${this.apiVersion}/projects/`)){let r=n.path.slice(this.apiVersion.length+1);n.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${r}`}}async prepareRequest(n,{url:r,options:o}){}get(n,r){return this.methodRequest("get",n,r)}post(n,r){return this.methodRequest("post",n,r)}patch(n,r){return this.methodRequest("patch",n,r)}put(n,r){return this.methodRequest("put",n,r)}delete(n,r){return this.methodRequest("delete",n,r)}methodRequest(n,r,o){return this.request(Promise.resolve(o).then(i=>Object.assign({method:n,path:r},i)))}request(n,r=null){return new $g(this,this.makeRequest(n,r,void 0))}async makeRequest(n,r,o){var i,s,a;let l=await n,c=(i=l.maxRetries)!==null&&i!==void 0?i:this.maxRetries;r==null&&(r=c),await this.prepareOptions(l);let{req:f,url:h,timeout:p}=await this.buildRequest(l,{retryCount:c-r});await this.prepareRequest(f,{url:h,options:l});let m="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),g=o===void 0?"":`, retryOf: ${o}`,y=Date.now();if(Je(this).debug(`[${m}] sending request`,qr({retryOfRequestLogID:o,method:l.method,url:h,options:l,headers:f.headers})),!((s=l.signal)===null||s===void 0)&&s.aborted)throw new Qs;let _=new AbortController,C=await this.fetchWithTimeout(h,f,p,_).catch(Vg),I=Date.now();if(C instanceof globalThis.Error){let A=`retrying, ${r} attempts remaining`;if(!((a=l.signal)===null||a===void 0)&&a.aborted)throw new Qs;let R=Lg(C)||/timed? ?out/i.test(String(C)+("cause"in C?String(C.cause):""));if(r)return Je(this).info(`[${m}] connection ${R?"timed out":"failed"} - ${A}`),Je(this).debug(`[${m}] connection ${R?"timed out":"failed"} (${A})`,qr({retryOfRequestLogID:o,url:h,durationMs:I-y,message:C.message})),this.retryRequest(l,r,o??m);throw Je(this).info(`[${m}] connection ${R?"timed out":"failed"} - error; no more retries left`),Je(this).debug(`[${m}] connection ${R?"timed out":"failed"} (error; no more retries left)`,qr({retryOfRequestLogID:o,url:h,durationMs:I-y,message:C.message})),R?new sc:new Zo({cause:C})}let w=`[${m}${g}] ${f.method} ${h} ${C.ok?"succeeded":"failed"} with status ${C.status} in ${I-y}ms`;if(!C.ok){let A=await this.shouldRetry(C);if(r&&A){let N=`retrying, ${r} attempts remaining`;return await kU(C.body),Je(this).info(`${w} - ${N}`),Je(this).debug(`[${m}] response error (${N})`,qr({retryOfRequestLogID:o,url:C.url,status:C.status,headers:C.headers,durationMs:I-y})),this.retryRequest(l,r,o??m,C.headers)}let R=A?"error; no more retries left":"error; not retryable";Je(this).info(`${w} - ${R}`);let $=await C.text().catch(N=>Vg(N).message),L=SU($),P=L?void 0:$;throw Je(this).debug(`[${m}] response error (${R})`,qr({retryOfRequestLogID:o,url:C.url,status:C.status,headers:C.headers,message:P,durationMs:Date.now()-y})),this.makeStatusError(C.status,L,P,C.headers)}return Je(this).info(w),Je(this).debug(`[${m}] response start`,qr({retryOfRequestLogID:o,url:C.url,status:C.status,headers:C.headers,durationMs:I-y})),{response:C,options:l,controller:_,requestLogID:m,retryOfRequestLogID:o,startTime:y}}async fetchWithTimeout(n,r,o,i){let s=r||{},{signal:a,method:l}=s,c=ic(s,["signal","method"]);a&&a.addEventListener("abort",()=>i.abort());let f=setTimeout(()=>i.abort(),o),h=globalThis.ReadableStream&&c.body instanceof globalThis.ReadableStream||typeof c.body=="object"&&c.body!==null&&Symbol.asyncIterator in c.body,p=Object.assign(Object.assign(Object.assign({signal:i.signal},h?{duplex:"half"}:{}),{method:"GET"}),c);l&&(p.method=l.toUpperCase());try{return await this.fetch.call(void 0,n,p)}finally{clearTimeout(f)}}async shouldRetry(n){let r=n.headers.get("x-should-retry");return r==="true"?!0:r==="false"?!1:n.status===408||n.status===409||n.status===429||n.status>=500}async retryRequest(n,r,o,i){var s;let a,l=i?.get("retry-after-ms");if(l){let f=parseFloat(l);Number.isNaN(f)||(a=f)}let c=i?.get("retry-after");if(c&&!a){let f=parseFloat(c);Number.isNaN(f)?a=Date.parse(c)-Date.now():a=f*1e3}if(!(a&&0<=a&&a<60*1e3)){let f=(s=n.maxRetries)!==null&&s!==void 0?s:this.maxRetries;a=this.calculateDefaultRetryTimeoutMillis(r,f)}return await bU(a),this.makeRequest(n,r-1,o)}calculateDefaultRetryTimeoutMillis(n,r){let s=r-n,a=Math.min(.5*Math.pow(2,s),8),l=1-Math.random()*.25;return a*l*1e3}async buildRequest(n,{retryCount:r=0}={}){var o,i,s;let a=Object.assign({},n),{method:l,path:c,query:f,defaultBaseURL:h}=a,p=this.buildURL(c,f,h);"timeout"in a&&TU("timeout",a.timeout),a.timeout=(o=a.timeout)!==null&&o!==void 0?o:this.timeout;let{bodyHeaders:m,body:g}=this.buildBody({options:a}),y=await this.buildHeaders({options:n,method:l,bodyHeaders:m,retryCount:r});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:l,headers:y},a.signal&&{signal:a.signal}),globalThis.ReadableStream&&g instanceof globalThis.ReadableStream&&{duplex:"half"}),g&&{body:g}),(i=this.fetchOptions)!==null&&i!==void 0?i:{}),(s=a.fetchOptions)!==null&&s!==void 0?s:{}),url:p,timeout:a.timeout}}async buildHeaders({options:n,method:r,bodyHeaders:o,retryCount:i}){let s={};this.idempotencyHeader&&r!=="get"&&(n.idempotencyKey||(n.idempotencyKey=this.defaultIdempotencyKey()),s[this.idempotencyHeader]=n.idempotencyKey);let a=await this.authHeaders(n),l=zs([s,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(i)},n.timeout?{"X-Stainless-Timeout":String(Math.trunc(n.timeout/1e3))}:{}),NU()),this._options.defaultHeaders,o,n.headers,a]);return this.validateHeaders(l),l.values}buildBody({options:{body:n,headers:r}}){if(!n)return{bodyHeaders:void 0,body:void 0};let o=zs([r]);return ArrayBuffer.isView(n)||n instanceof ArrayBuffer||n instanceof DataView||typeof n=="string"&&o.values.has("content-type")||globalThis.Blob&&n instanceof globalThis.Blob||n instanceof FormData||n instanceof URLSearchParams||globalThis.ReadableStream&&n instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:n}:typeof n=="object"&&(Symbol.asyncIterator in n||Symbol.iterator in n&&"next"in n&&typeof n.next=="function")?{bodyHeaders:void 0,body:PU(n)}:this.encoder({body:n,headers:o})}}return t.DEFAULT_TIMEOUT=6e4,t})(),Ae=class extends XU{constructor(){super(...arguments),this.interactions=new gc(this)}};Pw=Ae;Ae.GeminiNextGenAPIClient=Pw;Ae.GeminiNextGenAPIClientError=nt;Ae.APIError=rt;Ae.APIConnectionError=Zo;Ae.APIConnectionTimeoutError=sc;Ae.APIUserAbortError=Qs;Ae.NotFoundError=cc;Ae.ConflictError=dc;Ae.RateLimitError=hc;Ae.BadRequestError=ac;Ae.AuthenticationError=lc;Ae.InternalServerError=pc;Ae.PermissionDeniedError=uc;Ae.UnprocessableEntityError=fc;Ae.toFile=BU;Ae.Interactions=gc;function eB(t,e){let n={},r=u(t,["name"]);return r!=null&&d(n,["_url","name"],r),n}function tB(t,e){let n={},r=u(t,["name"]);return r!=null&&d(n,["_url","name"],r),n}function nB(t,e){let n={},r=u(t,["sdkHttpResponse"]);return r!=null&&d(n,["sdkHttpResponse"],r),n}function rB(t,e){let n={},r=u(t,["sdkHttpResponse"]);return r!=null&&d(n,["sdkHttpResponse"],r),n}function oB(t,e,n){let r={};if(u(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");let o=u(t,["tunedModelDisplayName"]);if(e!==void 0&&o!=null&&d(e,["displayName"],o),u(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");let i=u(t,["epochCount"]);e!==void 0&&i!=null&&d(e,["tuningTask","hyperparameters","epochCount"],i);let s=u(t,["learningRateMultiplier"]);if(s!=null&&d(r,["tuningTask","hyperparameters","learningRateMultiplier"],s),u(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(u(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(u(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");let a=u(t,["batchSize"]);e!==void 0&&a!=null&&d(e,["tuningTask","hyperparameters","batchSize"],a);let l=u(t,["learningRate"]);if(e!==void 0&&l!=null&&d(e,["tuningTask","hyperparameters","learningRate"],l),u(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(u(t,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return r}function iB(t,e,n){let r={},o=u(n,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){let m=u(t,["validationDataset"]);e!==void 0&&m!=null&&d(e,["supervisedTuningSpec"],ZI(m))}else if(o==="PREFERENCE_TUNING"){let m=u(t,["validationDataset"]);e!==void 0&&m!=null&&d(e,["preferenceOptimizationSpec"],ZI(m))}let i=u(t,["tunedModelDisplayName"]);e!==void 0&&i!=null&&d(e,["tunedModelDisplayName"],i);let s=u(t,["description"]);e!==void 0&&s!=null&&d(e,["description"],s);let a=u(n,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){let m=u(t,["epochCount"]);e!==void 0&&m!=null&&d(e,["supervisedTuningSpec","hyperParameters","epochCount"],m)}else if(a==="PREFERENCE_TUNING"){let m=u(t,["epochCount"]);e!==void 0&&m!=null&&d(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],m)}let l=u(n,["config","method"]);if(l===void 0&&(l="SUPERVISED_FINE_TUNING"),l==="SUPERVISED_FINE_TUNING"){let m=u(t,["learningRateMultiplier"]);e!==void 0&&m!=null&&d(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],m)}else if(l==="PREFERENCE_TUNING"){let m=u(t,["learningRateMultiplier"]);e!==void 0&&m!=null&&d(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],m)}let c=u(n,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){let m=u(t,["exportLastCheckpointOnly"]);e!==void 0&&m!=null&&d(e,["supervisedTuningSpec","exportLastCheckpointOnly"],m)}else if(c==="PREFERENCE_TUNING"){let m=u(t,["exportLastCheckpointOnly"]);e!==void 0&&m!=null&&d(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],m)}let f=u(n,["config","method"]);if(f===void 0&&(f="SUPERVISED_FINE_TUNING"),f==="SUPERVISED_FINE_TUNING"){let m=u(t,["adapterSize"]);e!==void 0&&m!=null&&d(e,["supervisedTuningSpec","hyperParameters","adapterSize"],m)}else if(f==="PREFERENCE_TUNING"){let m=u(t,["adapterSize"]);e!==void 0&&m!=null&&d(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],m)}if(u(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(u(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");let h=u(t,["labels"]);e!==void 0&&h!=null&&d(e,["labels"],h);let p=u(t,["beta"]);return e!==void 0&&p!=null&&d(e,["preferenceOptimizationSpec","hyperParameters","beta"],p),r}function sB(t,e){let n={},r=u(t,["baseModel"]);r!=null&&d(n,["baseModel"],r);let o=u(t,["preTunedModel"]);o!=null&&d(n,["preTunedModel"],o);let i=u(t,["trainingDataset"]);i!=null&&yB(i);let s=u(t,["config"]);return s!=null&&oB(s,n),n}function aB(t,e){let n={},r=u(t,["baseModel"]);r!=null&&d(n,["baseModel"],r);let o=u(t,["preTunedModel"]);o!=null&&d(n,["preTunedModel"],o);let i=u(t,["trainingDataset"]);i!=null&&_B(i,n,e);let s=u(t,["config"]);return s!=null&&iB(s,n,e),n}function lB(t,e){let n={},r=u(t,["name"]);return r!=null&&d(n,["_url","name"],r),n}function uB(t,e){let n={},r=u(t,["name"]);return r!=null&&d(n,["_url","name"],r),n}function cB(t,e,n){let r={},o=u(t,["pageSize"]);e!==void 0&&o!=null&&d(e,["_query","pageSize"],o);let i=u(t,["pageToken"]);e!==void 0&&i!=null&&d(e,["_query","pageToken"],i);let s=u(t,["filter"]);return e!==void 0&&s!=null&&d(e,["_query","filter"],s),r}function dB(t,e,n){let r={},o=u(t,["pageSize"]);e!==void 0&&o!=null&&d(e,["_query","pageSize"],o);let i=u(t,["pageToken"]);e!==void 0&&i!=null&&d(e,["_query","pageToken"],i);let s=u(t,["filter"]);return e!==void 0&&s!=null&&d(e,["_query","filter"],s),r}function fB(t,e){let n={},r=u(t,["config"]);return r!=null&&cB(r,n),n}function hB(t,e){let n={},r=u(t,["config"]);return r!=null&&dB(r,n),n}function pB(t,e){let n={},r=u(t,["sdkHttpResponse"]);r!=null&&d(n,["sdkHttpResponse"],r);let o=u(t,["nextPageToken"]);o!=null&&d(n,["nextPageToken"],o);let i=u(t,["tunedModels"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>kw(a))),d(n,["tuningJobs"],s)}return n}function mB(t,e){let n={},r=u(t,["sdkHttpResponse"]);r!=null&&d(n,["sdkHttpResponse"],r);let o=u(t,["nextPageToken"]);o!=null&&d(n,["nextPageToken"],o);let i=u(t,["tuningJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>qg(a))),d(n,["tuningJobs"],s)}return n}function gB(t,e){let n={},r=u(t,["name"]);r!=null&&d(n,["model"],r);let o=u(t,["name"]);return o!=null&&d(n,["endpoint"],o),n}function yB(t,e){let n={};if(u(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(u(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");let r=u(t,["examples"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(i=>i)),d(n,["examples","examples"],o)}return n}function _B(t,e,n){let r={},o=u(n,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){let s=u(t,["gcsUri"]);e!==void 0&&s!=null&&d(e,["supervisedTuningSpec","trainingDatasetUri"],s)}else if(o==="PREFERENCE_TUNING"){let s=u(t,["gcsUri"]);e!==void 0&&s!=null&&d(e,["preferenceOptimizationSpec","trainingDatasetUri"],s)}let i=u(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){let s=u(t,["vertexDatasetResource"]);e!==void 0&&s!=null&&d(e,["supervisedTuningSpec","trainingDatasetUri"],s)}else if(i==="PREFERENCE_TUNING"){let s=u(t,["vertexDatasetResource"]);e!==void 0&&s!=null&&d(e,["preferenceOptimizationSpec","trainingDatasetUri"],s)}if(u(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function kw(t,e){let n={},r=u(t,["sdkHttpResponse"]);r!=null&&d(n,["sdkHttpResponse"],r);let o=u(t,["name"]);o!=null&&d(n,["name"],o);let i=u(t,["state"]);i!=null&&d(n,["state"],lw(i));let s=u(t,["createTime"]);s!=null&&d(n,["createTime"],s);let a=u(t,["tuningTask","startTime"]);a!=null&&d(n,["startTime"],a);let l=u(t,["tuningTask","completeTime"]);l!=null&&d(n,["endTime"],l);let c=u(t,["updateTime"]);c!=null&&d(n,["updateTime"],c);let f=u(t,["description"]);f!=null&&d(n,["description"],f);let h=u(t,["baseModel"]);h!=null&&d(n,["baseModel"],h);let p=u(t,["_self"]);return p!=null&&d(n,["tunedModel"],gB(p)),n}function qg(t,e){let n={},r=u(t,["sdkHttpResponse"]);r!=null&&d(n,["sdkHttpResponse"],r);let o=u(t,["name"]);o!=null&&d(n,["name"],o);let i=u(t,["state"]);i!=null&&d(n,["state"],lw(i));let s=u(t,["createTime"]);s!=null&&d(n,["createTime"],s);let a=u(t,["startTime"]);a!=null&&d(n,["startTime"],a);let l=u(t,["endTime"]);l!=null&&d(n,["endTime"],l);let c=u(t,["updateTime"]);c!=null&&d(n,["updateTime"],c);let f=u(t,["error"]);f!=null&&d(n,["error"],f);let h=u(t,["description"]);h!=null&&d(n,["description"],h);let p=u(t,["baseModel"]);p!=null&&d(n,["baseModel"],p);let m=u(t,["tunedModel"]);m!=null&&d(n,["tunedModel"],m);let g=u(t,["preTunedModel"]);g!=null&&d(n,["preTunedModel"],g);let y=u(t,["supervisedTuningSpec"]);y!=null&&d(n,["supervisedTuningSpec"],y);let _=u(t,["preferenceOptimizationSpec"]);_!=null&&d(n,["preferenceOptimizationSpec"],_);let C=u(t,["tuningDataStats"]);C!=null&&d(n,["tuningDataStats"],C);let I=u(t,["encryptionSpec"]);I!=null&&d(n,["encryptionSpec"],I);let w=u(t,["partnerModelTuningSpec"]);w!=null&&d(n,["partnerModelTuningSpec"],w);let A=u(t,["customBaseModel"]);A!=null&&d(n,["customBaseModel"],A);let R=u(t,["experiment"]);R!=null&&d(n,["experiment"],R);let $=u(t,["labels"]);$!=null&&d(n,["labels"],$);let L=u(t,["outputUri"]);L!=null&&d(n,["outputUri"],L);let P=u(t,["pipelineJob"]);P!=null&&d(n,["pipelineJob"],P);let b=u(t,["serviceAccount"]);b!=null&&d(n,["serviceAccount"],b);let N=u(t,["tunedModelDisplayName"]);N!=null&&d(n,["tunedModelDisplayName"],N);let we=u(t,["veoTuningSpec"]);return we!=null&&d(n,["veoTuningSpec"],we),n}function vB(t,e){let n={},r=u(t,["sdkHttpResponse"]);r!=null&&d(n,["sdkHttpResponse"],r);let o=u(t,["name"]);o!=null&&d(n,["name"],o);let i=u(t,["metadata"]);i!=null&&d(n,["metadata"],i);let s=u(t,["done"]);s!=null&&d(n,["done"],s);let a=u(t,["error"]);return a!=null&&d(n,["error"],a),n}function ZI(t,e){let n={},r=u(t,["gcsUri"]);r!=null&&d(n,["validationDatasetUri"],r);let o=u(t,["vertexDatasetResource"]);return o!=null&&d(n,["validationDatasetUri"],o),n}var Wg=class extends Ft{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Mn(rr.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.get=async n=>await this.getInternal(n),this.tune=async n=>{var r;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){let o={tunedModelName:n.baseModel};!((r=n.config)===null||r===void 0)&&r.preTunedModelCheckpointId&&(o.checkpointId=n.config.preTunedModelCheckpointId);let i=Object.assign(Object.assign({},n),{preTunedModel:o});return i.baseModel=void 0,await this.tuneInternal(i)}else{let o=Object.assign({},n);return await this.tuneInternal(o)}else{let o=Object.assign({},n),i=await this.tuneMldevInternal(o),s="";return i.metadata!==void 0&&i.metadata.tunedModel!==void 0?s=i.metadata.tunedModel:i.name!==void 0&&i.name.includes("/operations/")&&(s=i.name.split("/operations/")[0]),{name:s,state:tw.JOB_STATE_QUEUED}}}}async getInternal(e){var n,r,o,i;let s,a="",l={};if(this.apiClient.isVertexAI()){let c=uB(e);return a=M("{name}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{let p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>qg(f))}else{let c=lB(e);return a=M("{name}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(h=>{let p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>kw(f))}}async listInternal(e){var n,r,o,i;let s,a="",l={};if(this.apiClient.isVertexAI()){let c=hB(e);return a=M("tuningJobs",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{let p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{let h=mB(f),p=new Xu;return Object.assign(p,h),p})}else{let c=fB(e);return a=M("tunedModels",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(h=>{let p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{let h=pB(f),p=new Xu;return Object.assign(p,h),p})}}async cancel(e){var n,r,o,i;let s,a="",l={};if(this.apiClient.isVertexAI()){let c=tB(e);return a=M("{name}:cancel",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{let p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{let h=rB(f),p=new ec;return Object.assign(p,h),p})}else{let c=eB(e);return a=M("{name}:cancel",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(h=>{let p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{let h=nB(f),p=new ec;return Object.assign(p,h),p})}}async tuneInternal(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI()){let a=aB(e,e);return i=M("tuningJobs",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(c=>{let f=c;return f.sdkHttpResponse={headers:l.headers},f})),o.then(l=>qg(l))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let a=sB(e);return i=M("tunedModels",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(c=>{let f=c;return f.sdkHttpResponse={headers:l.headers},f})),o.then(l=>vB(l))}}};var zg=class{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}},EB=1024*1024*8,CB=3,DB=1e3,IB=2,_c="x-goog-upload-status";async function wB(t,e,n){var r;let o=await Fw(t,e,n),i=await o?.json();if(((r=o?.headers)===null||r===void 0?void 0:r[_c])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return i.file}async function TB(t,e,n){var r;let o=await Fw(t,e,n),i=await o?.json();if(((r=o?.headers)===null||r===void 0?void 0:r[_c])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");let s=ew(i),a=new mg;return Object.assign(a,s),a}async function Fw(t,e,n){var r,o;let i=0,s=0,a=new Js(new Response),l="upload";for(i=t.size;s<i;){let c=Math.min(EB,i-s),f=t.slice(s,s+c);s+c>=i&&(l+=", finalize");let h=0,p=DB;for(;h<CB&&(a=await n.request({path:"",body:f,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":l,"X-Goog-Upload-Offset":String(s),"Content-Length":String(c)}}}),!(!((r=a?.headers)===null||r===void 0)&&r[_c]));)h++,await bB(p),p=p*IB;if(s+=c,((o=a?.headers)===null||o===void 0?void 0:o[_c])!=="active")break;if(i<=s)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return a}async function SB(t){return{size:t.size,type:t.type}}function bB(t){return new Promise(e=>setTimeout(e,t))}var jg=class{async upload(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await wB(e,n,r)}async uploadToFileSearchStore(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await TB(e,n,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await SB(e)}};var Yg=class{create(e,n,r){return new Jg(e,n,r)}},Jg=class{constructor(e,n,r){this.url=e,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}};var XI="x-goog-api-key",Kg=class{constructor(e){this.apiKey=e}async addAuthHeaders(e,n){if(e.get(XI)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(XI,this.apiKey)}}};var AB="gl-node/",vc=class{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");let e=this.httpOptions;e?.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");let n=new Ae({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:e?.timeout});return this._interactions=n.interactions,this._interactions}constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;let r=tF(e.httpOptions,e.vertexai,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;let o=new Kg(this.apiKey);this.apiClient=new Sg({auth:o,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:AB+"web",uploader:new jg,downloader:new zg}),this.models=new Rg(this.apiClient),this.live=new xg(this.apiClient,o,new Yg),this.batches=new _g(this.apiClient),this.chats=new Eg(this.models,this.apiClient),this.caches=new vg(this.apiClient),this.files=new Dg(this.apiClient),this.operations=new Pg(this.apiClient),this.authTokens=new kg(this.apiClient),this.tunings=new Wg(this.apiClient),this.fileSearchStores=new Og(this.apiClient)}};var MB=(t,e)=>e.id;function xB(t,e){t&1&&(v(0,"span",6),Y(1,"span",54),D(2," Nube "),E())}function NB(t,e){t&1&&(v(0,"span",7),wt(),v(1,"svg",55),Y(2,"path",56)(3,"path",57)(4,"path",58),E(),D(5," Local "),E())}function RB(t,e){t&1&&(v(0,"span"),D(1,"\u{1F680} Alto"),E())}function PB(t,e){t&1&&(v(0,"span"),D(1,"\u{1F4FA} ECO"),E())}function kB(t,e){t&1&&(wt(),v(0,"svg",59),Y(1,"circle",60)(2,"path",61),E(),D(3," Analizando... "))}function FB(t,e){t&1&&(wt(),v(0,"svg",27),Y(1,"path",62)(2,"path",63)(3,"path",64)(4,"path",65)(5,"path",66)(6,"path",67)(7,"path",68)(8,"path",69),E(),D(9," Generar Reporte "))}function OB(t,e){if(t&1&&(v(0,"div",21),D(1),E()),t&2){let n=le();T(),_e(" ",n.analysisResult()," ")}}function LB(t,e){t&1&&(wt(),v(0,"svg",59),Y(1,"circle",60)(2,"path",61),E(),D(3," Procesando... "))}function VB(t,e){t&1&&(wt(),v(0,"svg",27),Y(1,"path",28)(2,"polyline",70)(3,"line",71),E(),D(4," Subir Excel "))}function UB(t,e){if(t&1){let n=Il();v(0,"div",38)(1,"span",72),D(2),E(),v(3,"div",15)(4,"button",73),me("click",function(){let o=gn(n).$index,i=le();return yn(i.moveWidget(o,"up"))}),D(5," \u2B06\uFE0F "),E(),v(6,"button",73),me("click",function(){let o=gn(n).$index,i=le();return yn(i.moveWidget(o,"down"))}),D(7," \u2B07\uFE0F "),E()()()}if(t&2){let n=e.$implicit,r=e.$index,o=e.$count;T(2),Tl("",r+1,". ",n.label),T(2),Te("disabled",r===0),T(2),Te("disabled",r===o-1)}}function BB(t,e){if(t&1){let n=Il();v(0,"tr",53)(1,"td",74),D(2),E(),v(3,"td",75)(4,"input",76),me("ngModelChange",function(o){let i=gn(n).$index,s=le();return yn(s.updateCrewField(i,"pdf",o))}),E()(),v(5,"td",75)(6,"input",77),me("ngModelChange",function(o){let i=gn(n).$index,s=le();return yn(s.updateCrewField(i,"stayTime",o))}),E()(),v(7,"td",75)(8,"input",78),me("ngModelChange",function(o){let i=gn(n).$index,s=le();return yn(s.updateCrewField(i,"security",o))}),E()(),v(9,"td",75)(10,"input",79),me("ngModelChange",function(o){let i=gn(n).$index,s=le();return yn(s.updateCrewField(i,"ranking",o))}),E()()()}if(t&2){let n=e.$implicit;T(2),ye(n.name),T(2),Te("ngModel",n.pdf),T(2),Te("ngModel",n.stayTime),T(2),Te("ngModel",n.security),T(2),Te("ngModel",n.ranking)}}var Ic=class t{constructor(){this.store=K(zo);this.safetyForm=x({},this.store.safety());this.warehouseForm=x({},this.store.warehouse());this.crews=this.store.crews;this.bonus=this.store.bonusObjectives;this.isAnalyzing=oe(!1);this.analysisResult=oe(null);this.isUploading=oe(!1)}saveSafety(){this.store.updateSafety(this.safetyForm),alert("Seguridad actualizada!")}saveWarehouse(){this.store.updateWarehouse(this.warehouseForm),alert("Almac\xE9n actualizado!")}updateAnnouncement(e){this.store.updateAnnouncement(e.target.value)}updateCrewField(e,n,r){let o=r;if(["pdf","palletsAverage","security","totalSum","ranking"].includes(n)){let i=parseFloat(r);isNaN(i)||(o=i)}this.store.updateCrew(e,{[n]:o})}updateBonusField(e,n,r){let o=r;if(["accumulated"].includes(n)){let i=parseFloat(r);isNaN(i)||(o=i)}this.store.updateBonusRaw(e,{[n]:o})}randomizeFreight(){this.store.randomizeFreight()}randomizeStayTime(){this.store.randomizeStayTime()}moveWidget(e,n){this.store.moveWidget(e,n)}toggleSimulation(){this.store.toggleSimulation(!this.store.isSimulationActive())}async generateCrewReport(){if(!this.isAnalyzing()){this.isAnalyzing.set(!0),this.analysisResult.set(null);try{let e=new vc({apiKey:process.env.API_KEY}),r=`
        Act\xFAa como un Gerente de Planta experto en log\xEDstica y producci\xF3n.
        Analiza los siguientes datos de rendimiento de las tripulaciones del turno matutino:
        ${JSON.stringify(this.store.crews())}
        
        M\xE9tricas clave: 
        - PDF (Productividad): Mayor es mejor.
        - Tiempo Estancia: Menor es mejor.
        - Seguridad: 5.00 es perfecto.
        
        Genera un reporte ejecutivo breve (m\xE1ximo 150 palabras) en espa\xF1ol que incluya:
        1. \xBFQui\xE9n es la tripulaci\xF3n ganadora y por qu\xE9?
        2. Una observaci\xF3n cr\xEDtica sobre la tripulaci\xF3n con menor rendimiento.
        3. Una recomendaci\xF3n de mejora general.
        
        Usa un tono profesional, directo e industrial.
      `,o=await e.models.generateContent({model:"gemini-2.5-flash",contents:r});this.analysisResult.set(o.text)}catch(e){console.error("Error generating AI report:",e),this.analysisResult.set("Error al conectar con Gemini. Verifique su API Key.")}finally{this.isAnalyzing.set(!1)}}}parseExcelTime(e){if(e==null||e==="")return 0;if(e instanceof Date){let r=e.getHours()*60+e.getMinutes();return Math.round(r)}if(typeof e=="string"&&e.includes(":")){let r=e.split(":").map(o=>parseFloat(o));if(r.length>=2&&!isNaN(r[0])&&!isNaN(r[1]))return r[0]*60+r[1]}let n=Number(e);return isNaN(n)?0:n<2&&n>0?Math.round(n*24*60):Math.round(n)}formatTimeToString(e){let n=this.parseExcelTime(e),r=Math.floor(n/60),o=Math.floor(n%60);return`${r.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`}downloadTemplate(){let e=XLSX.utils.book_new(),n=[this.store.safety()],r=XLSX.utils.json_to_sheet(n);XLSX.utils.book_append_sheet(e,r,"Seguridad");let o=[this.store.warehouse()],i=XLSX.utils.json_to_sheet(o);XLSX.utils.book_append_sheet(e,i,"Almacen");let s=this.store.freight(),a=XLSX.utils.json_to_sheet(s);XLSX.utils.book_append_sheet(e,a,"Fleteo");let l=this.store.stayTime(),c=XLSX.utils.json_to_sheet(l);XLSX.utils.book_append_sheet(e,c,"TiempoEstancia");let f=this.store.crews(),h=XLSX.utils.json_to_sheet(f);XLSX.utils.book_append_sheet(e,h,"Tripulacion");let p=this.store.waste(),m=XLSX.utils.json_to_sheet(p);XLSX.utils.book_append_sheet(e,m,"Mermas");let g=this.store.downtime(),y=XLSX.utils.json_to_sheet(g);XLSX.utils.book_append_sheet(e,y,"TiempoPerdido");let _=this.store.bonusObjectives().map(I=>({Indicador:I.description,MIN:I.min,SAT:I.sat,EXC:I.exc,Resultado:I.accumulated,Peso:I.weight})),C=XLSX.utils.json_to_sheet(_);XLSX.utils.book_append_sheet(e,C,"Bono"),XLSX.writeFile(e,"Dashboard_Plantilla.xlsx")}async onFileChange(e){let n=e.target;if(n.files.length!==1){alert("Por favor carga un solo archivo.");return}this.isUploading.set(!0);try{let o=await n.files[0].arrayBuffer();this.store.toggleSimulation(!1);let i=XLSX.read(o,{dense:!1}),s=0;if(i.Sheets.Seguridad){let l=XLSX.utils.sheet_to_json(i.Sheets.Seguridad);l.length>0&&(this.store.updateSafety(l[0]),this.safetyForm=x({},this.store.safety()),s++)}if(i.Sheets.Almacen){let l=XLSX.utils.sheet_to_json(i.Sheets.Almacen);l.length>0&&(this.store.updateWarehouse(l[0]),this.warehouseForm=x({},this.store.warehouse()),s++)}if(i.Sheets.Fleteo){let l=XLSX.utils.sheet_to_json(i.Sheets.Fleteo);l.length>0&&(this.store.updateFreight(l),s++)}if(i.Sheets.TiempoEstancia){let l=XLSX.utils.sheet_to_json(i.Sheets.TiempoEstancia);if(l.length>0){let c=l.map(f=>({day:f.day||f.Dia||f.Day,real:this.parseExcelTime(f.real),goal:this.parseExcelTime(f.goal||f.meta)}));this.store.updateStayTime(c),s++}}if(i.Sheets.Tripulacion){let l=XLSX.utils.sheet_to_json(i.Sheets.Tripulacion);if(l.length>0){let c=l.map(f=>W(x({},f),{stayTime:this.formatTimeToString(f.stayTime),plantTime:this.formatTimeToString(f.plantTime)}));this.store.crews.set(c),s++}}if(i.Sheets.Mermas){let l=XLSX.utils.sheet_to_json(i.Sheets.Mermas);l.length>0&&(this.store.updateWaste(l),s++)}if(i.Sheets.TiempoPerdido){let l=XLSX.utils.sheet_to_json(i.Sheets.TiempoPerdido);if(l.length>0){let c=l.map(f=>W(x({},f),{lostTime:this.parseExcelTime(f.lostTime)}));this.store.updateDowntime(c),s++}}let a=i.SheetNames.find(l=>l.toLowerCase().includes("bono")||l.toLowerCase().includes("indicador"));if(a){let l=XLSX.utils.sheet_to_json(i.Sheets[a]);if(l.length>0){let c=this.store.bonusObjectives();l.forEach(f=>{let h=f.Indicador||f.Description||f.Descripcion,p=f.Resultado||f.Accumulated||f.Real||f.accumulated;if(h&&p!==void 0){let m=c.find(g=>g.description.toLowerCase().trim()===h.toString().toLowerCase().trim()||h.toString().toLowerCase().includes(g.description.toLowerCase()));if(m){let g=Number(p);m.format==="time"?g=this.parseExcelTime(p):m.format==="percent"&&g<=1&&g>0&&(g=g*100),this.store.updateBonusResult(m.description,g)}}}),s++}}this.isUploading.set(!1),s>0?alert(`\xA1\xC9xito! Se actualizaron ${s} secciones.`):alert("No se encontraron datos v\xE1lidos.")}catch(r){console.error(r),this.isUploading.set(!1),alert("Error al leer el archivo. Verifica el formato.")}e.target.value=""}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=En({type:t,selectors:[["app-admin"]],decls:134,vars:46,consts:[[1,"p-3","sm:p-6","max-w-4xl","mx-auto","bg-gray-50","min-h-screen","border-l","border-r","border-gray-200"],[1,"flex","flex-col","md:flex-row","justify-between","items-start","md:items-center","mb-6","border-b","pb-4","gap-4"],[1,"text-2xl","sm:text-3xl","font-black","text-coke-dark","tracking-tight"],[1,"flex","flex-wrap","items-center","gap-4","mt-2"],[1,"flex","items-center","gap-2"],[1,"text-xs","font-bold","text-gray-400","uppercase"],[1,"flex","items-center","gap-1","bg-green-100","text-green-700","px-2","py-0.5","rounded-full","text-xs","font-bold","border","border-green-200"],[1,"flex","items-center","gap-1","bg-gray-100","text-gray-600","px-2","py-0.5","rounded-full","text-xs","font-bold","border","border-gray-300"],[1,"flex","items-center","gap-1","px-2","py-0.5","rounded-full","text-xs","font-bold","border","transition-colors","select-none",3,"click"],[1,"flex","items-center","gap-2","w-full","md:w-auto"],[1,"text-sm","font-semibold","text-gray-600","hidden","sm:inline"],[1,"flex-1","md:flex-none","px-3","py-2","md:py-1","rounded-lg","md:rounded-full","text-xs","font-bold","transition-colors","border","justify-center",3,"click"],[1,"mb-8","bg-amber-50","p-4","sm:p-6","rounded-xl","border","border-amber-200","shadow-sm"],[1,"text-lg","sm:text-xl","font-bold","mb-2","flex","items-center","gap-2","text-amber-800"],[1,"text-xl","sm:text-2xl"],[1,"flex","gap-2"],["type","text","placeholder","Escribe el aviso aqu\xED...",1,"w-full","p-3","border","border-amber-300","rounded-lg","focus:ring-2","focus:ring-amber-500","outline-none","text-sm",3,"input","value"],[1,"mb-8","bg-gradient-to-r","from-purple-50","to-white","p-4","sm:p-6","rounded-xl","border","border-purple-200","shadow-sm"],[1,"text-lg","sm:text-xl","font-bold","mb-4","flex","items-center","gap-2","text-purple-800"],[1,"text-sm","text-purple-900","mb-4","hidden","sm:block"],[1,"w-full","sm:w-auto","flex","items-center","justify-center","gap-2","bg-purple-600","text-white","px-6","py-3","rounded-lg","hover:bg-purple-700","font-semibold","transition-colors","disabled:opacity-50","disabled:cursor-wait","shadow-sm","text-sm",3,"click","disabled"],[1,"mt-4","p-4","bg-white","border-l-4","border-purple-500","rounded","shadow-sm","text-xs","sm:text-sm","text-gray-800","leading-relaxed","font-mono","whitespace-pre-wrap"],[1,"my-8","border-gray-200"],[1,"mb-8","bg-blue-50","p-4","sm:p-6","rounded-xl","border","border-blue-200"],[1,"text-lg","sm:text-xl","font-bold","mb-4","flex","items-center","gap-2","text-blue-800"],[1,"flex","flex-col","sm:flex-row","gap-4","items-center"],[1,"flex","items-center","gap-2","bg-white","border","border-blue-300","text-blue-700","px-4","py-3","rounded-lg","hover:bg-blue-50","font-semibold","transition-colors","w-full","sm:w-auto","justify-center","shadow-sm","text-sm",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2 2H5a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"],["points","7 10 12 15 17 10"],["x1","12","x2","12","y1","15","y2","3"],[1,"relative","w-full","sm:w-auto"],["for","excel-upload",1,"flex","items-center","gap-2","bg-blue-600","text-white","px-4","py-3","rounded-lg","hover:bg-blue-700","font-semibold","transition-colors","cursor-pointer","w-full","justify-center","select-none","shadow-sm","text-sm"],["id","excel-upload","type","file","accept",".xlsx, .xls",1,"hidden",3,"change","disabled"],[1,"mb-8"],[1,"text-lg","sm:text-xl","font-bold","mb-4","flex","items-center","gap-2","text-coke-red"],[1,"w-2","h-8","bg-coke-red","block","rounded-sm"],[1,"bg-white","border","rounded-lg","overflow-hidden","shadow-sm"],[1,"flex","items-center","justify-between","p-3","border-b","last:border-0","hover:bg-gray-50","transition-colors"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-6"],[1,"space-y-4"],[1,"form-group"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","number",1,"w-full","p-3","border","rounded-lg","focus:ring-2","focus:ring-red-500","outline-none",3,"ngModelChange","ngModel"],[1,"w-full","bg-coke-red","text-white","px-6","py-3","rounded-lg","hover:bg-red-700","transition-colors","font-semibold","shadow-sm","text-sm",3,"click"],[1,"grid","grid-cols-2","gap-4"],[1,"block","text-xs","font-bold","text-gray-500","mb-1","uppercase"],[1,"w-full","bg-gray-800","text-white","px-6","py-3","rounded-lg","hover:bg-gray-700","transition-colors","font-semibold","shadow-sm","text-sm",3,"click"],[1,"mb-8","pb-12"],[1,"overflow-x-auto","border","rounded-lg","bg-white","shadow-sm"],[1,"w-full","text-sm","text-left","min-w-[600px]"],[1,"bg-gray-100","text-gray-600","uppercase","text-xs"],[1,"p-3","border-b"],[1,"hover:bg-gray-50"],[1,"w-2","h-2","rounded-full","bg-green-500","animate-pulse"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2",1,"w-3","h-3"],["d","M20 16V8a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v8"],["d","M2 12h20"],["d","M12 2v20"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","h-4","w-4","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],["d","m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72Z"],["d","m14 7 3 3"],["d","M5 6v4"],["d","M19 14v4"],["d","M10 2v2"],["d","M7 8H3"],["d","M21 16h-4"],["d","M11 3H9"],["points","17 8 12 3 7 8"],["x1","12","x2","12","y1","3","y2","15"],[1,"font-semibold","text-gray-700","text-sm"],[1,"p-2","bg-gray-100","rounded","hover:bg-gray-200","disabled:opacity-30","disabled:cursor-not-allowed",3,"click","disabled"],[1,"p-2","border-b","font-bold"],[1,"p-2","border-b"],["type","number","step","0.01",1,"w-full","p-2","border","rounded","focus:ring-1","focus:ring-blue-500",3,"ngModelChange","ngModel"],["type","text",1,"w-full","p-2","border","rounded","focus:ring-1","focus:ring-blue-500",3,"ngModelChange","ngModel"],["type","number","step","0.1",1,"w-full","p-2","border","rounded","focus:ring-1","focus:ring-blue-500",3,"ngModelChange","ngModel"],["type","number",1,"w-full","p-2","border","rounded","focus:ring-1","focus:ring-blue-500",3,"ngModelChange","ngModel"]],template:function(n,r){n&1&&(v(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),D(4,"Panel de Administraci\xF3n"),E(),v(5,"div",3)(6,"div",4)(7,"span",5),D(8,"Sincronizaci\xF3n:"),E(),Ue(9,xB,3,0,"span",6)(10,NB,6,0,"span",7),E(),v(11,"div",4)(12,"span",5),D(13,"Modo TV:"),E(),v(14,"button",8),me("click",function(){return r.store.togglePerformanceMode()}),Ue(15,RB,2,0,"span")(16,PB,2,0,"span"),E()()()(),v(17,"div",9)(18,"span",10),D(19,"Simulaci\xF3n:"),E(),v(20,"button",11),me("click",function(){return r.toggleSimulation()}),D(21),E()()(),v(22,"section",12)(23,"h2",13)(24,"span",14),D(25,"\u{1F4E2}"),E(),D(26," Cintillo de Avisos "),E(),v(27,"div",15)(28,"input",16),me("input",function(i){return r.updateAnnouncement(i)}),E()()(),v(29,"section",17)(30,"h2",18)(31,"span",14),D(32,"\u2728"),E(),D(33," Inteligencia Artificial "),E(),v(34,"p",19),D(35," Genera un reporte ejecutivo autom\xE1tico basado en los datos actuales de las tripulaciones. "),E(),v(36,"button",20),me("click",function(){return r.generateCrewReport()}),Ue(37,kB,4,0)(38,FB,10,0),E(),Ue(39,OB,2,1,"div",21),E(),Y(40,"hr",22),v(41,"section",23)(42,"h2",24)(43,"span",14),D(44,"\u{1F4C2}"),E(),D(45," Carga Masiva (Excel) "),E(),v(46,"div",25)(47,"button",26),me("click",function(){return r.downloadTemplate()}),wt(),v(48,"svg",27),Y(49,"path",28)(50,"polyline",29)(51,"line",30),E(),D(52," Descargar Plantilla "),E(),po(),v(53,"div",31)(54,"label",32),Ue(55,LB,4,0)(56,VB,5,0),E(),v(57,"input",33),me("change",function(i){return r.onFileChange(i)}),E()()()(),Y(58,"hr",22),v(59,"section",34)(60,"h2",35),Y(61,"span",36),D(62," Orden de Tarjetas (Layout) "),E(),v(63,"div",37),Qt(64,UB,8,4,"div",38,MB),E()(),Y(66,"hr",22),v(67,"div",39)(68,"section")(69,"h2",35),Y(70,"span",36),D(71," Datos de Seguridad "),E(),v(72,"div",40)(73,"div",41)(74,"label",42),D(75,"D\xEDas sin Accidentes"),E(),v(76,"input",43),en("ngModelChange",function(i){return Dn(r.safetyForm.daysWithoutAccident,i)||(r.safetyForm.daysWithoutAccident=i),i}),E()(),v(77,"div",41)(78,"label",42),D(79,"R\xE9cord Hist\xF3rico"),E(),v(80,"input",43),en("ngModelChange",function(i){return Dn(r.safetyForm.recordDays,i)||(r.safetyForm.recordDays=i),i}),E()(),v(81,"div",41)(82,"label",42),D(83,"R\xE9cord Anterior"),E(),v(84,"input",43),en("ngModelChange",function(i){return Dn(r.safetyForm.previousRecord,i)||(r.safetyForm.previousRecord=i),i}),E()(),v(85,"button",44),me("click",function(){return r.saveSafety()}),D(86," Guardar Seguridad "),E()()(),v(87,"section")(88,"h2",35),Y(89,"span",36),D(90," Saturaci\xF3n Almac\xE9n "),E(),v(91,"div",40)(92,"div",45)(93,"div")(94,"label",46),D(95,"Prod. Terminado (Real)"),E(),v(96,"input",43),en("ngModelChange",function(i){return Dn(r.warehouseForm.ptReal,i)||(r.warehouseForm.ptReal=i),i}),E()(),v(97,"div")(98,"label",46),D(99,"Capacidad PT"),E(),v(100,"input",43),en("ngModelChange",function(i){return Dn(r.warehouseForm.ptCap,i)||(r.warehouseForm.ptCap=i),i}),E()()(),v(101,"div",45)(102,"div")(103,"label",46),D(104,"Materia Prima (Real)"),E(),v(105,"input",43),en("ngModelChange",function(i){return Dn(r.warehouseForm.matReal,i)||(r.warehouseForm.matReal=i),i}),E()(),v(106,"div")(107,"label",46),D(108,"Capacidad MP"),E(),v(109,"input",43),en("ngModelChange",function(i){return Dn(r.warehouseForm.matCap,i)||(r.warehouseForm.matCap=i),i}),E()()(),v(110,"button",47),me("click",function(){return r.saveWarehouse()}),D(111," Guardar Almac\xE9n "),E()()()(),Y(112,"hr",22),v(113,"section",48)(114,"h2",35),Y(115,"span",36),D(116," Tripulaciones (Edici\xF3n R\xE1pida) "),E(),v(117,"div",49)(118,"table",50)(119,"thead",51)(120,"tr")(121,"th",52),D(122,"Nombre"),E(),v(123,"th",52),D(124,"PDF"),E(),v(125,"th",52),D(126,"Estancia"),E(),v(127,"th",52),D(128,"Seguridad"),E(),v(129,"th",52),D(130,"Ranking"),E()()(),v(131,"tbody"),Qt(132,BB,11,5,"tr",53,mh),E()()()()()),n&2&&(T(9),Be(r.store.syncStatus()==="cloud"?9:10),T(5),xe("bg-blue-100",r.store.performanceMode()==="high")("text-blue-700",r.store.performanceMode()==="high")("border-blue-200",r.store.performanceMode()==="high")("bg-orange-100",r.store.performanceMode()==="eco")("text-orange-700",r.store.performanceMode()==="eco")("border-orange-200",r.store.performanceMode()==="eco"),T(),Be(r.store.performanceMode()==="high"?15:16),T(5),xe("bg-green-100",r.store.isSimulationActive())("text-green-800",r.store.isSimulationActive())("border-green-300",r.store.isSimulationActive())("bg-gray-100",!r.store.isSimulationActive())("text-gray-500",!r.store.isSimulationActive())("border-gray-300",!r.store.isSimulationActive()),T(),_e(" ",r.store.isSimulationActive()?"ACTIVADA":"PAUSADA"," "),T(7),Te("value",r.store.announcement()),T(8),Te("disabled",r.isAnalyzing()),T(),Be(r.isAnalyzing()?37:38),T(2),Be(r.analysisResult()?39:-1),T(15),xe("opacity-50",r.isUploading())("cursor-not-allowed",r.isUploading())("pointer-events-none",r.isUploading()),T(),Be(r.isUploading()?55:56),T(2),Te("disabled",r.isUploading()),T(7),Zt(r.store.layout()),T(12),Xt("ngModel",r.safetyForm.daysWithoutAccident),T(4),Xt("ngModel",r.safetyForm.recordDays),T(4),Xt("ngModel",r.safetyForm.previousRecord),T(12),Xt("ngModel",r.warehouseForm.ptReal),T(4),Xt("ngModel",r.warehouseForm.ptCap),T(5),Xt("ngModel",r.warehouseForm.matReal),T(4),Xt("ngModel",r.warehouseForm.matCap),T(23),Zt(r.crews()))},dependencies:[tn,AI,Vu,Km,TI,Jm],encapsulation:2})}};function HB(t,e){t&1&&(v(0,"span",2),D(1,"\u2699\uFE0F Admin"),E())}function GB(t,e){t&1&&(v(0,"span",2),D(1,"\u{1F4CA} Dashboard"),E())}function $B(t,e){t&1&&Y(0,"app-dashboard")}function qB(t,e){t&1&&Y(0,"app-admin")}var wc=class t{constructor(){this.currentView=oe("dashboard")}toggleView(){this.currentView.update(e=>e==="dashboard"?"admin":"dashboard")}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=En({type:t,selectors:[["app-root"]],decls:6,vars:2,consts:[[1,"fixed","bottom-4","right-4","z-50","opacity-0","hover:opacity-100","transition-opacity","duration-500"],[1,"bg-femsa-dark","text-white","p-3","rounded-full","shadow-lg","hover:scale-105","transition-transform","border-2","border-femsa-red","flex","items-center","gap-2",3,"click"],[1,"font-bold"]],template:function(n,r){n&1&&(v(0,"div",0)(1,"button",1),me("click",function(){return r.toggleView()}),Ue(2,HB,2,0,"span",2)(3,GB,2,0,"span",2),E()(),Ue(4,$B,1,0,"app-dashboard")(5,qB,1,0,"app-admin")),n&2&&(T(2),Be(r.currentView()==="dashboard"?2:3),T(2),Be(r.currentView()==="dashboard"?4:5))},dependencies:[tn,Pu,Ic],encapsulation:2})}};function WB(t){let e=t,n=Math.floor(Math.abs(t)),r=t.toString().replace(/^[^.]*\.?/,"").length,o=parseInt(t.toString().replace(/^[^e]*(e([-+]?\d+))?/,"$2"))||0;return e===1?1:o===0&&n!==0&&n%1e6===0&&r===0||!(o>=0&&o<=5)?4:5}var Ow=["es",[["a.\u202Fm.","p.\u202Fm."],void 0,["a.\xA0m.","p.\xA0m."]],void 0,[["D","L","M","X","J","V","S"],["dom","lun","mar","mi\xE9","jue","vie","s\xE1b"],["domingo","lunes","martes","mi\xE9rcoles","jueves","viernes","s\xE1bado"],["DO","LU","MA","MI","JU","VI","SA"]],void 0,[["E","F","M","A","M","J","J","A","S","O","N","D"],["ene","feb","mar","abr","may","jun","jul","ago","sept","oct","nov","dic"],["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]],void 0,[["a. C.","d. C."],void 0,["antes de Cristo","despu\xE9s de Cristo"]],1,[6,0],["d/M/yy","d MMM y","d 'de' MMMM 'de' y","EEEE, d 'de' MMMM 'de' y"],["H:mm","H:mm:ss","H:mm:ss z","H:mm:ss (zzzz)"],["{1}, {0}",void 0,void 0,void 0],[",",".",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0\xA0%","#,##0.00\xA0\xA4","#E0"],"EUR","\u20AC","euro",{AUD:[void 0,"$"],BRL:[void 0,"R$"],BYN:[void 0,"\u0440."],CAD:[void 0,"$"],CNY:[void 0,"\xA5"],EGP:[void 0,"EGP"],ESP:["\u20A7"],GBP:[void 0,"\xA3"],HKD:[void 0,"$"],ILS:[void 0,"\u20AA"],INR:[void 0,"\u20B9"],JPY:[void 0,"\xA5"],KRW:[void 0,"\u20A9"],MXN:[void 0,"$"],NZD:[void 0,"$"],PHP:[void 0,"\u20B1"],RON:[void 0,"L"],THB:["\u0E3F"],TWD:[void 0,"NT$"],USD:["US$","$"],XAF:[],XCD:[void 0,"$"],XOF:[]},"ltr",WB];wC(Ow);Qh(wc,{providers:[Th(),{provide:In,useValue:"es-MX"}]}).catch(t=>console.error(t));
